<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:slash="http://purl.org/rss/1.0/modules/slash/"><channel><title>博客园-lifehacker</title><link>http://www.cnblogs.com/Lifehacker/</link><description>为美好生活而hack</description><language>zh-cn</language><lastBuildDate>Sun, 05 Jan 2020 08:58:53 GMT</lastBuildDate><pubDate>Sun, 05 Jan 2020 08:58:53 GMT</pubDate><ttl>60</ttl><item><title>jemalloc内存占用问题</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/11/28/jemalloc_settings.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 28 Nov 2019 12:09:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/11/28/jemalloc_settings.html</guid><description><![CDATA[<p>最近，有部分越南的服务器内存不断上涨，怀疑是内存泄漏，因为框架提供的内存报告里，C内存和Lua占用内存都不大，和ps里看的差好多。总内存在12G左右，C和Lua的加起来约4G，两者相差了8G</p>
<p>&nbsp;</p>
<p>经过一番排查，排除了混用glibc malloc和jemalloc的可能。于是<a href="https://github.com/spin6lock/multithread_memory_alloc_example" target="_blank">写了一个多线程的测试程序</a>，由多个生产者-消费者线程对组成。生产者分配一个随机大小的内存（在SIZE范围内），然后memset将内存遍历一次，再将指针通过管道发给消费者。消费者拿到指针后，读一下指针的值，然后释放指针对应内存块。这个模型模拟了skynet的一个线程分配内存（消息），发给另一个线程消费（释放）的情况。在没有设置jemalloc的参数的情况下，这个例程的内存会逐渐涨到一个峰值，然后不再增大，但也不再减少。如果设定了例程里的ABORT_COUNT，过了指定次数后不再进行内存分配，内存过几个小时也不会下降，这跟线上的情况类似</p>
<p>&nbsp;</p>
<p>通过MALLOC_CONF环境变量，设置了dirty_decay_ms:0,muzzy_decay_ms:0以后，内存的峰值变低了，观察top命令的RES内存，明显低了不少。将选项换成了background_thread:true，则例程即使不再分配内存，内存占用也会逐渐降低了。dirty_decay_ms表示内存块从dirty状态移动到muzzy状态的时间，muzzy_decay_ms是muzzy状态到释放给系统的时间。设为0以后行为会不一样，比如我两个参数都设置10000ms，并不是20秒后就会还给系统。。</p>
<p>&nbsp;</p>
<p>往后打算设置一下background_thread:true，让内存不再使用时慢慢还给系统，避免OOM Killer找上门来杀进程</p>]]></description></item><item><title>罕见的coredump了</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/10/27/lua_c_extension_stackoverflow.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 26 Oct 2019 16:11:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/10/27/lua_c_extension_stackoverflow.html</guid><description><![CDATA[<p>最近，项目在越南版删档测试的时候，发生了罕见的coredump，简单记一点排查日志</p>
<p>&nbsp;</p>
<p>目前的敏感词过滤是在C层做判定的，先后经过几个项目考验，模块算是比较稳定了。越南版有个需求，需要将敏感词里的空格去掉。比如敏感词是abc，现在不能说abc了，但是玩家可以输入&ldquo;a b c&rdquo;，所以需要过滤掉空格。有同事就对C层改了一下，判断rune是32的时候，就继续判断后续字符，出事的代码大致如下：</p>
<div class="cnblogs_code">
<pre>　　　　　　　　lua_rawgeti(L, 1, j);             <br />　　　　　　　　uint32_t rune = (uint32_t)lua_tointeger(L, -<span style="color: #800080;">1</span><span style="color: #000000;">);                                   
</span>+            <span style="color: #0000ff;">if</span> (rune == <span style="color: #800080;">32</span><span style="color: #000000;">) {                                                                 
</span>+                <span style="color: #0000ff;">continue</span><span style="color: #000000;">;                                                                     
</span>+<span style="color: #000000;">            }                                                                                 
             lua_pop(L, </span><span style="color: #800080;">1</span><span style="color: #000000;">);                                                                    
</span>-
             <span style="color: #0000ff;">if</span>(node ==<span style="color: #000000;"> NULL) {                                                                
                 node </span>=<span style="color: #000000;"> table_get(dict, rune);                                                 
             } </span><span style="color: #0000ff;">else</span> {</pre>
</div>
<p>这里会跳过lua_pop语句，导致之前lua_rawgeti的结果残留在栈上。但这个缺陷不会马上让进程挂掉，而是将栈弄坏一点点。我们来看Lua的栈定义：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;">** 'per thread' state
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 4</span> <span style="color: #0000ff;">struct</span><span style="color: #000000;"> lua_State {
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">  CommonHeader;
</span><span style="color: #008080;"> 6</span>   unsigned <span style="color: #0000ff;">short</span> nci;  <span style="color: #008000;">/*</span><span style="color: #008000;"> number of items in 'ci' list </span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 7</span> <span style="color: #000000;">  lu_byte status;
</span><span style="color: #008080;"> 8</span>   StkId top;  <span style="color: #008000;">/*</span><span style="color: #008000;"> first free slot in the stack </span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 9</span>   global_State *<span style="color: #000000;">l_G;
</span><span style="color: #008080;">10</span>   CallInfo *ci;  <span style="color: #008000;">/*</span><span style="color: #008000;"> call info for current function </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">11</span>   <span style="color: #0000ff;">const</span> Instruction *oldpc;  <span style="color: #008000;">/*</span><span style="color: #008000;"> last pc traced </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">12</span>   StkId stack_last;  <span style="color: #008000;">/*</span><span style="color: #008000;"> last free slot in the stack </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">13</span>   StkId stack;  <span style="color: #008000;">/*</span><span style="color: #008000;"> stack base </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">14</span>   UpVal *openupval;  <span style="color: #008000;">/*</span><span style="color: #008000;"> list of open upvalues in this stack </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">15</span>   GCObject *<span style="color: #000000;">gclist;
</span><span style="color: #008080;">16</span>   <span style="color: #0000ff;">struct</span> lua_State *twups;  <span style="color: #008000;">/*</span><span style="color: #008000;"> list of threads with open upvalues </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">17</span>   <span style="color: #0000ff;">struct</span> lua_longjmp *errorJmp;  <span style="color: #008000;">/*</span><span style="color: #008000;"> current error recover point </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">18</span>   CallInfo base_ci;  <span style="color: #008000;">/*</span><span style="color: #008000;"> CallInfo for first level (C calling Lua) </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">19</span>   <span style="color: #0000ff;">volatile</span><span style="color: #000000;"> lua_Hook hook;
</span><span style="color: #008080;">20</span>   ptrdiff_t errfunc;  <span style="color: #008000;">/*</span><span style="color: #008000;"> current error handling function (stack index) </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">21</span>   <span style="color: #0000ff;">int</span><span style="color: #000000;"> stacksize;
</span><span style="color: #008080;">22</span>   <span style="color: #0000ff;">int</span><span style="color: #000000;"> basehookcount;
</span><span style="color: #008080;">23</span>   <span style="color: #0000ff;">int</span><span style="color: #000000;"> hookcount;
</span><span style="color: #008080;">24</span>   unsigned <span style="color: #0000ff;">short</span> nny;  <span style="color: #008000;">/*</span><span style="color: #008000;"> number of non-yieldable calls in stack </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">25</span>   unsigned <span style="color: #0000ff;">short</span> nCcalls;  <span style="color: #008000;">/*</span><span style="color: #008000;"> number of nested C calls </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">26</span> <span style="color: #000000;">  l_signalT hookmask;
</span><span style="color: #008080;">27</span> <span style="color: #000000;">  lu_byte allowhook;
</span><span style="color: #008080;">28</span> };</pre>
</div>
<p>lua_State的stack是一个指针，指向一个动态申请的TValue指针数组。这个栈不仅是lua和C交互的时候，用于双方交换数据；lua函数调用的时候，也会将函数参数压栈（当然，调用关系不在这个栈上，而是通过CallInfo指针组织的双向链表来记录）Lua默认会给函数初始化20个格子，也可以通过lua_checkstack函数去增加栈的大小。L-&gt;top指向的是栈上的第一个可用空槽，L-&gt;top在正常使用的时候会小于L-&gt;ci-&gt;top，lua自带有api_check来检查。之前为了压榨性能，api_check也关掉了，所以没检查出stack overflow。</p>
<p>&nbsp;</p>
<p>当一个C函数不断往栈上push函数，超过栈的大小后，会写坏什么内存就没法确定了。出事的时候，写坏的是另一个协程的stack，另一个协程正准备resume回来，但是栈上存的ci-&gt;func是TValue（正数32），不是一个函数类型，就coredump了。</p>
<p>&nbsp;</p>
<p>稳妥起见，以后改C代码还是走一下code review吧，自己也打开api_check检查一下。。查这个问题花了很久，还有一个原因是其他同学搞混了线上版本，我看的是有问题的版本，结果另一个分支上的是没问题的版本，以为正式服上跑的是没问题的版本，查了好久。。。</p>]]></description></item><item><title>iPhone惊爆史诗级漏洞？漏洞细节解析</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/09/29/11609010.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 29 Sep 2019 09:24:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/09/29/11609010.html</guid><description><![CDATA[<p>最近@axi0mX 提到iOS有一个不能修复的漏洞，命名checkm8（读checkmate），可以击穿iPhone 4S到iPhone X间的所有iOS设备。而且由于这个漏洞存在于只读的bootrom中，苹果应该没法通过系统更新来修复掉。他发布这个漏洞是为了让大家可以安全的在最新系统下越狱，这样系统更安全，开发者也有更大的空间。</p>
<p>&nbsp;</p>
<p>好奇<a href="https://github.com/axi0mX/ipwndfu" target="_blank">看了一眼GitHub仓库</a>，作者两天前提交了一份</p>]]></description></item><item><title>线程数与游戏卡顿</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/09/21/thread_context_switch_slow.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 21 Sep 2019 09:24:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/09/21/thread_context_switch_slow.html</guid><description><![CDATA[<p>在某天凌晨，欧美服出现了卡顿，但是服务器的CPU并不高，内部服务监控日志来看，是clusteragent的mq overload了，网卡IO从流量上来看，也没达到瓶颈。后来，对方SA说是参数配错了，8核的机器配了24线程，改成8线程后重启，就不卡顿了。这里排查的时候用到了tracetag，虽然有点麻烦，还是值得的。</p>
<p>&nbsp;</p>
<p>后来，又再一次出现了同样的问题。反复调参后，发现center配4线程就有问题，配6线程就不会卡顿。子熏怀疑是<a href="https://github.com/cloudwu/skynet/blob/master/skynet-src/skynet_start.c#L209" target="_blank">线程权重设置有问题</a>，前面的-1都改成0就解决了，改成0以后即使再配4线程，也没有问题了。出问题的代码如下：</p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> weight[] =<span style="color: #000000;"> { 
        </span>-<span style="color: #800080;">1</span>, -<span style="color: #800080;">1</span>, -<span style="color: #800080;">1</span>, -<span style="color: #800080;">1</span>, <span style="color: #800080;">0</span>, <span style="color: #800080;">0</span>, <span style="color: #800080;">0</span>, <span style="color: #800080;">0</span><span style="color: #000000;">,
        </span><span style="color: #800080;">1</span>, <span style="color: #800080;">1</span>, <span style="color: #800080;">1</span>, <span style="color: #800080;">1</span>, <span style="color: #800080;">1</span>, <span style="color: #800080;">1</span>, <span style="color: #800080;">1</span>, <span style="color: #800080;">1</span><span style="color: #000000;">, 
        </span><span style="color: #800080;">2</span>, <span style="color: #800080;">2</span>, <span style="color: #800080;">2</span>, <span style="color: #800080;">2</span>, <span style="color: #800080;">2</span>, <span style="color: #800080;">2</span>, <span style="color: #800080;">2</span>, <span style="color: #800080;">2</span><span style="color: #000000;">, 
        </span><span style="color: #800080;">3</span>, <span style="color: #800080;">3</span>, <span style="color: #800080;">3</span>, <span style="color: #800080;">3</span>, <span style="color: #800080;">3</span>, <span style="color: #800080;">3</span>, <span style="color: #800080;">3</span>, <span style="color: #800080;">3</span><span style="color: #000000;">, };
    </span><span style="color: #0000ff;">struct</span><span style="color: #000000;"> worker_parm wp[thread];
    </span><span style="color: #0000ff;">for</span> (i=<span style="color: #800080;">0</span>;i&lt;thread;i++<span style="color: #000000;">) {
        wp[i].m </span>=<span style="color: #000000;"> m;
        wp[i].id </span>=<span style="color: #000000;"> i;
        </span><span style="color: #0000ff;">if</span> (i &lt; <span style="color: #0000ff;">sizeof</span>(weight)/<span style="color: #0000ff;">sizeof</span>(weight[<span style="color: #800080;">0</span><span style="color: #000000;">])) {
            wp[i].weight</span>=<span style="color: #000000;"> weight[i];
        } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
            wp[i].weight </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
        }
        create_thread(</span>&amp;pid[i+<span style="color: #800080;">3</span>], thread_worker, &amp;<span style="color: #000000;">wp[i]);
    }</span></pre>
</div>
<p>这里线程创建的时候，会定义一个权重数组，4核的时候，相当于每个线程权重都是-1，权重的用途<a href="https://github.com/cloudwu/skynet/blob/master/skynet-src/skynet_server.c#L320" target="_blank">可以看这里</a>：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span>     <span style="color: #0000ff;">int</span> i,n=<span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">struct</span><span style="color: #000000;"> skynet_message msg;
</span><span style="color: #008080;"> 3</span> 
<span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">for</span> (i=<span style="color: #800080;">0</span>;i&lt;n;i++<span style="color: #000000;">) {
</span><span style="color: #008080;"> 5</span>         <span style="color: #0000ff;">if</span> (skynet_mq_pop(q,&amp;<span style="color: #000000;">msg)) {
</span><span style="color: #008080;"> 6</span> <span style="color: #000000;">            skynet_context_release(ctx);
</span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> skynet_globalmq_pop();
</span><span style="color: #008080;"> 8</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (i==<span style="color: #800080;">0</span> &amp;&amp; weight &gt;= <span style="color: #800080;">0</span><span style="color: #000000;">) {
</span><span style="color: #008080;"> 9</span>             n =<span style="color: #000000;"> skynet_mq_length(q);
</span><span style="color: #008080;">10</span>             n &gt;&gt;=<span style="color: #000000;"> weight;
</span><span style="color: #008080;">11</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">int</span> overload =<span style="color: #000000;"> skynet_mq_overload(q);
</span><span style="color: #008080;">13</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (overload) {
</span><span style="color: #008080;">14</span>             skynet_error(ctx, <span style="color: #800000;">"</span><span style="color: #800000;">May overload, message queue length = %d</span><span style="color: #800000;">"</span><span style="color: #000000;">, overload);
</span><span style="color: #008080;">15</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span> <span style="color: #000000;">        skynet_monitor_trigger(sm, msg.source , handle);
</span><span style="color: #008080;">18</span> 
<span style="color: #008080;">19</span>         <span style="color: #0000ff;">if</span> (ctx-&gt;cb ==<span style="color: #000000;"> NULL) {
</span><span style="color: #008080;">20</span> <span style="color: #000000;">            skynet_free(msg.data);
</span><span style="color: #008080;">21</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">22</span>             dispatch_message(ctx, &amp;<span style="color: #000000;">msg);
</span><span style="color: #008080;">23</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span>         skynet_monitor_trigger(sm, <span style="color: #800080;">0</span>,<span style="color: #800080;">0</span><span style="color: #000000;">);
</span><span style="color: #008080;">26</span>     }</pre>
</div>
<p>这里10行的n表示mq的未处理消息条数，n右移-1位就是0，下面22行的dispatch_message就只会执行一次。右移0位，就表示有多少条消息，就处理多少条消息，右移1位，就是只处理（未处理消息条数/2）这么多。skynet_mq_pop是说从mq里尝试弹消息，成功返回0，mq是空则返回1。如果第一次进入for循环，mq有未处理消息，这时候权重为0，就会处理当前积压的消息。即使处理过程中来了新的消息，因为第8行的代码不会重复跑，所以会归并到下次消息调度来处理。</p>
<p>&nbsp;</p>
<p>子熏提到可以将权重改成-1，0，-1，0这样排布，目前项目是直接将最低线程数改成8来解决的，不用改代码。远期来看，可能引入优先级比较好，高优先级的多处理一下。子熏提的另一个问题值得思考，线程每次处理一个消息，然后切换出去，跟每次处理完当下所有消息，再切换出去，不考虑切换开销的话，工作量是不变的。为什么现在会出现CPU不高的情况呢？而且消息处理明显慢了很多</p>
<p>&nbsp;</p>
<p>我觉得这从侧面反映了当前的测量体系是有问题的，CPU不高不能反映游戏就正常运行了。有可能是线程总是在切换ctx，所以cache miss比较高，效率就比较低了。最好是能够搞出来一个工作模型，里面跑的是跟线上业务类似的工作负载，每条消息处理不会太快也不会太慢，然后比较一下处理一条就切换，跟处理完再切换，两种不同调度的吞吐量区别。</p>
<p>&nbsp;</p>
<p>参考阅读：</p>
<p>http://www.brendangregg.com/blog/2017-05-09/cpu-utilization-is-wrong.html</p>
<p>CPU Utilization is Wrong 作者认为CPU使用率指导意义不大，应该看的是Instruction Per Cycle，小于1的话往往是memory限制了CPU运行效率。吐槽下virtualbox，没提供相应的计数器，在perf里看不出来。。。</p>
<p>&nbsp;</p>
<p>后续</p>
<p>上次子熏提到，如果消息很多处理不过来，CPU不可能这么低。最后，子熏在卡顿的时候直接用gdb attach进去了，发现卡顿的时候在调poll。捋了一遍代码，结果是连接平台的mq用了block住线程的poll接口，然后最近合服，跑了多条mq。。。应该一条mq注册多个serverid，而不是每个serverid单独起一个服务，每个服务都去连平台mq的。</p>
<p>&nbsp;</p>
<p>调了权重后能极大改善，是因为mq服务卡了几个线程，剩余线程每次只处理一个的话，吞吐量就不够了，换成0会改善很多，但是如果mq服务更多（合服数量更多），还是会有同样的问题的。</p>
<p>&nbsp;</p>
<p>这里用gdb有点蛋疼，如果attach进去没遇上那个窗口，就比较难看到了。可惜用systemtap对系统要求太高了，装完一堆东西，还是这个没有那个没有，没法跑出来看。最后发现strace可以看到，strace -k -fp 进程pid -T -tt -o /tmp/strace.log可以打出来系统调用，还有每个调用的耗时，-k可以打调用栈。-k依赖于libunwind，我是自己编译后的版本才有的。。</p>]]></description></item><item><title>技能问题引发内存泄漏</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/08/09/npc_memory_leak.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 09 Aug 2019 08:16:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/08/09/npc_memory_leak.html</guid><description><![CDATA[<p>最近，在国服上的新职业技能，包含了一个弱点标记技能。玩家用技能打怪的时候，有一定概率给怪挂上弱点，下次攻击时用另一个技能攻击弱点，能爆出更大伤害。弱点的生命周期大约半分钟，过了以后弱点会消失，玩家退出场景后，弱点也会消失。</p>
<p>&nbsp;</p>
<p>实现的时候，弱点命中情况记在了受害者身上，同时注册监听了一个玩家死亡事件，方便玩家死亡的时候，清理受害者身上记录的玩家命中弱点信息。但是实现的时候，漏掉了反注册监听事件，导致怪物虽然死亡，但是事件管理器上还一直引用着这个对象，引发内存泄漏。</p>
<p>&nbsp;</p>
<p>万幸的是，对于场景服务，之前加上了skynet.memlimit 的2G内存限制。同时，因为同一个场景有多个分线，玩家没法进去的时候，会自己切换到另一个分线继续，所以没酿成重大事故。内存满了的服务，不会再接受call请求，所以玩家继续call的话，会变成玩家上的task堆积</p>
<p>&nbsp;</p>
<p>这个问题修了两次才修好，需要引以为戒。第一次修的时候，换了一套事件管理器，以为新的管理器会自动在怪物死亡时，清理它监听的事件。同时，看日志的时候只看到gc后内存小了，没有具体打印出怪物的数量来排查，测试的时间也比较短，需要一段时间才能看出来漏没漏的。。第二次添加了反注册监听事件就好了</p>
<p>&nbsp;</p>
<p>还有值得改进的，是以后开发这种复杂对象相互引用的，还是能用id就用id，避免错误引用住复杂对象。同时，事件管理器也可以优化一下，a对象关心b对象的事件，当a或者b死亡的时候，就应该清理注册的a关心b的事件，避免手残引起内存泄漏。。</p>
<p>&nbsp;</p>]]></description></item><item><title>Pull Request找原作者做review</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/07/30/git_blame_find_origin_authur.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 30 Jul 2019 13:28:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/07/30/git_blame_find_origin_authur.html</guid><description><![CDATA[<p>最近对代码库进行了一次全局替换，改了150个左右的文件，发了PR后需要找原作者确认一下，于是写了个工具做git blame，<a href="https://github.com/spin6lock/check_original_author" target="_blank">地址在这里</a></p>
<p>&nbsp;</p>
<p>写完发现一个问题，如果只是新增一个函数，没有调用，是应该不用找原作者的......但是，要识别出新增一个函数，没想象中容易，需要基于ast来做diff，才能发现。也就是说，这个工具对于批量替换的功能，才比较好用，其他改动不太合适，蛋疼&hellip;&hellip;</p>]]></description></item><item><title>Nginx超时设定</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/07/11/goscon_handshake_timeout_setting.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 11 Jul 2019 12:33:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/07/11/goscon_handshake_timeout_setting.html</guid><description><![CDATA[<p>最近针对公司的goscon网关发了一个PR，新增了握手阶段的超时判定。现在回顾一下Nginx的所有超时判定，看看目前还缺少哪些判定</p>
<p>&nbsp;</p>
<p>ngx_http_core_module包含的timeout：</p>
<p><code><strong>client_header_timeout （默认60秒）<br /></strong></code></p>
<p><code><strong>client_body_timeout　　（默认60秒）<br /></strong></code></p>
<p><code><strong>keepalive_timeout　　　（默认75秒）</strong> </code></p>
<p><code><strong>lingering_timeout　　　（默认5秒）</strong></code></p>
<p><strong><code><strong>resolver_timeout　　　　（默认30秒）</strong></code></strong></p>
<p><code><strong>send_timeout　　　　　　（默认60秒）</strong></code></p>
<p>&nbsp;</p>
<p>上述参数对应的行为如下：</p>
<ol>
<li><code><strong>client_header_timeout</strong></code>对应的是客户端发送http请求头的行为</li>
<li><code><strong>client_body_timeout</strong></code>对应的是客户端发送http消息体的行为</li>
<li><code><strong>keepalive_timeout</strong></code>对应的是http 1.1协议里的保活时长</li>
<li><code><strong>lingering_timeout</strong></code>是配合<code><strong>lingering_close</strong>使用的，就是说关闭socket前，客户端还有数据发给服务器的话，<strong>lingering_close</strong>用于设定要不要等客户端继续发，<code><strong>lingering_timeout</strong></code>决定等多久。这里是一个等待-读取-抛弃数据的循环，有可能重复多次，但是每次等待都不会超过<code><strong>lingering_timeout</strong></code>设定的时长</code></li>
<li><strong><code><strong>resolver_timeout</strong></code></strong>对应的是域名解析的时长</li>
<li><code><strong>send_timeout</strong></code>对应的是发送http响应给客户端时的超时。这里对应的是两次写操作之间的时长，经过了<code><strong>send_timeout</strong>的时间后，还不能写的话，就关闭连接。</code></li>

</ol>
<p>对应到goscon，目前的超时参数，是reuseTimeout和uploadMaxDelay。reuseTimeout会在read/write操作异常的时候生效，度过reuseTimeout时间后，goscon保持的连接对就会被释放，里面的缓存数据都会丢掉。从行为上看，有点类似Nginx的keepalive_timeout。</p>
<p>&nbsp;</p>
<p>uploadMaxDelay是用在给socket设置读超时上的，只要设置了这个参数（和optUploadMinPacket），每次从socket里读数据都会设置一个deadline。超过deadline后，会返回错误。这里漏了一个写的超时，留了个SetWriteDeadline的接口，但是没有调用。每次写操作也应该有类似的流程，超过delay后write就返回error，Timeout()==True。这个参数类似于Nginx的send_timeout，针对的是两次成功写操作的间隔。缺陷是对方依然可以每次读1个字节，然后等满一次timeout来占用资源。</p>
<p>&nbsp;</p>
<p>这次goscon新增的握手阶段的超时（handshakeTimeout），类似于client_header_timeout+client_body_timeout+send_timeout，包含了服务器对客户端的一次读，对客户端的一次写。之前只要连上tcp，不进行握手操作，不会有任何超时机制，目前新增的超时可以针对这种情况做处理。</p>]]></description></item><item><title>Rust对协程的思考</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/06/02/rust_remove_librt_and_green_thread.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 02 Jun 2019 02:34:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/06/02/rust_remove_librt_and_green_thread.html</guid><description><![CDATA[<p>最近和同事聊起来，觉得lua缺乏编译型语言的类型校验功能，还有变量拼写检查之类的，导致线上总是有低级错误出现。比如最近有一个是变量名拼写少了一个字母，导致某功能没开启；还有一个是变量传参时，之前测试多加了一个参数，测试完成后忘记删了，导致参数顺序不对。之前看过有个TypeLua，没想到现在已经不怎么维护了，去搞了Titan-lang，然而Titan也是4个月没动静了。。。</p>
<p>&nbsp;</p>
<p>目前也没想到什么好的解决办法，于是顺带看看Rust-lang，开阔一下思路。我最佩服rust这帮人的，是他们有点壮士断腕的勇气，已经写好的runtime和协程，认为和rust的定位不妥，就直接砍掉了。<a href="https://github.com/rust-lang/rfcs/pull/230" target="_blank">相关的PR在这里</a>，<a href="https://github.com/aturon/rfcs/blob/remove-runtime/active/0000-remove-runtime.md" target="_blank">rfcs在这里</a>。rfcs里面关于协程、线程模型的讨论相当到位，我简要翻译一下，权当记录。以下是译文（节译）：</p>
<p>&nbsp;</p>
<p>背景：线程/任务模型和I/O</p>
<p>很多语言/库会提供任务，任务一般有别于操作系统的原始线程。任务的特性可以按以下几个维度区分：</p>
<ul>
<li>1:1 vs M:N 最根本的问题是一个任务是不是总是对应到一个OS级别的线程（1:1模型），或者是通过用户空间调度器，将任务映射到worker线程上（M：N模型）。有一些内核，比如Windows，支持用户空间调度的1:1模型，结合了这两者的优势。</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在M：N模型里，关于任务何时或者是否在worker线程迁移，各自有不同的选择。但是这个模型有个弊端，如果其中一个任务触发了page fault，整个worker线程都会被阻塞。选择合适的worker线程数目是非常困难的，有些框架尝试动态分配线程数，这也会产生额外开销。</p>
<ul>
<li>&nbsp;栈管理。在1:1模型里，任务就是线程，天然具有栈。在M：N模型里，任务可能有他们自己的栈，这里有重要的取舍：
<ul>
<li>分段栈（segmented stacks）允许栈随着时间增长，意味着任务可以有自己的栈，而且依然保持轻量。但是，分段栈有<a href="https://mail.mozilla.org/pipermail/rust-dev/2013-November/006314.html" target="_blank">明显的性能问题和复杂度开销</a>。</li>
<li>在没有自己的栈的情况下，任务要么无法在工作线程间迁移（例如Java框架里的<a href="http://gee.cs.oswego.edu/dl/papers/fj.pdf" target="_blank">fork/join</a>），或者只能用CPS（continuation-passing style）实现，即每个阻塞操作都用一个闭包保存自己的工作状态。（CPS一般将用到的栈保存在闭包里）好处是这些任务特别轻量，基本只是闭包的开销。</li>
</ul>
</li>
<li>阻塞和I/O支持。在1:1模型里，一个任务可以被任意阻塞而不会影响其他任务，因为每个任务都是一个OS线程。在M：N模型里，OS的阻塞意味着工作线程的阻塞（比如运行较长时间的循环，或者page fault）M：N模型可以用数种方法解决阻塞。在Java的fork/join框架下，是透过动态增减工作线程来实现的。另一种实现，是提供特殊的任务阻塞操作（包括I/O），将阻塞操作化作底层的非阻塞操作，允许底层工作线程继续运行。但是，这种实现只能对显式阻塞起作用，对于循环、page fault之类的就无效了。</li>
</ul>
<p>Rust的现状</p>
<p>Rust从绿色线程模型（即协程模型）转向了原始线程模型：</p>
<ul>
<li>在Rust的绿色线程模型里，任务是按M:N进行调度，有自己的栈。最初，Rust使用了分段栈，后面改成了预分配的栈，这样Rust的绿色线程就不是轻量级的了。对阻塞的操作下文再叙</li>
<li>在Rust的原始线程模型里，任务是1:1的和OS线程匹配的。</li>
</ul>
<p>（节略）</p>
<p>问题</p>
<p>强制的共同演进：绿色线程模型和原始线程模型必须提供相同的I/O接口，但是有部分接口只会在其中一种模型里有效。比如，轻量级</p>
<p>开销：目前的Rust模型允许运行时将绿色线程模型和原始线程模型混合使用。但是实现上有如下缺点：</p>
<ul>
<li>二进制大小。任意二进制文件里都包含了整个I/O系统的实现，因为他是libstd标准库的一部分。</li>
<li>任务局部存储。目前的任务局部存储是可以无缝在原始线程和绿色线程间切换的。但是性能会有影响，即使可以改进，也比直接采用原始的线程局部存储要复杂得多。</li>
<li>动态分配和调度。当前的设计下，所有I/O操作都需要动态调度，大部分的内存分配操作也是。但是，绝大部分情况下，</li>
</ul>
<p>问题重重的I/O交互：</p>
<p>嵌入式的Rust：</p>
<p>维护困难：</p>]]></description></item><item><title>Python的定时执行</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/05/29/python_crontab.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 29 May 2019 08:37:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/05/29/python_crontab.html</guid><description><![CDATA[<p>最近手把手教妹子写Python，被一篇博客误导了，这里记录一下。</p>
<p>妹子需要的是一个定时闹钟，到点往钉钉群里推个消息。她一顿搜索猛如虎，参照着其他人的博客，搞了一个while：</p>
<div class="cnblogs_code">
<pre>target_time = mktime(time.strptime(<span style="color: #800000;">"</span><span style="color: #800000;">2019-5-29 15:30:00</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">%Y-%m-%d %H:%M:%S</span><span style="color: #800000;">"</span><span style="color: #000000;">))

</span><span style="color: #0000ff;">while</span><span style="color: #000000;"> True:
   now </span>=<span style="color: #000000;"> time.time()
   </span><span style="color: #0000ff;">if</span> now &gt;<span style="color: #000000;"> target_time:
       </span><span style="color: #0000ff;">print</span>(u<span style="color: #800000;">"</span><span style="color: #800000;">到点</span><span style="color: #800000;">"</span><span style="color: #000000;">)
       </span><span style="color: #0000ff;">break</span></pre>
</div>
<p>这种没啥技术含量的代码，居然有人堂而皇之写在博客里，简直是误导嘛。。。跑起来以后CPU一个核就在空跑，等着时间到了，跟<a href="https://www.jianshu.com/p/4f526ea40df4" target="_blank">睡眠排序</a>的xx程度可以一拼</p>
<p>&nbsp;</p>
<p>于是先让妹子搞好发钉钉的代码，封装一个给文本就能推钉钉机器人的小函数出来：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> requests
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> json
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> _notify_dd(text):
        ding_msg </span>=<span style="color: #000000;"> {
            </span><span style="color: #800000;">"</span><span style="color: #800000;">msgtype</span><span style="color: #800000;">"</span>: <span style="color: #800000;">"</span><span style="color: #800000;">text</span><span style="color: #800000;">"</span><span style="color: #000000;">,
            </span><span style="color: #800000;">"</span><span style="color: #800000;">text</span><span style="color: #800000;">"</span><span style="color: #000000;">: 
            {
                </span><span style="color: #800000;">"</span><span style="color: #800000;">content</span><span style="color: #800000;">"</span><span style="color: #000000;">: text,
                </span><span style="color: #800000;">"</span><span style="color: #800000;">title</span><span style="color: #800000;">"</span>:<span style="color: #800000;">"</span><span style="color: #800000;"> title</span><span style="color: #800000;">"</span><span style="color: #000000;">
             }
        }
        robotUrl </span>= <span style="color: #800000;">"</span><span style="color: #800000;">xxxx</span><span style="color: #800000;">"</span> #<span style="color: #000000;">自己填钉钉机器人url
        headers </span>= {<span style="color: #800000;">"</span><span style="color: #800000;">Content-Type</span><span style="color: #800000;">"</span>:<span style="color: #800000;">"</span><span style="color: #800000;">application/json</span><span style="color: #800000;">"</span><span style="color: #000000;">}
        requests.post(robotUrl, data </span>= json.dumps(ding_msg), headers = headers)</pre>
</div>
<p>接下来就是定时器的部分，之前我是想着给她开一个Linux用户，然后用crontab跑。后来发现Python有个模块sched，可以定时执行，示例代码：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> sched, time
s </span>=<span style="color: #000000;"> sched.scheduler(time.time, time.sleep)
</span><span style="color: #0000ff;">def</span> print_time(a=<span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span><span style="color: #000000;">):
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">From print_time</span><span style="color: #800000;">"</span><span style="color: #000000;">, time.time(), a)

</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> print_some_times():
    </span><span style="color: #0000ff;">print</span><span style="color: #000000;">(time.time())
    s.enter(</span>10, 1<span style="color: #000000;">, print_time)
    s.enter(</span>5, 2, print_time, argument=(<span style="color: #800000;">'</span><span style="color: #800000;">positional</span><span style="color: #800000;">'</span><span style="color: #000000;">,))
    s.enter(</span>5, 1, print_time, kwargs={<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">keyword</span><span style="color: #800000;">'</span><span style="color: #000000;">})
    s.run()
    </span></pre>
</div>
<p>这里调了：sched.scheduler、s.enter、s.run三个方法。第一个方法是创建一个调度器，采用time.sleep阻塞等待，time.time返回当前时间。s.enter是插入定时执行事件，第一个参数是需要等待的时间，第二个参数是优先级，时间相同按优先级执行，第三个是需要执行的函数action，后面的参数是传给action的参数。第三个s.run是执行阻塞，等待事件执行</p>
<p>&nbsp;</p>
<p>最后，只要结合time.mktime来算下目标时间的时间戳，然后和当前时间相减算下等待时间，交给sched去执行就行了😄如果需要循环执行，可以考虑用schedule这个第三方库，语法比较友好</p>]]></description></item><item><title>占坑</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/04/30/10798380.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 30 Apr 2019 14:31:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/04/30/10798380.html</guid><description><![CDATA[<p>test</p>]]></description></item><item><title>Mesh内存分配器的mmap小技巧</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/03/05/mmap_tricks_in_mesh_allocation.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 05 Mar 2019 06:57:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/03/05/mmap_tricks_in_mesh_allocation.html</guid><description><![CDATA[<p>最近看了<a href="https://arxiv.org/abs/1902.04738" target="_blank">一篇内存分配器的论文</a>，原理很简单，但是里面的数学论证还没看懂，这次先简单写一下原理和用到的API。</p>
<p>&nbsp;</p>
<p>内存分配器是用于封装操作系统提供的底层API，给应用程序提供动态内存的。内存不断申请释放后，往往会形成内存碎片。当需要申请一段较大的内存时，当前剩余内存总量是够的，但是被当前申请的内存块隔断成一个个小隔间，内存分配器无法给出指定长度的内存。这时就只能向操作系统重新申请，或者对应用程序返回分配失败了。</p>
<p>&nbsp;</p>
<p><a href="https://fredrikhaglund.net/blog/2006/09/15/user-group-meeting-in-stockholm/" target="_blank"><img src="https://img2018.cnblogs.com/blog/90397/201903/90397-20190305113233131-1712887515.gif" alt="" /></a>（<a href="https://fredrikhaglund.net/blog/2006/09/15/user-group-meeting-in-stockholm/" target="_blank">图片来自这里</a>）</p>
<p>如上图所示，不断申请内存后，内存占用如Figure 2所示。应用程序释放部分内存后，形成Figure 3。前面的两个空闲内存块，就只能用来放小的内存对象了。即使总内存足够，也因为中间内存对象的隔断，无法分配出足够大的内存。</p>
<p>&nbsp;</p>
<p>为了避免内存碎片增多，Mesh提出了内存页合并的想法。在现代的Linux系统上，内存页一般以4K大小分配，假设页A有碎片，页B也有碎片，但是页A和页B的碎片相对于页头的偏移刚好不重叠，那就可以将两者合成一页，腾出完整的一页来分配较大的内存。见下图：</p>
<p>&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/90397/201903/90397-20190305114638452-1611828768.png" alt="" />（图来自论文）</p>
<p>这种合并的方法有一个问题，c/c++的应用程序可能直接存下了对象的地址，所以内存合并后，原有分配对象的地址不能变。作者用了一个巧妙的方法来解决这个问题：</p>
<p>1. 作者用内存文件系统创建了一个内存文件（mkstemp）</p>
<p>2. 通过mmap api创建一个1:1的内存映射，将第一步的文件映射为一块内存（mmap，这里需要设为MAP_SHARED, 如果设为&nbsp;MAP_PRIVATE则重映射后B页内容会丢掉）</p>
<p>3. 假设算法发现有A和B两页内存可进行合并，则将B中存的对象用memcpy拷贝到A里去（memcpy或者普通的赋值操作）</p>
<p>4. 通过mmap api将B页重新映射到A页对应的文件偏移上（mmap，这里需要设为MAP_FIXED，表示新的内存映射就用这个地址开始）</p>
<p>这样应用程序依然可以通过原有的内存地址访问原有的内存对象，而对象实际上已经移动到新的位置了。</p>
<p>&nbsp;</p>
<p>上面的步骤<a href="https://github.com/spin6lock/mmap_experiment/" target="_blank">我做了个小实验</a>验证了一下，的确可行。作者论文里提到修改页表来完成，之前纠结了很久为什么应用程序可以改页表，不是操作系统维护页表的吗？可以改页表不就可以碰物理内存了？&hellip;&hellip;才知道原来mmap可以这样玩233333</p>
<p>&nbsp;</p>]]></description></item><item><title>尝鲜svnup</title><link>http://www.cnblogs.com/Lifehacker/archive/2019/01/24/try_svnup.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 24 Jan 2019 02:50:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2019/01/24/try_svnup.html</guid><description><![CDATA[<p>最近有同事折腾了一下svnup的编译，终于可以在Mac OS X和Linux上面编译通过了，<a href="https://github.com/lvzixun/svnup/" target="_blank">仓库在这里：https://github.com/lvzixun/svnup/</a></p>
<p>&nbsp;</p>
<p>svnup这个工具只有一个功能，就是跑svn up。然而比较奇葩的是这货基本不读svn的配置，即使是在checkout好的svn仓库里跑，也还是需要自己在/usr/local/etc/svnup.conf里将仓库的路径之类传进去。或者用里面的一个section，然后命令行传参覆盖仓库地址。这个工具支持svn和http协议，但是居然不支持http协议的身份验证，还是同事帮忙加上的&hellip;&hellip;Apache实现的svn，必须一个一个文件checkout下来，一个文件卡住，其他文件也拉不下来。而svnup是不管三七二十一，直接将请求一股脑丢给服务器，然后再慢慢等服务器返回。之前听到这点的时候还是感觉风中凌乱的，http1.x协议都是一个请求一个回复，顺序进行的，需要多个请求并发就需要多个连接。后来想了一下，也的确没毛病，反正读完一个请求就写一个文件，文件checkout下来的顺序并不重要</p>
<p>&nbsp;</p>
<p>看subversion的代码，他是封装了一个libsvn_client的库来做实际逻辑的。update的时候一个一个请求的发，是因为有可能需要处理冲突的情况，一个一个处理冲突，对于frontend来说比较简单吧</p>
<p>&nbsp;</p>
<p>所以svnup其实相当于一个爬虫，根据版本号直接批量将文件下载下来，不管本地文件有没有修改，有没有冲突，直接统统覆盖掉&hellip;&hellip;建议慎用:)</p>]]></description></item><item><title>HTTP Post multipart/form-data支持</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/12/24/skynet_http_multipart.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 24 Dec 2018 09:18:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/12/24/skynet_http_multipart.html</guid><description><![CDATA[<p>最近需要向平台发送录像文件，但是Skynet没有multipart/form-data的Post请求支持，写篇blog记录一下</p>
<p>&nbsp;</p>
<p>skynet有自带简单的httpc，里面有post方法。但是这个post方法已经写死了Content-type，只能是url-encoded类型的，所以只适合body是几个key-value对的情况。</p>
<p>&nbsp;</p>
<p>所以只能有最原始的httpc.request方法了。请求头比较灵活，可以自己设置为Content-type: multipart/form-data; 除了这个，还需要设置一个boundary，用来分割需要同时上传多个field的情况。每个field长这样：</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">--------------------------d74496d66958873e
Content-Disposition: form-data; name="secret"; filename="file.txt"
Content-Type: text/plain

contents of the file
--------------------------d74496d66958873e--</span></pre>
</div>
<p>其中<span style="color: #000000;">--------------------------d74496d66958873e</span> 这个就是boundary，最后会加上--表示结束。</p>
<p>&nbsp;</p>
<p>特别鸣谢cURL的文档：https://ec.haxx.se/http-multipart.html，里面写的非常详细。还提到了一个Expect参数，让服务器可以用100 continue来让客户端继续传，如果因为身份认证等问题出错，可以直接返回错误码，中断客户端上传，避免上传了一大堆然后发现没权限的浪费。</p>
<p>&nbsp;</p>
<p>对于多个field的编码，可以用这个库：https://github.com/Kong/lua-multipart，会帮你将body编码好</p>]]></description></item><item><title>MongoDB慢查询性能分析</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/11/25/mongodb_slow_quey.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 25 Nov 2018 11:50:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/11/25/mongodb_slow_quey.html</guid><description><![CDATA[<div>最近，长期运营后的港台服出现一个问题，web充值很慢，用gm指令查询玩家信息也很慢。最后定位到MongoDB查询也很慢。</div>
<div>&nbsp;</div>
<div>刚开始定位的时候，运营SA直接查指定的玩家，并反映很慢，就猜测是索引的问题。有可能是索引太大，没法全部放进内存，导致读索引需要多次读取磁盘，最后整个查询要4-5s才能完成。后来阅读了一下MongoDB的文档，发现其也是用B-Tree放索引的，也尽量将索引加载在内存里了。当然，索引有没有在内存里这个指标，还是没有日志或者查询结果暴露的&hellip;&hellip;</div>
<div>&nbsp;</div>
<div>后来，对面运营客服提醒，只有指定角色比较慢，也让运营的DBA做了分析，发现是有命中唯一索引的。优化只能去查询部分字段，避免全量查询来解决了。但是我让对方SA导出了指定查询慢的玩家数据，这个文档只有不到4MB，ssd读取这么小的数据不应该这么慢</div>
<div>&nbsp;</div>
<div>于是继续翻文档，将explain、loglevel调整增加性能日志项、mongotop、mongostat等工具都玩了一遍，全部都提示查询时间在毫秒级别，命中索引，没看到哪个指标反映到现在秒级查询时间的状况</div>
<div>&nbsp;</div>
<div>后来猜应该是字段太多，做了个小工具做分析，打印一个document里嵌套最深的字段，以及下级元素最多的字段。发现由于web充值慢的问题，台方客服一直往玩家身上发订单，数据没有及时清理，所以订单字段挂了2000张订单的信息&hellip;&hellip;还有一处回收系统的设计缺陷，导致回收数据膨胀，一个数组有上万大小。这可能导致了MongoDB将数据序列化成bson时产生性能问题，不过所有统计工具都不会分析bson化所需时间，好郁闷</div>
<div>&nbsp;</div>
<div>于是按生效快慢程度排了优先级，分别针对几个问题做处理。首先是将查询接口做特化处理，去掉这次分析出的庞大字段，该方法生效最快，影响较小，但是由于历史原因，具体用到的字段没有明确列出，没法做的太细和精准了。然后针对订单问题，做了玩家上线后清理订单的操作。最后，回收系统的bug做了修复，上线时做好数据清理</div>
<div>&nbsp;</div>
<div>为了进一步压缩玩家文档大小，还紧急上线了一个orm方面的优化，如果一个结构体里都是默认字段，而该结构体也不在一个数组里，则整个结构体都不做存储，减少默认字段对空间的占用问题。优化后，原来查询慢的玩家，document大小缩小到原来一半，成效卓著</div>]]></description></item><item><title>redis的LRU算法（二）</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/09/24/redis_lru.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 24 Sep 2018 05:23:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/09/24/redis_lru.html</guid><description><![CDATA[<p><a href="https://www.cnblogs.com/Lifehacker/p/redis_random_lru.html" target="_blank">前文再续，书接上一回</a>。上次讲到redis的LRU算法，文章实在精妙，最近可能有机会用到其中的技巧，顺便将下半部翻译出来，实现的时候参考下。</p>
<p>&nbsp;</p>
<p>搏击俱乐部的第一法则：用裸眼观测你的算法</p>
<p>Redis2.8的LRU实现已经上线了，在不同的负载环境下经过测试，用户没有抱怨Redis的清理机制。为了继续改进，我希望能观察到算法的性能，同时不会浪费大量CPU，不增加1比特空间占用。</p>
<p>&nbsp;</p>
<p>我设计了一个测试用例。导入指定数量的key，然后顺序访问他们，好让他们的最近访问时间顺序递减。再添加50%的key，那么之前的key有50%就会被淘汰掉。理想情况下，被淘汰的应该是前50%的。如下图：</p>
<p><img src="https://img2018.cnblogs.com/blog/90397/201809/90397-20180924105603880-781523132.png" alt="" /></p>
<p>绿色的是新添加的key，灰色的是第一次添加的key，白色表示被移除的。</p>
<p>&nbsp;</p>
<p>LRU v2：不要丢掉重要信息</p>
<p>当采用了N-key取样时，默认会建立16个key的池，将里面的key按空闲时间排序。新key只会在池不满或者空闲时间大于池里最小的，才能进池。</p>
<p>&nbsp;</p>
<p>这个实现极大的提升了性能，实现又简单，没有大bug。只要一点点性能监控和一些memmove()就完成了。</p>
<p>&nbsp;</p>
<p>同时，新的redis-cli模式（-lru-test）支持测试LRU精度，可以更接近真实的负载来看新算法的工况，尝试不同算法的时候，至少可以发现明显的速度退化。</p>
<p>&nbsp;</p>
<p>最近最少访问（LFU）</p>
<p>我最近又部分重构了Redis cache的换页算法。这些工作源于一个issue：当你在Redis 3.2有多个数据库的时候，算法总是做局部选择。比如DB 0的所有key都用的很频繁，DB 1的所有key都用的很少。Redis会从每个DB里丢弃一个key。理性的选择应该是先丢弃DB 1的key，丢完以后再丢DB 0的</p>
<p>&nbsp;</p>
<p>Redis用作cache的时候，通常不会跟不同DB混合用，但我还是开始着手改进，最后将db的id包括在池里，然后所有DB都共用一个池，这个实现比原始先快20%</p>
<p>&nbsp;</p>
<p>这次改进激起了我对Redis这块子系统的好奇心。我花了好些天进行优化，如果我用一个大点的池子，会好点吗？如果选择key的时候考虑了流逝的时间，效果会不会更好？</p>
<p>&nbsp;</p>
<p>最后，我终于明白到，LRU算法会受到取样数量限制，只要数量足够，效果就很好，很难再改进。正如上图所示，每次取样10个键，已经和理论上的LRU几乎一样准确了。</p>
<p>&nbsp;</p>
<p>因为原始算法难以改进，我开始想其他办法。回顾前文，其实我们真正想要的，是保留未来最有可能访问的key，即是最常访问的key，而不是最新访问的key。这就是LFU算法。理论上LFU的实现很简单，只要给每个key挂一个计数器，我们就可以知道给定的key是不是比另一个key访问更多了。</p>
<p>&nbsp;</p>
<p>当然，LFU的实现上有几个通用的难点：</p>
<p>1. LFU里没法使用链表法转移到头部的技巧了。因为完美LFU需要key严格按访问量排序。当访问量一致时，排序算法可能劣化为O（N），即使计数器只变了一点点</p>
<p>2. LFU没法简单的只在访问时对计数器加一。因为访问模式会随着时间发生变化，所以一个高分的key需要随着时间流逝而分数递减。</p>
<p>&nbsp;</p>
<p>在Redis里第一个问题不是问题，我们可以沿用LRU的随机取样方法。第二个问题仍然存在，我们需要一个方法来递减分数，或者随着时间流逝将计数器折半。</p>
<p>&nbsp;</p>
<p>24bit空间实现的LFU</p>
<p>在Redis里，我们可以用的就是LRU的24bit空间，需要一些奇技淫巧来实现。</p>
<p>&nbsp;</p>
<p>在24bit空间里，需要塞下：</p>
<p>1. 某种类型的访问计数器</p>
<p>2. 足够的信息来决定何时折半计数器</p>
<p>&nbsp;</p>
<p>我的解决方案如下：</p>
<div class="cnblogs_code">
<pre>           <span style="color: #800080;">16</span> bits      <span style="color: #800080;">8</span><span style="color: #000000;"> bits
      </span>+----------------+--------+
      + Last decr time | LOG_C  |
      +----------------+--------+</pre>
</div>
<p>8bit用来计数，16bit用来记录上次递减的时间</p>
<p>&nbsp;</p>
<p>你可能会认为，8bit计数器很快就会溢出了吧？这就是技巧所在：我用的是对数计数器。具体代码如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">  uint8_t LFULogIncr(uint8_t counter) {
      </span><span style="color: #0000ff;">if</span> (counter == <span style="color: #800080;">255</span>) <span style="color: #0000ff;">return</span> <span style="color: #800080;">255</span><span style="color: #000000;">;
      </span><span style="color: #0000ff;">double</span> r = (<span style="color: #0000ff;">double</span>)rand()/<span style="color: #000000;">RAND_MAX;
      </span><span style="color: #0000ff;">double</span> baseval = counter -<span style="color: #000000;"> LFU_INIT_VAL;
      </span><span style="color: #0000ff;">if</span> (baseval &lt; <span style="color: #800080;">0</span>) baseval = <span style="color: #800080;">0</span><span style="color: #000000;">;
      </span><span style="color: #0000ff;">double</span> p = <span style="color: #800080;">1.0</span>/(baseval*server.lfu_log_factor+<span style="color: #800080;">1</span><span style="color: #000000;">);
      </span><span style="color: #0000ff;">if</span> (r &lt; p) counter++<span style="color: #000000;">;
      </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> counter;
  }</span></pre>
</div>
<p>计数器的值越大，真正加一的概率越小。上述代码算出一个概率p，介乎0到1之间，计数器越大，p越小。然后生成0-1之间的随机数r，只有r&lt;p的时候，计数器才会加一。</p>
<p>&nbsp;</p>
<p>现在我们来看看计数器折半的问题。转成分钟为单位的unix时间，低16位会存在上面保留的16位空间内。当Redis进行随机取样，扫描key空间的时候，所有遇到的key都会被检查是否应该递减。如果上次递减实在N分钟之前（N是可配置的），并且计数器的值是高分值，那计数器就会被折半。如果计数器是低分值，则只会递减。（希望我们可以更好的分辨少访问量的key，因为我们的计数器精度比较低）</p>
<p>&nbsp;</p>
<p>还有一个问题，新的key需要一个生存的机会。Redis里新key会从5分开始。上面的递减算法已经考虑到这个分数，如果key分数低于5分，更容易被丢弃（一般是长时间没访问的非活跃key）。</p>
<p>&nbsp;</p>]]></description></item><item><title>Skynet服务热点火焰图分析</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/09/16/skynet_systemtap_for_service.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 15 Sep 2018 17:22:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/09/16/skynet_systemtap_for_service.html</guid><description><![CDATA[<p>最近花了一周时间对场景服务进行热点分析，利用<a href="http://www.cnblogs.com/Lifehacker/p/skynet_flamegraph.html" target="_blank">以前的火焰图工具</a>做了一点微小的贡献，分享下心得（仓库地址在https://github.com/spin6lock/skynet_systemtap_set）。</p>
<p>&nbsp;</p>
<p><a href="https://github.com/cloudwu/skynet" target="_blank">Skynet是一个轻量级的多线程在线游戏框架</a>。线程作为worker，从服务的队列中抽出有消息的，然后处理上面的消息。服务间通过发消息来相互通信。目前服务主要是用Lua进行编写。</p>
<p>&nbsp;</p>
<p>以前做的火焰图工具，没法单独看一个skynet服务的堆栈，只能看到整个进程的。要想针对单个服务做优化分析，需要抓出skynet_context的地址，才能取到服务的id。一个服务对应的是一个Lua VM，在这个VM里，snlua.so会悄悄的将skynet_context地址塞进去REGISTRY。那么，我们只要将skynet_context取出来，然后判断skynet_context-&gt;handle即可。这看似简单的东西，在C里就一句话：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">struct</span> skynet_context * ctx = lua_touserdata(L, lua_upvalueindex(<span style="color: #800080;">1</span>));</pre>
</div>
<p>但是，翻译成stap脚本后，就变成了：</p>
<div class="cnblogs_code">
<pre>        <span style="color: #0000ff;">if</span> (((((p-&gt;func))-&gt;tt_) == ((<span style="color: #800080;">6</span> | (<span style="color: #800080;">1</span> &lt;&lt; <span style="color: #800080;">4</span><span style="color: #000000;">))))) {
            next
        }
        </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
            gc </span>= p-&gt;func-&gt;value_-&gt;<span style="color: #000000;">gc
            closure </span>= &amp;@cast(gc, <span style="color: #800000;">"</span><span style="color: #800000;">GCUnion</span><span style="color: #800000;">"</span>, @<span style="color: #800080;">1</span>)-&gt;<span style="color: #000000;">cl
            func </span>= &amp;@cast(closure, <span style="color: #800000;">"</span><span style="color: #800000;">Closure</span><span style="color: #800000;">"</span>, @<span style="color: #800080;">1</span>)-&gt;c <span style="color: #008000;">//</span><span style="color: #008000;">CClosure</span>
            <span style="color: #0000ff;">if</span> (idx &lt;= func-&gt;<span style="color: #000000;">nupvalues) {
                upvalue_type </span>= func-&gt;upvalue[idx - <span style="color: #800080;">1</span>]-&gt;<span style="color: #000000;">tt_
                </span><span style="color: #0000ff;">if</span> (upvalue_type != <span style="color: #800080;">2</span><span style="color: #000000;">) {
                    next
                } </span><span style="color: #008000;">/*</span><span style="color: #008000;"> only this one can enter counter </span><span style="color: #008000;">*/</span><span style="color: #000000;">
                skynet_context </span>= &amp;@cast(func-&gt;upvalue[idx - <span style="color: #800080;">1</span>]-&gt;value_-&gt;p, <span style="color: #800000;">"</span><span style="color: #800000;">skynet_context</span><span style="color: #800000;">"</span>, @<span style="color: #800080;">1</span><span style="color: #000000;">)
                </span><span style="color: #008000;">/*</span><span style="color: #008000;"> service id in decimal</span><span style="color: #008000;">*/</span>
                <span style="color: #0000ff;">if</span> (skynet_context-&gt;handle != strtol(@<span style="color: #800080;">2</span>, <span style="color: #800080;">10</span><span style="color: #000000;">)) {
                    next
                }
            } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                next
            }
        }</span></pre>
</div>
<p>感谢gcc -E，帮我展开了一重重的宏&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>这个过程无比蛋疼，要将C翻译成stp脚本。stp可以保护新手，避免搞挂内核，但是随之而来的就是晦涩的指针运算魔法了。接下来打算试试用bcc写了</p>
<p>&nbsp;</p>
<p>Anyway，折腾出来一个火焰图：</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkx
JQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy
9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0MDAiI
GhlaWdodD0iNTE0IiBvbmxvYWQ9ImluaXQoZXZ0KSIgdmlld0JveD0iMCAwIDI0MDAgNTE0IiB4
bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d
3LnczLm9yZy8xOTk5L3hsaW5rIj4KPCEtLSBGbGFtZSBncmFwaCBzdGFjayB2aXN1YWxpemF0aW
9uLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2JyZW5kYW5ncmVnZy9GbGFtZUdyYXBoIGZvciBsY
XRlc3QgdmVyc2lvbiwgYW5kIGh0dHA6Ly93d3cuYnJlbmRhbmdyZWdnLmNvbS9mbGFtZWdyYXBo
cy5odG1sIGZvciBleGFtcGxlcy4gLS0+CjxkZWZzID4KCTxsaW5lYXJHcmFkaWVudCBpZD0iYmF
ja2dyb3VuZCIgeTE9IjAiIHkyPSIxIiB4MT0iMCIgeDI9IjAiID4KCQk8c3RvcCBzdG9wLWNvbG
9yPSIjZWVlZWVlIiBvZmZzZXQ9IjUlIiAvPgoJCTxzdG9wIHN0b3AtY29sb3I9IiNlZWVlYjAiI
G9mZnNldD0iOTUlIiAvPgoJPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8c3R5bGUgdHlwZT0i
dGV4dC9jc3MiPgoJLmZ1bmNfZzpob3ZlciB7IHN0cm9rZTpibGFjazsgc3Ryb2tlLXdpZHRoOjA
uNTsgY3Vyc29yOnBvaW50ZXI7IH0KPC9zdHlsZT4KPHNjcmlwdCB0eXBlPSJ0ZXh0L2VjbWFzY3
JpcHQiPgo8IVtDREFUQVsKCXZhciBkZXRhaWxzLCBzZWFyY2hidG4sIG1hdGNoZWR0eHQsIHN2Z
zsKCWZ1bmN0aW9uIGluaXQoZXZ0KSB7CgkJZGV0YWlscyA9IGRvY3VtZW50LmdldEVsZW1lbnRC
eUlkKCJkZXRhaWxzIikuZmlyc3RDaGlsZDsKCQlzZWFyY2hidG4gPSBkb2N1bWVudC5nZXRFbGV
tZW50QnlJZCgic2VhcmNoIik7CgkJbWF0Y2hlZHR4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeU
lkKCJtYXRjaGVkIik7CgkJc3ZnID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInN2Z
yIpWzBdOwoJCXNlYXJjaGluZyA9IDA7Cgl9CgoJLy8gbW91c2Utb3ZlciBmb3IgaW5mbwoJZnVu
Y3Rpb24gcyhub2RlKSB7CQkvLyBzaG93CgkJaW5mbyA9IGdfdG9fdGV4dChub2RlKTsKCQlkZXR
haWxzLm5vZGVWYWx1ZSA9ICJGdW5jdGlvbjogIiArIGluZm87Cgl9CglmdW5jdGlvbiBjKCkgew
kJCS8vIGNsZWFyCgkJZGV0YWlscy5ub2RlVmFsdWUgPSAnICc7Cgl9CgoJLy8gY3RybC1GIGZvc
iBzZWFyY2gKCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIixmdW5jdGlvbiAoZSkg
ewoJCWlmIChlLmtleUNvZGUgPT09IDExNCB8fCAoZS5jdHJsS2V5ICYmIGUua2V5Q29kZSA9PT0
gNzApKSB7CgkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJc2VhcmNoX3Byb21wdCgpOwoJCX0KCX
0pCgoJLy8gZnVuY3Rpb25zCglmdW5jdGlvbiBmaW5kX2NoaWxkKHBhcmVudCwgbmFtZSwgYXR0c
ikgewoJCXZhciBjaGlsZHJlbiA9IHBhcmVudC5jaGlsZE5vZGVzOwoJCWZvciAodmFyIGk9MDsg
aTxjaGlsZHJlbi5sZW5ndGg7aSsrKSB7CgkJCWlmIChjaGlsZHJlbltpXS50YWdOYW1lID09IG5
hbWUpCgkJCQlyZXR1cm4gKGF0dHIgIT0gdW5kZWZpbmVkKSA/IGNoaWxkcmVuW2ldLmF0dHJpYn
V0ZXNbYXR0cl0udmFsdWUgOiBjaGlsZHJlbltpXTsKCQl9CgkJcmV0dXJuOwoJfQoJZnVuY3Rpb
24gb3JpZ19zYXZlKGUsIGF0dHIsIHZhbCkgewoJCWlmIChlLmF0dHJpYnV0ZXNbIl9vcmlnXyIr
YXR0cl0gIT0gdW5kZWZpbmVkKSByZXR1cm47CgkJaWYgKGUuYXR0cmlidXRlc1thdHRyXSA9PSB
1bmRlZmluZWQpIHJldHVybjsKCQlpZiAodmFsID09IHVuZGVmaW5lZCkgdmFsID0gZS5hdHRyaW
J1dGVzW2F0dHJdLnZhbHVlOwoJCWUuc2V0QXR0cmlidXRlKCJfb3JpZ18iK2F0dHIsIHZhbCk7C
gl9CglmdW5jdGlvbiBvcmlnX2xvYWQoZSwgYXR0cikgewoJCWlmIChlLmF0dHJpYnV0ZXNbIl9v
cmlnXyIrYXR0cl0gPT0gdW5kZWZpbmVkKSByZXR1cm47CgkJZS5hdHRyaWJ1dGVzW2F0dHJdLnZ
hbHVlID0gZS5hdHRyaWJ1dGVzWyJfb3JpZ18iK2F0dHJdLnZhbHVlOwoJCWUucmVtb3ZlQXR0cm
lidXRlKCJfb3JpZ18iK2F0dHIpOwoJfQoJZnVuY3Rpb24gZ190b190ZXh0KGUpIHsKCQl2YXIgd
GV4dCA9IGZpbmRfY2hpbGQoZSwgInRpdGxlIikuZmlyc3RDaGlsZC5ub2RlVmFsdWU7CgkJcmV0
dXJuICh0ZXh0KQoJfQoJZnVuY3Rpb24gZ190b19mdW5jKGUpIHsKCQl2YXIgZnVuYyA9IGdfdG9
fdGV4dChlKTsKCQlpZiAoZnVuYyAhPSBudWxsKQoJCQlmdW5jID0gZnVuYy5yZXBsYWNlKC8gLi
ovLCAiIik7CgkJcmV0dXJuIChmdW5jKTsKCX0KCWZ1bmN0aW9uIHVwZGF0ZV90ZXh0KGUpIHsKC
Ql2YXIgciA9IGZpbmRfY2hpbGQoZSwgInJlY3QiKTsKCQl2YXIgdCA9IGZpbmRfY2hpbGQoZSwg
InRleHQiKTsKCQl2YXIgdyA9IHBhcnNlRmxvYXQoci5hdHRyaWJ1dGVzWyJ3aWR0aCJdLnZhbHV
lKSAtMzsKCQl2YXIgdHh0ID0gZmluZF9jaGlsZChlLCAidGl0bGUiKS50ZXh0Q29udGVudC5yZX
BsYWNlKC9cKFteKF0qXCkkLywiIik7CgkJdC5hdHRyaWJ1dGVzWyJ4Il0udmFsdWUgPSBwYXJzZ
UZsb2F0KHIuYXR0cmlidXRlc1sieCJdLnZhbHVlKSArMzsKCgkJLy8gU21hbGxlciB0aGFuIHRo
aXMgc2l6ZSB3b24ndCBmaXQgYW55dGhpbmcKCQlpZiAodyA8IDIqMTIqMC41OSkgewoJCQl0LnR
leHRDb250ZW50ID0gIiI7CgkJCXJldHVybjsKCQl9CgoJCXQudGV4dENvbnRlbnQgPSB0eHQ7Cg
kJLy8gRml0IGluIGZ1bGwgdGV4dCB3aWR0aAoJCWlmICgvXiAqJC8udGVzdCh0eHQpIHx8IHQuZ
2V0U3ViU3RyaW5nTGVuZ3RoKDAsIHR4dC5sZW5ndGgpIDwgdykKCQkJcmV0dXJuOwoKCQlmb3Ig
KHZhciB4PXR4dC5sZW5ndGgtMjsgeD4wOyB4LS0pIHsKCQkJaWYgKHQuZ2V0U3ViU3RyaW5nTGV
uZ3RoKDAsIHgrMikgPD0gdykgewoJCQkJdC50ZXh0Q29udGVudCA9IHR4dC5zdWJzdHJpbmcoMC
x4KSArICIuLiI7CgkJCQlyZXR1cm47CgkJCX0KCQl9CgkJdC50ZXh0Q29udGVudCA9ICIiOwoJf
QoKCS8vIHpvb20KCWZ1bmN0aW9uIHpvb21fcmVzZXQoZSkgewoJCWlmIChlLmF0dHJpYnV0ZXMg
IT0gdW5kZWZpbmVkKSB7CgkJCW9yaWdfbG9hZChlLCAieCIpOwoJCQlvcmlnX2xvYWQoZSwgInd
pZHRoIik7CgkJfQoJCWlmIChlLmNoaWxkTm9kZXMgPT0gdW5kZWZpbmVkKSByZXR1cm47CgkJZm
9yKHZhciBpPTAsIGM9ZS5jaGlsZE5vZGVzOyBpPGMubGVuZ3RoOyBpKyspIHsKCQkJem9vbV9yZ
XNldChjW2ldKTsKCQl9Cgl9CglmdW5jdGlvbiB6b29tX2NoaWxkKGUsIHgsIHJhdGlvKSB7CgkJ
aWYgKGUuYXR0cmlidXRlcyAhPSB1bmRlZmluZWQpIHsKCQkJaWYgKGUuYXR0cmlidXRlc1sieCJ
dICE9IHVuZGVmaW5lZCkgewoJCQkJb3JpZ19zYXZlKGUsICJ4Iik7CgkJCQllLmF0dHJpYnV0ZX
NbIngiXS52YWx1ZSA9IChwYXJzZUZsb2F0KGUuYXR0cmlidXRlc1sieCJdLnZhbHVlKSAtIHggL
SAxMCkgKiByYXRpbyArIDEwOwoJCQkJaWYoZS50YWdOYW1lID09ICJ0ZXh0IikgZS5hdHRyaWJ1
dGVzWyJ4Il0udmFsdWUgPSBmaW5kX2NoaWxkKGUucGFyZW50Tm9kZSwgInJlY3QiLCAieCIpICs
gMzsKCQkJfQoJCQlpZiAoZS5hdHRyaWJ1dGVzWyJ3aWR0aCJdICE9IHVuZGVmaW5lZCkgewoJCQ
kJb3JpZ19zYXZlKGUsICJ3aWR0aCIpOwoJCQkJZS5hdHRyaWJ1dGVzWyJ3aWR0aCJdLnZhbHVlI
D0gcGFyc2VGbG9hdChlLmF0dHJpYnV0ZXNbIndpZHRoIl0udmFsdWUpICogcmF0aW87CgkJCX0K
CQl9CgoJCWlmIChlLmNoaWxkTm9kZXMgPT0gdW5kZWZpbmVkKSByZXR1cm47CgkJZm9yKHZhciB
pPTAsIGM9ZS5jaGlsZE5vZGVzOyBpPGMubGVuZ3RoOyBpKyspIHsKCQkJem9vbV9jaGlsZChjW2
ldLCB4LTEwLCByYXRpbyk7CgkJfQoJfQoJZnVuY3Rpb24gem9vbV9wYXJlbnQoZSkgewoJCWlmI
ChlLmF0dHJpYnV0ZXMpIHsKCQkJaWYgKGUuYXR0cmlidXRlc1sieCJdICE9IHVuZGVmaW5lZCkg
ewoJCQkJb3JpZ19zYXZlKGUsICJ4Iik7CgkJCQllLmF0dHJpYnV0ZXNbIngiXS52YWx1ZSA9IDE
wOwoJCQl9CgkJCWlmIChlLmF0dHJpYnV0ZXNbIndpZHRoIl0gIT0gdW5kZWZpbmVkKSB7CgkJCQ
lvcmlnX3NhdmUoZSwgIndpZHRoIik7CgkJCQllLmF0dHJpYnV0ZXNbIndpZHRoIl0udmFsdWUgP
SBwYXJzZUludChzdmcud2lkdGguYmFzZVZhbC52YWx1ZSkgLSAoMTAqMik7CgkJCX0KCQl9CgkJ
aWYgKGUuY2hpbGROb2RlcyA9PSB1bmRlZmluZWQpIHJldHVybjsKCQlmb3IodmFyIGk9MCwgYz1
lLmNoaWxkTm9kZXM7IGk8Yy5sZW5ndGg7IGkrKykgewoJCQl6b29tX3BhcmVudChjW2ldKTsKCQ
l9Cgl9CglmdW5jdGlvbiB6b29tKG5vZGUpIHsKCQl2YXIgYXR0ciA9IGZpbmRfY2hpbGQobm9kZ
SwgInJlY3QiKS5hdHRyaWJ1dGVzOwoJCXZhciB3aWR0aCA9IHBhcnNlRmxvYXQoYXR0clsid2lk
dGgiXS52YWx1ZSk7CgkJdmFyIHhtaW4gPSBwYXJzZUZsb2F0KGF0dHJbIngiXS52YWx1ZSk7Cgk
JdmFyIHhtYXggPSBwYXJzZUZsb2F0KHhtaW4gKyB3aWR0aCk7CgkJdmFyIHltaW4gPSBwYXJzZU
Zsb2F0KGF0dHJbInkiXS52YWx1ZSk7CgkJdmFyIHJhdGlvID0gKHN2Zy53aWR0aC5iYXNlVmFsL
nZhbHVlIC0gMioxMCkgLyB3aWR0aDsKCgkJLy8gWFhYOiBXb3JrYXJvdW5kIGZvciBKYXZhU2Ny
aXB0IGZsb2F0IGlzc3VlcyAoZml4IG1lKQoJCXZhciBmdWRnZSA9IDAuMDAwMTsKCgkJdmFyIHV
uem9vbWJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ1bnpvb20iKTsKCQl1bnpvb21idG
4uc3R5bGVbIm9wYWNpdHkiXSA9ICIxLjAiOwoKCQl2YXIgZWwgPSBkb2N1bWVudC5nZXRFbGVtZ
W50c0J5VGFnTmFtZSgiZyIpOwoJCWZvcih2YXIgaT0wO2k8ZWwubGVuZ3RoO2krKyl7CgkJCXZh
ciBlID0gZWxbaV07CgkJCXZhciBhID0gZmluZF9jaGlsZChlLCAicmVjdCIpLmF0dHJpYnV0ZXM
7CgkJCXZhciBleCA9IHBhcnNlRmxvYXQoYVsieCJdLnZhbHVlKTsKCQkJdmFyIGV3ID0gcGFyc2
VGbG9hdChhWyJ3aWR0aCJdLnZhbHVlKTsKCQkJLy8gSXMgaXQgYW4gYW5jZXN0b3IKCQkJaWYgK
DAgPT0gMCkgewoJCQkJdmFyIHVwc3RhY2sgPSBwYXJzZUZsb2F0KGFbInkiXS52YWx1ZSkgPiB5
bWluOwoJCQl9IGVsc2UgewoJCQkJdmFyIHVwc3RhY2sgPSBwYXJzZUZsb2F0KGFbInkiXS52YWx
1ZSkgPCB5bWluOwoJCQl9CgkJCWlmICh1cHN0YWNrKSB7CgkJCQkvLyBEaXJlY3QgYW5jZXN0b3
IKCQkJCWlmIChleCA8PSB4bWluICYmIChleCtldytmdWRnZSkgPj0geG1heCkgewoJCQkJCWUuc
3R5bGVbIm9wYWNpdHkiXSA9ICIwLjUiOwoJCQkJCXpvb21fcGFyZW50KGUpOwoJCQkJCWUub25j
bGljayA9IGZ1bmN0aW9uKGUpe3Vuem9vbSgpOyB6b29tKHRoaXMpO307CgkJCQkJdXBkYXRlX3R
leHQoZSk7CgkJCQl9CgkJCQkvLyBub3QgaW4gY3VycmVudCBwYXRoCgkJCQllbHNlCgkJCQkJZS
5zdHlsZVsiZGlzcGxheSJdID0gIm5vbmUiOwoJCQl9CgkJCS8vIENoaWxkcmVuIG1heWJlCgkJC
WVsc2UgewoJCQkJLy8gbm8gY29tbW9uIHBhdGgKCQkJCWlmIChleCA8IHhtaW4gfHwgZXggKyBm
dWRnZSA+PSB4bWF4KSB7CgkJCQkJZS5zdHlsZVsiZGlzcGxheSJdID0gIm5vbmUiOwoJCQkJfQo
JCQkJZWxzZSB7CgkJCQkJem9vbV9jaGlsZChlLCB4bWluLCByYXRpbyk7CgkJCQkJZS5vbmNsaW
NrID0gZnVuY3Rpb24oZSl7em9vbSh0aGlzKTt9OwoJCQkJCXVwZGF0ZV90ZXh0KGUpOwoJCQkJf
QoJCQl9CgkJfQoJfQoJZnVuY3Rpb24gdW56b29tKCkgewoJCXZhciB1bnpvb21idG4gPSBkb2N1
bWVudC5nZXRFbGVtZW50QnlJZCgidW56b29tIik7CgkJdW56b29tYnRuLnN0eWxlWyJvcGFjaXR
5Il0gPSAiMC4wIjsKCgkJdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIm
ciKTsKCQlmb3IoaT0wO2k8ZWwubGVuZ3RoO2krKykgewoJCQllbFtpXS5zdHlsZVsiZGlzcGxhe
SJdID0gImJsb2NrIjsKCQkJZWxbaV0uc3R5bGVbIm9wYWNpdHkiXSA9ICIxIjsKCQkJem9vbV9y
ZXNldChlbFtpXSk7CgkJCXVwZGF0ZV90ZXh0KGVsW2ldKTsKCQl9Cgl9CgoJLy8gc2VhcmNoCgl
mdW5jdGlvbiByZXNldF9zZWFyY2goKSB7CgkJdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudH
NCeVRhZ05hbWUoInJlY3QiKTsKCQlmb3IgKHZhciBpPTA7IGkgPCBlbC5sZW5ndGg7IGkrKykge
woJCQlvcmlnX2xvYWQoZWxbaV0sICJmaWxsIikKCQl9Cgl9CglmdW5jdGlvbiBzZWFyY2hfcHJv
bXB0KCkgewoJCWlmICghc2VhcmNoaW5nKSB7CgkJCXZhciB0ZXJtID0gcHJvbXB0KCJFbnRlciB
hIHNlYXJjaCB0ZXJtIChyZWdleHAgIiArCgkJCSAgICAiYWxsb3dlZCwgZWc6IF5leHQ0XykiLC
AiIik7CgkJCWlmICh0ZXJtICE9IG51bGwpIHsKCQkJCXNlYXJjaCh0ZXJtKQoJCQl9CgkJfSBlb
HNlIHsKCQkJcmVzZXRfc2VhcmNoKCk7CgkJCXNlYXJjaGluZyA9IDA7CgkJCXNlYXJjaGJ0bi5z
dHlsZVsib3BhY2l0eSJdID0gIjAuMSI7CgkJCXNlYXJjaGJ0bi5maXJzdENoaWxkLm5vZGVWYWx
1ZSA9ICJTZWFyY2giCgkJCW1hdGNoZWR0eHQuc3R5bGVbIm9wYWNpdHkiXSA9ICIwLjAiOwoJCQ
ltYXRjaGVkdHh0LmZpcnN0Q2hpbGQubm9kZVZhbHVlID0gIiIKCQl9Cgl9CglmdW5jdGlvbiBzZ
WFyY2godGVybSkgewoJCXZhciByZSA9IG5ldyBSZWdFeHAodGVybSk7CgkJdmFyIGVsID0gZG9j
dW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImciKTsKCQl2YXIgbWF0Y2hlcyA9IG5ldyBPYmp
lY3QoKTsKCQl2YXIgbWF4d2lkdGggPSAwOwoJCWZvciAodmFyIGkgPSAwOyBpIDwgZWwubGVuZ3
RoOyBpKyspIHsKCQkJdmFyIGUgPSBlbFtpXTsKCQkJaWYgKGUuYXR0cmlidXRlc1siY2xhc3MiX
S52YWx1ZSAhPSAiZnVuY19nIikKCQkJCWNvbnRpbnVlOwoJCQl2YXIgZnVuYyA9IGdfdG9fZnVu
YyhlKTsKCQkJdmFyIHJlY3QgPSBmaW5kX2NoaWxkKGUsICJyZWN0Iik7CgkJCWlmIChyZWN0ID0
9IG51bGwpIHsKCQkJCS8vIHRoZSByZWN0IG1pZ2h0IGJlIHdyYXBwZWQgaW4gYW4gYW5jaG9yCg
kJCQkvLyBpZiBuYW1lYXR0ciBocmVmIGlzIGJlaW5nIHVzZWQKCQkJCWlmIChyZWN0ID0gZmluZ
F9jaGlsZChlLCAiYSIpKSB7CgkJCQkgICAgcmVjdCA9IGZpbmRfY2hpbGQociwgInJlY3QiKTsK
CQkJCX0KCQkJfQoJCQlpZiAoZnVuYyA9PSBudWxsIHx8IHJlY3QgPT0gbnVsbCkKCQkJCWNvbnR
pbnVlOwoKCQkJLy8gU2F2ZSBtYXggd2lkdGguIE9ubHkgd29ya3MgYXMgd2UgaGF2ZSBhIHJvb3
QgZnJhbWUKCQkJdmFyIHcgPSBwYXJzZUZsb2F0KHJlY3QuYXR0cmlidXRlc1sid2lkdGgiXS52Y
Wx1ZSk7CgkJCWlmICh3ID4gbWF4d2lkdGgpCgkJCQltYXh3aWR0aCA9IHc7CgoJCQlpZiAoZnVu
Yy5tYXRjaChyZSkpIHsKCQkJCS8vIGhpZ2hsaWdodAoJCQkJdmFyIHggPSBwYXJzZUZsb2F0KHJ
lY3QuYXR0cmlidXRlc1sieCJdLnZhbHVlKTsKCQkJCW9yaWdfc2F2ZShyZWN0LCAiZmlsbCIpOw
oJCQkJcmVjdC5hdHRyaWJ1dGVzWyJmaWxsIl0udmFsdWUgPQoJCQkJICAgICJyZ2IoMjMwLDAsM
jMwKSI7CgoJCQkJLy8gcmVtZW1iZXIgbWF0Y2hlcwoJCQkJaWYgKG1hdGNoZXNbeF0gPT0gdW5k
ZWZpbmVkKSB7CgkJCQkJbWF0Y2hlc1t4XSA9IHc7CgkJCQl9IGVsc2UgewoJCQkJCWlmICh3ID4
gbWF0Y2hlc1t4XSkgewoJCQkJCQkvLyBvdmVyd3JpdGUgd2l0aCBwYXJlbnQKCQkJCQkJbWF0Y2
hlc1t4XSA9IHc7CgkJCQkJfQoJCQkJfQoJCQkJc2VhcmNoaW5nID0gMTsKCQkJfQoJCX0KCQlpZ
iAoIXNlYXJjaGluZykKCQkJcmV0dXJuOwoKCQlzZWFyY2hidG4uc3R5bGVbIm9wYWNpdHkiXSA9
ICIxLjAiOwoJCXNlYXJjaGJ0bi5maXJzdENoaWxkLm5vZGVWYWx1ZSA9ICJSZXNldCBTZWFyY2g
iCgoJCS8vIGNhbGN1bGF0ZSBwZXJjZW50IG1hdGNoZWQsIGV4Y2x1ZGluZyB2ZXJ0aWNhbCBvdm
VybGFwCgkJdmFyIGNvdW50ID0gMDsKCQl2YXIgbGFzdHggPSAtMTsKCQl2YXIgbGFzdHcgPSAwO
woJCXZhciBrZXlzID0gQXJyYXkoKTsKCQlmb3IgKGsgaW4gbWF0Y2hlcykgewoJCQlpZiAobWF0
Y2hlcy5oYXNPd25Qcm9wZXJ0eShrKSkKCQkJCWtleXMucHVzaChrKTsKCQl9CgkJLy8gc29ydCB
0aGUgbWF0Y2hlZCBmcmFtZXMgYnkgdGhlaXIgeCBsb2NhdGlvbgoJCS8vIGFzY2VuZGluZywgdG
hlbiB3aWR0aCBkZXNjZW5kaW5nCgkJa2V5cy5zb3J0KGZ1bmN0aW9uKGEsIGIpewoJCQkJcmV0d
XJuIGEgLSBiOwoJCQlpZiAoYSA8IGIgfHwgYSA+IGIpCgkJCQlyZXR1cm4gYSAtIGI7CgkJCXJl
dHVybiBtYXRjaGVzW2JdIC0gbWF0Y2hlc1thXTsKCQl9KTsKCQkvLyBTdGVwIHRocm91Z2ggZnJ
hbWVzIHNhdmluZyBvbmx5IHRoZSBiaWdnZXN0IGJvdHRvbS11cCBmcmFtZXMKCQkvLyB0aGFua3
MgdG8gdGhlIHNvcnQgb3JkZXIuIFRoaXMgcmVsaWVzIG9uIHRoZSB0cmVlIHByb3BlcnR5CgkJL
y8gd2hlcmUgY2hpbGRyZW4gYXJlIGFsd2F5cyBzbWFsbGVyIHRoYW4gdGhlaXIgcGFyZW50cy4K
CQlmb3IgKHZhciBrIGluIGtleXMpIHsKCQkJdmFyIHggPSBwYXJzZUZsb2F0KGtleXNba10pOwo
JCQl2YXIgdyA9IG1hdGNoZXNba2V5c1trXV07CgkJCWlmICh4ID49IGxhc3R4ICsgbGFzdHcpIH
sKCQkJCWNvdW50ICs9IHc7CgkJCQlsYXN0eCA9IHg7CgkJCQlsYXN0dyA9IHc7CgkJCX0KCQl9C
gkJLy8gZGlzcGxheSBtYXRjaGVkIHBlcmNlbnQKCQltYXRjaGVkdHh0LnN0eWxlWyJvcGFjaXR5
Il0gPSAiMS4wIjsKCQlwY3QgPSAxMDAgKiBjb3VudCAvIG1heHdpZHRoOwoJCWlmIChwY3QgPT0
gMTAwKQoJCQlwY3QgPSAiMTAwIgoJCWVsc2UKCQkJcGN0ID0gcGN0LnRvRml4ZWQoMSkKCQltYX
RjaGVkdHh0LmZpcnN0Q2hpbGQubm9kZVZhbHVlID0gIk1hdGNoZWQ6ICIgKyBwY3QgKyAiJSI7C
gl9CglmdW5jdGlvbiBzZWFyY2hvdmVyKGUpIHsKCQlzZWFyY2hidG4uc3R5bGVbIm9wYWNpdHki
XSA9ICIxLjAiOwoJfQoJZnVuY3Rpb24gc2VhcmNob3V0KGUpIHsKCQlpZiAoc2VhcmNoaW5nKSB
7CgkJCXNlYXJjaGJ0bi5zdHlsZVsib3BhY2l0eSJdID0gIjEuMCI7CgkJfSBlbHNlIHsKCQkJc2
VhcmNoYnRuLnN0eWxlWyJvcGFjaXR5Il0gPSAiMC4xIjsKCQl9Cgl9Cl1dPgo8L3NjcmlwdD4KP
HJlY3QgeD0iMC4wIiB5PSIwIiB3aWR0aD0iMjQwMC4wIiBoZWlnaHQ9IjUxNC4wIiBmaWxsPSJ1
cmwoI2JhY2tncm91bmQpIiAgLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMTIwMC4
wMCIgeT0iMjQiIGZvbnQtc2l6ZT0iMTciIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2
IoMCwwLDApIiAgPkZsYW1lIEdyYXBoPC90ZXh0Pgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxM
C4wMCIgeT0iNDk3IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0i
cmdiKDAsMCwwKSIgaWQ9ImRldGFpbHMiID4gPC90ZXh0Pgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB
4PSIxMC4wMCIgeT0iMjQiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaW
xsPSJyZ2IoMCwwLDApIiBpZD0idW56b29tIiBvbmNsaWNrPSJ1bnpvb20oKSIgc3R5bGU9Im9wY
WNpdHk6MC4wO2N1cnNvcjpwb2ludGVyIiA+UmVzZXQgWm9vbTwvdGV4dD4KPHRleHQgdGV4dC1h
bmNob3I9IiIgeD0iMjI5MC4wMCIgeT0iMjQiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJ
WZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiBpZD0ic2VhcmNoIiBvbm1vdXNlb3Zlcj0ic2Vhcm
Nob3ZlcigpIiBvbm1vdXNlb3V0PSJzZWFyY2hvdXQoKSIgb25jbGljaz0ic2VhcmNoX3Byb21wd
CgpIiBzdHlsZT0ib3BhY2l0eTowLjE7Y3Vyc29yOnBvaW50ZXIiID5TZWFyY2g8L3RleHQ+Cjx0
ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIyOTAuMDAiIHk9IjQ5NyIgZm9udC1zaXplPSIxMiIgZm9
udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiIGlkPSJtYXRjaGVkIiA+IDwvdG
V4dD4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9I
mMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vcm9vbS5s
dWE6MzIxICg3NDQgc2FtcGxlcywgMy4xMiUpPC90aXRsZT48cmVjdCB4PSIxMC4wIiB5PSIxNzc
iIHdpZHRoPSI3NC40IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzUsMTk2LDIpIiByeD0iMi
Igcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSIxODcuNSIgZm9ud
C1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+bHVh
bGliL3cuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGl
zKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmNfZnVuY3
Rpb246MHg3ZjMwMmJjNTJiMzggICAgICAgICg4IHNhbXBsZXMsIDAuMDMlKTwvdGl0bGU+PHJlY
3QgeD0iMjM4OC40IiB5PSIzODUiIHdpZHRoPSIwLjgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdi
KDIxNywxMTUsMCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjM
5MS40MCIgeT0iMzk1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaW
xsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb
3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRp
dGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfYmFzZS5sdWE6MjM1ICgyMjggc2FtcGxlcywgMC4
5NiUpPC90aXRsZT48cmVjdCB4PSIxNjQzLjciIHk9IjEyOSIgd2lkdGg9IjIyLjgiIGhlaWdodD
0iMTUuMCIgZmlsbD0icmdiKDIzOCw1OSw0MCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4d
C1hbmNob3I9IiIgeD0iMTY0Ni43MSIgeT0iMTM5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFt
aWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmwuLjwvdGV4dD4KPC9nPgo8ZyBjbGF
zcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaW
NrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmFsaWIvd2FyX29iamVjdHMvYWkvYWlfbmV1cm9uLmx1Y
To5ODcgKDIyOCBzYW1wbGVzLCAwLjk2JSk8L3RpdGxlPjxyZWN0IHg9Ijg0LjQiIHk9IjI3MyIg
d2lkdGg9IjIyLjgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyNiwxNjYsNDcpIiByeD0iMiI
gcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9Ijg3LjM3IiB5PSIyODMuNSIgZm9udC
1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+YS4uP
C90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1v
dXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+c2t5bmV0L2x1YWxpYi9
za3luZXQubHVhOjM0NCAoNywyMDAgc2FtcGxlcywgMzAuMjQlKTwvdGl0bGU+PHJlY3QgeD0iMT
Y2Ny45IiB5PSIyMjUiIHdpZHRoPSI3MTkuNyIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjEzL
DE4NywzMCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTY3MC45
MCIgeT0iMjM1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJ
yZ2IoMCwwLDApIiAgPnNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1YTozNDQ8L3RleHQ+CjwvZz4KPG
cgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb
25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX2Jhc2Uu
bHVhOjIzNSAoNzQ0IHNhbXBsZXMsIDMuMTIlKTwvdGl0bGU+PHJlY3QgeD0iMTAuMCIgeT0iMjA
5IiB3aWR0aD0iNzQuNCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjIzLDg4LDQ1KSIgcng9Ij
IiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iMjE5LjUiIGZvb
nQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1
YWxpYi93Li48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGh
pcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaW
Ivd2FyX3Jvb20vcm9vbS5sdWE6MjUwICg3LDIwMCBzYW1wbGVzLCAzMC4yNCUpPC90aXRsZT48c
mVjdCB4PSIxNjY3LjkiIHk9IjMwNSIgd2lkdGg9IjcxOS43IiBoZWlnaHQ9IjE1LjAiIGZpbGw9
InJnYigyMTEsMCwyNykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0
iMTY3MC45MCIgeT0iMzE1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIi
BmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfcm9vbS9yb29tLmx1YToyNTA8L3RleHQ+C
jwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9
ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2J
qX3JvbGUubHVhOjEzODYgKDIyOCBzYW1wbGVzLCAwLjk2JSk8L3RpdGxlPjxyZWN0IHg9IjE2ND
MuNyIgeT0iMTc3IiB3aWR0aD0iMjIuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjM3LDE0N
iwyNCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTY0Ni43MSIg
eT0iMTg3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2I
oMCwwLDApIiAgPmwuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj
0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlP
nNlcnZpY2Uvc2NlbmUvc2NlbmVfYmFzZS5sdWE6ODIgKDcsMjAwIHNhbXBsZXMsIDMwLjI0JSk8
L3RpdGxlPjxyZWN0IHg9IjE2NjcuOSIgeT0iMjQxIiB3aWR0aD0iNzE5LjciIGhlaWdodD0iMTU
uMCIgZmlsbD0icmdiKDIxNSwxMTIsMTkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW
5jaG9yPSIiIHg9IjE2NzAuOTAiIHk9IjI1MS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlse
T0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5zZXJ2aWNlL3NjZW5lL3NjZW5lX2Jhc2Uu
bHVhOjgyPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXM
pIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+YWxsICgyMy
w4MTAgc2FtcGxlcywgMTAwJSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjQ2NSIgd2lkdGg9I
jIzODAuMCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjI2LDE2Miw0NCkiIHJ4PSIyIiByeT0i
MiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjQ3NS41IiBmb250LXNpemU
9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+Cj
wvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9I
mMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvbG9nZ2VyLmx1YTo4NyAo
MTQgc2FtcGxlcywgMC4wNiUpPC90aXRsZT48cmVjdCB4PSIxNjY2LjUiIHk9IjIyNSIgd2lkdGg
9IjEuNCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjMwLDE1OCw0MykiIHJ4PSIyIiByeT0iMi
IgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTY2OS41MCIgeT0iMjM1LjUiIGZvbnQtc2l6Z
T0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4K
PC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0
iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi9lam95X3RpbWVyLmx1YT
oyNiAoMjMsNzg2IHNhbXBsZXMsIDk5LjkwJSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjQxN
yIgd2lkdGg9IjIzNzcuNiIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjUwLDE4LDMzKSIgcng9
IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iNDI3LjUiIGZ
vbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPm
x1YWxpYi9lam95X3RpbWVyLmx1YToyNjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvb
m1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMp
Ij4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTUyNCAoMjI4IHNhbXB
sZXMsIDAuOTYlKTwvdGl0bGU+PHJlY3QgeD0iODQuNCIgeT0iMjU3IiB3aWR0aD0iMjIuOCIgaG
VpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjI1LDE1NSwyOSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRle
HQgdGV4dC1hbmNob3I9IiIgeD0iODcuMzciIHk9IjI2Ny41IiBmb250LXNpemU9IjEyIiBmb250
LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sLi48L3RleHQ+CjwvZz4KPGc
gY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb2
5jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZXJ2aWNlL3NjZW5lL3NjZW5lX2Jhc2UubHVhO
jE1NSAoOCBzYW1wbGVzLCAwLjAzJSk8L3RpdGxlPjxyZWN0IHg9IjIzODkuMiIgeT0iNDE3IiB3
aWR0aD0iMC44IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMTksNzcsMzkpIiByeD0iMiIgcnk
9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIzOTIuMjAiIHk9IjQyNy41IiBmb250LX
NpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3Rle
HQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2Vv
dXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvZWpveV90aW1lci5
sdWE6MjkgKDggc2FtcGxlcywgMC4wMyUpPC90aXRsZT48cmVjdCB4PSIyMzg3LjYiIHk9IjQxNy
Igd2lkdGg9IjAuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjA3LDUxLDE4KSIgcng9IjIiI
HJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMzkwLjYwIiB5PSI0MjcuNSIgZm9u
dC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC9
0ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdX
Nlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY
3RzL2FpL2FpLmx1YToyMDQgKDE2LDU3MiBzYW1wbGVzLCA2OS42MCUpPC90aXRsZT48cmVjdCB4
PSIxMC4wIiB5PSIzMDUiIHdpZHRoPSIxNjU2LjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI
xOCwxMTcsMzQpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLj
AwIiB5PSIzMTUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9I
nJnYigwLDAsMCkiICA+bHVhbGliL3dhcl9vYmplY3RzL2FpL2FpLmx1YToyMDQ8L3RleHQ+Cjwv
Zz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImM
oKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5saWdodF9jX2Z1bmN0aW9uOmx1YUJfcG
NhbGwgKDIzLDc4NiBzYW1wbGVzLCA5OS45MCUpPC90aXRsZT48cmVjdCB4PSIxMC4wIiB5PSI0M
DEiIHdpZHRoPSIyMzc3LjYiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxMiwxODYsMSkiIHJ4
PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjQxMS41IiB
mb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID
5saWdodF9jX2Z1bmN0aW9uOmx1YUJfcGNhbGw8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZ
yIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0
aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX2Jhc2UubHVhOjIzNSAoMjI4IHN
hbXBsZXMsIDAuOTYlKTwvdGl0bGU+PHJlY3QgeD0iODQuNCIgeT0iMjI1IiB3aWR0aD0iMjIuOC
IgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjI1LDE1NiwxNSkiIHJ4PSIyIiByeT0iMiIgLz4KP
HRleHQgdGV4dC1hbmNob3I9IiIgeD0iODcuMzciIHk9IjIzNS41IiBmb250LXNpemU9IjEyIiBm
b250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sLi48L3RleHQ+CjwvZz4
KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKS
Igb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX3Jvb
GUubHVhOjE0ODMgKDIyOCBzYW1wbGVzLCAwLjk2JSk8L3RpdGxlPjxyZWN0IHg9IjE2NDMuNyIg
eT0iMTYxIiB3aWR0aD0iMjIuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ3LDIxMCwyNSk
iIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTY0Ni43MSIgeT0iMT
cxLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwL
DApIiAgPmwuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0
aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmNfZnV
uY3Rpb246MHg3ZjMwMmJjNTJiMzggICAgICAgICg4IHNhbXBsZXMsIDAuMDMlKTwvdGl0bGU+PH
JlY3QgeD0iMjM4Ny42IiB5PSIzODUiIHdpZHRoPSIwLjgiIGhlaWdodD0iMTUuMCIgZmlsbD0ic
mdiKDIwNiwxLDMyKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIy
MzkwLjYwIiB5PSIzOTUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZ
pbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2
VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8d
Gl0bGU+bHVhbGliL3dhcl9yb29tL3Jvb20ubHVhOjI0MCAoMTQgc2FtcGxlcywgMC4wNiUpPC90
aXRsZT48cmVjdCB4PSIxNjY2LjUiIHk9IjMwNSIgd2lkdGg9IjEuNCIgaGVpZ2h0PSIxNS4wIiB
maWxsPSJyZ2IoMjM5LDIyMCwyMikiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3
I9IiIgeD0iMTY2OS41MCIgeT0iMzE1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZ
XJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19n
IiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHR
oaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTQ4MyAoNzQ0IH
NhbXBsZXMsIDMuMTIlKTwvdGl0bGU+PHJlY3QgeD0iMTAuMCIgeT0iMjQxIiB3aWR0aD0iNzQuN
CIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjI5LDk3LDM0KSIgcng9IjIiIHJ5PSIyIiAvPgo8
dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iMjUxLjUiIGZvbnQtc2l6ZT0iMTIiIGZ
vbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93Li48L3RleH
Q+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2Vvd
XQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5hbGliL3dhcl9vYmplY3RzL2Fp
L2FpX25ldXJvbi5sdWE6NTE5ICg3NDQgc2FtcGxlcywgMy4xMiUpPC90aXRsZT48cmVjdCB4PSI
xMC4wIiB5PSIyNzMiIHdpZHRoPSI3NC40IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjMsMT
ExLDQ0KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIge
T0iMjgzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2Io
MCwwLDApIiAgPmFsaWIvd2FyLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3V
zZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cj
x0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX3JvbGUubHVhOjEzNzkgKDE1LDM3MiBzYW1wb
GVzLCA2NC41NiUpPC90aXRsZT48cmVjdCB4PSIxMDcuMiIgeT0iMTc3IiB3aWR0aD0iMTUzNi41
IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMTUsNzUsMzkpIiByeD0iMiIgcnk9IjIiIC8+Cjx
0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjExMC4xNiIgeT0iMTg3LjUiIGZvbnQtc2l6ZT0iMTIiIG
ZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfb2JqZ
WN0cy9vYmpfcm9sZS5sdWE6MTM3OTwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1v
dXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4
KPHRpdGxlPnNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1YToyMzUgKDggc2FtcGxlcywgMC4wMyUpPC
90aXRsZT48cmVjdCB4PSIyMzg4LjQiIHk9IjQwMSIgd2lkdGg9IjAuOCIgaGVpZ2h0PSIxNS4wI
iBmaWxsPSJyZ2IoMjE1LDEwMSw1MCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNo
b3I9IiIgeD0iMjM5MS40MCIgeT0iNDExLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJ
WZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY1
9nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tK
HRoaXMpIj4KPHRpdGxlPmNfZnVuY3Rpb246MHg3ZjMwMmJjNTJhNzggICAgKDE1LDM3MiBzYW1w
bGVzLCA2NC41NiUpPC90aXRsZT48cmVjdCB4PSIxMDcuMiIgeT0iMzMiIHdpZHRoPSIxNTM2LjU
iIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyMSwxNywzNikiIHJ4PSIyIiByeT0iMiIgLz4KPH
RleHQgdGV4dC1hbmNob3I9IiIgeD0iMTEwLjE2IiB5PSI0My41IiBmb250LXNpemU9IjEyIiBmb
250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5jX2Z1bmN0aW9uOjB4N2Yz
MDJiYzUyYTc4ICAgPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJ
zKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bH
VhbGliL3dhcl9yb29tL3Jvb20ubHVhOjMyMSAoMjI4IHNhbXBsZXMsIDAuOTYlKTwvdGl0bGU+P
HJlY3QgeD0iMTY0My43IiB5PSI5NyIgd2lkdGg9IjIyLjgiIGhlaWdodD0iMTUuMCIgZmlsbD0i
cmdiKDIyMCwxMjcsMTMpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg
9IjE2NDYuNzEiIHk9IjEwNy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYS
IgZmlsbD0icmdiKDAsMCwwKSIgID5sLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb
25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlz
KSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX3JvbGUubHVhOjEzMDggKDc0NCBzYW1
wbGVzLCAzLjEyJSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjIyNSIgd2lkdGg9Ijc0LjQiIG
hlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzMSwxNzEsNSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRle
HQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjIzNS41IiBmb250LXNpemU9IjEyIiBmb250
LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIvdy4uPC90ZXh0Pgo
8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PS
JjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ia
l9yb2xlLmx1YToxNDE3ICg3NDQgc2FtcGxlcywgMy4xMiUpPC90aXRsZT48cmVjdCB4PSIxMC4w
IiB5PSIyNTciIHdpZHRoPSI3NC40IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNTIsMTMwLDI
xKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iMj
Y3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwL
DApIiAgPmx1YWxpYi93Li48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92
ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXR
sZT5sdWFsaWIvd2FyX29iamVjdHMvZXZlbnRfc3lzdGVtLmx1YTo3MSAoMTUsNjAwIHNhbXBsZX
MsIDY1LjUyJSk8L3RpdGxlPjxyZWN0IHg9IjEwNy4yIiB5PSIyMjUiIHdpZHRoPSIxNTU5LjMiI
GhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0MywyMDYsNDEpIiByeD0iMiIgcnk9IjIiIC8+Cjx0
ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjExMC4xNiIgeT0iMjM1LjUiIGZvbnQtc2l6ZT0iMTIiIGZ
vbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfb2JqZW
N0cy9ldmVudF9zeXN0ZW0ubHVhOjcxPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ub
W91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcyki
Pgo8dGl0bGU+bHVhbGliL3NreW5ldF9leHRlbmQvZGVidWcubHVhOjI2ICg4IHNhbXBsZXMsIDA
uMDMlKTwvdGl0bGU+PHJlY3QgeD0iMjM4OC40IiB5PSI0MTciIHdpZHRoPSIwLjgiIGhlaWdodD
0iMTUuMCIgZmlsbD0icmdiKDIxOCw3MCwyMykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4d
C1hbmNob3I9IiIgeD0iMjM5MS40MCIgeT0iNDI3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFt
aWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0
iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPS
J6b29tKHRoaXMpIj4KPHRpdGxlPmxpZ2h0X2NfZnVuY3Rpb246bHVhQl94cGNhbGwgKDIzLDc4N
iBzYW1wbGVzLCA5OS45MCUpPC90aXRsZT48cmVjdCB4PSIxMC4wIiB5PSIzNTMiIHdpZHRoPSIy
Mzc3LjYiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxOCwxNCwzMCkiIHJ4PSIyIiByeT0iMiI
gLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjM2My41IiBmb250LXNpemU9Ij
EyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5saWdodF9jX2Z1b
mN0aW9uOmx1YUJfeHBjYWxsPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2Vv
dmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl
0bGU+bHVhbGliL3dhcl9yb29tL3RpbWVyX21nci5sdWE6MjggKDIzLDc4NiBzYW1wbGVzLCA5OS
45MCUpPC90aXRsZT48cmVjdCB4PSIxMC4wIiB5PSIzMjEiIHdpZHRoPSIyMzc3LjYiIGhlaWdod
D0iMTUuMCIgZmlsbD0icmdiKDIyMywxLDMxKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0
LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iMzMxLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx
5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfcm9vbS90aW1lcl9tZ3
IubHVhOjI4PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoa
XMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+Y19mdW5j
dGlvbjoweDdmMzAyYmM1MmE3OCAgICAgICgyMjggc2FtcGxlcywgMC45NiUpPC90aXRsZT48cmV
jdCB4PSI4NC40IiB5PSIxNDUiIHdpZHRoPSIyMi44IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYi
gyMjYsMzEsNDEpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9Ijg3L
jM3IiB5PSIxNTUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9
InJnYigwLDAsMCkiICA+Yy4uPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2V
vdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dG
l0bGU+c2t5bmV0L2x1YWxpYi9za3luZXQubHVhOjM0NCAoMTQgc2FtcGxlcywgMC4wNiUpPC90a
XRsZT48cmVjdCB4PSIxNjY2LjUiIHk9IjIwOSIgd2lkdGg9IjEuNCIgaGVpZ2h0PSIxNS4wIiBm
aWxsPSJyZ2IoMjA2LDE4MSw1MykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I
9IiIgeD0iMTY2OS41MCIgeT0iMjE5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZX
JkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nI
iBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRo
aXMpIj4KPHRpdGxlPmNfZnVuY3Rpb246MHg3ZjMwMmJjNTJhNzggICAgICg3LDIwMCBzYW1wbGV
zLCAzMC4yNCUpPC90aXRsZT48cmVjdCB4PSIxNjY3LjkiIHk9IjIwOSIgd2lkdGg9IjcxOS43Ii
BoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjYsMTI2LDkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0Z
Xh0IHRleHQtYW5jaG9yPSIiIHg9IjE2NzAuOTAiIHk9IjIxOS41IiBmb250LXNpemU9IjEyIiBm
b250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5jX2Z1bmN0aW9uOjB4N2Y
zMDJiYzUyYTc4ICAgIDwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj
0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlP
nNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1YToyMzUgKDggc2FtcGxlcywgMC4wMyUpPC90aXRsZT48
cmVjdCB4PSIyMzg3LjYiIHk9IjQwMSIgd2lkdGg9IjAuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJ
yZ2IoMjEzLDYxLDUzKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PS
IyMzkwLjYwIiB5PSI0MTEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiI
GZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91
c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo
8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial9yb2xlLmx1YToxMzA4ICgxNSwzNzIgc2FtcG
xlcywgNjQuNTYlKTwvdGl0bGU+PHJlY3QgeD0iMTA3LjIiIHk9IjEyOSIgd2lkdGg9IjE1MzYuN
SIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQyLDgwLDE1KSIgcng9IjIiIHJ5PSIyIiAvPgo8
dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMTAuMTYiIHk9IjEzOS41IiBmb250LXNpemU9IjEyIiB
mb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIvd2FyX29iam
VjdHMvb2JqX3JvbGUubHVhOjEzMDg8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb
3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+
Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YToxMjU0ICg3NDQgc2FtcGxlcywgMy4xMiU
pPC90aXRsZT48cmVjdCB4PSIxMC4wIiB5PSIxOTMiIHdpZHRoPSI3NC40IiBoZWlnaHQ9IjE1Lj
AiIGZpbGw9InJnYigyNDYsODAsNDEpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5ja
G9yPSIiIHg9IjEzLjAwIiB5PSIyMDMuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZl
cmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+bHVhbGliL3cuLjwvdGV4dD4KPC9nPgo8ZyBjbGF
zcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaW
NrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1YTozNDQgKDc0N
CBzYW1wbGVzLCAzLjEyJSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjE0NSIgd2lkdGg9Ijc0
LjQiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxMSwxMjQsMjcpIiByeD0iMiIgcnk9IjIiIC8
+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSIxNTUuNSIgZm9udC1zaXplPSIxMi
IgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+c2t5bmV0L2wuLjwvd
GV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3Vz
ZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi9sb2cubHVhOjU
zICgxNCBzYW1wbGVzLCAwLjA2JSk8L3RpdGxlPjxyZWN0IHg9IjE2NjYuNSIgeT0iMjg5IiB3aW
R0aD0iMS40IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzgsMTI4LDUzKSIgcng9IjIiIHJ5P
SIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjY5LjUwIiB5PSIyOTkuNSIgZm9udC1z
aXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh
0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3
V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+c2t5bmV0L2x1YWxpYi9za3luZ
XQubHVhOjM0NCAoMjI4IHNhbXBsZXMsIDAuOTYlKTwvdGl0bGU+PHJlY3QgeD0iMTY0My43IiB5
PSI2NSIgd2lkdGg9IjIyLjgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0NSwyMTIsMTIpIiB
yeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2NDYuNzEiIHk9Ijc1Lj
UiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApI
iAgPnMuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlz
KSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNreW5ldC9
sdWFsaWIvc2t5bmV0Lmx1YToyMzUgKDggc2FtcGxlcywgMC4wMyUpPC90aXRsZT48cmVjdCB4PS
IyMzg5LjIiIHk9IjQwMSIgd2lkdGg9IjAuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjEyL
DIyNyw0MykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjM5Mi4y
MCIgeT0iNDExLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJ
yZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj
0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlP
mFsaWIvd2FyX29iamVjdHMvYWkvYWlfbmV1cm9uLmx1YTo1NjggKDE1LDYwMCBzYW1wbGVzLCA2
NS41MiUpPC90aXRsZT48cmVjdCB4PSIxMDcuMiIgeT0iMjA5IiB3aWR0aD0iMTU1OS4zIiBoZWl
naHQ9IjE1LjAiIGZpbGw9InJnYigyMzcsMjEsMjUpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IH
RleHQtYW5jaG9yPSIiIHg9IjExMC4xNiIgeT0iMjE5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZ
mFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmFsaWIvd2FyX29iamVjdHMvYWkv
YWlfbmV1cm9uLmx1YTo1Njg8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW9
2ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aX
RsZT5za3luZXQvbHVhbGliL3NreW5ldC5sdWE6MTI4ICgyMyw4MTAgc2FtcGxlcywgMTAwLjAwJ
Sk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjQ0OSIgd2lkdGg9IjIzODAuMCIgaGVpZ2h0PSIx
NS4wIiBmaWxsPSJyZ2IoMjM4LDI2LDI1KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWF
uY2hvcj0iIiB4PSIxMy4wMCIgeT0iNDU5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PS
JWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPnNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1YToxM
jg8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9u
bW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5jX2Z1bmN0aW9uOjB
4N2YzMDJiYzUyYTc4ICAgICAgKDc0NCBzYW1wbGVzLCAzLjEyJSk8L3RpdGxlPjxyZWN0IHg9Ij
EwLjAiIHk9IjEyOSIgd2lkdGg9Ijc0LjQiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyNCwyM
jAsMjcpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5
PSIxMzkuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYig
wLDAsMCkiICA+Y19mdW5jdGkuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdX
Nlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KP
HRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfYmFzZS5sdWE6MjM1ICgxNSwzNzIgc2FtcGxl
cywgNjQuNTYlKTwvdGl0bGU+PHJlY3QgeD0iMTA3LjIiIHk9IjExMyIgd2lkdGg9IjE1MzYuNSI
gaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjE4LDEwLDIpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZX
h0IHRleHQtYW5jaG9yPSIiIHg9IjExMC4xNiIgeT0iMTIzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvb
nQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfb2JqZWN0
cy9vYmpfYmFzZS5sdWE6MjM1PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2V
vdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dG
l0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6MTI1NCAoMjI4IHNhbXBsZXMsIDAuOTYlKTwvd
Gl0bGU+PHJlY3QgeD0iMTY0My43IiB5PSIxMTMiIHdpZHRoPSIyMi44IiBoZWlnaHQ9IjE1LjAi
IGZpbGw9InJnYigyMjcsMTExLDMwKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2h
vcj0iIiB4PSIxNjQ2LjcxIiB5PSIxMjMuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9Il
ZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+bC4uPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmd
W5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpv
b20odGhpcykiPgo8dGl0bGU+c2t5bmV0L2x1YWxpYi9za3luZXQubHVhOjM0NCAoMjI4IHNhbXB
sZXMsIDAuOTYlKTwvdGl0bGU+PHJlY3QgeD0iODQuNCIgeT0iMTYxIiB3aWR0aD0iMjIuOCIgaG
VpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjIwLDEwMSwzMCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRle
HQgdGV4dC1hbmNob3I9IiIgeD0iODcuMzciIHk9IjE3MS41IiBmb250LXNpemU9IjEyIiBmb250
LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5zLi48L3RleHQ+CjwvZz4KPGc
gY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb2
5jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YToxODA2I
Cg3LDIwMCBzYW1wbGVzLCAzMC4yNCUpPC90aXRsZT48cmVjdCB4PSIxNjY3LjkiIHk9IjI4OSIg
d2lkdGg9IjcxOS43IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMDYsMTg2LDE3KSIgcng9IjI
iIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjcwLjkwIiB5PSIyOTkuNSIgZm
9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+b
HVhbGliL3dhcl9yb29tL21hcC5sdWE6MTgwNjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19n
IiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHR
oaXMpIj4KPHRpdGxlPmx1YWxpYi9sb2dnZXIubHVhOjMwNyAoMTQgc2FtcGxlcywgMC4wNiUpPC
90aXRsZT48cmVjdCB4PSIxNjY2LjUiIHk9IjI0MSIgd2lkdGg9IjEuNCIgaGVpZ2h0PSIxNS4wI
iBmaWxsPSJyZ2IoMjQxLDE5NSwxNikiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNo
b3I9IiIgeD0iMTY2OS41MCIgeT0iMjUxLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJ
WZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY1
9nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tK
HRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTU0MSAoMTUs
MzcyIHNhbXBsZXMsIDY0LjU2JSk8L3RpdGxlPjxyZWN0IHg9IjEwNy4yIiB5PSIxNjEiIHdpZHR
oPSIxNTM2LjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIwNywxNDIsOSkiIHJ4PSIyIiByeT
0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTEwLjE2IiB5PSIxNzEuNSIgZm9udC1za
XplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+bHVhbGli
L3dhcl9vYmplY3RzL29ial9yb2xlLmx1YToxNTQxPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5
jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb2
0odGhpcykiPgo8dGl0bGU+Y19mdW5jdGlvbjoweDdmMzAyYmM1MmE3OCAgICAgICAoMTQgc2Ftc
GxlcywgMC4wNiUpPC90aXRsZT48cmVjdCB4PSIxNjY2LjUiIHk9IjE5MyIgd2lkdGg9IjEuNCIg
aGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjA5LDE5NSw1KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV
4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjY5LjUwIiB5PSIyMDMuNSIgZm9udC1zaXplPSIxMiIgZm
9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnI
GNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9u
Y2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+YWxpYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb24
ubHVhOjk5NCAoMTUsNjAwIHNhbXBsZXMsIDY1LjUyJSk8L3RpdGxlPjxyZWN0IHg9IjEwNy4yIi
B5PSIyNzMiIHdpZHRoPSIxNTU5LjMiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyMywxNywxN
CkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTEwLjE2IiB5PSIy
ODMuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDA
sMCkiICA+YWxpYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb24ubHVhOjk5NDwvdGV4dD4KPC9nPg
o8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpI
iBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9haS9haS5s
dWE6NTQ0ICgxNSw2MDAgc2FtcGxlcywgNjUuNTIlKTwvdGl0bGU+PHJlY3QgeD0iMTA3LjIiIHk
9IjI0MSIgd2lkdGg9IjE1NTkuMyIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjI4LDE0Miw1NC
kiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTEwLjE2IiB5PSIyN
TEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAs
MCkiICA+bHVhbGliL3dhcl9vYmplY3RzL2FpL2FpLmx1YTo1NDQ8L3RleHQ+CjwvZz4KPGcgY2x
hc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbG
ljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvbG9nZ2VyLmx1YTozMjIgKDE0IHNhbXBsZ
XMsIDAuMDYlKTwvdGl0bGU+PHJlY3QgeD0iMTY2Ni41IiB5PSIyNTciIHdpZHRoPSIxLjQiIGhl
aWdodD0iMTUuMCIgZmlsbD0icmdiKDI1Myw0NSwyMykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQ
gdGV4dC1hbmNob3I9IiIgeD0iMTY2OS41MCIgeT0iMjY3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbn
QtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjb
GFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNs
aWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNlcnZpY2Uvc2NlbmUvc2NlbmVfYmFzZS5sdWE6ODI
gKDc0NCBzYW1wbGVzLCAzLjEyJSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjE2MSIgd2lkdG
g9Ijc0LjQiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzNyw0Miw1MykiIHJ4PSIyIiByeT0iM
iIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjE3MS41IiBmb250LXNpemU9
IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5zZXJ2aWNlLy4
uPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm
1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb
29tL21hcC5sdWE6MTQ3MCAoNywyMDAgc2FtcGxlcywgMzAuMjQlKTwvdGl0bGU+PHJlY3QgeD0i
MTY2Ny45IiB5PSIyNzMiIHdpZHRoPSI3MTkuNyIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjU
wLDEsMzEpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2NzAuOT
AiIHk9IjI4My41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0ic
mdiKDAsMCwwKSIgID5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YToxNDcwPC90ZXh0Pgo8L2c+Cjxn
IGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9
uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+YWxpYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb2
4ubHVhOjYxNSAoMTUsNjAwIHNhbXBsZXMsIDY1LjUyJSk8L3RpdGxlPjxyZWN0IHg9IjEwNy4yI
iB5PSIxOTMiIHdpZHRoPSIxNTU5LjMiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0NSw0OSwz
NSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTEwLjE2IiB5PSI
yMDMuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLD
AsMCkiICA+YWxpYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb24ubHVhOjYxNTwvdGV4dD4KPC9nP
go8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygp
IiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS9yb29tLmx1YTo
zMjEgKDcsMjAwIHNhbXBsZXMsIDMwLjI0JSk8L3RpdGxlPjxyZWN0IHg9IjE2NjcuOSIgeT0iMj
U3IiB3aWR0aD0iNzE5LjciIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyNiwxMDgsNTIpIiBye
D0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2NzAuOTAiIHk9IjI2Ny41
IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSI
gID5sdWFsaWIvd2FyX3Jvb20vcm9vbS5sdWE6MzIxPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW
5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb
20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6MTI1NCAoMTUsMzcyIHNh
bXBsZXMsIDY0LjU2JSk8L3RpdGxlPjxyZWN0IHg9IjEwNy4yIiB5PSI5NyIgd2lkdGg9IjE1MzY
uNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjA5LDIxMywxOSkiIHJ4PSIyIiByeT0iMiIgLz
4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTEwLjE2IiB5PSIxMDcuNSIgZm9udC1zaXplPSIxM
iIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+bHVhbGliL3dhcl9y
b29tL21hcC5sdWE6MTI1NDwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Z
lcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdG
xlPmx1YWxpYi93YXJfcm9vbS9tYXAubHVhOjEyNTQgKDIyOCBzYW1wbGVzLCAwLjk2JSk8L3Rpd
GxlPjxyZWN0IHg9Ijg0LjQiIHk9IjIwOSIgd2lkdGg9IjIyLjgiIGhlaWdodD0iMTUuMCIgZmls
bD0icmdiKDIzMiwxNzUsNDMpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSI
iIHg9Ijg3LjM3IiB5PSIyMTkuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbm
EiIGZpbGw9InJnYigwLDAsMCkiICA+bC4uPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciI
G9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhp
cykiPgo8dGl0bGU+YWxpYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb24ubHVhOjU0NCAoNzQ0IHN
hbXBsZXMsIDMuMTIlKTwvdGl0bGU+PHJlY3QgeD0iMTAuMCIgeT0iMjg5IiB3aWR0aD0iNzQuNC
IgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjMwLDQ0LDMpIiByeD0iMiIgcnk9IjIiIC8+Cjx0Z
Xh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSIyOTkuNSIgZm9udC1zaXplPSIxMiIgZm9u
dC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+YWxpYi93YXIuLjwvdGV4dD4
KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD
0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNreW5ldC9sdWFsaWIvc2t5bmV0L
mx1YTozNDQgKDE1LDM3MiBzYW1wbGVzLCA2NC41NiUpPC90aXRsZT48cmVjdCB4PSIxMDcuMiIg
eT0iNDkiIHdpZHRoPSIxNTM2LjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0NSwxOTYsNSk
iIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTEwLjE2IiB5PSI1OS
41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwK
SIgID5za3luZXQvbHVhbGliL3NreW5ldC5sdWE6MzQ0PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJm
dW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inp
vb20odGhpcykiPgo8dGl0bGU+c2VydmljZS9zY2VuZS9zY2VuZV9iYXNlLmx1YTo4MiAoMjI4IH
NhbXBsZXMsIDAuOTYlKTwvdGl0bGU+PHJlY3QgeD0iODQuNCIgeT0iMTc3IiB3aWR0aD0iMjIuO
CIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQxLDIxOSwxOSkiIHJ4PSIyIiByeT0iMiIgLz4K
PHRleHQgdGV4dC1hbmNob3I9IiIgeD0iODcuMzciIHk9IjE4Ny41IiBmb250LXNpemU9IjEyIiB
mb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5zLi48L3RleHQ+CjwvZz
4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoK
SIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZXJ2aWNlL3NjZW5lL3NjZW5lX2Jhc2Uu
bHVhOjgyICgyMjggc2FtcGxlcywgMC45NiUpPC90aXRsZT48cmVjdCB4PSIxNjQzLjciIHk9Ijg
xIiB3aWR0aD0iMjIuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ2LDIwNiw0MikiIHJ4PS
IyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTY0Ni43MSIgeT0iOTEuNSIgZ
m9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+
cy4uPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiB
vbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL2Vqb3
lfdGltZXIubHVhOjUzICgyMyw3ODYgc2FtcGxlcywgOTkuOTAlKTwvdGl0bGU+PHJlY3QgeD0iM
TAuMCIgeT0iMzM3IiB3aWR0aD0iMjM3Ny42IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzYs
NjcsNDkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB
5PSIzNDcuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYi
gwLDAsMCkiICA+bHVhbGliL2Vqb3lfdGltZXIubHVhOjUzPC90ZXh0Pgo8L2c+CjxnIGNsYXNzP
SJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9
Inpvb20odGhpcykiPgo8dGl0bGU+Y19mdW5jdGlvbjoweDdmMzAyYmM1MmE3OCAgICAgICgyMjg
gc2FtcGxlcywgMC45NiUpPC90aXRsZT48cmVjdCB4PSIxNjQzLjciIHk9IjQ5IiB3aWR0aD0iMj
IuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ0LDEwOSwxOCkiIHJ4PSIyIiByeT0iMiIgL
z4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTY0Ni43MSIgeT0iNTkuNSIgZm9udC1zaXplPSIx
MiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+Yy4uPC90ZXh0Pgo
8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PS
JjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+Y19mdW5jdGlvbjoweDdmMzAyYmM1M
mIzOCAgICAgICAgKDggc2FtcGxlcywgMC4wMyUpPC90aXRsZT48cmVjdCB4PSIyMzg5LjIiIHk9
IjM4NSIgd2lkdGg9IjAuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjM3LDEsMTApIiByeD0
iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIzOTIuMjAiIHk9IjM5NS41Ii
Bmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgI
D48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9u
bW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3J
vb20vcm9vbS5sdWE6MzIxICgyMjggc2FtcGxlcywgMC45NiUpPC90aXRsZT48cmVjdCB4PSI4NC
40IiB5PSIxOTMiIHdpZHRoPSIyMi44IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjEsMTU3L
DExKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSI4Ny4zNyIgeT0i
MjAzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCw
wLDApIiAgPmwuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icy
h0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1Y
WxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTQ4MyAoMTUsMzcyIHNhbXBsZXMsIDY0LjU2
JSk8L3RpdGxlPjxyZWN0IHg9IjEwNy4yIiB5PSIxNDUiIHdpZHRoPSIxNTM2LjUiIGhlaWdodD0
iMTUuMCIgZmlsbD0icmdiKDI1MCwxNDEsNDIpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleH
QtYW5jaG9yPSIiIHg9IjExMC4xNiIgeT0iMTU1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFta
Wx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpf
cm9sZS5sdWE6MTQ4MzwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0
icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPm
x1YWxpYi9sb2dnZXIubHVhOjM2OSAoMTQgc2FtcGxlcywgMC4wNiUpPC90aXRsZT48cmVjdCB4P
SIxNjY2LjUiIHk9IjI3MyIgd2lkdGg9IjEuNCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjE0
LDIwMCwzNCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTY2OS4
1MCIgeT0iMjgzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPS
JyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlc
j0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxl
Pmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTMwOCAoMjI4IHNhbXBsZXMsIDAuOTY
lKTwvdGl0bGU+PHJlY3QgeD0iMTY0My43IiB5PSIxNDUiIHdpZHRoPSIyMi44IiBoZWlnaHQ9Ij
E1LjAiIGZpbGw9InJnYigyMjEsMjEwLDQ2KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0L
WFuY2hvcj0iIiB4PSIxNjQ2LjcxIiB5PSIxNTUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1p
bHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+bC4uPC90ZXh0Pgo8L2c+CjxnIGNsYXN
zPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2
s9Inpvb20odGhpcykiPgo8dGl0bGU+c2VydmljZS9zY2VuZS9zY2VuZV9iYXNlLmx1YTo4MiAoM
TUsMzcyIHNhbXBsZXMsIDY0LjU2JSk8L3RpdGxlPjxyZWN0IHg9IjEwNy4yIiB5PSI2NSIgd2lk
dGg9IjE1MzYuNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjA1LDE3MCw0MikiIHJ4PSIyIiB
yeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTEwLjE2IiB5PSI3NS41IiBmb250LX
NpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5zZXJ2a
WNlL3NjZW5lL3NjZW5lX2Jhc2UubHVhOjgyPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ci
IG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGh
pcykiPgo8dGl0bGU+bHVhbGliL2Vqb3lfdGltZXIubHVhOjQ4ICgyMyw3ODYgc2FtcGxlcywgOT
kuOTAlKTwvdGl0bGU+PHJlY3QgeD0iMTAuMCIgeT0iMzg1IiB3aWR0aD0iMjM3Ny42IiBoZWlna
HQ9IjE1LjAiIGZpbGw9InJnYigyMTMsMTQ2LDE3KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0
ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iMzk1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmF
taWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi9lam95X3RpbWVyLmx1YT
o0ODwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb
25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmFsaWIvd2FyX29i
amVjdHMvYWkvYWlfbmV1cm9uLmx1YToxMDk4ICgxNSw2MDAgc2FtcGxlcywgNjUuNTIlKTwvdGl
0bGU+PHJlY3QgeD0iMTA3LjIiIHk9IjI1NyIgd2lkdGg9IjE1NTkuMyIgaGVpZ2h0PSIxNS4wIi
BmaWxsPSJyZ2IoMjIzLDIyMywyMykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob
3I9IiIgeD0iMTEwLjE2IiB5PSIyNjcuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZl
cmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+YWxpYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb24
ubHVhOjEwOTg8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModG
hpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5hbGliL
3dhcl9vYmplY3RzL2FpL2FpX25ldXJvbi5sdWE6OTQ3ICgxNSw4Mjggc2FtcGxlcywgNjYuNDgl
KTwvdGl0bGU+PHJlY3QgeD0iODQuNCIgeT0iMjg5IiB3aWR0aD0iMTU4Mi4xIiBoZWlnaHQ9IjE
1LjAiIGZpbGw9InJnYigyNTEsMTcxLDM1KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LW
FuY2hvcj0iIiB4PSI4Ny4zNyIgeT0iMjk5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5P
SJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmFsaWIvd2FyX29iamVjdHMvYWkvYWlfbmV1
cm9uLmx1YTo5NDc8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InM
odGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdW
FsaWIvd2FyX29iamVjdHMvb2JqX3JvbGUubHVhOjEzMDggKDIyOCBzYW1wbGVzLCAwLjk2JSk8L
3RpdGxlPjxyZWN0IHg9Ijg0LjQiIHk9IjI0MSIgd2lkdGg9IjIyLjgiIGhlaWdodD0iMTUuMCIg
ZmlsbD0icmdiKDIyMSwxNTYsMjApIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9
yPSIiIHg9Ijg3LjM3IiB5PSIyNTEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcm
RhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+bC4uPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX
2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20o
dGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL3Jvb20ubHVhOjMyMSAoMTUsMzcyIHNhbXB
sZXMsIDY0LjU2JSk8L3RpdGxlPjxyZWN0IHg9IjEwNy4yIiB5PSI4MSIgd2lkdGg9IjE1MzYuNS
IgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjExLDE2NSw2KSIgcng9IjIiIHJ5PSIyIiAvPgo8d
GV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMTAuMTYiIHk9IjkxLjUiIGZvbnQtc2l6ZT0iMTIiIGZv
bnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfcm9vbS9
yb29tLmx1YTozMjE8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9In
ModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5id
WlsZC9sdWFsaWIvdGltZXIubHVhOjExMCAoMjMsNzg2IHNhbXBsZXMsIDk5LjkwJSk8L3RpdGxl
PjxyZWN0IHg9IjEwLjAiIHk9IjM2OSIgd2lkdGg9IjIzNzcuNiIgaGVpZ2h0PSIxNS4wIiBmaWx
sPSJyZ2IoMjQ4LDE3Myw0OSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9Ii
IgeD0iMTMuMDAiIHk9IjM3OS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuY
SIgZmlsbD0icmdiKDAsMCwwKSIgID5idWlsZC9sdWFsaWIvdGltZXIubHVhOjExMDwvdGV4dD4K
PC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0
iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNreW5ldC9sdWFsaWIvc2t5bmV0Lm
x1YTo1NDUgKDIzLDgxMCBzYW1wbGVzLCAxMDAuMDAlKTwvdGl0bGU+PHJlY3QgeD0iMTAuMCIge
T0iNDMzIiB3aWR0aD0iMjM4MC4wIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMTIsNjcsNDAp
IiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSI0NDM
uNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMC
kiICA+c2t5bmV0L2x1YWxpYi9za3luZXQubHVhOjU0NTwvdGV4dD4KPC9nPgo8L3N2Zz4=" alt="" /></p>
<p>&nbsp;</p>
<p>火焰图取材于在内核取样的数据点，纵向切一刀，表示当前时刻的lua栈。横向表示统计时间内，各个栈帧的占比。横向越长，时间越长。纵向越深，调用越深。颜色没有关系，可以忽略</p>
<p>&nbsp;</p>
<p>可以看到里面有个堆栈很高，说明调用深度很深，另外宽度也很大，说明调用频次占比高。后来定位了一下这个函数，发现是多调了一次aoi同步&hellip;&hellip;</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkx
JQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy
9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0MDAiI
GhlaWdodD0iNDk4IiBvbmxvYWQ9ImluaXQoZXZ0KSIgdmlld0JveD0iMCAwIDI0MDAgNDk4IiB4
bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d
3LnczLm9yZy8xOTk5L3hsaW5rIj4KPCEtLSBGbGFtZSBncmFwaCBzdGFjayB2aXN1YWxpemF0aW
9uLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2JyZW5kYW5ncmVnZy9GbGFtZUdyYXBoIGZvciBsY
XRlc3QgdmVyc2lvbiwgYW5kIGh0dHA6Ly93d3cuYnJlbmRhbmdyZWdnLmNvbS9mbGFtZWdyYXBo
cy5odG1sIGZvciBleGFtcGxlcy4gLS0+CjxkZWZzID4KCTxsaW5lYXJHcmFkaWVudCBpZD0iYmF
ja2dyb3VuZCIgeTE9IjAiIHkyPSIxIiB4MT0iMCIgeDI9IjAiID4KCQk8c3RvcCBzdG9wLWNvbG
9yPSIjZWVlZWVlIiBvZmZzZXQ9IjUlIiAvPgoJCTxzdG9wIHN0b3AtY29sb3I9IiNlZWVlYjAiI
G9mZnNldD0iOTUlIiAvPgoJPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8c3R5bGUgdHlwZT0i
dGV4dC9jc3MiPgoJLmZ1bmNfZzpob3ZlciB7IHN0cm9rZTpibGFjazsgc3Ryb2tlLXdpZHRoOjA
uNTsgY3Vyc29yOnBvaW50ZXI7IH0KPC9zdHlsZT4KPHNjcmlwdCB0eXBlPSJ0ZXh0L2VjbWFzY3
JpcHQiPgo8IVtDREFUQVsKCXZhciBkZXRhaWxzLCBzZWFyY2hidG4sIG1hdGNoZWR0eHQsIHN2Z
zsKCWZ1bmN0aW9uIGluaXQoZXZ0KSB7CgkJZGV0YWlscyA9IGRvY3VtZW50LmdldEVsZW1lbnRC
eUlkKCJkZXRhaWxzIikuZmlyc3RDaGlsZDsKCQlzZWFyY2hidG4gPSBkb2N1bWVudC5nZXRFbGV
tZW50QnlJZCgic2VhcmNoIik7CgkJbWF0Y2hlZHR4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeU
lkKCJtYXRjaGVkIik7CgkJc3ZnID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInN2Z
yIpWzBdOwoJCXNlYXJjaGluZyA9IDA7Cgl9CgoJLy8gbW91c2Utb3ZlciBmb3IgaW5mbwoJZnVu
Y3Rpb24gcyhub2RlKSB7CQkvLyBzaG93CgkJaW5mbyA9IGdfdG9fdGV4dChub2RlKTsKCQlkZXR
haWxzLm5vZGVWYWx1ZSA9ICJGdW5jdGlvbjogIiArIGluZm87Cgl9CglmdW5jdGlvbiBjKCkgew
kJCS8vIGNsZWFyCgkJZGV0YWlscy5ub2RlVmFsdWUgPSAnICc7Cgl9CgoJLy8gY3RybC1GIGZvc
iBzZWFyY2gKCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIixmdW5jdGlvbiAoZSkg
ewoJCWlmIChlLmtleUNvZGUgPT09IDExNCB8fCAoZS5jdHJsS2V5ICYmIGUua2V5Q29kZSA9PT0
gNzApKSB7CgkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJc2VhcmNoX3Byb21wdCgpOwoJCX0KCX
0pCgoJLy8gZnVuY3Rpb25zCglmdW5jdGlvbiBmaW5kX2NoaWxkKHBhcmVudCwgbmFtZSwgYXR0c
ikgewoJCXZhciBjaGlsZHJlbiA9IHBhcmVudC5jaGlsZE5vZGVzOwoJCWZvciAodmFyIGk9MDsg
aTxjaGlsZHJlbi5sZW5ndGg7aSsrKSB7CgkJCWlmIChjaGlsZHJlbltpXS50YWdOYW1lID09IG5
hbWUpCgkJCQlyZXR1cm4gKGF0dHIgIT0gdW5kZWZpbmVkKSA/IGNoaWxkcmVuW2ldLmF0dHJpYn
V0ZXNbYXR0cl0udmFsdWUgOiBjaGlsZHJlbltpXTsKCQl9CgkJcmV0dXJuOwoJfQoJZnVuY3Rpb
24gb3JpZ19zYXZlKGUsIGF0dHIsIHZhbCkgewoJCWlmIChlLmF0dHJpYnV0ZXNbIl9vcmlnXyIr
YXR0cl0gIT0gdW5kZWZpbmVkKSByZXR1cm47CgkJaWYgKGUuYXR0cmlidXRlc1thdHRyXSA9PSB
1bmRlZmluZWQpIHJldHVybjsKCQlpZiAodmFsID09IHVuZGVmaW5lZCkgdmFsID0gZS5hdHRyaW
J1dGVzW2F0dHJdLnZhbHVlOwoJCWUuc2V0QXR0cmlidXRlKCJfb3JpZ18iK2F0dHIsIHZhbCk7C
gl9CglmdW5jdGlvbiBvcmlnX2xvYWQoZSwgYXR0cikgewoJCWlmIChlLmF0dHJpYnV0ZXNbIl9v
cmlnXyIrYXR0cl0gPT0gdW5kZWZpbmVkKSByZXR1cm47CgkJZS5hdHRyaWJ1dGVzW2F0dHJdLnZ
hbHVlID0gZS5hdHRyaWJ1dGVzWyJfb3JpZ18iK2F0dHJdLnZhbHVlOwoJCWUucmVtb3ZlQXR0cm
lidXRlKCJfb3JpZ18iK2F0dHIpOwoJfQoJZnVuY3Rpb24gZ190b190ZXh0KGUpIHsKCQl2YXIgd
GV4dCA9IGZpbmRfY2hpbGQoZSwgInRpdGxlIikuZmlyc3RDaGlsZC5ub2RlVmFsdWU7CgkJcmV0
dXJuICh0ZXh0KQoJfQoJZnVuY3Rpb24gZ190b19mdW5jKGUpIHsKCQl2YXIgZnVuYyA9IGdfdG9
fdGV4dChlKTsKCQlpZiAoZnVuYyAhPSBudWxsKQoJCQlmdW5jID0gZnVuYy5yZXBsYWNlKC8gLi
ovLCAiIik7CgkJcmV0dXJuIChmdW5jKTsKCX0KCWZ1bmN0aW9uIHVwZGF0ZV90ZXh0KGUpIHsKC
Ql2YXIgciA9IGZpbmRfY2hpbGQoZSwgInJlY3QiKTsKCQl2YXIgdCA9IGZpbmRfY2hpbGQoZSwg
InRleHQiKTsKCQl2YXIgdyA9IHBhcnNlRmxvYXQoci5hdHRyaWJ1dGVzWyJ3aWR0aCJdLnZhbHV
lKSAtMzsKCQl2YXIgdHh0ID0gZmluZF9jaGlsZChlLCAidGl0bGUiKS50ZXh0Q29udGVudC5yZX
BsYWNlKC9cKFteKF0qXCkkLywiIik7CgkJdC5hdHRyaWJ1dGVzWyJ4Il0udmFsdWUgPSBwYXJzZ
UZsb2F0KHIuYXR0cmlidXRlc1sieCJdLnZhbHVlKSArMzsKCgkJLy8gU21hbGxlciB0aGFuIHRo
aXMgc2l6ZSB3b24ndCBmaXQgYW55dGhpbmcKCQlpZiAodyA8IDIqMTIqMC41OSkgewoJCQl0LnR
leHRDb250ZW50ID0gIiI7CgkJCXJldHVybjsKCQl9CgoJCXQudGV4dENvbnRlbnQgPSB0eHQ7Cg
kJLy8gRml0IGluIGZ1bGwgdGV4dCB3aWR0aAoJCWlmICgvXiAqJC8udGVzdCh0eHQpIHx8IHQuZ
2V0U3ViU3RyaW5nTGVuZ3RoKDAsIHR4dC5sZW5ndGgpIDwgdykKCQkJcmV0dXJuOwoKCQlmb3Ig
KHZhciB4PXR4dC5sZW5ndGgtMjsgeD4wOyB4LS0pIHsKCQkJaWYgKHQuZ2V0U3ViU3RyaW5nTGV
uZ3RoKDAsIHgrMikgPD0gdykgewoJCQkJdC50ZXh0Q29udGVudCA9IHR4dC5zdWJzdHJpbmcoMC
x4KSArICIuLiI7CgkJCQlyZXR1cm47CgkJCX0KCQl9CgkJdC50ZXh0Q29udGVudCA9ICIiOwoJf
QoKCS8vIHpvb20KCWZ1bmN0aW9uIHpvb21fcmVzZXQoZSkgewoJCWlmIChlLmF0dHJpYnV0ZXMg
IT0gdW5kZWZpbmVkKSB7CgkJCW9yaWdfbG9hZChlLCAieCIpOwoJCQlvcmlnX2xvYWQoZSwgInd
pZHRoIik7CgkJfQoJCWlmIChlLmNoaWxkTm9kZXMgPT0gdW5kZWZpbmVkKSByZXR1cm47CgkJZm
9yKHZhciBpPTAsIGM9ZS5jaGlsZE5vZGVzOyBpPGMubGVuZ3RoOyBpKyspIHsKCQkJem9vbV9yZ
XNldChjW2ldKTsKCQl9Cgl9CglmdW5jdGlvbiB6b29tX2NoaWxkKGUsIHgsIHJhdGlvKSB7CgkJ
aWYgKGUuYXR0cmlidXRlcyAhPSB1bmRlZmluZWQpIHsKCQkJaWYgKGUuYXR0cmlidXRlc1sieCJ
dICE9IHVuZGVmaW5lZCkgewoJCQkJb3JpZ19zYXZlKGUsICJ4Iik7CgkJCQllLmF0dHJpYnV0ZX
NbIngiXS52YWx1ZSA9IChwYXJzZUZsb2F0KGUuYXR0cmlidXRlc1sieCJdLnZhbHVlKSAtIHggL
SAxMCkgKiByYXRpbyArIDEwOwoJCQkJaWYoZS50YWdOYW1lID09ICJ0ZXh0IikgZS5hdHRyaWJ1
dGVzWyJ4Il0udmFsdWUgPSBmaW5kX2NoaWxkKGUucGFyZW50Tm9kZSwgInJlY3QiLCAieCIpICs
gMzsKCQkJfQoJCQlpZiAoZS5hdHRyaWJ1dGVzWyJ3aWR0aCJdICE9IHVuZGVmaW5lZCkgewoJCQ
kJb3JpZ19zYXZlKGUsICJ3aWR0aCIpOwoJCQkJZS5hdHRyaWJ1dGVzWyJ3aWR0aCJdLnZhbHVlI
D0gcGFyc2VGbG9hdChlLmF0dHJpYnV0ZXNbIndpZHRoIl0udmFsdWUpICogcmF0aW87CgkJCX0K
CQl9CgoJCWlmIChlLmNoaWxkTm9kZXMgPT0gdW5kZWZpbmVkKSByZXR1cm47CgkJZm9yKHZhciB
pPTAsIGM9ZS5jaGlsZE5vZGVzOyBpPGMubGVuZ3RoOyBpKyspIHsKCQkJem9vbV9jaGlsZChjW2
ldLCB4LTEwLCByYXRpbyk7CgkJfQoJfQoJZnVuY3Rpb24gem9vbV9wYXJlbnQoZSkgewoJCWlmI
ChlLmF0dHJpYnV0ZXMpIHsKCQkJaWYgKGUuYXR0cmlidXRlc1sieCJdICE9IHVuZGVmaW5lZCkg
ewoJCQkJb3JpZ19zYXZlKGUsICJ4Iik7CgkJCQllLmF0dHJpYnV0ZXNbIngiXS52YWx1ZSA9IDE
wOwoJCQl9CgkJCWlmIChlLmF0dHJpYnV0ZXNbIndpZHRoIl0gIT0gdW5kZWZpbmVkKSB7CgkJCQ
lvcmlnX3NhdmUoZSwgIndpZHRoIik7CgkJCQllLmF0dHJpYnV0ZXNbIndpZHRoIl0udmFsdWUgP
SBwYXJzZUludChzdmcud2lkdGguYmFzZVZhbC52YWx1ZSkgLSAoMTAqMik7CgkJCX0KCQl9CgkJ
aWYgKGUuY2hpbGROb2RlcyA9PSB1bmRlZmluZWQpIHJldHVybjsKCQlmb3IodmFyIGk9MCwgYz1
lLmNoaWxkTm9kZXM7IGk8Yy5sZW5ndGg7IGkrKykgewoJCQl6b29tX3BhcmVudChjW2ldKTsKCQ
l9Cgl9CglmdW5jdGlvbiB6b29tKG5vZGUpIHsKCQl2YXIgYXR0ciA9IGZpbmRfY2hpbGQobm9kZ
SwgInJlY3QiKS5hdHRyaWJ1dGVzOwoJCXZhciB3aWR0aCA9IHBhcnNlRmxvYXQoYXR0clsid2lk
dGgiXS52YWx1ZSk7CgkJdmFyIHhtaW4gPSBwYXJzZUZsb2F0KGF0dHJbIngiXS52YWx1ZSk7Cgk
JdmFyIHhtYXggPSBwYXJzZUZsb2F0KHhtaW4gKyB3aWR0aCk7CgkJdmFyIHltaW4gPSBwYXJzZU
Zsb2F0KGF0dHJbInkiXS52YWx1ZSk7CgkJdmFyIHJhdGlvID0gKHN2Zy53aWR0aC5iYXNlVmFsL
nZhbHVlIC0gMioxMCkgLyB3aWR0aDsKCgkJLy8gWFhYOiBXb3JrYXJvdW5kIGZvciBKYXZhU2Ny
aXB0IGZsb2F0IGlzc3VlcyAoZml4IG1lKQoJCXZhciBmdWRnZSA9IDAuMDAwMTsKCgkJdmFyIHV
uem9vbWJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ1bnpvb20iKTsKCQl1bnpvb21idG
4uc3R5bGVbIm9wYWNpdHkiXSA9ICIxLjAiOwoKCQl2YXIgZWwgPSBkb2N1bWVudC5nZXRFbGVtZ
W50c0J5VGFnTmFtZSgiZyIpOwoJCWZvcih2YXIgaT0wO2k8ZWwubGVuZ3RoO2krKyl7CgkJCXZh
ciBlID0gZWxbaV07CgkJCXZhciBhID0gZmluZF9jaGlsZChlLCAicmVjdCIpLmF0dHJpYnV0ZXM
7CgkJCXZhciBleCA9IHBhcnNlRmxvYXQoYVsieCJdLnZhbHVlKTsKCQkJdmFyIGV3ID0gcGFyc2
VGbG9hdChhWyJ3aWR0aCJdLnZhbHVlKTsKCQkJLy8gSXMgaXQgYW4gYW5jZXN0b3IKCQkJaWYgK
DAgPT0gMCkgewoJCQkJdmFyIHVwc3RhY2sgPSBwYXJzZUZsb2F0KGFbInkiXS52YWx1ZSkgPiB5
bWluOwoJCQl9IGVsc2UgewoJCQkJdmFyIHVwc3RhY2sgPSBwYXJzZUZsb2F0KGFbInkiXS52YWx
1ZSkgPCB5bWluOwoJCQl9CgkJCWlmICh1cHN0YWNrKSB7CgkJCQkvLyBEaXJlY3QgYW5jZXN0b3
IKCQkJCWlmIChleCA8PSB4bWluICYmIChleCtldytmdWRnZSkgPj0geG1heCkgewoJCQkJCWUuc
3R5bGVbIm9wYWNpdHkiXSA9ICIwLjUiOwoJCQkJCXpvb21fcGFyZW50KGUpOwoJCQkJCWUub25j
bGljayA9IGZ1bmN0aW9uKGUpe3Vuem9vbSgpOyB6b29tKHRoaXMpO307CgkJCQkJdXBkYXRlX3R
leHQoZSk7CgkJCQl9CgkJCQkvLyBub3QgaW4gY3VycmVudCBwYXRoCgkJCQllbHNlCgkJCQkJZS
5zdHlsZVsiZGlzcGxheSJdID0gIm5vbmUiOwoJCQl9CgkJCS8vIENoaWxkcmVuIG1heWJlCgkJC
WVsc2UgewoJCQkJLy8gbm8gY29tbW9uIHBhdGgKCQkJCWlmIChleCA8IHhtaW4gfHwgZXggKyBm
dWRnZSA+PSB4bWF4KSB7CgkJCQkJZS5zdHlsZVsiZGlzcGxheSJdID0gIm5vbmUiOwoJCQkJfQo
JCQkJZWxzZSB7CgkJCQkJem9vbV9jaGlsZChlLCB4bWluLCByYXRpbyk7CgkJCQkJZS5vbmNsaW
NrID0gZnVuY3Rpb24oZSl7em9vbSh0aGlzKTt9OwoJCQkJCXVwZGF0ZV90ZXh0KGUpOwoJCQkJf
QoJCQl9CgkJfQoJfQoJZnVuY3Rpb24gdW56b29tKCkgewoJCXZhciB1bnpvb21idG4gPSBkb2N1
bWVudC5nZXRFbGVtZW50QnlJZCgidW56b29tIik7CgkJdW56b29tYnRuLnN0eWxlWyJvcGFjaXR
5Il0gPSAiMC4wIjsKCgkJdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIm
ciKTsKCQlmb3IoaT0wO2k8ZWwubGVuZ3RoO2krKykgewoJCQllbFtpXS5zdHlsZVsiZGlzcGxhe
SJdID0gImJsb2NrIjsKCQkJZWxbaV0uc3R5bGVbIm9wYWNpdHkiXSA9ICIxIjsKCQkJem9vbV9y
ZXNldChlbFtpXSk7CgkJCXVwZGF0ZV90ZXh0KGVsW2ldKTsKCQl9Cgl9CgoJLy8gc2VhcmNoCgl
mdW5jdGlvbiByZXNldF9zZWFyY2goKSB7CgkJdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudH
NCeVRhZ05hbWUoInJlY3QiKTsKCQlmb3IgKHZhciBpPTA7IGkgPCBlbC5sZW5ndGg7IGkrKykge
woJCQlvcmlnX2xvYWQoZWxbaV0sICJmaWxsIikKCQl9Cgl9CglmdW5jdGlvbiBzZWFyY2hfcHJv
bXB0KCkgewoJCWlmICghc2VhcmNoaW5nKSB7CgkJCXZhciB0ZXJtID0gcHJvbXB0KCJFbnRlciB
hIHNlYXJjaCB0ZXJtIChyZWdleHAgIiArCgkJCSAgICAiYWxsb3dlZCwgZWc6IF5leHQ0XykiLC
AiIik7CgkJCWlmICh0ZXJtICE9IG51bGwpIHsKCQkJCXNlYXJjaCh0ZXJtKQoJCQl9CgkJfSBlb
HNlIHsKCQkJcmVzZXRfc2VhcmNoKCk7CgkJCXNlYXJjaGluZyA9IDA7CgkJCXNlYXJjaGJ0bi5z
dHlsZVsib3BhY2l0eSJdID0gIjAuMSI7CgkJCXNlYXJjaGJ0bi5maXJzdENoaWxkLm5vZGVWYWx
1ZSA9ICJTZWFyY2giCgkJCW1hdGNoZWR0eHQuc3R5bGVbIm9wYWNpdHkiXSA9ICIwLjAiOwoJCQ
ltYXRjaGVkdHh0LmZpcnN0Q2hpbGQubm9kZVZhbHVlID0gIiIKCQl9Cgl9CglmdW5jdGlvbiBzZ
WFyY2godGVybSkgewoJCXZhciByZSA9IG5ldyBSZWdFeHAodGVybSk7CgkJdmFyIGVsID0gZG9j
dW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImciKTsKCQl2YXIgbWF0Y2hlcyA9IG5ldyBPYmp
lY3QoKTsKCQl2YXIgbWF4d2lkdGggPSAwOwoJCWZvciAodmFyIGkgPSAwOyBpIDwgZWwubGVuZ3
RoOyBpKyspIHsKCQkJdmFyIGUgPSBlbFtpXTsKCQkJaWYgKGUuYXR0cmlidXRlc1siY2xhc3MiX
S52YWx1ZSAhPSAiZnVuY19nIikKCQkJCWNvbnRpbnVlOwoJCQl2YXIgZnVuYyA9IGdfdG9fZnVu
YyhlKTsKCQkJdmFyIHJlY3QgPSBmaW5kX2NoaWxkKGUsICJyZWN0Iik7CgkJCWlmIChyZWN0ID0
9IG51bGwpIHsKCQkJCS8vIHRoZSByZWN0IG1pZ2h0IGJlIHdyYXBwZWQgaW4gYW4gYW5jaG9yCg
kJCQkvLyBpZiBuYW1lYXR0ciBocmVmIGlzIGJlaW5nIHVzZWQKCQkJCWlmIChyZWN0ID0gZmluZ
F9jaGlsZChlLCAiYSIpKSB7CgkJCQkgICAgcmVjdCA9IGZpbmRfY2hpbGQociwgInJlY3QiKTsK
CQkJCX0KCQkJfQoJCQlpZiAoZnVuYyA9PSBudWxsIHx8IHJlY3QgPT0gbnVsbCkKCQkJCWNvbnR
pbnVlOwoKCQkJLy8gU2F2ZSBtYXggd2lkdGguIE9ubHkgd29ya3MgYXMgd2UgaGF2ZSBhIHJvb3
QgZnJhbWUKCQkJdmFyIHcgPSBwYXJzZUZsb2F0KHJlY3QuYXR0cmlidXRlc1sid2lkdGgiXS52Y
Wx1ZSk7CgkJCWlmICh3ID4gbWF4d2lkdGgpCgkJCQltYXh3aWR0aCA9IHc7CgoJCQlpZiAoZnVu
Yy5tYXRjaChyZSkpIHsKCQkJCS8vIGhpZ2hsaWdodAoJCQkJdmFyIHggPSBwYXJzZUZsb2F0KHJ
lY3QuYXR0cmlidXRlc1sieCJdLnZhbHVlKTsKCQkJCW9yaWdfc2F2ZShyZWN0LCAiZmlsbCIpOw
oJCQkJcmVjdC5hdHRyaWJ1dGVzWyJmaWxsIl0udmFsdWUgPQoJCQkJICAgICJyZ2IoMjMwLDAsM
jMwKSI7CgoJCQkJLy8gcmVtZW1iZXIgbWF0Y2hlcwoJCQkJaWYgKG1hdGNoZXNbeF0gPT0gdW5k
ZWZpbmVkKSB7CgkJCQkJbWF0Y2hlc1t4XSA9IHc7CgkJCQl9IGVsc2UgewoJCQkJCWlmICh3ID4
gbWF0Y2hlc1t4XSkgewoJCQkJCQkvLyBvdmVyd3JpdGUgd2l0aCBwYXJlbnQKCQkJCQkJbWF0Y2
hlc1t4XSA9IHc7CgkJCQkJfQoJCQkJfQoJCQkJc2VhcmNoaW5nID0gMTsKCQkJfQoJCX0KCQlpZ
iAoIXNlYXJjaGluZykKCQkJcmV0dXJuOwoKCQlzZWFyY2hidG4uc3R5bGVbIm9wYWNpdHkiXSA9
ICIxLjAiOwoJCXNlYXJjaGJ0bi5maXJzdENoaWxkLm5vZGVWYWx1ZSA9ICJSZXNldCBTZWFyY2g
iCgoJCS8vIGNhbGN1bGF0ZSBwZXJjZW50IG1hdGNoZWQsIGV4Y2x1ZGluZyB2ZXJ0aWNhbCBvdm
VybGFwCgkJdmFyIGNvdW50ID0gMDsKCQl2YXIgbGFzdHggPSAtMTsKCQl2YXIgbGFzdHcgPSAwO
woJCXZhciBrZXlzID0gQXJyYXkoKTsKCQlmb3IgKGsgaW4gbWF0Y2hlcykgewoJCQlpZiAobWF0
Y2hlcy5oYXNPd25Qcm9wZXJ0eShrKSkKCQkJCWtleXMucHVzaChrKTsKCQl9CgkJLy8gc29ydCB
0aGUgbWF0Y2hlZCBmcmFtZXMgYnkgdGhlaXIgeCBsb2NhdGlvbgoJCS8vIGFzY2VuZGluZywgdG
hlbiB3aWR0aCBkZXNjZW5kaW5nCgkJa2V5cy5zb3J0KGZ1bmN0aW9uKGEsIGIpewoJCQkJcmV0d
XJuIGEgLSBiOwoJCQlpZiAoYSA8IGIgfHwgYSA+IGIpCgkJCQlyZXR1cm4gYSAtIGI7CgkJCXJl
dHVybiBtYXRjaGVzW2JdIC0gbWF0Y2hlc1thXTsKCQl9KTsKCQkvLyBTdGVwIHRocm91Z2ggZnJ
hbWVzIHNhdmluZyBvbmx5IHRoZSBiaWdnZXN0IGJvdHRvbS11cCBmcmFtZXMKCQkvLyB0aGFua3
MgdG8gdGhlIHNvcnQgb3JkZXIuIFRoaXMgcmVsaWVzIG9uIHRoZSB0cmVlIHByb3BlcnR5CgkJL
y8gd2hlcmUgY2hpbGRyZW4gYXJlIGFsd2F5cyBzbWFsbGVyIHRoYW4gdGhlaXIgcGFyZW50cy4K
CQlmb3IgKHZhciBrIGluIGtleXMpIHsKCQkJdmFyIHggPSBwYXJzZUZsb2F0KGtleXNba10pOwo
JCQl2YXIgdyA9IG1hdGNoZXNba2V5c1trXV07CgkJCWlmICh4ID49IGxhc3R4ICsgbGFzdHcpIH
sKCQkJCWNvdW50ICs9IHc7CgkJCQlsYXN0eCA9IHg7CgkJCQlsYXN0dyA9IHc7CgkJCX0KCQl9C
gkJLy8gZGlzcGxheSBtYXRjaGVkIHBlcmNlbnQKCQltYXRjaGVkdHh0LnN0eWxlWyJvcGFjaXR5
Il0gPSAiMS4wIjsKCQlwY3QgPSAxMDAgKiBjb3VudCAvIG1heHdpZHRoOwoJCWlmIChwY3QgPT0
gMTAwKQoJCQlwY3QgPSAiMTAwIgoJCWVsc2UKCQkJcGN0ID0gcGN0LnRvRml4ZWQoMSkKCQltYX
RjaGVkdHh0LmZpcnN0Q2hpbGQubm9kZVZhbHVlID0gIk1hdGNoZWQ6ICIgKyBwY3QgKyAiJSI7C
gl9CglmdW5jdGlvbiBzZWFyY2hvdmVyKGUpIHsKCQlzZWFyY2hidG4uc3R5bGVbIm9wYWNpdHki
XSA9ICIxLjAiOwoJfQoJZnVuY3Rpb24gc2VhcmNob3V0KGUpIHsKCQlpZiAoc2VhcmNoaW5nKSB
7CgkJCXNlYXJjaGJ0bi5zdHlsZVsib3BhY2l0eSJdID0gIjEuMCI7CgkJfSBlbHNlIHsKCQkJc2
VhcmNoYnRuLnN0eWxlWyJvcGFjaXR5Il0gPSAiMC4xIjsKCQl9Cgl9Cl1dPgo8L3NjcmlwdD4KP
HJlY3QgeD0iMC4wIiB5PSIwIiB3aWR0aD0iMjQwMC4wIiBoZWlnaHQ9IjQ5OC4wIiBmaWxsPSJ1
cmwoI2JhY2tncm91bmQpIiAgLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMTIwMC4
wMCIgeT0iMjQiIGZvbnQtc2l6ZT0iMTciIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2
IoMCwwLDApIiAgPkZsYW1lIEdyYXBoPC90ZXh0Pgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxM
C4wMCIgeT0iNDgxIiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0i
cmdiKDAsMCwwKSIgaWQ9ImRldGFpbHMiID4gPC90ZXh0Pgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB
4PSIxMC4wMCIgeT0iMjQiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaW
xsPSJyZ2IoMCwwLDApIiBpZD0idW56b29tIiBvbmNsaWNrPSJ1bnpvb20oKSIgc3R5bGU9Im9wY
WNpdHk6MC4wO2N1cnNvcjpwb2ludGVyIiA+UmVzZXQgWm9vbTwvdGV4dD4KPHRleHQgdGV4dC1h
bmNob3I9IiIgeD0iMjI5MC4wMCIgeT0iMjQiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJ
WZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiBpZD0ic2VhcmNoIiBvbm1vdXNlb3Zlcj0ic2Vhcm
Nob3ZlcigpIiBvbm1vdXNlb3V0PSJzZWFyY2hvdXQoKSIgb25jbGljaz0ic2VhcmNoX3Byb21wd
CgpIiBzdHlsZT0ib3BhY2l0eTowLjE7Y3Vyc29yOnBvaW50ZXIiID5TZWFyY2g8L3RleHQ+Cjx0
ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIyOTAuMDAiIHk9IjQ4MSIgZm9udC1zaXplPSIxMiIgZm9
udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiIGlkPSJtYXRjaGVkIiA+IDwvdG
V4dD4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9I
mMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5saWdodF9jX2Z1bmN0aW9uOmx1YUJf
cGNhbGwgKDI0IHNhbXBsZXMsIDAuMDElKTwvdGl0bGU+PHJlY3QgeD0iMTYwNC45IiB5PSIxOTM
iIHdpZHRoPSIwLjIiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyNCwxOTksNDMpIiByeD0iMi
Igcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MDcuOTEiIHk9IjIwMy41IiBmb
250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48
L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW9
1c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb2
0vbWFwLmx1YToxMjkwICgxNjgsMTA4IHNhbXBsZXMsIDYyLjQ2JSk8L3RpdGxlPjxyZWN0IHg9I
jMwLjQiIHk9IjE5MyIgd2lkdGg9IjE0ODYuNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjU0
LDIwNCw1MikiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMzMuMzc
iIHk9IjIwMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icm
diKDAsMCwwKSIgID5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YToxMjkwPC90ZXh0Pgo8L2c+CjxnI
GNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9u
Y2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL3Jvb20ubHVhOjMyNSA
oMTIwIHNhbXBsZXMsIDAuMDQlKTwvdGl0bGU+PHJlY3QgeD0iMTYwNS4xIiB5PSIxNDUiIHdpZH
RoPSIxLjEiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzMCwxMTAsMTUpIiByeD0iMiIgcnk9I
jIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MDguMTIiIHk9IjE1NS41IiBmb250LXNp
emU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ
+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdX
Q9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb
W92ZV9jdHJsLmx1YTozMDIgKDE1LDA0OCBzYW1wbGVzLCA1LjU5JSk8L3RpdGxlPjxyZWN0IHg9
IjE5NDIuMiIgeT0iMjg5IiB3aWR0aD0iMTMzLjEiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI
xNSw1Myw0KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxOTQ1Lj
I1IiB5PSIyOTkuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9I
nJnYigwLDAsMCkiICA+bHVhbGliL3dhcl9vYmplYy4uPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJm
dW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inp
vb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6MTI1MyAoNjQ4IHNhbX
BsZXMsIDAuMjQlKTwvdGl0bGU+PHJlY3QgeD0iMTk0Mi4yIiB5PSIxOTMiIHdpZHRoPSI1LjgiI
GhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0NywxOTAsMTQpIiByeD0iMiIgcnk9IjIiIC8+Cjx0
ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5NDUuMjUiIHk9IjIwMy41IiBmb250LXNpemU9IjEyIiB
mb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPG
cgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb
25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vcm9vbS5sdWE6MzI1
ICg3Njggc2FtcGxlcywgMC4yOSUpPC90aXRsZT48cmVjdCB4PSIxMC4wIiB5PSIxNjEiIHdpZHR
oPSI2LjgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxMiwxNDUsMzEpIiByeD0iMiIgcnk9Ij
IiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSIxNzEuNSIgZm9udC1zaXplP
SIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8
L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJ
jKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial
9yb2xlLmx1YToxNDMwICg4NjQgc2FtcGxlcywgMC4zMiUpPC90aXRsZT48cmVjdCB4PSIyMi43I
iB5PSIyMjUiIHdpZHRoPSI3LjciIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI1MywxODEsMjAp
IiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjI1LjczIiB5PSIyMzU
uNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMC
kiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpI
iBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dh
cl9yb29tL21hcC5sdWE6MTI5MCAoNzY4IHNhbXBsZXMsIDAuMjklKTwvdGl0bGU+PHJlY3QgeD0
iMTAuMCIgeT0iMTc3IiB3aWR0aD0iNi44IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMTEsNj
ksNTQpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5P
SIxODcuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigw
LDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHR
oaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbG
liL2xvZy5sdWE6NTMgKDQyIHNhbXBsZXMsIDAuMDIlKTwvdGl0bGU+PHJlY3QgeD0iMjA3NS4zI
iB5PSIyNzMiIHdpZHRoPSIwLjQiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0OSwyMjQsMzUp
IiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIwNzguMzIiIHk9IjI
4My41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMC
wwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpc
ykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5jX2Z1bmN0
aW9uOjB4N2Y1NDEwMGU0NzY4ICAgICAgKDg2NCBzYW1wbGVzLCAwLjMyJSk8L3RpdGxlPjxyZWN
0IHg9IjIyLjciIHk9Ijk3IiB3aWR0aD0iNy43IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMT
YsNjksMSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjUuNzMiI
Hk9IjEwNy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdi
KDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InM
odGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5saW
dodF9jX2Z1bmN0aW9uOmx1YUJfcGNhbGwgKDk2IHNhbXBsZXMsIDAuMDQlKTwvdGl0bGU+PHJlY
3QgeD0iMTk0OC4wIiB5PSIxNzciIHdpZHRoPSIwLjgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdi
KDI0NCw2LDQwKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxOTU
wLjk4IiB5PSIxODcuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbG
w9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2Vvd
mVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0
bGU+bHVhbGliL3dhcl9vYmplY3RzL21vdmVfY3RybC5sdWE6NDMxICg3NDQgc2FtcGxlcywgMC4
yOCUpPC90aXRsZT48cmVjdCB4PSIxOTQyLjIiIHk9IjI1NyIgd2lkdGg9IjYuNiIgaGVpZ2h0PS
IxNS4wIiBmaWxsPSJyZ2IoMjA1LDIyMCwzOSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4d
C1hbmNob3I9IiIgeD0iMTk0NS4yNSIgeT0iMjY3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFt
aWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0
iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPS
J6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi9lam95X3RpbWVyLmx1YTo1MyAoMjY5LDE0MiBzY
W1wbGVzLCAxMDAuMDAlKTwvdGl0bGU+PHJlY3QgeD0iMTAuMCIgeT0iMzIxIiB3aWR0aD0iMjM4
MC4wIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMTMsMTQ3LDM4KSIgcng9IjIiIHJ5PSIyIiA
vPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iMzMxLjUiIGZvbnQtc2l6ZT0iMT
IiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi9lam95X
3RpbWVyLmx1YTo1MzwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0i
cyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx
1YWxpYi93YXJfcm9vbS9tYXAubHVhOjEyNTMgKDEsNzI4IHNhbXBsZXMsIDAuNjQlKTwvdGl0bG
U+PHJlY3QgeD0iMjA1NS44IiB5PSIxOTMiIHdpZHRoPSIxNS4zIiBoZWlnaHQ9IjE1LjAiIGZpb
Gw9InJnYigyMjUsODIsNDApIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIi
IHg9IjIwNTguNzkiIHk9IjIwMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGF
uYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb2
5tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzK
SI+Cjx0aXRsZT5jX2Z1bmN0aW9uOjB4N2Y1NDEwMGU0NzY4ICAgICAoOSw5NDggc2FtcGxlcywg
My43MCUpPC90aXRsZT48cmVjdCB4PSIxNTE2LjkiIHk9IjExMyIgd2lkdGg9Ijg4LjAiIGhlaWd
odD0iMTUuMCIgZmlsbD0icmdiKDIxMyw3MSwzNSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdG
V4dC1hbmNob3I9IiIgeD0iMTUxOS45NCIgeT0iMTIzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZ
mFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmNfZnVuY3Rpb24uLjwvdGV4dD4K
PC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0
iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmJ1aWxkL2x1YWxpYi90aW1lci5sdW
E6MTEwICgyNjksMTQyIHNhbXBsZXMsIDEwMC4wMCUpPC90aXRsZT48cmVjdCB4PSIxMC4wIiB5P
SIzNTMiIHdpZHRoPSIyMzgwLjAiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI1MSw5LDIpIiBy
eD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSIzNjMuNSI
gZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiIC
A+YnVpbGQvbHVhbGliL3RpbWVyLmx1YToxMTA8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZ
yIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0
aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vcm9vbS5sdWE6MjU0ICgzNSw1NDQgc2FtcGx
lcywgMTMuMjElKTwvdGl0bGU+PHJlY3QgeD0iMjA3NS43IiB5PSIyODkiIHdpZHRoPSIzMTQuMy
IgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjE3LDIyMiwzNCkiIHJ4PSIyIiByeT0iMiIgLz4KP
HRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjA3OC42OSIgeT0iMjk5LjUiIGZvbnQtc2l6ZT0iMTIi
IGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfcm9
vbS9yb29tLmx1YToyNTQ8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZX
I9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZ
T5sdWFsaWIvd2FyX29iamVjdHMvb2JqX3JvbGUubHVhOjEzODIgKDY3MiBzYW1wbGVzLCAwLjI1
JSk8L3RpdGxlPjxyZWN0IHg9IjE2LjgiIHk9IjI0MSIgd2lkdGg9IjUuOSIgaGVpZ2h0PSIxNS4
wIiBmaWxsPSJyZ2IoMjM2LDIyMCw0OCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbm
Nob3I9IiIgeD0iMTkuNzkiIHk9IjI1MS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iV
mVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNf
ZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh
0aGlzKSI+Cjx0aXRsZT5hbGliL3dhcl9vYmplY3RzL2FpL2FpX25ldXJvbi5sdWE6OTYyICgxMj
Agc2FtcGxlcywgMC4wNCUpPC90aXRsZT48cmVjdCB4PSIxNjA1LjEiIHk9IjI1NyIgd2lkdGg9I
jEuMSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjE3LDc3LDI4KSIgcng9IjIiIHJ5PSIyIiAv
Pgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjA4LjEyIiB5PSIyNjcuNSIgZm9udC1zaXplPSI
xMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2
c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjK
CkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+Y19mdW5jdGlvbjoweDdmNTQxMDBlNDc2
OCAgICAoMzcsNDg4IHNhbXBsZXMsIDEzLjkzJSk8L3RpdGxlPjxyZWN0IHg9IjE2MTAuNyIgeT0
iMzMiIHdpZHRoPSIzMzEuNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjA4LDE2LDQpIiByeD
0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MTMuNzQiIHk9IjQzLjUiI
GZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAg
PmNfZnVuY3Rpb246MHg3ZjU0MTAwZTQ3NjggICA8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmN
fZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbS
h0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YToxNjQ0ICgzLDI4OCBzYW1wb
GVzLCAxLjIyJSk8L3RpdGxlPjxyZWN0IHg9IjIwNzUuNyIgeT0iMjU3IiB3aWR0aD0iMjkuMSIg
aGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjEyLDIwMSw0NikiIHJ4PSIyIiByeT0iMiIgLz4KPHR
leHQgdGV4dC1hbmNob3I9IiIgeD0iMjA3OC42OSIgeT0iMjY3LjUiIGZvbnQtc2l6ZT0iMTIiIG
ZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1Li48L3RleHQ+CjwvZ
z4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMo
KSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vcm9vbS5sdWE
6MzI1ICgxMiwwOTYgc2FtcGxlcywgNC40OSUpPC90aXRsZT48cmVjdCB4PSIxOTQ4LjgiIHk9Ij
E0NSIgd2lkdGg9IjEwNy4wIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzcsOTYsNDYpIiBye
D0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5NTEuODMiIHk9IjE1NS41
IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSI
gID5sdWFsaWIvd2FyX3JvLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW
92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0a
XRsZT5sdWFsaWIvbG9nZ2VyLmx1YTozMDcgKDQyIHNhbXBsZXMsIDAuMDIlKTwvdGl0bGU+PHJl
Y3QgeD0iMjA3NS4zIiB5PSIyMjUiIHdpZHRoPSIwLjQiIGhlaWdodD0iMTUuMCIgZmlsbD0icmd
iKDI0MCwxLDIwKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMD
c4LjMyIiB5PSIyMzUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpb
Gw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2Vv
dmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl
0bGU+c2t5bmV0L2x1YWxpYi9za3luZXQubHVhOjM0NCAoMywyODggc2FtcGxlcywgMS4yMiUpPC
90aXRsZT48cmVjdCB4PSIyMDc1LjciIHk9IjE5MyIgd2lkdGg9IjI5LjEiIGhlaWdodD0iMTUuM
CIgZmlsbD0icmdiKDIxNywyMTMsMzgpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5j
aG9yPSIiIHg9IjIwNzguNjkiIHk9IjIwMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0
iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5zay4uPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPS
JmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9I
npvb20odGhpcykiPgo8dGl0bGU+YWxpYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb24ubHVhOjE4
MjIgKDc2OCBzYW1wbGVzLCAwLjI5JSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjI1NyIgd2l
kdGg9IjYuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjI4LDY0LDQpIiByeD0iMiIgcnk9Ij
IiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSIyNjcuNSIgZm9udC1zaXplP
SIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8
L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJ
jKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+YWxpYi93YXJfb2JqZWN0cy9haS9haV
9uZXVyb24ubHVhOjE3ODcgKDEsNDQwIHNhbXBsZXMsIDAuNTQlKTwvdGl0bGU+PHJlY3QgeD0iM
TAuMCIgeT0iMjczIiB3aWR0aD0iMTIuNyIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjMzLDQz
LDM2KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0
iMjgzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMC
wwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0a
GlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmNfZnVu
Y3Rpb246MHg3ZjU0MTAwZTQ3NjggICAgICAgKDk2IHNhbXBsZXMsIDAuMDQlKTwvdGl0bGU+PHJ
lY3QgeD0iMTk0OC4wIiB5PSI5NyIgd2lkdGg9IjAuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2
IoMjM5LDY5LDM3KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxO
TUwLjk4IiB5PSIxMDcuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZp
bGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2V
vdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dG
l0bGU+c2t5bmV0L2x1YWxpYi9za3luZXQubHVhOjM0NCAoMSw3Mjggc2FtcGxlcywgMC42NCUpP
C90aXRsZT48cmVjdCB4PSIyMDU1LjgiIHk9IjEyOSIgd2lkdGg9IjE1LjMiIGhlaWdodD0iMTUu
MCIgZmlsbD0icmdiKDIxNCwyMDgsMTgpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5
jaG9yPSIiIHg9IjIwNTguNzkiIHk9IjEzOS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT
0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1b
mNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9v
bSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YTo4MDUgKDIsNjQwIHNhbXB
sZXMsIDAuOTglKTwvdGl0bGU+PHJlY3QgeD0iMjEwNC44IiB5PSIyNDEiIHdpZHRoPSIyMy4zIi
BoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjUsNjksNSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRle
HQgdGV4dC1hbmNob3I9IiIgeD0iMjEwNy43NiIgeT0iMjUxLjUiIGZvbnQtc2l6ZT0iMTIiIGZv
bnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmwuLjwvdGV4dD4KPC9nPgo
8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIi
BvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNlcnZpY2Uvc2NlbmUvc2NlbmVfYmFzZS5sd
WE6ODIgKDUxNiBzYW1wbGVzLCAwLjE5JSk8L3RpdGxlPjxyZWN0IHg9IjE2MDYuMiIgeT0iMTYx
IiB3aWR0aD0iNC41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMDUsMTQxLDcpIiByeD0iMiI
gcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MDkuMTgiIHk9IjE3MS41IiBmb2
50LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L
3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91
c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5za3luZXQvbHVhbGliL3N
reW5ldC5sdWE6MzQ0ICgxMiwwOTYgc2FtcGxlcywgNC40OSUpPC90aXRsZT48cmVjdCB4PSIxOT
Q4LjgiIHk9IjExMyIgd2lkdGg9IjEwNy4wIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNDgsM
TksMTMpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5NTEuODMi
IHk9IjEyMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmd
iKDAsMCwwKSIgID5za3luZXQvbHVhbGliLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZy
Igb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0a
GlzKSI+Cjx0aXRsZT5jX2Z1bmN0aW9uOjB4N2Y1NDEwMGU0NzY4ICAgICAgICg0MiBzYW1wbGVz
LCAwLjAyJSk8L3RpdGxlPjxyZWN0IHg9IjIwNzUuMyIgeT0iMTc3IiB3aWR0aD0iMC40IiBoZWl
naHQ9IjE1LjAiIGZpbGw9InJnYigyMjYsMTYzLDI4KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dC
B0ZXh0LWFuY2hvcj0iIiB4PSIyMDc4LjMyIiB5PSIxODcuNSIgZm9udC1zaXplPSIxMiIgZm9ud
C1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNs
YXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2x
pY2s9Inpvb20odGhpcykiPgo8dGl0bGU+c2t5bmV0L2x1YWxpYi9za3luZXQubHVhOjM0NCAoOS
w5NDggc2FtcGxlcywgMy43MCUpPC90aXRsZT48cmVjdCB4PSIxNTE2LjkiIHk9IjEyOSIgd2lkd
Gg9Ijg4LjAiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyOCw3OSw0NykiIHJ4PSIyIiByeT0i
MiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTUxOS45NCIgeT0iMTM5LjUiIGZvbnQtc2l
6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPnNreW5ldC
9sdWEuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzK
SIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93
YXJfb2JqZWN0cy9vYmpfYmFzZS5sdWE6MjM1ICg5LDk0OCBzYW1wbGVzLCAzLjcwJSk8L3RpdGx
lPjxyZWN0IHg9IjE1MTYuOSIgeT0iMTkzIiB3aWR0aD0iODguMCIgaGVpZ2h0PSIxNS4wIiBmaW
xsPSJyZ2IoMjM3LDE4Miw0OSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9I
iIgeD0iMTUxOS45NCIgeT0iMjAzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJk
YW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXIuLjwvdGV4dD4KPC9nPgo8ZyBjbGF
zcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaW
NrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS9yb29tLmx1YTozMjUgKDE2O
CwxMDggc2FtcGxlcywgNjIuNDYlKTwvdGl0bGU+PHJlY3QgeD0iMzAuNCIgeT0iMTc3IiB3aWR0
aD0iMTQ4Ni41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNDcsMCw0NSkiIHJ4PSIyIiByeT0
iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMzMuMzciIHk9IjE4Ny41IiBmb250LXNpem
U9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIvd
2FyX3Jvb20vcm9vbS5sdWE6MzI1PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91
c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo
8dGl0bGU+bHVhbGliL2xvZ2dlci5sdWE6MzY5ICg0MiBzYW1wbGVzLCAwLjAyJSk8L3RpdGxlPj
xyZWN0IHg9IjIwNzUuMyIgeT0iMjU3IiB3aWR0aD0iMC40IiBoZWlnaHQ9IjE1LjAiIGZpbGw9I
nJnYigyMzYsMzgsMTkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9
IjIwNzguMzIiIHk9IjI2Ny41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSI
gZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3
VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+C
jx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vcm9vbS5sdWE6MzI1ICgxLDcyOCBzYW1wbGVzLCAwLjY0
JSk8L3RpdGxlPjxyZWN0IHg9IjIwNTUuOCIgeT0iMTYxIiB3aWR0aD0iMTUuMyIgaGVpZ2h0PSI
xNS4wIiBmaWxsPSJyZ2IoMjE2LDE4MSwwKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LW
FuY2hvcj0iIiB4PSIyMDU4Ljc5IiB5PSIxNzEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pb
Hk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJm
dW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inp
vb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial9yb2xlLmx1YToxNDE4IC
gxMjAgc2FtcGxlcywgMC4wNCUpPC90aXRsZT48cmVjdCB4PSIxNjA1LjEiIHk9IjI0MSIgd2lkd
Gg9IjEuMSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjUyLDE5LDM2KSIgcng9IjIiIHJ5PSIy
IiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjA4LjEyIiB5PSIyNTEuNSIgZm9udC1zaXp
lPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pg
o8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0P
SJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29i
al9iYXNlLmx1YToyMzUgKDM3LDQ4OCBzYW1wbGVzLCAxMy45MyUpPC90aXRsZT48cmVjdCB4PSI
xNjEwLjciIHk9IjExMyIgd2lkdGg9IjMzMS41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMT
IsMTk0LDI2KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjEzL
jc0IiB5PSIxMjMuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9
InJnYigwLDAsMCkiICA+bHVhbGliL3dhcl9vYmplY3RzL29ial9iYXNlLmx1YToyMzU8L3RleHQ
+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdX
Q9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvZWpveV90aW1lci5sd
WE6NDggKDI2OSwxNDIgc2FtcGxlcywgMTAwLjAwJSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9
IjM2OSIgd2lkdGg9IjIzODAuMCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjE0LDk5LDExKSI
gcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iMzc5Lj
UiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApI
iAgPmx1YWxpYi9lam95X3RpbWVyLmx1YTo0ODwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19n
IiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHR
oaXMpIj4KPHRpdGxlPmxpZ2h0X2NfZnVuY3Rpb246bHVhQl9wY2FsbCAoMjY5LDE0MiBzYW1wbG
VzLCAxMDAuMDAlKTwvdGl0bGU+PHJlY3QgeD0iMTAuMCIgeT0iMzg1IiB3aWR0aD0iMjM4MC4wI
iBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNDgsMjExLDQ2KSIgcng9IjIiIHJ5PSIyIiAvPgo8
dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iMzk1LjUiIGZvbnQtc2l6ZT0iMTIiIGZ
vbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmxpZ2h0X2NfZnVuY3Rpb2
46bHVhQl9wY2FsbDwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0ic
yh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmNf
ZnVuY3Rpb246MHg3ZjU0MTAwZTQ3NjggICAgICgxLDcyOCBzYW1wbGVzLCAwLjY0JSk8L3RpdGx
lPjxyZWN0IHg9IjIwNTUuOCIgeT0iMTEzIiB3aWR0aD0iMTUuMyIgaGVpZ2h0PSIxNS4wIiBmaW
xsPSJyZ2IoMjA2LDE2MywxMykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9I
iIgeD0iMjA1OC43OSIgeT0iMTIzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJk
YW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiB
vbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaX
MpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS9tYXAubHVhOjExNTggKDI0IHNhbXBsZXMsIDAuM
DElKTwvdGl0bGU+PHJlY3QgeD0iMTYwNC45IiB5PSIyMjUiIHdpZHRoPSIwLjIiIGhlaWdodD0i
MTUuMCIgZmlsbD0icmdiKDIxOCwyMTQsNDApIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQ
tYW5jaG9yPSIiIHg9IjE2MDcuOTEiIHk9IjIzNS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbW
lseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9I
mZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0i
em9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX3JvbGUubHVhOjE1Mzc
gKDUxNiBzYW1wbGVzLCAwLjE5JSk8L3RpdGxlPjxyZWN0IHg9IjE2MDYuMiIgeT0iMjQxIiB3aW
R0aD0iNC41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzQsNDgsNDMpIiByeD0iMiIgcnk9I
jIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MDkuMTgiIHk9IjI1MS41IiBmb250LXNp
emU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ
+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdX
Q9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWFwL
mx1YToxODUxICg1LDkyOCBzYW1wbGVzLCAyLjIwJSk8L3RpdGxlPjxyZWN0IHg9IjIwNzUuNyIg
eT0iMjczIiB3aWR0aD0iNTIuNCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ4LDExMCw0Myk
iIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjA3OC42OSIgeT0iMj
gzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwL
DApIiAgPmx1YWxpLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9
InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5
jX2Z1bmN0aW9uOjB4N2Y1NDEwMGU0NzY4ICAgICAgICgyNCBzYW1wbGVzLCAwLjAxJSk8L3RpdG
xlPjxyZWN0IHg9IjE2MDQuOSIgeT0iMTEzIiB3aWR0aD0iMC4yIiBoZWlnaHQ9IjE1LjAiIGZpb
Gw9InJnYigyMDUsODksNDkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIi
IHg9IjE2MDcuOTEiIHk9IjEyMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGF
uYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb2
5tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzK
SI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvbW92ZV9jdHJsLmx1YTo0MzMgKDEyLDA5NiBz
YW1wbGVzLCA0LjQ5JSk8L3RpdGxlPjxyZWN0IHg9IjE5NDguOCIgeT0iMjU3IiB3aWR0aD0iMTA
3LjAiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzOSwxNzcsMTkpIiByeD0iMiIgcnk9IjIiIC
8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5NTEuODMiIHk9IjI2Ny41IiBmb250LXNpemU9I
jEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIvd2Fy
X29iLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcyk
iIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZXJ2aWNlL3
NjZW5lL3NjZW5lX2Jhc2UubHVhOjgyICg5NiBzYW1wbGVzLCAwLjA0JSk8L3RpdGxlPjxyZWN0I
Hg9IjE5NDguMCIgeT0iMTI5IiB3aWR0aD0iMC44IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigy
NDksMTc0LDQzKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxOTU
wLjk4IiB5PSIxMzkuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbG
w9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2Vvd
mVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0
bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6MTI5MCAoMTIsMDk2IHNhbXBsZXMsIDQuNDklKTw
vdGl0bGU+PHJlY3QgeD0iMTk0OC44IiB5PSIxNjEiIHdpZHRoPSIxMDcuMCIgaGVpZ2h0PSIxNS
4wIiBmaWxsPSJyZ2IoMjQ5LDEzNywxMykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hb
mNob3I9IiIgeD0iMTk1MS44MyIgeT0iMTcxLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5
PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfcm8uLjwvdGV4dD4KPC9
nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYy
gpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1Y
TozNDQgKDc2OCBzYW1wbGVzLCAwLjI5JSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjEyOSIg
d2lkdGg9IjYuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQwLDE2MiwzNSkiIHJ4PSIyIiB
yeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjEzOS41IiBmb250LX
NpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3Rle
HQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2Vv
dXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWF
wLmx1YToxMTU4ICg0MzIgc2FtcGxlcywgMC4xNiUpPC90aXRsZT48cmVjdCB4PSIyMDcxLjEiIH
k9IjIwOSIgd2lkdGg9IjMuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjU0LDEwMywzNykiI
HJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjA3NC4wNyIgeT0iMjE5
LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDA
pIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKS
Igb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93Y
XJfcm9vbS9tYXAubHVhOjEyMzcgKDQ4IHNhbXBsZXMsIDAuMDIlKTwvdGl0bGU+PHJlY3QgeD0i
MjA3NC45IiB5PSIyMDkiIHdpZHRoPSIwLjQiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzMyw
xOTYsNTQpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIwNzcuOD
kiIHk9IjIxOS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0ic
mdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9
InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5
sdWFsaWIvd2FyX29iamVjdHMvb2JqX3JvbGUubHVhOjEzNTggKDE2OCwxMDggc2FtcGxlcywgNj
IuNDYlKTwvdGl0bGU+PHJlY3QgeD0iMzAuNCIgeT0iMjU3IiB3aWR0aD0iMTQ4Ni41IiBoZWlna
HQ9IjE1LjAiIGZpbGw9InJnYigyMDksMTc3LDEzKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0
ZXh0LWFuY2hvcj0iIiB4PSIzMy4zNyIgeT0iMjY3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmF
taWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfb2JqZWN0cy9vYm
pfcm9sZS5sdWE6MTM1ODwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlc
j0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxl
Pmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfYmFzZS5sdWE6MTAyICgyLDE2MCBzYW1wbGVzLCAwLjg
wJSk8L3RpdGxlPjxyZWN0IHg9IjIwNTUuOCIgeT0iMjI1IiB3aWR0aD0iMTkuMSIgaGVpZ2h0PS
IxNS4wIiBmaWxsPSJyZ2IoMjA4LDE1MCwxMikiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4d
C1hbmNob3I9IiIgeD0iMjA1OC43OSIgeT0iMjM1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFt
aWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0
iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPS
J6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfYmFzZS5sdWE6MjM1I
Cg4NjQgc2FtcGxlcywgMC4zMiUpPC90aXRsZT48cmVjdCB4PSIyMi43IiB5PSIxNzciIHdpZHRo
PSI3LjciIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyOCwxODIsMzMpIiByeD0iMiIgcnk9IjI
iIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjI1LjczIiB5PSIxODcuNSIgZm9udC1zaXplPS
IxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L
2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJj
KCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+Y19mdW5jdGlvbjoweDdmNTQxMDBlNDc
2OCAgICAgKDMsMjg4IHNhbXBsZXMsIDEuMjIlKTwvdGl0bGU+PHJlY3QgeD0iMjA3NS43IiB5PS
IxNzciIHdpZHRoPSIyOS4xIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjIsMTQ4LDMwKSIgc
ng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDc4LjY5IiB5PSIxODcu
NSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCk
iICA+Y18uLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aG
lzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNreW5ld
C9sdWFsaWIvc2t5bmV0Lmx1YTozNDQgKDQzMiBzYW1wbGVzLCAwLjE2JSk8L3RpdGxlPjxyZWN0
IHg9IjIwNzEuMSIgeT0iMTEzIiB3aWR0aD0iMy44IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYig
yNDYsMzYsMjkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIwNz
QuMDciIHk9IjEyMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsb
D0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92
ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXR
sZT5jX2Z1bmN0aW9uOjB4N2Y1NDEwMGU0NzY4ICAgICgxMiwwOTYgc2FtcGxlcywgNC40OSUpPC
90aXRsZT48cmVjdCB4PSIxOTQ4LjgiIHk9Ijk3IiB3aWR0aD0iMTA3LjAiIGhlaWdodD0iMTUuM
CIgZmlsbD0icmdiKDIyNiwxOTUsNTEpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5j
aG9yPSIiIHg9IjE5NTEuODMiIHk9IjEwNy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0
iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5jX2Z1bmN0aW9uOjB4Li48L3RleHQ+CjwvZz
4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoK
SIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX3Jv
bGUubHVhOjE1NTQgKDc2OCBzYW1wbGVzLCAwLjI5JSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk
9IjI0MSIgd2lkdGg9IjYuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjIyLDE3NCw0MSkiIH
J4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjI1MS41I
iBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIg
ID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9
ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5hbGliL3dhcl9vYm
plY3RzL2FpL2FpX25ldXJvbi5sdWE6MTA5OCAoMzcsNDg4IHNhbXBsZXMsIDEzLjkzJSk8L3Rpd
GxlPjxyZWN0IHg9IjE2MTAuNyIgeT0iMjQxIiB3aWR0aD0iMzMxLjUiIGhlaWdodD0iMTUuMCIg
ZmlsbD0icmdiKDIzNyw1NSwzNCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I
9IiIgeD0iMTYxMy43NCIgeT0iMjUxLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZX
JkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmFsaWIvd2FyX29iamVjdHMvYWkvYWlfbmV1cm9uL
mx1YToxMDk4PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRo
aXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGl
iL2xvZ2dlci5sdWE6MzIyICg0MiBzYW1wbGVzLCAwLjAyJSk8L3RpdGxlPjxyZWN0IHg9IjIwNz
UuMyIgeT0iMjQxIiB3aWR0aD0iMC40IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMTMsMTQxL
DI5KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDc4LjMyIiB5
PSIyNTEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYig
wLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKH
RoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+Y19md
W5jdGlvbjoweDdmNTQxMDBlNDc2OCAgICgxNjgsMTA4IHNhbXBsZXMsIDYyLjQ2JSk8L3RpdGxl
PjxyZWN0IHg9IjMwLjQiIHk9IjEyOSIgd2lkdGg9IjE0ODYuNSIgaGVpZ2h0PSIxNS4wIiBmaWx
sPSJyZ2IoMjE5LDk4LDQxKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIi
B4PSIzMy4zNyIgeT0iMTM5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hI
iBmaWxsPSJyZ2IoMCwwLDApIiAgPmNfZnVuY3Rpb246MHg3ZjU0MTAwZTQ3NjggIDwvdGV4dD4K
PC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0
iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNreW5ldC9sdWFsaWIvc2t5bmV0Lm
x1YTozNDQgKDQ4IHNhbXBsZXMsIDAuMDIlKTwvdGl0bGU+PHJlY3QgeD0iMjA3NC45IiB5PSIxM
jkiIHdpZHRoPSIwLjQiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyOSw3OSwxNykiIHJ4PSIy
IiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjA3Ny44OSIgeT0iMTM5LjUiIGZ
vbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPj
wvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb
3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9v
bS9tYXAubHVhOjgwNSAoNDggc2FtcGxlcywgMC4wMiUpPC90aXRsZT48cmVjdCB4PSIyMDc0Ljk
iIHk9IjE3NyIgd2lkdGg9IjAuNCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQzLDkxLDEyKS
Igcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDc3Ljg5IiB5PSIxO
DcuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAs
MCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXM
pIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3
dhcl9yb29tL21hcC5sdWE6MTE1NCAoNjQ4IHNhbXBsZXMsIDAuMjQlKTwvdGl0bGU+PHJlY3Qge
D0iMTk0Mi4yIiB5PSIyMDkiIHdpZHRoPSI1LjgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0
MiwzMywzMikiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTk0NS4
yNSIgeT0iMjE5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPS
JyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlc
j0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxl
PnNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1YTozNDQgKDg2NCBzYW1wbGVzLCAwLjMyJSk8L3RpdGx
lPjxyZWN0IHg9IjIyLjciIHk9IjExMyIgd2lkdGg9IjcuNyIgaGVpZ2h0PSIxNS4wIiBmaWxsPS
JyZ2IoMjEwLDEyNCwzOSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIge
D0iMjUuNzMiIHk9IjEyMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIg
ZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3V
zZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cj
x0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YToxODU2ICgyOSw2MTYgc2FtcGxlcywgMTEuM
DAlKTwvdGl0bGU+PHJlY3QgeD0iMjEyOC4xIiB5PSIyNzMiIHdpZHRoPSIyNjEuOSIgaGVpZ2h0
PSIxNS4wIiBmaWxsPSJyZ2IoMjI5LDIwOSw1MSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV
4dC1hbmNob3I9IiIgeD0iMjEzMS4xMSIgeT0iMjgzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZm
FtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfcm9vbS9tYXAub
HVhOjE4NTY8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhp
cykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZXJ2aWN
lL3NjZW5lL3NjZW5lX2Jhc2UubHVhOjgyICg2NDggc2FtcGxlcywgMC4yNCUpPC90aXRsZT48cm
VjdCB4PSIxOTQyLjIiIHk9IjE0NSIgd2lkdGg9IjUuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ
2IoMjM5LDk2LDM0KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIx
OTQ1LjI1IiB5PSIxNTUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZ
pbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2
VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8d
Gl0bGU+c2VydmljZS9zY2VuZS9zY2VuZV9iYXNlLmx1YTo4MiAoODY0IHNhbXBsZXMsIDAuMzIl
KTwvdGl0bGU+PHJlY3QgeD0iMjIuNyIgeT0iMTI5IiB3aWR0aD0iNy43IiBoZWlnaHQ9IjE1LjA
iIGZpbGw9InJnYigyMjQsOCwzOSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3
I9IiIgeD0iMjUuNzMiIHk9IjEzOS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZ
GFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIg
b25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGl
zKSI+Cjx0aXRsZT5zZXJ2aWNlL3NjZW5lL3NjZW5lX2Jhc2UubHVhOjgyICg2NzIgc2FtcGxlcy
wgMC4yNSUpPC90aXRsZT48cmVjdCB4PSIxNi44IiB5PSIxNDUiIHdpZHRoPSI1LjkiIGhlaWdod
D0iMTUuMCIgZmlsbD0icmdiKDIxMSwxNTEsMjkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRl
eHQtYW5jaG9yPSIiIHg9IjE5Ljc5IiB5PSIxNTUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1
pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPS
JmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9I
npvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6MTUxNyAoMjksNjE2
IHNhbXBsZXMsIDExLjAwJSk8L3RpdGxlPjxyZWN0IHg9IjIxMjguMSIgeT0iMjU3IiB3aWR0aD0
iMjYxLjkiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxNCwyMjAsMTMpIiByeD0iMiIgcnk9Ij
IiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIxMzEuMTEiIHk9IjI2Ny41IiBmb250LXNpe
mU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIv
d2FyX3Jvb20vbWFwLmx1YToxNTE3PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW9
1c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPg
o8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial9yb2xlLmx1YToxMzIxICg1MTYgc2FtcGxlc
ywgMC4xOSUpPC90aXRsZT48cmVjdCB4PSIxNjA2LjIiIHk9IjIyNSIgd2lkdGg9IjQuNSIgaGVp
Z2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQyLDEyOSw1KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB
0ZXh0LWFuY2hvcj0iIiB4PSIxNjA5LjE4IiB5PSIyMzUuNSIgZm9udC1zaXplPSIxMiIgZm9udC
1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsY
XNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xp
Y2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial9yb2xlLmx1YTo
xMzIxICg4NjQgc2FtcGxlcywgMC4zMiUpPC90aXRsZT48cmVjdCB4PSIyMi43IiB5PSIxOTMiIH
dpZHRoPSI3LjciIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzMSwzNCw0OSkiIHJ4PSIyIiBye
T0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjUuNzMiIHk9IjIwMy41IiBmb250LXNp
emU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ
+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdX
Q9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZXJ2aWNlL3NjZW5lL3NjZW5lX
2Jhc2UubHVhOjgyICg0MzIgc2FtcGxlcywgMC4xNiUpPC90aXRsZT48cmVjdCB4PSIyMDcxLjEi
IHk9IjEyOSIgd2lkdGg9IjMuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ0LDE1NCwyOCk
iIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjA3NC4wNyIgeT0iMT
M5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwL
DApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlz
KSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNreW5ldC9
sdWFsaWIvc2t5bmV0Lmx1YTozNDQgKDEyMCBzYW1wbGVzLCAwLjA0JSk8L3RpdGxlPjxyZWN0IH
g9IjE2MDUuMSIgeT0iMTEzIiB3aWR0aD0iMS4xIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyM
TcsMTAyLDU0KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjA4
LjEyIiB5PSIxMjMuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw
9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2Vvdm
VyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0b
GU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6MTIzNyAoNDMyIHNhbXBsZXMsIDAuMTYlKTwvdGl0
bGU+PHJlY3QgeD0iMjA3MS4xIiB5PSIxOTMiIHdpZHRoPSIzLjgiIGhlaWdodD0iMTUuMCIgZml
sbD0icmdiKDI1Myw0Miw1KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIi
B4PSIyMDc0LjA3IiB5PSIyMDMuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhb
mEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9u
bW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcyk
iPgo8dGl0bGU+c2VydmljZS9zY2VuZS9zY2VuZV9iYXNlLmx1YTo4MiAoMjQgc2FtcGxlcywgMC
4wMSUpPC90aXRsZT48cmVjdCB4PSIxNjA0LjkiIHk9IjE0NSIgd2lkdGg9IjAuMiIgaGVpZ2h0P
SIxNS4wIiBmaWxsPSJyZ2IoMjM4LDE2NywxOSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4
dC1hbmNob3I9IiIgeD0iMTYwNy45MSIgeT0iMTU1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmF
taWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz
0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrP
SJ6b29tKHRoaXMpIj4KPHRpdGxlPmNfZnVuY3Rpb246MHg3ZjU0MTAwZTQ3NjggICAgICAoNjQ4
IHNhbXBsZXMsIDAuMjQlKTwvdGl0bGU+PHJlY3QgeD0iMTk0Mi4yIiB5PSIxMTMiIHdpZHRoPSI
1LjgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0NiwxOCwzOCkiIHJ4PSIyIiByeT0iMiIgLz
4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTk0NS4yNSIgeT0iMTIzLjUiIGZvbnQtc2l6ZT0iM
TIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9n
Pgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYyg
pIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNlcnZpY2Uvc2NlbmUvc2NlbmVfYmFzZS
5sdWE6ODIgKDI5LDYxNiBzYW1wbGVzLCAxMS4wMCUpPC90aXRsZT48cmVjdCB4PSIyMTI4LjEiI
Hk9IjIyNSIgd2lkdGg9IjI2MS45IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMDgsMjIwLDE5
KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMTMxLjExIiB5PSI
yMzUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLD
AsMCkiICA+c2VydmljZS9zY2VuZS9zY2VuZV9iYXNlLmx1YTo4MjwvdGV4dD4KPC9nPgo8ZyBjb
GFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNs
aWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS9yb29tLmx1YTozMjUgKDM
3LDQ4OCBzYW1wbGVzLCAxMy45MyUpPC90aXRsZT48cmVjdCB4PSIxNjEwLjciIHk9IjgxIiB3aW
R0aD0iMzMxLjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0NywyMjgsNDgpIiByeD0iMiIgc
nk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MTMuNzQiIHk9IjkxLjUiIGZvbnQt
c2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWx
pYi93YXJfcm9vbS9yb29tLmx1YTozMjU8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb2
5tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzK
SI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX2Jhc2UubHVhOjEwMiAoMjQgc2FtcGxl
cywgMC4wMSUpPC90aXRsZT48cmVjdCB4PSIxNjA0LjkiIHk9IjI0MSIgd2lkdGg9IjAuMiIgaGV
pZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ1LDEyOCw1MykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleH
QgdGV4dC1hbmNob3I9IiIgeD0iMTYwNy45MSIgeT0iMjUxLjUiIGZvbnQtc2l6ZT0iMTIiIGZvb
nQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBj
bGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmN
saWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdW
E6MTQ5NiAoOSw5NDggc2FtcGxlcywgMy43MCUpPC90aXRsZT48cmVjdCB4PSIxNTE2LjkiIHk9I
jIyNSIgd2lkdGg9Ijg4LjAiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyOSwxNjQsMTMpIiBy
eD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE1MTkuOTQiIHk9IjIzNS4
1IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKS
IgID5sdWFsaWIvd2FyLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92Z
XI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRs
ZT5hbGwgKDI2OSwxNDIgc2FtcGxlcywgMTAwJSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjQ
0OSIgd2lkdGg9IjIzODAuMCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjIyLDgzLDUxKSIgcn
g9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iNDU5LjUiI
GZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAg
PjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25
tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2
JqZWN0cy9vYmpfcm9sZS5sdWE6MTMyMSAoMTIwIHNhbXBsZXMsIDAuMDQlKTwvdGl0bGU+PHJlY
3QgeD0iMTYwNS4xIiB5PSIxOTMiIHdpZHRoPSIxLjEiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdi
KDIzNSwyMDUsMjEpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE
2MDguMTIiIHk9IjIwMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm
lsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZ
W92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0
aXRsZT5jX2Z1bmN0aW9uOjB4N2Y1NDEwMGU0NzY4ICAgICAgKDQzMiBzYW1wbGVzLCAwLjE2JSk
8L3RpdGxlPjxyZWN0IHg9IjIwNzEuMSIgeT0iOTciIHdpZHRoPSIzLjgiIGhlaWdodD0iMTUuMC
IgZmlsbD0icmdiKDI1MCw3NCwyOCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob
3I9IiIgeD0iMjA3NC4wNyIgeT0iMTA3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJW
ZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19
nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKH
RoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTMyMSAoMzcsN
Dg4IHNhbXBsZXMsIDEzLjkzJSk8L3RpdGxlPjxyZWN0IHg9IjE2MTAuNyIgeT0iMTI5IiB3aWR0
aD0iMzMxLjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0MCw3Miw0NCkiIHJ4PSIyIiByeT0
iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTYxMy43NCIgeT0iMTM5LjUiIGZvbnQtc2
l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpY
i93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTMyMTwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVu
Y19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29
tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfYmFzZS5sdWE6MjM1ICg1MT
Ygc2FtcGxlcywgMC4xOSUpPC90aXRsZT48cmVjdCB4PSIxNjA2LjIiIHk9IjIwOSIgd2lkdGg9I
jQuNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjMyLDIwOSw0NCkiIHJ4PSIyIiByeT0iMiIg
Lz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTYwOS4xOCIgeT0iMjE5LjUiIGZvbnQtc2l6ZT0
iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC
9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iY
ygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpf
cm9sZS5sdWE6MTMyMSAoMTY4LDEwOCBzYW1wbGVzLCA2Mi40NiUpPC90aXRsZT48cmVjdCB4PSI
zMC40IiB5PSIyMjUiIHdpZHRoPSIxNDg2LjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyMS
wxMjIsMTYpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjMzLjM3I
iB5PSIyMzUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJn
YigwLDAsMCkiICA+bHVhbGliL3dhcl9vYmplY3RzL29ial9yb2xlLmx1YToxMzIxPC90ZXh0Pgo
8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PS
JjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bGlnaHRfY19mdW5jdGlvbjpsdWFCX
3hwY2FsbCAoMjY5LDE0MiBzYW1wbGVzLCAxMDAuMDAlKTwvdGl0bGU+PHJlY3QgeD0iMTAuMCIg
eT0iMzM3IiB3aWR0aD0iMjM4MC4wIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjMsMTg2LDg
pIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSIzND
cuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsM
CkiICA+bGlnaHRfY19mdW5jdGlvbjpsdWFCX3hwY2FsbDwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0i
ZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ
6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS9tYXAubHVhOjEyOTAgKDY3MiBzYW
1wbGVzLCAwLjI1JSk8L3RpdGxlPjxyZWN0IHg9IjE2LjgiIHk9IjE3NyIgd2lkdGg9IjUuOSIga
GVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ2LDEzNSw4KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4
dCB0ZXh0LWFuY2hvcj0iIiB4PSIxOS43OSIgeT0iMTg3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQ
tZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbG
Fzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsa
WNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi9sb2dnZXIubHVhOjg3ICg0MiBzYW1wbGVz
LCAwLjAyJSk8L3RpdGxlPjxyZWN0IHg9IjIwNzUuMyIgeT0iMjA5IiB3aWR0aD0iMC40IiBoZWl
naHQ9IjE1LjAiIGZpbGw9InJnYigyMzksOSwzNSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdG
V4dC1hbmNob3I9IiIgeD0iMjA3OC4zMiIgeT0iMjE5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZ
mFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFz
cz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWN
rPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS9yb29tLmx1YTozMjUgKDk2IH
NhbXBsZXMsIDAuMDQlKTwvdGl0bGU+PHJlY3QgeD0iMTk0OC4wIiB5PSIxNDUiIHdpZHRoPSIwL
jgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxOSw2MSwyNCkiIHJ4PSIyIiByeT0iMiIgLz4K
PHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTk1MC45OCIgeT0iMTU1LjUiIGZvbnQtc2l6ZT0iMTI
iIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPg
o8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpI
iBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS90aW1lcl9tZ3Iu
bHVhOjI4ICgyNjksMTQyIHNhbXBsZXMsIDEwMC4wMCUpPC90aXRsZT48cmVjdCB4PSIxMC4wIiB
5PSIzMDUiIHdpZHRoPSIyMzgwLjAiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxNiw3NSwyNS
kiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjMxN
S41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCww
KSIgID5sdWFsaWIvd2FyX3Jvb20vdGltZXJfbWdyLmx1YToyODwvdGV4dD4KPC9nPgo8ZyBjbGF
zcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaW
NrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmFsaWIvd2FyX29iamVjdHMvYWkvYWlfbmV1cm9uLmx1Y
To0MzggKDg2NCBzYW1wbGVzLCAwLjMyJSk8L3RpdGxlPjxyZWN0IHg9IjIyLjciIHk9IjI1NyIg
d2lkdGg9IjcuNyIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjMwLDExLDMpIiByeD0iMiIgcnk
9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjI1LjczIiB5PSIyNjcuNSIgZm9udC1zaX
plPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0P
go8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0
PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+YWxpYi93YXJfb2JqZWN0cy9haS9
haV9uZXVyb24ubHVhOjU0NCAoOSw5NDggc2FtcGxlcywgMy43MCUpPC90aXRsZT48cmVjdCB4PS
IxNTE2LjkiIHk9IjI3MyIgd2lkdGg9Ijg4LjAiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0N
Sw0OCw1NCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTUxOS45
NCIgeT0iMjgzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJ
yZ2IoMCwwLDApIiAgPmFsaWIvd2FyX28uLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIi
Bvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoa
XMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9tb3ZlX2N0cmwubHVhOjQwMyAoMiwyMDgg
c2FtcGxlcywgMC44MiUpPC90aXRsZT48cmVjdCB4PSIyMDU1LjgiIHk9IjI3MyIgd2lkdGg9IjE
5LjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI1Miw1NSwzNCkiIHJ4PSIyIiByeT0iMiIgLz
4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjA1OC43OSIgeT0iMjgzLjUiIGZvbnQtc2l6ZT0iM
TIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9n
Pgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYyg
pIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS9yb29tLmx1YT
oyNDQgKDQyIHNhbXBsZXMsIDAuMDIlKTwvdGl0bGU+PHJlY3QgeD0iMjA3NS4zIiB5PSIyODkiI
HdpZHRoPSIwLjQiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzOCwxOCw4KSIgcng9IjIiIHJ5
PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDc4LjMyIiB5PSIyOTkuNSIgZm9udC1
zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZX
h0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb
3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21h
cC5sdWE6MTE1NCAoMSw3Mjggc2FtcGxlcywgMC42NCUpPC90aXRsZT48cmVjdCB4PSIyMDU1Ljg
iIHk9IjIwOSIgd2lkdGg9IjE1LjMiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0Niw4Niw2KS
Igcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDU4Ljc5IiB5PSIyM
TkuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAs
MCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXM
pIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+Y19mdW5jdG
lvbjoweDdmNTQxMDBlNDc2OCAgICAgICgxMjAgc2FtcGxlcywgMC4wNCUpPC90aXRsZT48cmVjd
CB4PSIxNjA1LjEiIHk9Ijk3IiB3aWR0aD0iMS4xIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigy
MDcsMiw1MikiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTYwOC4
xMiIgeT0iMTA3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPS
JyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlc
j0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxl
Pmx1YWxpYi93YXJfcm9vbS9yb29tLmx1YTozMjUgKDQzMiBzYW1wbGVzLCAwLjE2JSk8L3RpdGx
lPjxyZWN0IHg9IjIwNzEuMSIgeT0iMTQ1IiB3aWR0aD0iMy44IiBoZWlnaHQ9IjE1LjAiIGZpbG
w9InJnYigyMjgsMzUsNCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIge
D0iMjA3NC4wNyIgeT0iMTU1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5h
IiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1
vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj
4KPHRpdGxlPmxpZ2h0X2NfZnVuY3Rpb246bHVhQl9wY2FsbCAoNDMyIHNhbXBsZXMsIDAuMTYlK
TwvdGl0bGU+PHJlY3QgeD0iMjA3MS4xIiB5PSIxNzciIHdpZHRoPSIzLjgiIGhlaWdodD0iMTUu
MCIgZmlsbD0icmdiKDIzOSwyMTksOSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmN
ob3I9IiIgeD0iMjA3NC4wNyIgeT0iMTg3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PS
JWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY
19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29t
KHRoaXMpIj4KPHRpdGxlPnNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1YToxMjggKDI2OSwxNDIgc2F
tcGxlcywgMTAwLjAwJSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjQzMyIgd2lkdGg9IjIzOD
AuMCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ4LDE4MCwzMSkiIHJ4PSIyIiByeT0iMiIgL
z4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjQ0My41IiBmb250LXNpemU9IjEy
IiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5za3luZXQvbHVhbGl
iL3NreW5ldC5sdWE6MTI4PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2Vvdm
VyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0b
GU+bHVhbGliL3dhcl9yb29tL3Jvb20ubHVhOjMyNSAoMiw2NDAgc2FtcGxlcywgMC45OCUpPC90
aXRsZT48cmVjdCB4PSIyMTA0LjgiIHk9IjIyNSIgd2lkdGg9IjIzLjMiIGhlaWdodD0iMTUuMCI
gZmlsbD0icmdiKDIxNyw2OCw0OSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3
I9IiIgeD0iMjEwNy43NiIgeT0iMjM1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZ
XJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmwuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVu
Y19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29
tKHRoaXMpIj4KPHRpdGxlPmNfZnVuY3Rpb246MHg3ZjU0MTAwZTQ3NjggICAgKDI5LDYxNiBzYW
1wbGVzLCAxMS4wMCUpPC90aXRsZT48cmVjdCB4PSIyMTI4LjEiIHk9IjE5MyIgd2lkdGg9IjI2M
S45IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzEsNiw1NCkiIHJ4PSIyIiByeT0iMiIgLz4K
PHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjEzMS4xMSIgeT0iMjAzLjUiIGZvbnQtc2l6ZT0iMTI
iIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmNfZnVuY3Rpb246MH
g3ZjU0MTAwZTQ3NjggICA8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92Z
XI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRs
ZT5hbGliL3dhcl9vYmplY3RzL2FpL2FpX25ldXJvbi5sdWE6OTU5ICgyNCBzYW1wbGVzLCAwLjA
xJSk8L3RpdGxlPjxyZWN0IHg9IjE2MDQuOSIgeT0iMjU3IiB3aWR0aD0iMC4yIiBoZWlnaHQ9Ij
E1LjAiIGZpbGw9InJnYigyMTIsMjQsMSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hb
mNob3I9IiIgeD0iMTYwNy45MSIgeT0iMjY3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5
PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnV
uY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b2
9tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTQzMCAoM
TIwIHNhbXBsZXMsIDAuMDQlKTwvdGl0bGU+PHJlY3QgeD0iMTYwNS4xIiB5PSIyMjUiIHdpZHRo
PSIxLjEiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0Niw5MSwyKSIgcng9IjIiIHJ5PSIyIiA
vPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjA4LjEyIiB5PSIyMzUuNSIgZm9udC1zaXplPS
IxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L
2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJj
KCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial9
yb2xlLmx1YToxNDk2ICgxNjgsMTA4IHNhbXBsZXMsIDYyLjQ2JSk8L3RpdGxlPjxyZWN0IHg9Ij
MwLjQiIHk9IjI0MSIgd2lkdGg9IjE0ODYuNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjE1L
DI4LDU0KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIzMy4zNyIg
eT0iMjUxLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2I
oMCwwLDApIiAgPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTQ5NjwvdGV4dD4KPC
9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iY
ygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpf
YmFzZS5sdWE6MjM1ICgxMiwwOTYgc2FtcGxlcywgNC40OSUpPC90aXRsZT48cmVjdCB4PSIxOTQ
4LjgiIHk9IjE3NyIgd2lkdGg9IjEwNy4wIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNTAsNT
gsNDYpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5NTEuODMiI
Hk9IjE4Ny41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdi
KDAsMCwwKSIgID5sdWFsaWIvd2FyX29iLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyI
gb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aG
lzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YToxMTU4ICg5NiBzYW1wbGVzLCAwL
jA0JSk8L3RpdGxlPjxyZWN0IHg9IjE5NDguMCIgeT0iMjA5IiB3aWR0aD0iMC44IiBoZWlnaHQ9
IjE1LjAiIGZpbGw9InJnYigyMjQsMjA3LDI4KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh
0LWFuY2hvcj0iIiB4PSIxOTUwLjk4IiB5PSIyMTkuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW
1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzP
SJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9
Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6MTY0NSAoMiw2NDA
gc2FtcGxlcywgMC45OCUpPC90aXRsZT48cmVjdCB4PSIyMTA0LjgiIHk9IjI1NyIgd2lkdGg9Ij
IzLjMiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxNSwyMTQsMjIpIiByeD0iMiIgcnk9IjIiI
C8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIxMDcuNzYiIHk9IjI2Ny41IiBmb250LXNpemU9
IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sLi48L3RleHQ
+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdX
Q9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb
2JqX2Jhc2UubHVhOjIzNSAoMTY4LDEwOCBzYW1wbGVzLCA2Mi40NiUpPC90aXRsZT48cmVjdCB4
PSIzMC40IiB5PSIyMDkiIHdpZHRoPSIxNDg2LjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI
wOCwxMjEsMykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMzMuMz
ciIHk9IjIxOS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0ic
mdiKDAsMCwwKSIgID5sdWFsaWIvd2FyX29iamVjdHMvb2JqX2Jhc2UubHVhOjIzNTwvdGV4dD4K
PC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0
iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYm
pfcm9sZS5sdWE6MTQzMCAoOSw5NDggc2FtcGxlcywgMy43MCUpPC90aXRsZT48cmVjdCB4PSIxN
TE2LjkiIHk9IjI0MSIgd2lkdGg9Ijg4LjAiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI0MSwx
MzksMTcpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE1MTkuOTQ
iIHk9IjI1MS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icm
diKDAsMCwwKSIgID5sdWFsaWIvd2FyLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb
25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlz
KSI+Cjx0aXRsZT5hbGliL3dhcl9vYmplY3RzL2FpL2FpX25ldXJvbi5sdWE6NDYzICg4NjQgc2F
tcGxlcywgMC4zMiUpPC90aXRsZT48cmVjdCB4PSIyMi43IiB5PSIyNzMiIHdpZHRoPSI3LjciIG
hlaWdodD0iMTUuMCIgZmlsbD0icmdiKDI1MiwyMTksMTQpIiByeD0iMiIgcnk9IjIiIC8+Cjx0Z
Xh0IHRleHQtYW5jaG9yPSIiIHg9IjI1LjczIiB5PSIyODMuNSIgZm9udC1zaXplPSIxMiIgZm9u
dC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGN
sYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2
xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+c2t5bmV0L2x1YWxpYi9za3luZXQubHVhOjM0NCAoN
DIgc2FtcGxlcywgMC4wMiUpPC90aXRsZT48cmVjdCB4PSIyMDc1LjMiIHk9IjE5MyIgd2lkdGg9
IjAuNCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjIxLDExNCw1KSIgcng9IjIiIHJ5PSIyIiA
vPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDc4LjMyIiB5PSIyMDMuNSIgZm9udC1zaXplPS
IxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L
2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJj
KCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE
6MTI5MCAoOSw5NDggc2FtcGxlcywgMy43MCUpPC90aXRsZT48cmVjdCB4PSIxNTE2LjkiIHk9Ij
E3NyIgd2lkdGg9Ijg4LjAiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyNCwyMDMsNDMpIiBye
D0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE1MTkuOTQiIHk9IjE4Ny41
IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSI
gID5sdWFsaWIvd2FyLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZX
I9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZ
T5sdWFsaWIvd2FyX29iamVjdHMvbW92ZV9jdHJsLmx1YTozNjkgKDEyLDg0MCBzYW1wbGVzLCA0
Ljc3JSk8L3RpdGxlPjxyZWN0IHg9IjE5NDIuMiIgeT0iMjczIiB3aWR0aD0iMTEzLjYiIGhlaWd
odD0iMTUuMCIgZmlsbD0icmdiKDIzNyw3MSwxNikiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdG
V4dC1hbmNob3I9IiIgeD0iMTk0NS4yNSIgeT0iMjgzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZ
mFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfb2JqLi48L3Rl
eHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2V
vdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5jX2Z1bmN0aW9uOjB4N2Y1ND
EwMGU0NzY4ICAgICAoMiw2NDAgc2FtcGxlcywgMC45OCUpPC90aXRsZT48cmVjdCB4PSIyMTA0L
jgiIHk9IjE3NyIgd2lkdGg9IjIzLjMiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzOCwxNzks
MTcpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIxMDcuNzYiIHk
9IjE4Ny41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKD
AsMCwwKSIgID5jLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9I
nModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5z
ZXJ2aWNlL3NjZW5lL3NjZW5lX2Jhc2UubHVhOjgyICgxMjAgc2FtcGxlcywgMC4wNCUpPC90aXR
sZT48cmVjdCB4PSIxNjA1LjEiIHk9IjEyOSIgd2lkdGg9IjEuMSIgaGVpZ2h0PSIxNS4wIiBmaW
xsPSJyZ2IoMjIwLDEwMCw4KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iI
iB4PSIxNjA4LjEyIiB5PSIxMzkuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRh
bmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9
ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcy
kiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6MTE4NyAoNzQ0IHNhbXBsZXMsIDAuM
jglKTwvdGl0bGU+PHJlY3QgeD0iMTk0Mi4yIiB5PSIyNDEiIHdpZHRoPSI2LjYiIGhlaWdodD0i
MTUuMCIgZmlsbD0icmdiKDI0OCwxOTQsNDEpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQ
tYW5jaG9yPSIiIHg9IjE5NDUuMjUiIHk9IjI1MS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbW
lseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9I
mZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0i
em9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvZXZlbnRfc3lzdGVtLmx1YTo
3MSAoMzcsNDg4IHNhbXBsZXMsIDEzLjkzJSk8L3RpdGxlPjxyZWN0IHg9IjE2MTAuNyIgeT0iMj
A5IiB3aWR0aD0iMzMxLjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyNSw4OCwzKSIgcng9I
jIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjEzLjc0IiB5PSIyMTkuNSIg
Zm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA
+bHVhbGliL3dhcl9vYmplY3RzL2V2ZW50X3N5c3RlbS5sdWE6NzE8L3RleHQ+CjwvZz4KPGcgY2
xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jb
Gljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vcm9vbS5sdWE6MzI1ICg1
MTYgc2FtcGxlcywgMC4xOSUpPC90aXRsZT48cmVjdCB4PSIxNjA2LjIiIHk9IjE3NyIgd2lkdGg
9IjQuNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjM2LDIyMywxKSIgcng9IjIiIHJ5PSIyIi
AvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjA5LjE4IiB5PSIxODcuNSIgZm9udC1zaXplP
SIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8
L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJ
jKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial
9iYXNlLmx1YToyMzUgKDc2OCBzYW1wbGVzLCAwLjI5JSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiI
Hk9IjE5MyIgd2lkdGg9IjYuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjA4LDIxMiwyOCki
IHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjIwMy4
1IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKS
IgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiI
G9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2Fy
X3Jvb20vbWFwLmx1YToxMjkwICg1MTYgc2FtcGxlcywgMC4xOSUpPC90aXRsZT48cmVjdCB4PSI
xNjA2LjIiIHk9IjE5MyIgd2lkdGg9IjQuNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjM4LD
ExMywyMikiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTYwOS4xO
CIgeT0iMjAzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJy
Z2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0
icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPm
x1YWxpYi93YXJfb2JqZWN0cy9haS9haS5sdWE6NTQ0ICgzNyw0ODggc2FtcGxlcywgMTMuOTMlK
TwvdGl0bGU+PHJlY3QgeD0iMTYxMC43IiB5PSIyMjUiIHdpZHRoPSIzMzEuNSIgaGVpZ2h0PSIx
NS4wIiBmaWxsPSJyZ2IoMjIwLDUwLDMxKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWF
uY2hvcj0iIiB4PSIxNjEzLjc0IiB5PSIyMzUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbH
k9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+bHVhbGliL3dhcl9vYmplY3RzL2FpL2FpL
mx1YTo1NDQ8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhp
cykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5za3luZXQ
vbHVhbGliL3NreW5ldC5sdWE6MzQ0ICgyNCBzYW1wbGVzLCAwLjAxJSk8L3RpdGxlPjxyZWN0IH
g9IjE2MDQuOSIgeT0iMTI5IiB3aWR0aD0iMC4yIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyM
TcsMjIsMSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTYwNy45
MSIgeT0iMTM5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJ
yZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj
0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlP
mNfZnVuY3Rpb246MHg3ZjU0MTAwZTQ3NjggICAgICAgKDQ4IHNhbXBsZXMsIDAuMDIlKTwvdGl0
bGU+PHJlY3QgeD0iMjA3NC45IiB5PSIxMTMiIHdpZHRoPSIwLjQiIGhlaWdodD0iMTUuMCIgZml
sbD0icmdiKDI0NSw5OCwxNCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9Ii
IgeD0iMjA3Ny44OSIgeT0iMTIzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkY
W5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBv
bm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXM
pIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS9tYXAubHVhOjgwNSAoOTYgc2FtcGxlcywgMC4wNC
UpPC90aXRsZT48cmVjdCB4PSIxOTQ4LjAiIHk9IjE2MSIgd2lkdGg9IjAuOCIgaGVpZ2h0PSIxN
S4wIiBmaWxsPSJyZ2IoMjM1LDIxNSwyMCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1h
bmNob3I9IiIgeD0iMTk1MC45OCIgeT0iMTcxLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx
5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZn
VuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b
29tKHRoaXMpIj4KPHRpdGxlPmFsaWIvd2FyX29iamVjdHMvYWkvYWlfbmV1cm9uLmx1YTo5ODcg
KDUxNiBzYW1wbGVzLCAwLjE5JSk8L3RpdGxlPjxyZWN0IHg9IjE2MDYuMiIgeT0iMjU3IiB3aWR
0aD0iNC41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNDksMTMzLDI2KSIgcng9IjIiIHJ5PS
IyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjA5LjE4IiB5PSIyNjcuNSIgZm9udC1za
XplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0
Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V
0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+Y19mdW5jdGlvbjoweDdmNTQxMD
BlNDc2OCAgICAgICg2NzIgc2FtcGxlcywgMC4yNSUpPC90aXRsZT48cmVjdCB4PSIxNi44IiB5P
SIxMTMiIHdpZHRoPSI1LjkiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzMywxMzQsMykiIHJ4
PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTkuNzkiIHk9IjEyMy41IiB
mb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID
48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ub
W91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZXJ2aWNlL3NjZW5l
L3NjZW5lX2Jhc2UubHVhOjgyICgxLDcyOCBzYW1wbGVzLCAwLjY0JSk8L3RpdGxlPjxyZWN0IHg
9IjIwNTUuOCIgeT0iMTQ1IiB3aWR0aD0iMTUuMyIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMj
E2LDIwMiw0MykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjA1O
C43OSIgeT0iMTU1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxs
PSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Z
lcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdG
xlPmx1YWxpYi93YXJfcm9vbS9yb29tLmx1YTozMjUgKDg2NCBzYW1wbGVzLCAwLjMyJSk8L3Rpd
GxlPjxyZWN0IHg9IjIyLjciIHk9IjE0NSIgd2lkdGg9IjcuNyIgaGVpZ2h0PSIxNS4wIiBmaWxs
PSJyZ2IoMjQzLDE5LDQzKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB
4PSIyNS43MyIgeT0iMTU1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIi
BmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vd
XNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4K
PHRpdGxlPnNlcnZpY2Uvc2NlbmUvc2NlbmVfYmFzZS5sdWE6ODIgKDc2OCBzYW1wbGVzLCAwLjI
5JSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjE0NSIgd2lkdGg9IjYuOCIgaGVpZ2h0PSIxNS
4wIiBmaWxsPSJyZ2IoMjA1LDk4LDMxKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY
2hvcj0iIiB4PSIxMy4wMCIgeT0iMTU1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJW
ZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19
nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKH
RoaXMpIj4KPHRpdGxlPnNlcnZpY2Uvc2NlbmUvc2NlbmVfYmFzZS5sdWE6ODIgKDMsMjg4IHNhb
XBsZXMsIDEuMjIlKTwvdGl0bGU+PHJlY3QgeD0iMjA3NS43IiB5PSIyMDkiIHdpZHRoPSIyOS4x
IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjksMjExLDQyKSIgcng9IjIiIHJ5PSIyIiAvPgo
8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDc4LjY5IiB5PSIyMTkuNSIgZm9udC1zaXplPSIxMi
IgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+c2UuLjwvdGV4dD4KP
C9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0i
YygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNlcnZpY2Uvc2NlbmUvc2NlbmVfYmF
zZS5sdWE6ODIgKDE2OCwxMDggc2FtcGxlcywgNjIuNDYlKTwvdGl0bGU+PHJlY3QgeD0iMzAuNC
IgeT0iMTYxIiB3aWR0aD0iMTQ4Ni41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNDksMTcsN
DcpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjMzLjM3IiB5PSIx
NzEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDA
sMCkiICA+c2VydmljZS9zY2VuZS9zY2VuZV9iYXNlLmx1YTo4MjwvdGV4dD4KPC9nPgo8ZyBjbG
Fzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsa
WNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6
MTUyMCAoMTIsMDk2IHNhbXBsZXMsIDQuNDklKTwvdGl0bGU+PHJlY3QgeD0iMTk0OC44IiB5PSI
yNDEiIHdpZHRoPSIxMDcuMCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQyLDEwNSw0MSkiIH
J4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTk1MS44MyIgeT0iMjUxL
jUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDAp
IiAgPmx1YWxpYi93YXJfb2IuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXN
lb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPH
RpdGxlPmx1YWxpYi93YXJfcm9vbS9yb29tLmx1YTozMjUgKDY0OCBzYW1wbGVzLCAwLjI0JSk8L
3RpdGxlPjxyZWN0IHg9IjE5NDIuMiIgeT0iMTYxIiB3aWR0aD0iNS44IiBoZWlnaHQ9IjE1LjAi
IGZpbGw9InJnYigyMzQsNjMsMzcpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9
yPSIiIHg9IjE5NDUuMjUiIHk9IjE3MS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVm
VyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZ
yIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0
aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX3JvbGUubHVhOjEzOTkgKDM3LDQ
4OCBzYW1wbGVzLCAxMy45MyUpPC90aXRsZT48cmVjdCB4PSIxNjEwLjciIHk9IjE2MSIgd2lkdG
g9IjMzMS41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjcsMTA4LDYpIiByeD0iMiIgcnk9I
jIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MTMuNzQiIHk9IjE3MS41IiBmb250LXNp
emU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWI
vd2FyX29iamVjdHMvb2JqX3JvbGUubHVhOjEzOTk8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bm
NfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vb
Sh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YToxMjkwICgzNyw0ODggc2Ft
cGxlcywgMTMuOTMlKTwvdGl0bGU+PHJlY3QgeD0iMTYxMC43IiB5PSI5NyIgd2lkdGg9IjMzMS4
1IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzEsOTQsNDYpIiByeD0iMiIgcnk9IjIiIC8+Cj
x0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MTMuNzQiIHk9IjEwNy41IiBmb250LXNpemU9IjEyI
iBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIvd2FyX3Jv
b20vbWFwLmx1YToxMjkwPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmV
yPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bG
U+bHVhbGliL3dhcl9vYmplY3RzL29ial9yb2xlLmx1YToxNDMwICgxMiwwOTYgc2FtcGxlcywgN
C40OSUpPC90aXRsZT48cmVjdCB4PSIxOTQ4LjgiIHk9IjIyNSIgd2lkdGg9IjEwNy4wIiBoZWln
aHQ9IjE1LjAiIGZpbGw9InJnYigyNTIsOTgsMjUpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHR
leHQtYW5jaG9yPSIiIHg9IjE5NTEuODMiIHk9IjIzNS41IiBmb250LXNpemU9IjEyIiBmb250LW
ZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIvd2FyX29iLi48L3Rle
HQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2Vv
dXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5za3luZXQvbHVhbGliL3NreW5
ldC5sdWE6MzQ0ICgyLDY0MCBzYW1wbGVzLCAwLjk4JSk8L3RpdGxlPjxyZWN0IHg9IjIxMDQuOC
IgeT0iMTkzIiB3aWR0aD0iMjMuMyIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjE1LDE5NywyO
CkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjEwNy43NiIgeT0i
MjAzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCw
wLDApIiAgPnMuLjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icy
h0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPnNre
W5ldC9sdWFsaWIvc2t5bmV0Lmx1YTozNDQgKDk2IHNhbXBsZXMsIDAuMDQlKTwvdGl0bGU+PHJl
Y3QgeD0iMTk0OC4wIiB5PSIxMTMiIHdpZHRoPSIwLjgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmd
iKDIyMywyMTMsMzQpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9Ij
E5NTAuOTgiIHk9IjEyMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZ
mlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3Vz
ZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx
0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvYWkvYWkubHVhOjIwNCAoMjE4LDUwOCBzYW1wbGVzLC
A4MS4xOSUpPC90aXRsZT48cmVjdCB4PSIxMC4wIiB5PSIyODkiIHdpZHRoPSIxOTMyLjIiIGhla
WdodD0iMTUuMCIgZmlsbD0icmdiKDIyOCw5MCwxOSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQg
dGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjI5OS41IiBmb250LXNpemU9IjEyIiBmb250LWZ
hbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIvd2FyX29iamVjdHMvYW
kvYWkubHVhOjIwNDwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0ic
yh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1
YWxpYi93YXJfcm9vbS9yb29tLmx1YTozMjUgKDksOTQ4IHNhbXBsZXMsIDMuNzAlKTwvdGl0bGU
+PHJlY3QgeD0iMTUxNi45IiB5PSIxNjEiIHdpZHRoPSI4OC4wIiBoZWlnaHQ9IjE1LjAiIGZpbG
w9InJnYigyNTQsMTI1LDI3KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iI
iB4PSIxNTE5Ljk0IiB5PSIxNzEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRh
bmEiIGZpbGw9InJnYigwLDAsMCkiICA+bHVhbGliL3dhci4uPC90ZXh0Pgo8L2c+CjxnIGNsYXN
zPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2
s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial9yb2xlLmx1YToxN
DE4ICg4NjQgc2FtcGxlcywgMC4zMiUpPC90aXRsZT48cmVjdCB4PSIyMi43IiB5PSIyNDEiIHdp
ZHRoPSI3LjciIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyMywxMjksMzMpIiByeD0iMiIgcnk
9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjI1LjczIiB5PSIyNTEuNSIgZm9udC1zaX
plPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0P
go8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0
PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29
ial9yb2xlLmx1YToxMzIxICg3Njggc2FtcGxlcywgMC4yOSUpPC90aXRsZT48cmVjdCB4PSIxMC
4wIiB5PSIyMDkiIHdpZHRoPSI2LjgiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIwOCwxNDUsM
TQpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSIy
MTkuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDA
sMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaX
MpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL
3dhcl9yb29tL3Jvb20ubHVhOjMyNSAoNjcyIHNhbXBsZXMsIDAuMjUlKTwvdGl0bGU+PHJlY3Qg
eD0iMTYuOCIgeT0iMTYxIiB3aWR0aD0iNS45IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzQ
sNTcsNDUpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5Ljc5Ii
B5PSIxNzEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnY
igwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJz
KHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+YWx
pYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb24ubHVhOjk0NyAoMzgsMTQ4IHNhbXBsZXMsIDE0Lj
E3JSk8L3RpdGxlPjxyZWN0IHg9IjE2MDQuOSIgeT0iMjczIiB3aWR0aD0iMzM3LjMiIGhlaWdod
D0iMTUuMCIgZmlsbD0icmdiKDIwOSw4Niw0NikiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4
dC1hbmNob3I9IiIgeD0iMTYwNy45MSIgeT0iMjgzLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmF
taWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmFsaWIvd2FyX29iamVjdHMvYWkvYW
lfbmV1cm9uLmx1YTo5NDc8L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92Z
XI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRs
ZT5za3luZXQvbHVhbGliL3NreW5ldC5sdWE6MzQ0ICg1MTYgc2FtcGxlcywgMC4xOSUpPC90aXR
sZT48cmVjdCB4PSIxNjA2LjIiIHk9IjE0NSIgd2lkdGg9IjQuNSIgaGVpZ2h0PSIxNS4wIiBmaW
xsPSJyZ2IoMjE0LDExLDIyKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iI
iB4PSIxNjA5LjE4IiB5PSIxNTUuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRh
bmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9
ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcy
kiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6ODA1ICg2NDggc2FtcGxlcywgMC4yN
CUpPC90aXRsZT48cmVjdCB4PSIxOTQyLjIiIHk9IjE3NyIgd2lkdGg9IjUuOCIgaGVpZ2h0PSIx
NS4wIiBmaWxsPSJyZ2IoMjM2LDMwLDQ4KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWF
uY2hvcj0iIiB4PSIxOTQ1LjI1IiB5PSIxODcuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbH
k9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmd
W5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpv
b20odGhpcykiPgo8dGl0bGU+c2t5bmV0L2x1YWxpYi9za3luZXQubHVhOjU0NSAoMjY5LDE0MiB
zYW1wbGVzLCAxMDAuMDAlKTwvdGl0bGU+PHJlY3QgeD0iMTAuMCIgeT0iNDE3IiB3aWR0aD0iMj
M4MC4wIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzcsOTksMTcpIiByeD0iMiIgcnk9IjIiI
C8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjEzLjAwIiB5PSI0MjcuNSIgZm9udC1zaXplPSIx
MiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+c2t5bmV0L2x1YWx
pYi9za3luZXQubHVhOjU0NTwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3
Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpd
GxlPmx1YWxpYi93YXJfcm9vbS9tYXAubHVhOjgwNSAoMywyODggc2FtcGxlcywgMS4yMiUpPC90
aXRsZT48cmVjdCB4PSIyMDc1LjciIHk9IjI0MSIgd2lkdGg9IjI5LjEiIGhlaWdodD0iMTUuMCI
gZmlsbD0icmdiKDI1MCwxMTgsNykiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3
I9IiIgeD0iMjA3OC42OSIgeT0iMjUxLjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZ
XJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPmx1Li48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1
bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9
vbSh0aGlzKSI+Cjx0aXRsZT5saWdodF9jX2Z1bmN0aW9uOmx1YUJfcGNhbGwgKDQ4IHNhbXBsZX
MsIDAuMDIlKTwvdGl0bGU+PHJlY3QgeD0iMjA3NC45IiB5PSIxOTMiIHdpZHRoPSIwLjQiIGhla
WdodD0iMTUuMCIgZmlsbD0icmdiKDI0NCwxODYsNDApIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0
IHRleHQtYW5jaG9yPSIiIHg9IjIwNzcuODkiIHk9IjIwMy41IiBmb250LXNpemU9IjEyIiBmb25
0LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2
xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jb
Gljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5hbGliL3dhcl9vYmplY3RzL2FpL2FpX25ldXJvbi5s
dWE6NjE1ICgzNyw0ODggc2FtcGxlcywgMTMuOTMlKTwvdGl0bGU+PHJlY3QgeD0iMTYxMC43IiB
5PSIxNzciIHdpZHRoPSIzMzEuNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ2LDIxOSw0MC
kiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTYxMy43NCIgeT0iM
Tg3LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCww
LDApIiAgPmFsaWIvd2FyX29iamVjdHMvYWkvYWlfbmV1cm9uLmx1YTo2MTU8L3RleHQ+CjwvZz4
KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKS
Igb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMvb2JqX3Jvb
GUubHVhOjE0OTYgKDY3MiBzYW1wbGVzLCAwLjI1JSk8L3RpdGxlPjxyZWN0IHg9IjE2LjgiIHk9
IjIyNSIgd2lkdGg9IjUuOSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjI2LDIyMywzMikiIHJ
4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTkuNzkiIHk9IjIzNS41Ii
Bmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgI
D48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9u
bW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3J
vb20vcm9vbS5sdWE6MzI1ICg0OCBzYW1wbGVzLCAwLjAyJSk8L3RpdGxlPjxyZWN0IHg9IjIwNz
QuOSIgeT0iMTYxIiB3aWR0aD0iMC40IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNDAsMTkxL
DM0KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDc3Ljg5IiB5
PSIxNzEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYig
wLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKH
RoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhb
GliL3dhcl9vYmplY3RzL29ial9yb2xlLmx1YToxMzIxICgxMiwwOTYgc2FtcGxlcywgNC40OSUp
PC90aXRsZT48cmVjdCB4PSIxOTQ4LjgiIHk9IjE5MyIgd2lkdGg9IjEwNy4wIiBoZWlnaHQ9IjE
1LjAiIGZpbGw9InJnYigyMzgsMTkzLDkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW
5jaG9yPSIiIHg9IjE5NTEuODMiIHk9IjIwMy41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlse
T0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIvd2FyX29iLi48L3RleHQ+Cjwv
Zz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImM
oKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5za3luZXQvbHVhbGliL3NreW5ldC5sdW
E6MzQ0ICg2NzIgc2FtcGxlcywgMC4yNSUpPC90aXRsZT48cmVjdCB4PSIxNi44IiB5PSIxMjkiI
HdpZHRoPSI1LjkiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzMSwxNTgsNDIpIiByeD0iMiIg
cnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5Ljc5IiB5PSIxMzkuNSIgZm9udC1
zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZX
h0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb
3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3Rz
L29ial9yb2xlLmx1YToxMzIxICg2NzIgc2FtcGxlcywgMC4yNSUpPC90aXRsZT48cmVjdCB4PSI
xNi44IiB5PSIyMDkiIHdpZHRoPSI1LjkiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIwOCw0Ny
wxOCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTkuNzkiIHk9I
jIxOS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAs
MCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGh
pcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaW
Ivd2FyX29iamVjdHMvb2JqX3JvbGUubHVhOjEzMjEgKDksOTQ4IHNhbXBsZXMsIDMuNzAlKTwvd
Gl0bGU+PHJlY3QgeD0iMTUxNi45IiB5PSIyMDkiIHdpZHRoPSI4OC4wIiBoZWlnaHQ9IjE1LjAi
IGZpbGw9InJnYigyNDEsOTUsNDkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9
yPSIiIHg9IjE1MTkuOTQiIHk9IjIxOS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVm
VyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sdWFsaWIvd2FyLi48L3RleHQ+CjwvZz4KPGcgY
2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25j
bGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5za3luZXQvbHVhbGliL3NreW5ldC5sdWE6MzQ0ICg
zNyw0ODggc2FtcGxlcywgMTMuOTMlKTwvdGl0bGU+PHJlY3QgeD0iMTYxMC43IiB5PSI0OSIgd2
lkdGg9IjMzMS41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMDksMTE1LDQwKSIgcng9IjIiI
HJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjEzLjc0IiB5PSI1OS41IiBmb250
LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5za3l
uZXQvbHVhbGliL3NreW5ldC5sdWE6MzQ0PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG
9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpc
ykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial9iYXNlLmx1YToxMDIgKDQ4IHNhbXBs
ZXMsIDAuMDIlKTwvdGl0bGU+PHJlY3QgeD0iMjA3NC45IiB5PSIyNDEiIHdpZHRoPSIwLjQiIGh
laWdodD0iMTUuMCIgZmlsbD0icmdiKDI0NCwxMjIsMjkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZX
h0IHRleHQtYW5jaG9yPSIiIHg9IjIwNzcuODkiIHk9IjI1MS41IiBmb250LXNpemU9IjEyIiBmb
250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcg
Y2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25
jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZXJ2aWNlL3NjZW5lL3NjZW5lX2Jhc2UubHVhOj
gyICg0OCBzYW1wbGVzLCAwLjAyJSk8L3RpdGxlPjxyZWN0IHg9IjIwNzQuOSIgeT0iMTQ1IiB3a
WR0aD0iMC40IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNDYsMjI1LDgpIiByeD0iMiIgcnk9
IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjIwNzcuODkiIHk9IjE1NS41IiBmb250LXN
pemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleH
Q+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2Vvd
XQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZXJ2aWNlL3NjZW5lL3NjZW5l
X2Jhc2UubHVhOjgyICgzNyw0ODggc2FtcGxlcywgMTMuOTMlKTwvdGl0bGU+PHJlY3QgeD0iMTY
xMC43IiB5PSI2NSIgd2lkdGg9IjMzMS41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjIsMj
MsMzIpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MTMuNzQiI
Hk9Ijc1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2Io
MCwwLDApIiAgPnNlcnZpY2Uvc2NlbmUvc2NlbmVfYmFzZS5sdWE6ODI8L3RleHQ+CjwvZz4KPGc
gY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb2
5jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YToxMjM3I
Cg5NiBzYW1wbGVzLCAwLjA0JSk8L3RpdGxlPjxyZWN0IHg9IjE5NDguMCIgeT0iMTkzIiB3aWR0
aD0iMC44IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMzcsMTcsNDcpIiByeD0iMiIgcnk9IjI
iIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5NTAuOTgiIHk9IjIwMy41IiBmb250LXNpem
U9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+C
jwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9
ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5hbGliL3dhcl9vYmplY3RzL2FpL2F
pX25ldXJvbi5sdWE6NTY4ICgzNyw0ODggc2FtcGxlcywgMTMuOTMlKTwvdGl0bGU+PHJlY3QgeD
0iMTYxMC43IiB5PSIxOTMiIHdpZHRoPSIzMzEuNSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoM
jEzLDQ0LDMyKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjEz
Ljc0IiB5PSIyMDMuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw
9InJnYigwLDAsMCkiICA+YWxpYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb24ubHVhOjU2ODwvdG
V4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZ
W91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0
cy9vYmpfcm9sZS5sdWE6MTQ5NiAoNzY4IHNhbXBsZXMsIDAuMjklKTwvdGl0bGU+PHJlY3QgeD0
iMTAuMCIgeT0iMjI1IiB3aWR0aD0iNi44IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMDUsMT
IxLDM2KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIge
T0iMjM1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2Io
MCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh
0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YW
xpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTQ5NiAoODY0IHNhbXBsZXMsIDAuMzIlKTwvd
Gl0bGU+PHJlY3QgeD0iMjIuNyIgeT0iMjA5IiB3aWR0aD0iNy43IiBoZWlnaHQ9IjE1LjAiIGZp
bGw9InJnYigyMjgsMTIzLDQxKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0
iIiB4PSIyNS43MyIgeT0iMjE5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW
5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvb
m1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMp
Ij4KPHRpdGxlPnNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1YTozNDQgKDY0OCBzYW1wbGVzLCAwLjI
0JSk8L3RpdGxlPjxyZWN0IHg9IjE5NDIuMiIgeT0iMTI5IiB3aWR0aD0iNS44IiBoZWlnaHQ9Ij
E1LjAiIGZpbGw9InJnYigyNDIsMTExLDUxKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0L
WFuY2hvcj0iIiB4PSIxOTQ1LjI1IiB5PSIxMzkuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1p
bHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJ
mdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9In
pvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL29ial9yb2xlLmx1YToxNDk2I
CgxMiwwOTYgc2FtcGxlcywgNC40OSUpPC90aXRsZT48cmVjdCB4PSIxOTQ4LjgiIHk9IjIwOSIg
d2lkdGg9IjEwNy4wIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNTMsNzgsMjgpIiByeD0iMiI
gcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5NTEuODMiIHk9IjIxOS41IiBmb2
50LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5sd
WFsaWIvd2FyX29iLi48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9
InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5
sdWFsaWIvd2FyX3Jvb20vbWFwLmx1YTo4MDUgKDQzMiBzYW1wbGVzLCAwLjE2JSk8L3RpdGxlPj
xyZWN0IHg9IjIwNzEuMSIgeT0iMTYxIiB3aWR0aD0iMy44IiBoZWlnaHQ9IjE1LjAiIGZpbGw9I
nJnYigyMTgsMTcyLDI3KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4
PSIyMDc0LjA3IiB5PSIxNzEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmE
iIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW
91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiP
go8dGl0bGU+c2VydmljZS9zY2VuZS9zY2VuZV9iYXNlLmx1YTo4MiAoOSw5NDggc2FtcGxlcywg
My43MCUpPC90aXRsZT48cmVjdCB4PSIxNTE2LjkiIHk9IjE0NSIgd2lkdGg9Ijg4LjAiIGhlaWd
odD0iMTUuMCIgZmlsbD0icmdiKDIwOCwyMTcsMTkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IH
RleHQtYW5jaG9yPSIiIHg9IjE1MTkuOTQiIHk9IjE1NS41IiBmb250LXNpemU9IjEyIiBmb250L
WZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5zZXJ2aWNlL3NjLi48L3RleHQ+
CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ
9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5za3luZXQvbHVhbGliL3NreW5ldC
5sdWE6MzQ0ICgyOSw2MTYgc2FtcGxlcywgMTEuMDAlKTwvdGl0bGU+PHJlY3QgeD0iMjEyOC4xI
iB5PSIyMDkiIHdpZHRoPSIyNjEuOSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjMyLDIyNyw0
OSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjEzMS4xMSIgeT0
iMjE5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMC
wwLDApIiAgPnNreW5ldC9sdWFsaWIvc2t5bmV0Lmx1YTozNDQ8L3RleHQ+CjwvZz4KPGcgY2xhc
3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGlj
az0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZXJ2aWNlL3NjZW5lL3NjZW5lX2Jhc2UubHVhOjgyICg
yLDY0MCBzYW1wbGVzLCAwLjk4JSk8L3RpdGxlPjxyZWN0IHg9IjIxMDQuOCIgeT0iMjA5IiB3aW
R0aD0iMjMuMyIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjE4LDkyLDQzKSIgcng9IjIiIHJ5P
SIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMTA3Ljc2IiB5PSIyMTkuNSIgZm9udC1z
aXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+cy4uPC9
0ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdX
Nlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL
21hcC5sdWE6MTE4NyAoMiwxNjAgc2FtcGxlcywgMC44MCUpPC90aXRsZT48cmVjdCB4PSIyMDU1
LjgiIHk9IjI0MSIgd2lkdGg9IjE5LjEiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyMiw1LDE
3KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDU4Ljc5IiB5PS
IyNTEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwL
DAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRo
aXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGl
iL3dhcl9yb29tL3Jvb20ubHVhOjMyNSAoMywyODggc2FtcGxlcywgMS4yMiUpPC90aXRsZT48cm
VjdCB4PSIyMDc1LjciIHk9IjIyNSIgd2lkdGg9IjI5LjEiIGhlaWdodD0iMTUuMCIgZmlsbD0ic
mdiKDI0NCwxNjksNDgpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9
IjIwNzguNjkiIHk9IjIzNS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSI
gZmlsbD0icmdiKDAsMCwwKSIgID5sdS4uPC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG
9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpc
ykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sdWE6MTI5MCAoODY0IHNhbXBsZXMsIDAu
MzIlKTwvdGl0bGU+PHJlY3QgeD0iMjIuNyIgeT0iMTYxIiB3aWR0aD0iNy43IiBoZWlnaHQ9IjE
1LjAiIGZpbGw9InJnYigyMzksMTIyLDkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW
5jaG9yPSIiIHg9IjI1LjczIiB5PSIxNzEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9I
lZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5j
X2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20
odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL3Jvb20ubHVhOjMyNSAoMjQgc2FtcGxlcy
wgMC4wMSUpPC90aXRsZT48cmVjdCB4PSIxNjA0LjkiIHk9IjE2MSIgd2lkdGg9IjAuMiIgaGVpZ
2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjM3LDIwLDI2KSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0
ZXh0LWFuY2hvcj0iIiB4PSIxNjA3LjkxIiB5PSIxNzEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1
mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYX
NzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY
2s9Inpvb20odGhpcykiPgo8dGl0bGU+c2t5bmV0L2x1YWxpYi9za3luZXQubHVhOjM0NCAoMTY4
LDEwOCBzYW1wbGVzLCA2Mi40NiUpPC90aXRsZT48cmVjdCB4PSIzMC40IiB5PSIxNDUiIHdpZHR
oPSIxNDg2LjUiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxNSwzMCwzMSkiIHJ4PSIyIiByeT
0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMzMuMzciIHk9IjE1NS41IiBmb250LXNpe
mU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5za3luZXQv
bHVhbGliL3NreW5ldC5sdWE6MzQ0PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW9
1c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPg
o8dGl0bGU+Y19mdW5jdGlvbjoweDdmNTQxMDBlNDc2OCAgICAgICg1MTYgc2FtcGxlcywgMC4xO
SUpPC90aXRsZT48cmVjdCB4PSIxNjA2LjIiIHk9IjEyOSIgd2lkdGg9IjQuNSIgaGVpZ2h0PSIx
NS4wIiBmaWxsPSJyZ2IoMjM4LDEzNiwxOSkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1
hbmNob3I9IiIgeD0iMTYwOS4xOCIgeT0iMTM5LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaW
x5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZ
nVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6
b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9tb3ZlX2N0cmwubHVhOjQzOCA
oNDggc2FtcGxlcywgMC4wMiUpPC90aXRsZT48cmVjdCB4PSIyMDc0LjkiIHk9IjI1NyIgd2lkdG
g9IjAuNCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjUyLDIyNiw5KSIgcng9IjIiIHJ5PSIyI
iAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIyMDc3Ljg5IiB5PSIyNjcuNSIgZm9udC1zaXpl
PSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo
8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PS
JjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9yb29tL21hcC5sd
WE6ODA1ICgxLDcyOCBzYW1wbGVzLCAwLjY0JSk8L3RpdGxlPjxyZWN0IHg9IjIwNTUuOCIgeT0i
MTc3IiB3aWR0aD0iMTUuMyIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQyLDE2NiwyOSkiIHJ
4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjA1OC43OSIgeT0iMTg3Lj
UiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApI
iAgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIg
b25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJ
fcm9vbS9yb29tLmx1YTozMjUgKDI5LDYxNiBzYW1wbGVzLCAxMS4wMCUpPC90aXRsZT48cmVjdC
B4PSIyMTI4LjEiIHk9IjI0MSIgd2lkdGg9IjI2MS45IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnY
igyMzQsMTM5LDEyKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIy
MTMxLjExIiB5PSIyNTEuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZ
pbGw9InJnYigwLDAsMCkiICA+bHVhbGliL3dhcl9yb29tL3Jvb20ubHVhOjMyNTwvdGV4dD4KPC
9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iY
ygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfcm9vbS9tYXAubHVh
OjgwNSAoMjQgc2FtcGxlcywgMC4wMSUpPC90aXRsZT48cmVjdCB4PSIxNjA0LjkiIHk9IjE3NyI
gd2lkdGg9IjAuMiIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQ0LDIwNiwzNykiIHJ4PSIyIi
ByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTYwNy45MSIgeT0iMTg3LjUiIGZvb
nQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPjwv
dGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3V
zZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZW
N0cy9vYmpfcm9sZS5sdWE6MTQ5NiAoMzcsNDg4IHNhbXBsZXMsIDEzLjkzJSk8L3RpdGxlPjxyZ
WN0IHg9IjE2MTAuNyIgeT0iMTQ1IiB3aWR0aD0iMzMxLjUiIGhlaWdodD0iMTUuMCIgZmlsbD0i
cmdiKDI0OSw5OCw0NCkiIHJ4PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0
iMTYxMy43NCIgeT0iMTU1LjUiIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIi
BmaWxsPSJyZ2IoMCwwLDApIiAgPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTQ5N
jwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25t
b3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2J
qZWN0cy9vYmpfYmFzZS5sdWE6MjM1ICg2NzIgc2FtcGxlcywgMC4yNSUpPC90aXRsZT48cmVjdC
B4PSIxNi44IiB5PSIxOTMiIHdpZHRoPSI1LjkiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzM
ywxNzcsMzMpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE5Ljc5
IiB5PSIyMDMuNSIgZm9udC1zaXplPSIxMiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJ
nYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNsYXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPS
JzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2xpY2s9Inpvb20odGhpcykiPgo8dGl0bGU+Y
WxpYi93YXJfb2JqZWN0cy9haS9haV9uZXVyb24ubHVhOjUxOSAoOSw5NDggc2FtcGxlcywgMy43
MCUpPC90aXRsZT48cmVjdCB4PSIxNTE2LjkiIHk9IjI1NyIgd2lkdGg9Ijg4LjAiIGhlaWdodD0
iMTUuMCIgZmlsbD0icmdiKDI0NCwxMzcsMTIpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleH
QtYW5jaG9yPSIiIHg9IjE1MTkuOTQiIHk9IjI2Ny41IiBmb250LXNpemU9IjEyIiBmb250LWZhb
WlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5hbGliL3dhcl9vLi48L3RleHQ+Cjwv
Zz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImM
oKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvZWpveV90aW1lci5sdWE6Mj
YgKDI2OSwxNDIgc2FtcGxlcywgMTAwLjAwJSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjQwM
SIgd2lkdGg9IjIzODAuMCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjIzLDg1LDQ0KSIgcng9
IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxMy4wMCIgeT0iNDExLjUiIGZ
vbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiAgPm
x1YWxpYi9lam95X3RpbWVyLmx1YToyNjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvb
m1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMp
Ij4KPHRpdGxlPmFsaWIvd2FyX29iamVjdHMvYWkvYWlfbmV1cm9uLmx1YTo0ODkgKDE2OCwxMDg
gc2FtcGxlcywgNjIuNDYlKTwvdGl0bGU+PHJlY3QgeD0iMzAuNCIgeT0iMjczIiB3aWR0aD0iMT
Q4Ni41IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMjIsNjAsNTIpIiByeD0iMiIgcnk9IjIiI
C8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjMzLjM3IiB5PSIyODMuNSIgZm9udC1zaXplPSIx
MiIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+YWxpYi93YXJfb2J
qZWN0cy9haS9haV9uZXVyb24ubHVhOjQ4OTwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIi
Bvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoa
XMpIj4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfcm9sZS5sdWE6MTQ5NiAoMTIwIHNh
bXBsZXMsIDAuMDQlKTwvdGl0bGU+PHJlY3QgeD0iMTYwNS4xIiB5PSIyMDkiIHdpZHRoPSIxLjE
iIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIzMCwyMTQsMzcpIiByeD0iMiIgcnk9IjIiIC8+Cj
x0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MDguMTIiIHk9IjIxOS41IiBmb250LXNpemU9IjEyI
iBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4K
PGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSI
gb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5jX2Z1bmN0aW9uOjB4N2Y1NDEwMGU0NzY4IC
AgICAgKDc2OCBzYW1wbGVzLCAwLjI5JSk8L3RpdGxlPjxyZWN0IHg9IjEwLjAiIHk9IjExMyIgd
2lkdGg9IjYuOCIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjMxLDIxNyw1MykiIHJ4PSIyIiBy
eT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMTMuMDAiIHk9IjEyMy41IiBmb250LXN
pemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID48L3RleH
Q+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2Vvd
XQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdWFsaWIvd2FyX29iamVjdHMv
b2JqX2Jhc2UubHVhOjIzNSAoMTIwIHNhbXBsZXMsIDAuMDQlKTwvdGl0bGU+PHJlY3QgeD0iMTY
wNS4xIiB5PSIxNzciIHdpZHRoPSIxLjEiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIyMiwxMD
EsNDQpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MDguMTIiI
Hk9IjE4Ny41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdi
KDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InM
odGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5sdW
FsaWIvd2FyX3Jvb20vbWFwLmx1YToxMTU4ICg0OCBzYW1wbGVzLCAwLjAyJSk8L3RpdGxlPjxyZ
WN0IHg9IjIwNzQuOSIgeT0iMjI1IiB3aWR0aD0iMC40IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJn
YigyMTIsNTYsMjcpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjI
wNzcuODkiIHk9IjIzNS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm
lsbD0icmdiKDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZ
W92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0
aXRsZT5hbGliL3dhcl9vYmplY3RzL2FpL2FpX25ldXJvbi5sdWE6OTk0ICgzNyw0ODggc2FtcGx
lcywgMTMuOTMlKTwvdGl0bGU+PHJlY3QgeD0iMTYxMC43IiB5PSIyNTciIHdpZHRoPSIzMzEuNS
IgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjIwLDIwLDMxKSIgcng9IjIiIHJ5PSIyIiAvPgo8d
GV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxNjEzLjc0IiB5PSIyNjcuNSIgZm9udC1zaXplPSIxMiIg
Zm9udC1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+YWxpYi93YXJfb2JqZWN
0cy9haS9haV9uZXVyb24ubHVhOjk5NDwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm
1vdXNlb3Zlcj0icyh0aGlzKSIgb25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpI
j4KPHRpdGxlPmx1YWxpYi93YXJfb2JqZWN0cy9vYmpfYmFzZS5sdWE6MTAyICg3NDQgc2FtcGxl
cywgMC4yOCUpPC90aXRsZT48cmVjdCB4PSIxOTQyLjIiIHk9IjIyNSIgd2lkdGg9IjYuNiIgaGV
pZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjQyLDE5MCwxKSIgcng9IjIiIHJ5PSIyIiAvPgo8dGV4dC
B0ZXh0LWFuY2hvcj0iIiB4PSIxOTQ1LjI1IiB5PSIyMzUuNSIgZm9udC1zaXplPSIxMiIgZm9ud
C1mYW1pbHk9IlZlcmRhbmEiIGZpbGw9InJnYigwLDAsMCkiICA+PC90ZXh0Pgo8L2c+CjxnIGNs
YXNzPSJmdW5jX2ciIG9ubW91c2VvdmVyPSJzKHRoaXMpIiBvbm1vdXNlb3V0PSJjKCkiIG9uY2x
pY2s9Inpvb20odGhpcykiPgo8dGl0bGU+bHVhbGliL3dhcl9vYmplY3RzL21vdmVfY3RybC5sdW
E6NDMxICgyLDE2MCBzYW1wbGVzLCAwLjgwJSk8L3RpdGxlPjxyZWN0IHg9IjIwNTUuOCIgeT0iM
jU3IiB3aWR0aD0iMTkuMSIgaGVpZ2h0PSIxNS4wIiBmaWxsPSJyZ2IoMjMwLDEzNywyMCkiIHJ4
PSIyIiByeT0iMiIgLz4KPHRleHQgdGV4dC1hbmNob3I9IiIgeD0iMjA1OC43OSIgeT0iMjY3LjU
iIGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIi
AgPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb
25tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJf
cm9vbS9tYXAubHVhOjEyMzcgKDI0IHNhbXBsZXMsIDAuMDElKTwvdGl0bGU+PHJlY3QgeD0iMTY
wNC45IiB5PSIyMDkiIHdpZHRoPSIwLjIiIGhlaWdodD0iMTUuMCIgZmlsbD0icmdiKDIxNywxMD
AsMTgpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MDcuOTEiI
Hk9IjIxOS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdi
KDAsMCwwKSIgID48L3RleHQ+CjwvZz4KPGcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InM
odGhpcykiIG9ubW91c2VvdXQ9ImMoKSIgb25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5zZX
J2aWNlL3NjZW5lL3NjZW5lX2Jhc2UubHVhOjgyICgxMiwwOTYgc2FtcGxlcywgNC40OSUpPC90a
XRsZT48cmVjdCB4PSIxOTQ4LjgiIHk9IjEyOSIgd2lkdGg9IjEwNy4wIiBoZWlnaHQ9IjE1LjAi
IGZpbGw9InJnYigyNDAsNDMsMzUpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9
yPSIiIHg9IjE5NTEuODMiIHk9IjEzOS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVm
VyZGFuYSIgZmlsbD0icmdiKDAsMCwwKSIgID5zZXJ2aWNlL3NjZW5lLi48L3RleHQ+CjwvZz4KP
GcgY2xhc3M9ImZ1bmNfZyIgb25tb3VzZW92ZXI9InModGhpcykiIG9ubW91c2VvdXQ9ImMoKSIg
b25jbGljaz0iem9vbSh0aGlzKSI+Cjx0aXRsZT5hbGliL3dhcl9vYmplY3RzL2FpL2FpX25ldXJ
vbi5sdWE6MTgyNyAoNjcyIHNhbXBsZXMsIDAuMjUlKTwvdGl0bGU+PHJlY3QgeD0iMTYuOCIgeT
0iMjU3IiB3aWR0aD0iNS45IiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyMDUsMTc1LDI2KSIgc
ng9IjIiIHJ5PSIyIiAvPgo8dGV4dCB0ZXh0LWFuY2hvcj0iIiB4PSIxOS43OSIgeT0iMjY3LjUi
IGZvbnQtc2l6ZT0iMTIiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmaWxsPSJyZ2IoMCwwLDApIiA
gPjwvdGV4dD4KPC9nPgo8ZyBjbGFzcz0iZnVuY19nIiBvbm1vdXNlb3Zlcj0icyh0aGlzKSIgb2
5tb3VzZW91dD0iYygpIiBvbmNsaWNrPSJ6b29tKHRoaXMpIj4KPHRpdGxlPmx1YWxpYi93YXJfc
m9vbS9tYXAubHVhOjEyOTAgKDEyMCBzYW1wbGVzLCAwLjA0JSk8L3RpdGxlPjxyZWN0IHg9IjE2
MDUuMSIgeT0iMTYxIiB3aWR0aD0iMS4xIiBoZWlnaHQ9IjE1LjAiIGZpbGw9InJnYigyNDEsNDc
sMTkpIiByeD0iMiIgcnk9IjIiIC8+Cjx0ZXh0IHRleHQtYW5jaG9yPSIiIHg9IjE2MDguMTIiIH
k9IjE3MS41IiBmb250LXNpemU9IjEyIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZmlsbD0icmdiK
DAsMCwwKSIgID48L3RleHQ+CjwvZz4KPC9zdmc+" alt="" /></p>
<p>优化后栈的深度变浅了，剩下的基本是压测脚本跑的内容了。栈深度还能优化一下，到C函数的调用层次不宜过多。</p>
<p>&nbsp;</p>
<p>好了，睡觉了&hellip;&hellip;</p>]]></description></item><item><title>内存爆灯</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/08/27/out_of_memory.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 26 Aug 2018 17:34:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/08/27/out_of_memory.html</guid><description><![CDATA[<p>最近产品在韩国上线了，上线后的第一个周末，人数最多的一服内存爆了，被OOM杀掉宕机了，很郁闷</p>
<p>&nbsp;</p>
<p>机器用的4核16G，aws的实例。周四开服后，每天零点左右的在线人数峰值，内存都超过了80%的告警线。但是运营方不希望停机，于是采取了定时通过GM指令调用gc，15分钟回收一次内存，希望撑过峰值。到了周六晚，白天加班回到家，有点松懈了，就没再盯着内存曲线看，结果一不留神就爆了。。。峰值从78%飙升到91%，只用了7分钟，定时gc没赶上，就这样挂了</p>
<p>&nbsp;</p>
<p>按之前内网的压测结果，支撑3300人同时在线是没问题的。现在回头看，这个性能指标没有考虑到玩家获得大量武将、装备的情况。初级玩家3300人是没问题的，但是上升到一定级别的玩家，就不好说了。国服上线没有问题，是因为国服求稳，开服前先将内存升到32G，一周后再降配，外服直接上16G，是有点大意了。</p>
<p>&nbsp;</p>
<p>另一个是代码的问题。之前有几个服务用于缓存角色数据，避免重复从数据库里存取。后来分析了一下，这个缓存实在没什么用，玩家角色基本只会上线时自己读一次，以后写数据也是直写到数据库里的。还有一个比较意外的，是有个服务需要读玩家的基本角色信息，以及封禁信息。但是，当时写的同事大意了，直接将整个玩家数据查了出来，还缓存在服务里了。这两块优化了以后，实测内存降了几G&hellip;&hellip;</p>
<p><img src="https://images2018.cnblogs.com/blog/90397/201808/90397-20180827013240402-668165914.png" alt="" width="497" height="270" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>然后是GC的问题。Lua 5.3取消了分代GC，要等lua vm遍历完所有对象后，才开始释放。当对象的数量特别多的时候，gc就需要比较长的时间来mark完。另外，Lua的GC感觉比较惰性，看了下lvm.c的代码，在新建table、concat一个table、创建一个闭包的时候，才会跑一个step。至于跑多少个step可以完成一次完整的gc呢？不确定&hellip;&hellip;然后有两个服务，占用内存比较多，也没有显式的调gc，所以回收比较慢。</p>
<p>&nbsp;</p>
<p>除了GC，按<a href="https://github.com/cloudwu/skynet/issues/827" target="_blank">Skynet社区的经验贴</a>，jemalloc的参数也可以调优下，增加后台进程，积极回收没使用的内存。同时，释放的内存和分配后剩余的内存，都改成立即回收。</p>]]></description></item><item><title>时区问题</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/07/31/timezone_handling.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 30 Jul 2018 16:53:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/07/31/timezone_handling.html</guid><description><![CDATA[<p>最近，游戏要上国外运营了，搞完就算告一段落了&hellip;&hellip;放下种种不舍，搞好时区的问题，好好的送它一程吧</p>
<p>&nbsp;</p>
<p>受时区影响的问题主要分两类，一类是运营活动，一类是特殊玩法的开启。每天定时刷新的本来就有考虑时区，略过不表</p>
<p>&nbsp;</p>
<p>运营活动设计的时候已经考虑到时区，每个活动设计的时候，都需要填写活动开启的日期、时间及时区，这方面问题简化了很多。中间需要修改的，是偶尔有几个活动自作聪明，没有用库提供的日期计算函数，自己拿秒数来算。换上考虑时区的函数之后，就没有问题了。核心代码如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">local</span> TD = TIMEZONE * <span style="color: #800080;">3600</span>
<span style="color: #0000ff;">local</span> SECONDS_PER_DAY = <span style="color: #800080;">24</span> * <span style="color: #800080;">3600</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> date.count_day(t1, t2, reset_time)
    </span><span style="color: #0000ff;">if</span> t1 &gt; t2 <span style="color: #0000ff;">then</span><span style="color: #000000;">
        t1, t2 </span>=<span style="color: #000000;"> t2, t1
    </span><span style="color: #0000ff;">end</span><span style="color: #000000;">
    t1 </span>= t1 + TD -<span style="color: #000000;"> reset_time
    t2 </span>= t2 + TD -<span style="color: #000000;"> reset_time
    </span><span style="color: #0000ff;">local</span> day1 = t1 //<span style="color: #000000;"> SECONDS_PER_DAY
    </span><span style="color: #0000ff;">local</span> day2 = t2 //<span style="color: #000000;"> SECONDS_PER_DAY
    </span><span style="color: #0000ff;">return</span> <span style="color: #ff00ff;">math.floor</span>(day2 -<span style="color: #000000;"> day1)
</span><span style="color: #0000ff;">end</span></pre>
</div>
<p>&nbsp;</p>
<p>其他特殊玩法设计的时候没有让策划考虑时区的配置，而是一刀切，一切按导表的时区来。策划填的年月日-时分秒，最后导出的是一个UTC的时间戳，这个是按导表时机器所在的时区来转换的。因为同一个打包环境，要打出国内外的包，所以稍微需要做点修改。这里有个讨巧的办法，lua没有API可以取出系统时区，但是os.date通过传递不同参数，可以获得UTC时间和本地时间。这样就可以间接得到打包机的时区，再加上到目标时区的偏移就行了，核心代码如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">function</span><span style="color: #000000;"> get_timezone()
  </span><span style="color: #0000ff;">local</span> a=<span style="color: #ff00ff;">os.time</span><span style="color: #000000;">()
  </span><span style="color: #0000ff;">local</span> b=<span style="color: #ff00ff;">os.time</span>(<span style="color: #ff00ff;">os.date</span>(<span style="color: #800000;">"</span><span style="color: #800000;">!*t</span><span style="color: #800000;">"</span><span style="color: #000000;">))
  </span><span style="color: #0000ff;">return</span> ((a-b)/<span style="color: #800080;">3600</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">end</span></pre>
</div>
<p>&nbsp;</p>]]></description></item><item><title>与机器共生</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/06/23/living_with_robot.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 22 Jun 2018 16:17:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/06/23/living_with_robot.html</guid><description><![CDATA[<p>最近写代码比较少，干脆分享一点八卦，博诸君一笑:)</p>
<p>&nbsp;</p>
<p>几年前，在GitHub上建了几个golang的项目，主要是练手用的，也没几个人关注。最近几天，忽然几个仓库同时收到PR，<a href="https://github.com/spin6lock/go_mud/pull/4" target="_blank">类似这样的</a>，大意就是对仓库跑了下gofmt，其他别的都没干，请合并修改。然后在issue里写明了项目的地址，原来还是用golang写爬虫做的。自动用GitHub的API爬取golang的仓库，clone到本地，跑完gofmt后，看看有没有修改，有修改就提交PR。</p>
<p>&nbsp;</p>
<p>当时有点郁闷，仿佛多年黑历史被挖出来了:( 但是golang的规范就是建议用gofmt的，这样大家写的代码风格一致，不用再为风格吵架，节省时间，方便阅读。于是除了一个仓库外，其他都默默合并了。去爬虫仓库里看了一下，居然没有任何issue，看来还是新项目，立马给他<a href="https://github.com/rotblauer/gofmt-att/issues/1" target="_blank">贡献了第一个issue</a>。作者回复说会检查是否已经有PR了的，会考虑到open和close了的PR，不会反复提。还提到了爬虫里比较智能的地方，如果仓库里任何地方有提到 ROBOTS NOT WELCOME，或者NO ROBOTS，就会自动忽略掉，这些关键词可以商量，有新的建议可以加上，比如NOFMT。最后还教会了我一点小技巧，对于不想维护的仓库，可以放入只读模式，这样其他人就没法提PR和issue了。</p>
<p>&nbsp;</p>
<p>默默跟踪了一下这个项目，最近又多了一个issue。老外说话简单直接啊，标题就说你这个仓库不一定会受欢迎。具体是：1. 不同版本的gofmt格式会有细微变化，协作者之间不一定用相同的go版本，gofmt的结果不可靠。2. 你这是自动化操作的，都没有看过人家的代码，就可以刷GitHub的小绿点，夸大自己在GitHub的贡献。你这是虚伪 3. 我有些格式是golang代码规范允许的，你这个机器人给我改坏了。</p>
<p>&nbsp;</p>
<p>作者的回应也很精彩，建议大家读下原文。我简单总结一下：1. 你来这里发issue了，其他人也能找到这里来。我这个仓库就是提供一个讨论的空间，让不满和忧虑可以得到表达。我不开仓库，默默的用匿名账户提交，机器人跑完了事，才是虚伪。2. 我都是小批量的跑，跑完会人肉去跟进PR，跟普通人一样，签CLA（签名表明提交不涉及版权内容）、跟进代码覆盖和整理提交信息。3. 关于机器人，GitHub目前已经有很多机器人了，比如CLA机器人、安全检查机器人、格式检查机器人等等，既然仓库主人都用机器人管理了，那有人用机器人提交PR也很合理。</p>
<p>&nbsp;</p>
<p>回到标题，你说的对，没有办法可以令一个产品让所有人满意的。但是管理低质量提交是GitHub公开仓库管理者的日常啊，高质量的提交也不一定受欢迎，因为大家对架构、优先级、实现方式的构想也可能不同。具体到我这场实验，提出的155个PR中，关闭了55个，其中40个都合并了，成功率有72%，所以总体而言，我还是受欢迎的。农夫如果用机械作业，就不配得到他的粮食吗？为什么要歧视机器人呢？</p>
<p>&nbsp;</p>
<p>这次事件最大的触动是，以前会自己弄CI，搞个机器人检查代码覆盖，单元测试通过率，代码格式化等等。现在，即使你不搞，依然会有人用爬虫逐个逐个遍历GitHub的项目，帮你搞完，给你提PR。这一切还是自动化的，就好比你开源在GitHub了，就会有机器人&ldquo;鞭策&rdquo;你前进一样。学会与机器人共生变成越来越重要的技能了。另外，写作也是一个重要的技能，GitHub上通过issue互动，也是重要的贡献方式。代码是很重要，代码承载的思想同样重要，你必须要有能力传播你的观点，感化更多人与你一道参与，开源事业才会顺利</p>
<p>&nbsp;</p>]]></description></item><item><title>bug狩猎</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/06/20/bug_hunting.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 20 Jun 2018 09:43:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/06/20/bug_hunting.html</guid><description><![CDATA[<p>最近需求少了，终于有时间修一下底层的bug，做一点工具方便查bug，写篇文章简单记录一下。</p>
<p>&nbsp;</p>
<p>一是优化了一个玩法进程的启动速度。这个玩法需要用战力做匹配，玩家按战力分段放进不同的桶里，每个桶用skiplist组织。启动服务器的时候，会遍历所有玩家，放进对应的桶里，方便正式开放的时候进行搜索匹配。之前是遍历策划配置的战力分段表，高端玩家几乎要遍历完整个表才能进到桶里。现在改成了二分查找，匹配速度提高了好多</p>
<p>&nbsp;</p>
<p>二是隔壁组做mmo的同事，问了下有没有现成的查内存泄漏的工具。他们加班的比较凶，周六晚加完后，周一发现服务器被OOM Killer杀掉了。。。于是整合了一下云风的lua-snapshot，做到skynet里面，<a href="https://github.com/cloudwu/skynet/pull/848" target="_blank">提了个PR</a>。原理比较简单，第一次调用snapshot的时候，对VM的内存对象做一次镜像。做了某个可疑操作后，再调一次snapshot，前后镜像做比对。我对比较出来的对象按层次组织了一下，方便日志里打印。</p>
<p>&nbsp;</p>
<p>三是修复了gosproto的pack函数。这个bug相当诡异，会打出来一个客户端无法解包的sproto包。<a href="https://github.com/xjdrew/gosproto/pull/4" target="_blank">详情见github上的PR</a>，顺便读了下<a href="https://github.com/cloudwu/sproto#0-packing" target="_blank">sproto的pack的文档</a>，0xFF后面接的N是拷贝(N+1)*8 bytes的意思，之前理解错了。。 unpack应该还有问题，还在看。。。</p>]]></description></item><item><title>Lesson Learned</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/04/22/lesson_learned.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 21 Apr 2018 17:47:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/04/22/lesson_learned.html</guid><description><![CDATA[<p>最近，中兴ZTE违反美国商务部禁令，向伊朗出售敏感技术，被美国下达长达7年的禁止令，教训十分深刻。以诚待人，信守承诺，才能在商业社会站稳脚跟。</p>
<p>&nbsp;</p>
<p>还是说说最近自己上的一课吧。上了港台服以后，奇奇怪怪的问题比较多。其中之一是玩家被异常登录了。现象是玩家登录游戏，提示账号被异常登录。这种现象本来应该在玩家顶号操作时，被顶号的设备上出现的。不应该在正在登录的活跃客户端上显示</p>
<p>&nbsp;</p>
<p>回顾现在的登录过程，玩家连上游戏后，首先会创建一个session。登录完成后，会产生user挂在session上。最后，会找到对应的agent，在上面建立对应的role。当发生顶号的时候，会调用agent的下线流程，下线完成后，清理session。清理完成后，新玩家再执行正常登录流程</p>
<p>&nbsp;</p>
<p>现在的问题是，下线过程中，某一步变得比平常慢非常多，结果踢人卡住了。然后再次登录，又继续走踢人流程，结果变成新用户收到了错误的顶号提示信息。。。</p>
<p>&nbsp;</p>
<p>要彻底改掉这个问题，要么将顶号简化，变成只切换fd，不走下线流程；要么加上保护标记，玩家在下线过程里再登录，明确提示正在下线，请稍后再试。目前准备先上一些临时的解决方案，用gm指令清除已登录的标记，让玩家可以正常登，到时候覆盖之前下线存盘的数据就好。</p>
<p>&nbsp;</p>
<p>关于某一步登出特别慢的问题，想了一下，大概有两个方向，原因差不多。一个是离线过程里，agent服务要向其他服务发起调用，如果call比较多的话，会多次挂起。每次挂起后，收到返回值，都要重新排到消息队列末尾，如果系统繁忙，这时候需要处理的消息特别多，就会出现下线的函数耗时非常久了。另一个方向，是下线的时候，要向一个热门服务发起调用，这个服务的消息队列非常长，导致响应下线请求很慢。这两个问题都涉及到协程调度的公平问题，某些场景下，协程会出现饥饿（starvation）的情况，得不到调度。如果要搞分优先级的调度，估计会变得很麻烦，这块还要再想想</p>]]></description></item><item><title>下划线引起的血案</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/03/11/wsgi_header_filter.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 11 Mar 2018 15:13:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/03/11/wsgi_header_filter.html</guid><description><![CDATA[<p>最近公司搬迁，所有虚拟机都要重新部署，累死了。然后 Python 一堆依赖以前没管理好，直接装全局位置，也忘记导出一份版本号到新机器来安装。这是祸根&nbsp;</p>
<p>&nbsp;</p>
<p>换到新机器后，Skynet 和 Golang 相关应用都跑起来了。但是 Python 写的内部应用有点问题，网站认证后，认证用户名 valid_username 一直传不到应用里。检查过内部 Oauth 的代码，以及 Nginx 的转发配置，都没有问题。最终通过重放请求定位到是 Gevent 丢掉了这个参数。同事帮忙翻了下<a href="http://www.gevent.org/whatsnew_1_2.html" target="_blank">更新日志</a>，发现因为安全问题，带下划线的变量不再传递了，参考 <a href="https://github.com/gevent/gevent/issues/819" target="_blank">issue 819 </a>和 <a href="https://github.com/gevent/gevent/issues/775" target="_blank">issue 775</a></p>
<p>&nbsp;</p>
<p>819很简洁的引用了 waitress 库 以及<a href="https://www.djangoproject.com/weblog/2015/jan/13/security/" target="_blank"> Django，Apache 和 Nginx 的安全更新日志</a>。原来，这是一个下划线和破折号自动转换引起的 WSGI header 欺骗攻击。在 WSGI 环境下，所有 HTTP 请求头会全部转换为大写字母，所有破折号转换成下划线，并添加HTTP_ 前缀。例如，X-Auth-User 会转换成 HTTP_X_AUTH_USER</p>
<p>&nbsp;</p>
<p>这意味着，WSGI 环境无法区分带有破折号的请求头和带有下划线的请求头。比如，为了防止访客伪造请求，我写了过滤规则，将客户端发来的 X-Auth-User 变量都干掉。但是，对方有可能发的是 X-Auth_User，最后依然可以转化成 HTTP_X_AUTH_USER，从而绕过安全认证</p>
<p>&nbsp;</p>
<p>这个攻击是CVE-2015-0219，为了防止这种攻击，各大框架都加上了过滤下划线请求头的功能。内部应用还是用的带下划线请求头，所以触礁了。。。也就是说，以前的应用一直有安全漏洞，valid_username 请求头可能被伪造。当然，正常登录后，也是用 valid_username 来传递信息的，这个也要改掉，WSGI 不分敌我的干掉了。。。</p>
<p>&nbsp;</p>
<p>Golang 里还是照样可以使用下划线，因为 Golang 没有 WSGI 这货，天然就可以作为 Web 服务器跑起来。<a href="https://stackoverflow.com/questions/20771890/why-not-a-golang-wsgi-implementation" target="_blank">有篇爆栈的文章解释为什么 Golang 不需要 WSGI&nbsp;</a></p>]]></description></item><item><title>Intel的CPU漏洞：Spectre</title><link>http://www.cnblogs.com/Lifehacker/archive/2018/01/14/cpu_spectre.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 14 Jan 2018 10:13:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2018/01/14/cpu_spectre.html</guid><description><![CDATA[<p>最近觉得越来越忙，写博客都没精力了。一定是太沉迷农药和刷即刻了&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>17年年底，18年年初，Intel被爆出了Meltdown（熔断）和Spectre（幽灵）漏洞。等Spectre攻击的POC出来以后，<a href="https://github.com/Eugnis/spectre-attack" target="_blank">去github围观了一下</a>，真的非常精妙，好想贴上来分享一下。</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">void</span><span style="color: #000000;"> victim_function(size_t x)
{
    </span><span style="color: #0000ff;">if</span> (x &lt;<span style="color: #000000;"> array1_size)
    {
        temp </span>&amp;= array2[array1[x] * <span style="color: #800080;">512</span><span style="color: #000000;">];
    }
}</span></pre>
</div>
<p>主要代码就在Source.c里面，实际生效的不到100行，真的很精致。victim_function是用来越权访问的，看代码是没有问题的，x不符合条件，就不能访问到对应的内存。但是因为分支预测器的原因，即使没有满足if的条件，若分支预测器觉得条件会成立，还是会一边执行if的条件判断，一边执行if内的代码。当然，判断if失败后，会将if内代码执行的结果抛弃掉的。妙就妙在这里，结果会被回滚，但是cache不会。于是只要测度array2哪里访问的比较快，就知道密文是什么了。</p>
<p>&nbsp;</p>
<p>如何欺骗分支预测器呢？看这里：</p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000;">/*</span><span style="color: #008000;"> 30 loops: 5 training runs (x=training_x) per attack run (x=malicious_x) </span><span style="color: #008000;">*/</span><span style="color: #000000;">
        training_x </span>= tries %<span style="color: #000000;"> array1_size;
        </span><span style="color: #0000ff;">for</span> (j = <span style="color: #800080;">29</span>; j &gt;= <span style="color: #800080;">0</span>; j--<span style="color: #000000;">)
        {
            _mm_clflush(</span>&amp;<span style="color: #000000;">array1_size);
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">volatile</span> <span style="color: #0000ff;">int</span> z = <span style="color: #800080;">0</span>; z &lt; <span style="color: #800080;">100</span>; z++<span style="color: #000000;">)
            {
            } </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Delay (can also mfence) </span><span style="color: #008000;">*/</span>

            <span style="color: #008000;">/*</span><span style="color: #008000;"> Bit twiddling to set x=training_x if j%6!=0 or malicious_x if j%6==0 </span><span style="color: #008000;">*/</span>
            <span style="color: #008000;">/*</span><span style="color: #008000;"> Avoid jumps in case those tip off the branch predictor </span><span style="color: #008000;">*/</span><span style="color: #000000;">
            x </span>= ((j % <span style="color: #800080;">6</span>) - <span style="color: #800080;">1</span>) &amp; ~<span style="color: #800080;">0xFFFF</span>; <span style="color: #008000;">/*</span><span style="color: #008000;"> Set x=FFF.FF0000 if j%6==0, else x=0 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
            x </span>= (x | (x &gt;&gt; <span style="color: #800080;">16</span>)); <span style="color: #008000;">/*</span><span style="color: #008000;"> Set x=-1 if j%6=0, else x=0 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
            x </span>= training_x ^ (x &amp; (malicious_x ^<span style="color: #000000;"> training_x));

            </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Call the victim! </span><span style="color: #008000;">*/</span><span style="color: #000000;">
            victim_function(x);
        }</span></pre>
</div>
<p>跑5次满足if条件的调用，再跑一次不满足if条件的攻击。中间用位运算是为了避免额外的if语句会触动分支预测器。</p>
<p>测时间的逻辑在这：</p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000;">/*</span><span style="color: #008000;"> Time reads. Order is lightly mixed up to prevent stride prediction </span><span style="color: #008000;">*/</span>
        <span style="color: #0000ff;">for</span> (i = <span style="color: #800080;">0</span>; i &lt; <span style="color: #800080;">256</span>; i++<span style="color: #000000;">)
        {
            mix_i </span>= ((i * <span style="color: #800080;">167</span>) + <span style="color: #800080;">13</span>) &amp; <span style="color: #800080;">255</span><span style="color: #000000;">;
            addr </span>= &amp;array2[mix_i * <span style="color: #800080;">512</span><span style="color: #000000;">];
            time1 </span>= __rdtscp(&amp;junk); <span style="color: #008000;">/*</span><span style="color: #008000;"> READ TIMER </span><span style="color: #008000;">*/</span><span style="color: #000000;">
            junk </span>= *addr; <span style="color: #008000;">/*</span><span style="color: #008000;"> MEMORY ACCESS TO TIME </span><span style="color: #008000;">*/</span><span style="color: #000000;">
            time2 </span>= __rdtscp(&amp;junk) - time1; <span style="color: #008000;">/*</span><span style="color: #008000;"> READ TIMER &amp; COMPUTE ELAPSED TIME </span><span style="color: #008000;">*/</span>
            <span style="color: #0000ff;">if</span> (time2 &lt;= CACHE_HIT_THRESHOLD &amp;&amp; mix_i != array1[tries %<span style="color: #000000;"> array1_size])
                results[mix_i]</span>++; <span style="color: #008000;">/*</span><span style="color: #008000;"> cache hit - add +1 to score for this value </span><span style="color: #008000;">*/</span><span style="color: #000000;">
        }</span></pre>
</div>
<p>用到了<a href="http://www.felixcloutier.com/x86/RDTSCP.html" target="_blank">高精度的rdtscp</a>来计时，可以读入CPU计数器的读数。这里还硬编码了167和13进去，其实就是两个质数，目的就是让cache预读摸不着头脑，不会因为线性预读取干扰了测时。</p>
<p>&nbsp;</p>
<p>为了对抗Spectre攻击，<a href="https://support.google.com/faqs/answer/7625886" target="_blank">Google推出了Retpoline方法</a>，涉及到对可执行文件的二进制修改，还没看懂。。。</p>
<p>&nbsp;</p>]]></description></item><item><title>git和redmine同步</title><link>http://www.cnblogs.com/Lifehacker/archive/2017/11/25/git_push_to_redmine_issue.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 25 Nov 2017 14:24:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2017/11/25/git_push_to_redmine_issue.html</guid><description><![CDATA[<p>最近实现了github以及内部的gitbucket与redmine的同步。</p>
<p>&nbsp;</p>
<p>redmine是内部使用的一套工单系统，用于跟踪bug和需求，由于最近同时开发的版本比较多，在不同分支的提交容易漏掉。现在改为用redmine的工单跟踪需求和bug修复，提交的时候，只要在提交日志里写上单号，机器人就可以将提交信息同步到表单，可以方便的跟踪到提交有没有漏提交到指定分支。</p>
<p>&nbsp;</p>
<p>实现上居然很简单，整个过程还是很愉悦的。gitbucket方面比较简单，gitbucket的仓库属主可以添加一个hook，每次提交的时候gitbucket会调一下hook。调用里会包含提交的详细信息，包括分支、提交信息、具体改动的网页版地址。只要用正则搜出单号，然后利用redmine的rest api提交到表单里，就完成任务了。</p>
<p>&nbsp;</p>
<p>github的动手前觉得困难一点，因为github在外网，工单系统是内网访问的。没想到github体贴的推荐了ngrok作为安全的内网穿透工具。指定好协议和端口号之后，启动ngrok客户端，会自动随机生成一个https的二级域名。对这个域名的访问，会落到内网的ngrok客户端上。中间的通讯是加密的。这项服务这么优秀，居然还是免费的！比国内的花某壳好多了。</p>
<p>&nbsp;</p>
<p>打通内外网之后，剩下的步骤就和gitbucket的相差不多了。github的好处是每个人都可以对仓库设置自己的hook，还不止一个。遇到的小小的梗，是github的时间就是国内时区的，不像gitbucket还要从零时区算时间偏移。调试也很方便，每一次推送都可以在github上查阅到具体的请求内容，还能方便的redeliver，调到合适为止。</p>
<p>&nbsp;</p>
<p>以后可以在表单里写明需要提交到哪些分支，然后提交后隔一段时间自动检查，发现有漏提交就提醒程序或者策划，不过目前很懒，没有动力做这个QAQ</p>]]></description></item><item><title>syslog日志打印</title><link>http://www.cnblogs.com/Lifehacker/archive/2017/09/03/skynet_log_with_syslog.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 03 Sep 2017 03:00:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2017/09/03/skynet_log_with_syslog.html</guid><description><![CDATA[<div>最近syslog出了一次问题，我们配置了不同appname打印到不同文件。现在用不同appname打印log的时候，偶然会混在一起。检查过配置后，觉得不是配置问题，如果是配置问题应该每一条都会打错位置。后来同事发现是c接口线程不安全导致的。这里不是指syslog的libc接口线程不安全，是我们调用syslog的lua接口封装有问题。</div>
<div>&nbsp;</div>
<div>syslog是一个历史悠久的日志记录标准。一般的日志记录流程是这样的：内核会在内核空间，创建好一个ring buffer，然后调用printk函数在这个buffer里进行打印。用户空间的程序要访问这个buffer，可以通过两种方式读到，一个是/proc/kmsg，另一个是sys_syslog系统调用。</div>
<div>&nbsp;</div>
<div>内核ring buffer主要由两个程序读取：dmesg（1）和klogd（8），前者是供用户按需调用，查看内核信息，后者是从/proc/kmsg中自动读取（或者在/proc还没挂载的时候，调用sys_syslog接口读取），并转发到syslogd或者命令行，这是与内核相关的流程。</div>
<div>&nbsp;</div>
<div>用户空间的流程主要是由syslogd（8）来处理，它会监听一些unix domain socket，比如 /dev/log（具体路径可配置），或者UDP的514端口。同时也会从klogd（8）读取日志。然后，syslogd会把这些信息打印到/log，或者通过自己的UDP协议发送到远端。具体配置在<code>/etc/syslog.conf</code></div>
<div>&nbsp;</div>
<div>用户空间的程序会调用libc函数syslog（3）来进行打印。libc会将日志打到unix domain socket： /dev/log，并由syslogd(8)来读取。</div>
<div>&nbsp;</div>
<div>syslog(3)的接口主要用到的有openlog, syslog, closelog三个，分别是打开，关闭，和打印日志。openlog()先连接到系统logger，然后syslog接口打印日志。多线程的时候，openlog之后，还没有调syslog接口写日志，就切换到其他线程了。其他线程也调用了openlog和syslog来打印日志。切回来到原来的线程，再syslog的时候就会打印到错误的地方了。感觉openlog的接口设计也有点问题，一般是open完返回一个东西作为凭证。</div>
<div>&nbsp;</div>
<div>解决方法有三种，一种是skynet内新建一个服务，所有日志都打到这个服务，这个服务再打印日志，相当于利用skynet的消息队列做锁保护。另一种是调整syslog参数的priority，保证不同appname对应不同priority。最后一种是直接对这个函数加锁，保证线程安全。</div>
<div>&nbsp;</div>
<div>又及：libc的syslog接口，唯一做的就是新建，连接，写入，关闭udp socket，和自己直接做没有任何区别。对于过载，因为内核用的是ringbuffer，估计就直接覆盖前面的了。</div>]]></description></item><item><title>redis的LRU算法（一）</title><link>http://www.cnblogs.com/Lifehacker/archive/2017/07/31/redis_random_lru.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 31 Jul 2017 15:54:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2017/07/31/redis_random_lru.html</guid><description><![CDATA[<p>最近加班比较累，完全不想写作了。。</p>
<p>刚看到<a href="http://antirez.com/news/109" target="_blank">一篇有趣的文章</a>，是redis的作者antirez对redis的LRU算法的回顾。LRU算法是Least Recently Used的意思，将最近最少使用的资源丢掉。Redis经常被用作cache，如果能够将不常用的key移除，尽量保留常用的，那内存的利用率就相当高了。当然，LRU也有弱点，考虑下面一种情况：</p>
<div class="cnblogs_code">
<pre>~~~~~A~~~~~A~~~~~A~~~~A~~~~~A~~~~~A~~|
~~B~~B~~B~~B~~B~~B~~B~~B~~B~~B~~B~~B~|
~~~~~~~~~~C~~~~~~~~~C~~~~~~~~~C~~~~~~|
~~~~~D~~~~~~~~~~D~~~~~~~~~D~~~~~~~~~D|</pre>
</div>
<p>假设有4个key，A以5秒1次的频率被访问，B访问频率是2秒1次，C和D的访问频率都是10秒1次。因为B有最高的访问频率，所以B的空闲访问时间是最小的。它的上次访问时间也是第二最近的。但是D是一个特例，它的访问频率是10秒1次，但是它的访问时间是最近的。</p>
<p>&nbsp;</p>
<p>当然，长期来看，这个算法还是不错的。通常访问频率高的key都有相对比较小的空闲时间。LRU算法会换掉最近最少使用的key，即空闲时间最长的。这个算法实现起来非常简单，我们秩序要跟踪一个key上次访问的时间即可，甚至有时候都不用，只要维持一个链表，有访问的就移动到表头，需要换掉元素的时候，就移除链表尾部的。</p>
<p>&nbsp;</p>
<p>Redis最早并不支持LRU替换。通过修改Redis对象结构，作者挤出了24bit空间来做这个事情。因为指针太大，也没有空间来用链表实现。24bit用来存时间戳的低位已经足够了，可以支撑194天了，key的数据刷新频繁，够用了。</p>
<p>&nbsp;</p>
<p>如何选择最大空闲时间的key来换出也是一个问题，Redis的key存放在一个平坦的哈希表里，添加一个额外的数据结构来完成代价太大。既然LRU是理想换页的一个渐近算法，我们何不尝试下LRU的渐近算法呢？</p>
<p>&nbsp;</p>
<p>Redis的原始实现非常简单：当需要换出一个Key的时候，选任意3个key，，换出其中空闲时间最长的。相当于对整个key空间进行随机采样，并换出较好的选择。后来这个算法演变成N个随机key，算法优化后，默认变成采样5个key，速度没有损失。虽然实现是如此简单，但工作起来非常好。如果你仔细思考，你会发现你不可能用这个算法作出最佳决定，但是你也不大可能作出非常坏的决定。如果数据集里有一堆经常访问的key，5选1不大可能都挑中&ldquo;热&rdquo;的key。</p>
<p>&nbsp;</p>]]></description></item><item><title>skynet的网络收发</title><link>http://www.cnblogs.com/Lifehacker/archive/2017/07/02/skynet_network.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 02 Jul 2017 10:08:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2017/07/02/skynet_network.html</guid><description><![CDATA[<p>最近，有位前同事在skynet仓库里提了个<a href="https://github.com/cloudwu/skynet/issues/646" target="_blank">有关网络性能的issue</a>，正好理一下skynet的流程。</p>
<p>skynet启动的时候，会启动3个线程。1个负责monitor，监视是否有死循环的线程。1个负责timer，处理定时器事件。还有1个是处理socket io的，起了一个socket server。这是默认启动的，没包含worker线程。现在</p>]]></description></item><item><title>skynet的火焰图</title><link>http://www.cnblogs.com/Lifehacker/archive/2017/04/30/skynet_flamegraph.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 30 Apr 2017 15:45:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2017/04/30/skynet_flamegraph.html</guid><description><![CDATA[<p>之前搞过一下systemtap（<a href="http://www.cnblogs.com/Lifehacker/p/how_to_install_systemtap_on_centos.html" target="_blank">systemtap折腾笔记</a>），可惜很快琐事缠身，没有继续搞下去。最近偷空搞了一下，有点意思。</p>
<p>&nbsp;</p>
<p>章大大的思路，是用perl生成systemtap脚本，从/proc/$pid/maps里面扫出liblua.so的地址。然后hook这个地址里，以luaL_*和lua_*开头的lua虚拟机C函数。hook住的函数里，都会有个参数L，这个L表示lua的虚拟机。接下来就是按lua的C代码撸一遍，看看怎么从L的内存结构里，dump出整个lua的运行栈。相当于在systemtap里，重新实现一遍官方的debug.traceback。</p>
<p>&nbsp;</p>
<p>换到skynet里实现，有几个不同点。首先，skynet是把lua静态编译进去的，所以无法找到liblua.so。其实这样问题更简单了，不需要扫so的地址，只要hook住skynet里的相关函数，一样可以拿到L的地址。其次，是skynet用的是魔改版的lua，所以proto的位置与官方版有点不同，而且现在用的是lua53了，跟openresty的lua51比还是有差异的。我实现了一版给skynet用的lua-bt，参见skynet_systemtap_set仓库里的<a href="https://github.com/spin6lock/skynet_systemtap_set/blob/master/mini_lua_bt.stp" target="_blank">mini_lua_bt.stp</a></p>
<p>&nbsp;</p>
<p><img src="http://images2015.cnblogs.com/blog/90397/201705/90397-20170501175951914-1515293929.jpg" alt="" /></p>
<p>&nbsp;</p>
<p>做出来的效果就是上图这样。因为没有用户登录，所以只有一个exchange服务在跑。这个服务是用于和平台通讯的，所以会定时处理一些消息。</p>
<p>&nbsp;</p>
<p>目前还有点小问题，有时候同一个栈位置会打印两次，还没找到原因。另一个是目前打印的是文件名和行数，没有函数名直观。但是lua的函数其实只是一个指针，可以给这个指针绑定不同的名字，都是同一个函数，而且代码里还有大量的匿名函数，所以不好搞出来函数名。另外，从skynet的结构来说，其实可以找到更接近业务层的点。skynet底层是socket-server，然后用sn-lua跑lua服务，再用lua-skynet.c为lua服务提供skynet的接口。hook住lua-skynet的lcallback，应该就能看到skynet调lua业务的东西了。不过这个还没搞好&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>接下来再慢慢补充一下其他类型的脚本。。</p>]]></description></item><item><title>伤感三月</title><link>http://www.cnblogs.com/Lifehacker/archive/2017/03/31/fix_memory_leak.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 31 Mar 2017 15:58:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2017/03/31/fix_memory_leak.html</guid><description><![CDATA[<p>带着我经历过两个项目的boss离职了，好遗憾。老同事过来我们组帮忙了，算是一个小小的惊喜。</p>
<p>&nbsp;</p>
<p>最近看了《垃圾回收的算法与实现》，说实话，译者的水平比较有限，有几处明显的理解错误。不过，书里的插图还是很易懂的，看着伪代码和插图，勉强读了下来。读完会比较清醒的意识到，即使有gc帮助，还是有可能会有内存泄漏的。月中抽空压测了一下，的确发现了有泄漏。。</p>
<p>&nbsp;</p>
<p>我们用的脚本语言是Lua，Lua采用的是标记清除算法，从根出发，搜索不可达对象并回收掉。如果有泄漏，一定是有资源被某个地方引用住了，没有释放。从根里出发，会创建大量的role对象，但玩家下线的时候，明明已经释放对象了的。刚好新加了skynet task指令，发现task只增不减，才找到方向。原来从根出发，除了role对象，还有大量的协程对象。这些对象用于处理计时器、消息队列等设施。消息队列没有消息的时候会将当前协程放入等待队列，有消息再唤醒。而sub消息的handler，往往带有role对象，方便处理消息。玩家下线时，role字典里已经清空对应的role，但是还有沉睡的协程在引用，于是就有泄漏了。消息循环改为停止时唤醒所有睡眠协程，问题就解决了。或许我应该改成插入一个&ldquo;中断&rdquo;消息？</p>
<p>&nbsp;</p>
<p>一周6天的生活什么时候到头呢？&hellip;&hellip;好想放空自己&hellip;&hellip;</p>]]></description></item><item><title>加班月</title><link>http://www.cnblogs.com/Lifehacker/archive/2017/02/28/cloudflare_buffer_overflow_bug.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 28 Feb 2017 07:28:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2017/02/28/cloudflare_buffer_overflow_bug.html</guid><description><![CDATA[<p>本月都在埋头加班，没搞什么有趣的东西，就分享一篇Cloudflare捅的篓子吧XD</p>
<p>Google有个叫Project Zero的安全团队，成员Tavis Ormandy某天做一个语料库项目，突然发现Google缓存数据里出现了完整的https请求。排查发现这些请求都来自于Cloudflare。Cloudflare是业界闻名的CDN，通过DNS解释的原理工作，不需要修改页面的资源地址，而是将代理资源的域名，解释到靠近访客的Cloudflare服务器上，以此达到加速效果。Tavis怀疑这次事故跟Cloudflare的ScrapeShield产品有关。ScrapeShield是一个页面改写的产品，用来在网页里混入不可见的随机字符串，以跟踪爬虫的来源；对爬虫改写正文里的email，以防被批量爬Email地址发垃圾邮件。（参见Tavis Ormandy的<a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1139" target="_blank">报告</a>）</p>
<p>&nbsp;</p>
<p>Cloudflare接到报告后，用了47分钟关掉三个特性，7个小时后修复了漏洞。（<a href="https://blog.cloudflare.com/incident-report-on-memory-leak-caused-by-cloudflare-parser-bug/" target="_blank">参见Cloudflare的报告</a>）报告非常长，我这里简单说一下。Cloudflare使用了Ragel来处理html改写的任务，Ragel通过一般的正则表达式描述有限状态机，并将其编译成C代码执行。因业务发展，Cloudflare决定用新的cf-html来取代Ragel。Ragel和cf-html最终都是生成nginx的C代码模块，编译到nginx里面去。基于Ragel的分词器就有这个bug，换cf-html潜在改变了buffer的用法，引发了泄漏。罪魁祸首是以下这段代码：</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">/*</span><span style="color: #008000;"> generated code </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">if</span> ( ++p ==<span style="color: #000000;"> pe )
    </span><span style="color: #0000ff;">goto</span> _test_eof;</pre>
</div>
<p>因为在某些情形下，p有可能越过pe，导致了内存越界读取。生成这段C代码的Ragel代码如下：</p>
<div class="cnblogs_code">
<pre>script_consume_attr := ((unquoted_attr_char)* :&gt;&gt; (space|<span style="color: #800000;">'</span><span style="color: #800000;">/</span><span style="color: #800000;">'</span>|<span style="color: #800000;">'</span><span style="color: #800000;">&gt;</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span>&gt;{ ddctx(<span style="color: #800000;">"</span><span style="color: #800000;">script consume_attr</span><span style="color: #800000;">"</span><span style="color: #000000;">); }
@{ fhold; fgoto script_tag_parse; }
$lerr{ dd(</span><span style="color: #800000;">"</span><span style="color: #800000;">script consume_attr failed</span><span style="color: #800000;">"</span><span style="color: #000000;">);
       fgoto script_consume_attr; };</span></pre>
</div>
<p>&nbsp;如果匹配成功，执行@{}的内容，如果是残缺的&lt;script标签，则会执行$lerr{}的内容。比较一下两个分支，错误代码的分支少了一个fhold（fhold会生成p--)。所以p会错误停留在导致出错的字符上。如果出错的标签处在缓存的尾部，那么p已经指向了pe+1，++p == pe 总是为假，导致了缓冲区溢出。（所以不要用C来搞web ;)）</p>
<p>&nbsp;</p>
<p>有意思的是，Cloudflare在正文里提示用++p &gt;= pe就可以避免这个错误，但强调这个不是Ragel的问题（即使这句代码是Ragel生成的）。Ragel的作者则在<a href="https://blog.cloudflare.com/incident-report-on-memory-leak-caused-by-cloudflare-parser-bug/#comment-3172484963" target="_blank">评论吐槽说</a>，Cloudflare的报告毁掉了他的生意。而Google的大牛则花了整个周末帮忙清理Google的cache，验证Cloudflare的漏洞是否已堵上，顺便发现了一款流行密码管理器明文传输密码（1password已否认，剩下的Lastpass、Enpass不知道会不会表态呢？）随后，Ragel的作者写了<a href="http://www.colm.net/news/2017/02/28/changes-to-ragel-cloudflare.html" target="_blank">一篇文章</a>，解释了Ragel的正确用法。</p>
<p>&nbsp;</p>
<p>Ragel是一门描述状态机的语言，fgoto语句用于跳转到状态机中的其他子状态。Ragel允许用户定义Action，在各种情形下执行。Error Action是正常处理流程无法继续时执行的Action。它们一般在两种情形下执行：1. 错误发生在当前字符 2. 状态还没到达最终状态，而输入已经结束。如果错误发生在情形1，是否fhold来回退指针无关紧要。但是情形2里，因为输入已经结束，这时候必须回退。现有的Ragel代码需要检查自己对情形2的处理。</p>]]></description></item><item><title>the evolution of Lua 全文翻译</title><link>http://www.cnblogs.com/Lifehacker/archive/2017/01/25/finish_translation_of_the_paper.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 25 Jan 2017 11:25:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2017/01/25/finish_translation_of_the_paper.html</guid><description><![CDATA[<p>终于赶在春节前将论文全文翻译完，以后有时间将前面三章重新翻译一次，因为刚开始的时候没打算全文翻译的。。第一次每天花25分钟完成这么长的一篇翻译，证明滴水可以穿石，哈哈哈</p>
<p>中文地址：<a href="https://github.com/spin6lock/the_evolution_of_lua_zh_CN/blob/master/the_evolution_of_lua.md" target="_blank">Lua的演进</a></p>
<p>祝各位新春快乐，鸡年大吉，恭喜恭喜</p>]]></description></item><item><title>2016年终总结</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/12/31/2016_year_review.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 31 Dec 2016 04:30:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/12/31/2016_year_review.html</guid><description><![CDATA[<p>今年写了14篇博客，比去年的18篇要少，没有什么新技术，有点遗憾。倒是读了几篇好文章，比如Linkedin团队分享的The Log，还有The evolution of Lua。看了一下去年的<a href="http://www.cnblogs.com/Lifehacker/p/2015_summary.html" target="_blank">年终总结</a>，发现目标基本都没完成｡ﾟヽ(ﾟ&acute;Д`)ﾉﾟ｡ 只有坚持博客这点算是完成了。关于TCP/IP协议，其实很想就Google家的BBR写一篇短文，等下试试。建站这点完全提不起动力，买了域名和VPS之后，就搭了个Google网页代理就算了。。</p>
<p>&nbsp;</p>
<p>2016是第一次感觉到年纪大的一年。渐渐感觉到反应变慢了，特别是和别人讨论的时候，但是一旦理清了需求，就比以往更清晰的看到问题所在，更快找到解决办法。真是好坏参半的变化呢。</p>
<p>&nbsp;</p>
<p>今年相比去年的进步之处，在于实现了更好的知识管理和时间管理。知识管理上，更频繁的利用印象笔记了，将值得收藏的文章放入笔记里，可以不受网络限制，随时随地阅读。还有大量的写作工作日志，特别是服务器部署相关的，下次部署就方便多了。（其实做fabfile更好，可惜虚拟机每次都不一样。。。）每天写日志，每周写周结，每月写月结，这样才好写年结。另外，总结可以迫使自己进行回顾，从而做出时间跨度更大的思考，以完成更宏大的目标。时间管理上，除了继续坚持使用番茄工作法管理注意力，还使用了moment监控手机使用时间，sleepbot来监控睡眠时间（后来转了autosleep）。atimelogger2不错，只是我需要的是标签云，而不是有严格归属的类目录结构。</p>
<p>&nbsp;</p>
<p>2017年的展望比较简单，能够继续坚持自己的sideproject就好。最近的sideproject是智能家居，有点好玩O(&cap;_&cap;)O 年度具体目标不好定，先定三个试试：1、 游戏成功上线 2、 看完Google BBR，掌握TCP优化技巧 3、翻译完The evolution of Lua，掌握Lua实用技巧</p>
<p>&nbsp;</p>]]></description></item><item><title>《The Evolution of Lua》翻译part 2</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/11/28/translation_of_the_evolution_of_lua.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 28 Nov 2016 08:23:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/11/28/translation_of_the_evolution_of_lua.html</guid><description><![CDATA[<p><!--?xml version="1.0" encoding="UTF-8"?--></p>
<div>Lua2</div>
<div>1990年的时候，面向对象迈向巅峰，对于Lua没有面向对象的支持，我们受到了很大的压力。我们不想将Lua变成面向对象，因为我们不想&ldquo;修复&rdquo;一种编程范式（fix a programming paradigm）。特别是，我们不觉得Lua需要将对象和类作为基础语言概念，我们觉得可以透过table来实现（table可以保存方法和数据，因为函数是第一类对象）。直到今天，Lua也没有强加任何对象和类模型给用户，我们初心不变。很多用户建议和实现了面向对象模型；面向对象也是邮件列表里经常讨论的问题，我们觉得这是健康的。</div>
<div>&nbsp;</div>
<div>另一方面，我们希望允许Lua可以面向对象编程。我们决定提供一套灵活的机制，让用户可以选择对应用来说合适的模型，而不是修复模型。1995年2月发布的Lua2.1，标志着这些灵活语义的问世，极大的增加了Lua的表达能力，从此，灵活语义就变成了Lua的标志。</div>
<div>&nbsp;</div>
<div>灵活语义的一个目标是允许table作为对象和类的基础。为了实现这个目标，我们需要实现table的继承。另一个目标是将userdata变成应用数据的天然代理，可以作为函数参数而不只是一个句柄。我们希望能够索引userdata，就好像他们只是一个table，可供调用他们身上的方法。这让Lua可以更为自然的实现自己的主要设计目标：通过提供脚本访问到应用服务和数据，从而扩展应用。我们决定实现一套fallback机制，让Lua把未定义行为交给程序员处理，而不是直接在语言本身实现这些特性。</div>
<div>&nbsp;</div>
<div>在Lua2.1的时候，我们提供了fallback机制，支持以下行为：table索引，算术操作符，字符串拼接，顺序比较，函数调用。当这些操作应用到&ldquo;错误&rdquo;的类型上，对应的fallback就会被调用到，允许程序员决定Lua如何处理。table索引fallback允许userdata和其它值类型表现的跟表一样。我们也定义了当Key不在table时的fallback，从而实现多种形式的继承（通过委托）。为了完善面向对象编程，我们添加了两个语法糖：function a:foo(&hellip;)就好比function a.foo(self,&hellip;)一样，以及a:foo(&hellip;)作为a.foo(a, &hellip;)的语法糖。在6.8节我们会讨论fallback的细节。</div>
<div>&nbsp;</div>
<div>从Lua1.0开始，我们就提供了值类型的内省函数（introspective functions）：type，可以用来获取Lua值的类型；next，可以用来遍历一个table；以及nextvar，可以遍历全局环境。（正如第四章所述，这是为了实现类似SOL的类型检查）为了应付用户对完整调试设施的强烈需求，1995年12月发布的Lua2.2引入了一个debug API来获取运行中的函数信息。这个API为用户提供了以C语言编写自己的内省函数工具链的手段，比如编写自己的调试器和性能分析工具。debug API刚开始的时候相当简洁：debug库允许访问Lua的调用栈，访问当前执行的代码行行数，以及一个可以查找指定值的变量名的函数。根据M.Sc.的Tomas Gorham的工作，debug API在1996年5月发布的Lua2.4版本里得到了完善，提供了函数访问局部变量，提供了钩子在行数变化和函数调用时触发。</div>
<div>&nbsp;</div>
<div>因为Lua在Tecgraf的广泛使用，很多大型的图形源文件都是用Lua写的，作为图形编辑器的输出格式。加载这些源文件会随着文件大小变得越来越大和越来越复杂而变的越来越长。从第一版开始，Lua就预编译所有程序到字节码，再执行字节码。大型代码文件的加载时间可以通过保存bytecode来缩减。这和处理图形源文件特别有关系。所以在Lua 2.4版本，我们引入了一个外部编译器Luac，可以编译一个Lua文件为字节码并保存为二进制文件。这个二进制文件的格式经过精心选择，可以轻松加载同时体积小巧。通过luac，程序员可以在运行期避免词法分析和代码生成，这些操作早期还是比较耗时的。除了更快的加载，luac还允许离线的语法检查，以及随意的用户改动。很多产品（比如模拟人生和Adobe的Lightroom）都是透过预编译格式发布Lua脚本的。</div>
<div>&nbsp;</div>
<div>在luac的实现过程里，我们开始将Lua的核心重构成清晰的分离模块。于是，我们现在可以轻易移除词法解析的模块（词法解析器，语法解析器和代码生成器），这些部分占了大约35%的核心代码，剩下的部分可以加载预编译的Lua脚本。这种代码剪裁，对于在移动设备、机器人和感应器这些小设备里嵌入Lua，是有显著意义的。</div>
<div>&nbsp;</div>
<div>从第一版开始，Lua就自带有一个库来进行字符串处理。这个库在Lua2.4之前功能有限。但是，随着Lua的成熟，Lua需要进行更重量级的字符串处理。我们认为，沿革Snobol，Icon，Awk和Perl的传统，为Lua添加模式匹配是自然而然的。但是，我们不想将第三方的模式匹配引擎打包到Lua里面去，因为这些引擎通常都很大，我们也希望避开因为引入第三方库带来的代码版权问题。</div>
<div>&nbsp;</div>
<div>1995年的第二学期，作为Roberto指导下的学生项目，Milton Jonathan，Pedro Miller Rabinovitch，Pedro Willemsens和Vinicius Almendra为Lua写出了一个模式匹配库。那个设计的经验引导我们写出了我们自己的模式匹配引擎。1996年的12月，我们在Lua2.5中添加了两个函数：strfind（最早职能查找纯文本）和新的gsub函数（名字来源于Awk）。gsub函数可以用来全局替换符合指定模式的子串。它接受一个新的字符串或者一个函数作为参数，函数参数会在每次遇到匹配时调用，并预期该函数返回新子串以供替换。为了缩小实现的规模，我们没有支持完整的正则表达式。我们支持的模式包括字符类，重复，以及捕获（但是没有可选或组匹配）除了简洁性，这种模式匹配还十分强大，是Lua的一个强有力的补充。</div>
<div>&nbsp;</div>
<div>那一年是Lua历史上的转折点，因为Lua获得了全球的曝光。在1996年6月，我们在《Software：Practice &amp; Experience》杂志上发布了一篇Lua的文章，为Lua带来了外部的关注，至少是学术圈子的关注。在1996年的12月，Lua 2.5刚刚发布后，杂志Dr.Dobb&rsquo;s Journal也发表了Lua的文章。Dr.Dobb&rsquo;s Journal是一本面向程序员的流行刊物，那篇文章为Lua带去了软件工业界的关注。在那次发布之后，我们收到了很多消息，其中一条是1997年1月收到的，来自Bret Mogilefsky，LucasArts出品的冒险游戏&mdash;&mdash;Grim Fandango的首席程序员。Bret告诉我们，他从Dr.Dobb&rsquo;s上读到了Lua，他们打算用Lua代替自己写的脚本语言。1998年10月，Grim Fandango发布，1999年5月Bret告诉我们&ldquo;大量的游戏都是用Lua写的&rdquo;。那个时候，Bret参加了GDC（Game Developers&rsquo; Conference, 游戏开发者会议）的有关游戏脚本的圆桌会议。他谈到了Grim Fandango应用Lua的成功经验。很多我们认识的开发者，都是在那次事件里认识到Lua的。在那以后，Lua在游戏程序员之间口耳相传，变成了游戏工业里可资销售的技能。</div>
<div>&nbsp;</div>
<div>因为Lua的国际化曝光，向我们提问Lua的信息越来越多。1997年2月，我们建立了邮件列表，好更有效率的处理这些问题，让其他人也能帮忙回答问题，并开始建设Lua社区。这个列表至今发布了超过38000条消息。很多热门游戏对Lua的使用，吸引了很多人到邮件列表里。现在已经有超过1200个订阅者了。Lua列表十分友善，同时又富有技术性，我们对此深感幸运。邮件列表逐渐变成了Lua社区的焦点所在，也是Lua演进的动力源泉。所有的重大事件，都是首先在邮件列表里出现的：发布重大通知，请求新特性，bug报告等等。</div>
<div>&nbsp;</div>
<div>在Usenet新闻组里建立comp.lang.lua讨论组曾经在邮件列表里讨论过两次，分别是1998年的4月和1999年的7月。两次的结论都是邮件列表的流量不能保证创建一个新闻组。而且，更多人倾向于邮件列表。随着多个阅读和搜索完整邮件存档的web界面问世，创建新闻组变得无关紧要了。&nbsp;</div>]]></description></item><item><title>《The Evolution of Lua》读书笔记 1</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/10/30/notes_of_the_evolution_of_lua.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 30 Oct 2016 07:27:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/10/30/notes_of_the_evolution_of_lua.html</guid><description><![CDATA[<div>lua的优点：</div>
<ul>
<li>可移植性</li>
<li>容易嵌入</li>
<li>体积小</li>
<li>高效率</li>
</ul>
<div>这些优点都来自于lua的设计目标：简洁。从Scheme获得了很多灵感，包括匿名函数，合理的语义域概念</div>
<div>&nbsp;</div>
<div>
<div>lua前身：</div>
<div>巴西被禁运，引入计算机软件和硬件受限，巴西人有强烈的民族情绪去创造自己的软件。三名作者都是同一个实验室Tecgraf的，这个实验室与很多工业实体有合作关系。成立的头十年，重点是创造交互性的图形软件，帮助合作伙伴进行设计。巴西石油公司是其中一个重要伙伴。有大量的遗留数据需要处理。于是诞生了DEL，一个领域专用语言，主要用来描述数据流图的数据的。后来人们对DEL需求越来越多，不止是一门简单的数据描述语言可以解决的了。</div>
<div>&nbsp;</div>
<div>
<div>lua为解决实际问题而生，受到三位作者学过的语言影响。自己创造的是..（两个句号）连接字符串。自豪的是，在13年的演进里，lua的类型系统只修改了两次。lua诞生的时候，基本类型包括nil，number，string，table，C function，Lua function，userdata。97年的时候，Lua3.0将C function和Lua function合并了。03年的时候，提出了boolean值类型，增加了thread协程类型。</div>
<div>&nbsp;</div>
<div>1993年，第一版Lua由Waldemar在Roberto指导下完成。词法分析用了Unix上经典的yacc和lex。解释器将lua代码翻译成针对一个基于栈的虚拟机的指令。C API很容易扩展，因此最早只有5个函数（print,tonumber,type,next,nextvar）和3个库（input/output, string, math)。</div>
<div>&nbsp;</div>
<div>
<div>Lua的历史</div>
<div><img src="file:///C:/Users/Dell/AppData/Local/Temp/enhtmlclip/Image.png" alt="" /></div>
<div>lua的发布模式和其他社区不一样。alpha版本已经相当稳定，beta版本几乎可以作为final版，除非是用来修复bug。这个发布模式对于lua的稳定性有很大帮助，但不利于尝试新特性。因此，从5.0版本开始，添加了新的work版本。work版本是lua当前开发版的snapshot，有助于lua社区迈向开源社区的哲学：早发布、多发布。</div>
<div>&nbsp;</div>
<div>lua的标准库被刻意保持在一个很小的范围，因为大部分需要的功能都会由宿主或第三方库提供。4.0对C API重新设计了，C API有很大改动，之后就向着完美一点点前进了。结果是不再有任何内置函数，所有标准库都是基于C API实现，没有通过特别的后门去访问Lua内部结构。</div>
<div>&nbsp;</div>
<div>Lua的vm在4.0版本以前一直是基于栈的。在3.1版本，我们对多个指令添加了变量来提高性能。后来发现这个实现复杂度很高，性能提升不明显，于是在Lua 3.2版本去掉了。从Lua 5.0开始，vm改为基于寄存器。代码生成器因此有更多机会去优化和减少常见Lua程序的指令数了。</div>
<div>&nbsp;</div>
<div>Lua1</div>
<div>Lua的成功使得Lua被大规模用在数据描述上，而预编译Lua代码为VM字节码的特性，迫使Lua编译器必须非常快，即使是对于大型项目。通过将lex产生的scanner替换为一个手写的版本，我们几乎让Lua编译器的速度翻了一倍。同时，我们修改了Lua VM的table构造函数，构造一个大型的表不再需要一条条指令传参数进去了，可以一次调用完成。从那以后，优化重点就变成了预编译时间。</div>
<div>&nbsp;</div>
<div>1994年，我们发布了带有这些优化的lua版本：Lua1.1。这次发布和第一篇描述Lua的设计和实现的文章是重合的。之前从未公开发布过的版本，就被称为Lua 1.0（Lua1.0的一个1993年7月的snapshot在2003年10月发布，以此庆祝Lua十周年）</div>
<div>&nbsp;</div>
<div>Lua 1.1最早以源码方式在ftp提供下载。这远在开源运动兴盛蓬勃之前。Lua1.1有限制性的用户协议，对于学术用途是免费的，但是商业用途则需要协商。那部分协议没有凑效：尽管我们有一些初始联系人，从没有商业使用是经过协商的。其它脚本语言（比如Tcl）的免费促使我们意识到，限制商用甚至会反过来影响学术用途的发展，因为一些学术项目是打算最终走向市场的。因此，当发布Lua2.1的时候，我们将Lua作为无限制免费软件发布了。我们天真的以一种学院气的口吻对之前的协议重新措辞，并觉得新协议写的很直观了。稍后，随着开源许可证的散播，我们的协议文本变成了干扰着一些用户的噪音：我们的协议没有清晰的说明是否和GPL协议相容。在2002年5月，在邮件列表里进行了冗长的讨论后，我们决定将来发布的Lua版本（从Lua 5.0开始）都使用非常清晰直观的MIT协议。2002年7月，自由软件基金会（FSF）确认了我们之前的协议是GPL兼容的。但我们已经决定采纳MIT协议了。对我们协议的疑问从此都消失了。</div>
</div>
</div>
</div>]]></description></item><item><title>《一个 Go 程序系统线程暴涨的问题》结论</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/09/18/tcp_user_timeout.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 18 Sep 2016 12:39:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/09/18/tcp_user_timeout.html</guid><description><![CDATA[<p>原文地址：https://zhuanlan.zhihu.com/p/22474724</p>
<p>作者的结论没写好，我来说两句。。</p>
<p>&nbsp;</p>
<div>结论：</div>
<div>Docker swarm自己有个函数，叫setTcpUserTimeout，这个函数调用了conn.File()方法，将tcp的fd变成了blocking，而且没有关闭对应的fd。相当于每次设定tcpUserTimeout参数，再去read一下fd，都会产生一个新的线程。因为老的线程在读fd，而fd被设置成blocking了，于是golang的运行时只好再开一个新的。</div>
<div>解决方法：</div>
<div>不要用swarm的这个方法，或者提交到上游让swarm fixed掉，或者自己调用SetsockoptInt&hellip;&hellip;</div>
<div>&nbsp;</div>
<div>好奇八卦了一下TCP_USER_TIMEOUT是什么：根据RFC 5482，这个选项是用来跟对端沟通TCP超时时间的。顺带看了一下，有关TCP超时的RFC还包括：<a class="info" href="https://www.gont.com.ar/drafts/tcp-user-timeout-option/draft-ietf-tcpm-tcp-uto-03.html#RFC0793">[RFC0793]</a>&nbsp;&nbsp;<a class="info" href="https://www.gont.com.ar/drafts/tcp-user-timeout-option/draft-ietf-tcpm-tcp-uto-03.html#RFC1122">[RFC1122]</a>。之前，TCP有类似的超时选项TCP Keepalive。但是，TCP Keepalive是一个不建议打开的选项。因为委员会觉得这样会浪费带宽，引起不必要的网络中断。说白了，TCP是一组计时器组成的状态机，设计者是希望中间的电路中断、重新路由之类的变动，不会影响到两端的TCP状态。</div>
<div>&nbsp;</div>
<div>在游戏开发这块，一般都会做心跳机制。目的是为了让服务器的资源尽早释放，以支撑更多玩家。TCP Keepalive和上述的TCP_USER_TIMEOUT，勉强能完成任务。但是，不是所有平台都支持keepalive，所以只好放在应用层来做。目前用的心跳包是30秒一个的。太频繁的心跳，只会浪费流量，没有意义。同时，不断发送小数据包，会让手机的芯片持续处于高功率状态，游戏变得更加耗电。如果游戏本身能允许一定时间内的不一致，网络部分就能够更加灵活了。</div>
<div>&nbsp;</div>
<div>比如有玩家在地铁里进行游戏，列车行驶在站与站之间的时候，网络信号是非常弱的。如果能够将协议都变成异步的，游戏不需要等待上一条协议结果，就能继续进行。那么就可以定时上传操作日志，甚至可以模仿安卓的doze机制，发送超时就先睡眠一下，过一段时间再尝试。这样对电池的使用会更加友好，对地铁信号的适应性也会增强。只是游戏需要制定一个硬性同步的点，到了这个点一定要将所有日志同步到服务器，不然就暂时禁止玩家操作，直到同步成功为止。这个点处理的好，体验会提升不少。</div>
<div>&nbsp;</div>
<div>&nbsp;</div>]]></description></item><item><title>空中换心</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/09/03/reconstruct_server_architecture.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 03 Sep 2016 14:52:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/09/03/reconstruct_server_architecture.html</guid><description><![CDATA[<p>最近一周在做一件非常刺激的事情，刺激到不想再干第二遍了T_T。。。还有一个月就要内测的时候，换掉服务器架构，而且还要同时做需求，无异于对空中的飞机换引擎啊</p>
<p>&nbsp;</p>
<p>8月末的时候，老大开了个会，服务器架构要重构一下，将以前的逻辑分服改成物理分服。之前的架构里，开新服很简单，但因为是大服结构，任何一个逻辑服挂了，都会影响其他服的玩家，隔离性不够高。同时，做单服的服务时，处理逻辑需要考虑不同服的影响，添加了额外的心智负担，不容易做对。于是，架构决定改成这样：</p>
<p>&nbsp;</p>
<p><img src="https://camo.githubusercontent.com/c5bc3ab9a32fe00807e57fef0b0791afa70a5857/687474703a2f2f672e67726176697a6f2e636f6d2f673f253041253230253230646967726170682532304725323025374225304125323025323025323072616e6b6469723d524c3b25304125323025323025323025323267616d65312532322d2533452532326c6f67696e2f73686172655f67616d6525323225304125323025323025323025323267616d65322532322d2533452532326c6f67696e2f73686172655f67616d6525323225304125323025323025323025323267616d65332532322d2533452532326c6f67696e2f73686172655f67616d65253232253041253230253230253230253232636c69656e742532322d25334525323267616d6531253232253041253230253230253744" alt="share_game指跨服玩法，game1，game2...指游戏服，login所在的是center服" width="509" height="211" /></p>
<p>&nbsp;</p>
<p>每个game是一个进程，这样任意game挂掉都不会影响其他服务器了，适合策划们大量开新服，每周清理关停老服的洗量玩法。设计的时候，希望各个进程之间是松散的结合到一起的，甚至center都没有直接call到game的接口。取而代之的，是一个消息队列。game上线之后，就在center上创建一个消息队列，center需要发消息给game，就丢一个消息到队列里。最终的目标是，center即使短暂挂掉，也能快速重启，只造成短时间新玩家无法登录，已经登录游戏的玩家应该能继续游戏。同时，center的结构足够简单，几乎不会挂掉。</p>
<p>&nbsp;</p>
<p>上周老大和另外一位同事做了一周，这周就决定切换到新架构来了。因为我的工作主要是写逻辑，基本都是在玩家身上，挂在agent上的玩法，所以改动的地方不多，修好聊天和邮箱服务即可。于是，一边消化策划的新需求，一边参与迁移新架构。实际结果喜忧参半，喜的是新写的逻辑因为都在agent上，可以完全复用；忧的是时间非常紧迫，然后还要处理一些迁移架构带来的bug。幸而最后还是活过来了XD</p>
<p>&nbsp;</p>
<p>关于这次架构的变动，也跟其他组的同事讨论过，不过被吐槽说跟skynet的master-slave架构没什么区别^_^ 回来仔细想了一下，感觉还是可以辩护一下的。第一点，之前用的master-slave，没有指定slave具体负责的逻辑服id，每个slave都是相同的，都有可能被不同服的客户端连上。当然，这个问题可以改掉，改成跟现在架构类似的。第二点，之前的master挂掉之后，slave虽然不会马上挂掉，但是公会之类的服务是放在特殊的slave上的，也会立即失效，而新架构都在一个进程内，还能继续工作。归根结底，是因为master-slave被认为是一个稳定的整体，skynet不会处理内部的网络连接断开的。如果换成cluster，用消息队列来连接，相对来说容错性就更高了</p>
<p>&nbsp;</p>
<p>策划们最近学聪明了，也要搞隔离式设计了。出了十几二十种资源，基本都不互通，很多资源都是某个功能专有的，比如这种资源专用于升装备指定属性，那种资源用来升英雄特定属性。每种资源的投放到回收都隔离开来，不会相互影响。做设计的时候就可以不怎么动脑了，做错了大不了直接关掉这个系统，不需要为之前挖的坑埋单。对于这种快餐式设计，只能无奈叹气。程序做起来没什么难度啊，多一种资源不就多记一个变量。只不过这种水平扩展的系统，能不能给玩家带去更有层次感的游戏体验，个人对此表示怀疑。</p>]]></description></item><item><title>阅读分享：游戏服务器的设计与面向日志的工作流</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/07/31/game-server-pattern-analysis-and-review-of-the-log.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 31 Jul 2016 14:54:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/07/31/game-server-pattern-analysis-and-review-of-the-log.html</guid><description><![CDATA[<p>7月的工作平淡无奇，除了X系统由借鉴A游戏改成借鉴B游戏，就没什么了，还是谈点别的吧。</p>
<p>&nbsp;</p>
<p>最近看了<a href="http://www.cnblogs.com/fingerpass/p/game-server-programming-paradigm.html" target="_blank">《游戏服务器端究竟解决了什么问题》</a>，推荐给大家。作者关于烂框架的分析很有趣，框架定义角色时，不恰当的角色划分，会引起额外的复杂度，作者文章中后部分有分析。</p>
<p>&nbsp;</p>
<p>作者对服务器消息流通的分析，相当见功力。游戏的服务器端，可以抽象的看成消息的生产者和消费者的集合。每一个生产者/消费者，就是一个服务。skynet的优势，在于提供了&ldquo;服务&rdquo;这个封装，一组功能相对独立的逻辑，可以组合在一个服务内，通过skynet转发通信，为其他服务提供相应功能。常见的消息生产者，包括和客户端通信、解包的gate模块，skynet提供的timer定时驱动。服务就是对这些消息进行响应，并通过和其他服务的互动，完成自己的功能。</p>
<p>&nbsp;</p>
<p>在这个基础上，作者抽取出了消息pattern这个概念。常见的模式有C-&gt;Gate-&gt;S, S-&gt;Gate-&gt;C, S-&gt;Gate-&gt;C*。相对的，因为服务的存在，作者还引入了额外的MQ，来处理服务间的通讯问题。同理，有Service-&gt;MQ-&gt;Service, Service-&gt;MQ-&gt;Service*。</p>
<p>&nbsp;</p>
<p>对于玩家存档的问题，作者抽象了一个数据服务来做这个事情。对应于烂框架的DB代理进程，只能用跟项目高度相关的API进行数据读取，数据服务提供了更高层的功能：剥离游戏服务状态。剥离状态后，从skynet的角度看，所有agent、service，都是做一些简单的计算、比较、排序，最后数据都会存到数据服务上。这样的好处是，剥离了状态的skynet，随便挂，不会丢数据，对用户透明。这个思路非常棒，但是进程间通讯的代价比skynet内服务间通讯要大，怎么避免服务间通讯引起频繁的数据服务通讯，是一个值得思考的问题。</p>
<p>&nbsp;</p>
<p>作者对我启发最大的地方，是文末推荐的那篇<a href="https://engineering.linkedin.com/distributed-systems/log-what-every-software-engineer-should-know-about-real-time-datas-unifying" target="_blank">《The Log》</a>，作者是LinkedIn团队的开发成员。写Log是一件非常简单和入门的事，看完the log，却发现一直忽视了对log这种数据流的视角。文章字里行间，还透着点日志式数据库的意味。这篇文章比较长，核心思路是Table和Change Log是可以相互转化的，一个Table反映了当前的状态，而Log则记录了Table一路以来的状态转换。那么，只要有Log，其实Table不再重要，因为只要我回放Log，最终就可以得到Table。**这是一个有状态到无状态的转化**！然后Log这一块可以交给成熟的中间件处理，LinkdedIn是透过卡夫卡（Kafka）来完成的。消费者的消费速度慢？不要紧，无状态服务可以无限水平扩展。消息产生了消息链？没关系，丢回到Log中，下个周期再处理，完美！</p>
<p>&nbsp;</p>
<p>顺便推荐一篇对The Log的引用文章，来自于Yelp团队：<a href="http://engineeringblog.yelp.com/2016/07/billions-of-messages-a-day-yelps-real-time-data-pipeline.html" target="_blank">《billions of messages a day》</a>, 里面对利用Log进行解耦作了更深入的剖析，对兼容Log格式变更也有自己的解决办法，有空可以看看</p>
<p>&nbsp;</p>]]></description></item><item><title>六月小结</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/06/30/review_of_june_2016.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 30 Jun 2016 15:50:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/06/30/review_of_june_2016.html</guid><description><![CDATA[<p>六月的最后一天，解决了一个服务死循环的问题。吐槽下skynet，既然已经可以检测到endless loop，为什么不直接做个调试器去打出死循环在哪里？而且默认不自带超时功能，死了以后基本上服务统计的gm指令都挂了。要做超时的call，还需要自己套个代理服务上去。</p>
<p>&nbsp;</p>
<p>这个月将手头的系统都开发完了，开始进入修bug阶段。月中的时候接替同事，跟了一下玩法方面的代码，熟悉了玩法的代码结构。排行榜现在统一交到一个服务上去做了，这个服务会创建跟玩家一一对应的role，然后每个role还能饰演不同玩法的角色，参与不同的排行榜。这个抽象不错，避免了不同玩法分别实现一套排行榜，目前排行榜的区别只是榜单的key不一样，榜单长度不一样，其他规则是相同的，所以能很好的合到一起。</p>
<p>&nbsp;</p>
<p>另外，玩法开启的初期，为了激活用户活性，会导入机器人。策划将机器人的各个属性配好，就可以复用机器人。同时，基于排行榜的玩法也不用特殊处理，基本不需要区分是否机器人，直接按同样的规则去匹配人和机器人。这个统一的抽象也相当优雅，但是上次策划有特殊要求，每次搜索都提供机器人减少玩家挫败感，这个不知道怎么实现。让策划大量配机器人可以解决XD</p>
<p>&nbsp;</p>
<p>好困，滚去睡觉了😪</p>
<p>&nbsp;</p>
<p>EDIT:</p>
<p>好吧，skynet是有打断死循环功能的。。。参考https://github.com/cloudwu/skynet/wiki/DebugConsole，我滚去测试一下。。。</p>]]></description></item><item><title>忙忙忙</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/05/29/too_busy_to_draw_attention_to_all.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 29 May 2016 09:05:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/05/29/too_busy_to_draw_attention_to_all.html</guid><description><![CDATA[<p>最近都在加班，没什么好写的。每周六天，没事也要过来，有点崩溃。</p>
<p>&nbsp;</p>
<p>邮箱、聊天之类的都做成信道，尽量和数据抽离开，由具体系统处理对客户端的数据转换，但是orm那块不够灵活。如果不走orm，担心数据格式不对，直接用字符串保存的话，又丢了格式，以后运营的时候不好查找数据。</p>
<p>&nbsp;</p>
<p>玩法堆了几个，成长系统比较多，光英雄的就堆了5、6个了。战斗力计算没时间去理清，虽然都是简单的读表处理，但是各个系统之间有交互，不知道现在这套接口够不够灵活，会不会坑爹。另外，还有一些buff之类的，一直只有客户端维护，之前服务器是没有考虑到的，不知道战斗力会不会需要buff叠加。</p>
<p>&nbsp;</p>
<p>卡牌的投放还是一个没有定论的事情。究竟要不要经历一个卡牌到英雄实例化的过程，这个过程要不要暴露给玩家，还是没想好。策划们似乎能接受，投放卡牌的地方也不多，应该能改过来。</p>
<p>&nbsp;</p>
<p>成长系统里，很多系统都非常像，就是消耗改一点，或者升级加一点随机元素，改一下不读条直接升级，不知道这是什么设计。</p>
<p>&nbsp;</p>
<p>手头的奥义做完后，成长这一块算是结了。想给这一块代码来个总体的code review，但是都是读一下表，改几个数字，没什么逻辑，又不知道从何review起，有点迷茫。</p>
<p>&nbsp;</p>
<p>结论是还是要好好读完设计模式</p>
<p>&nbsp;</p>
<p>另，在kick starter入了pebble time 2，但是又口水google家的Project Soli，不知道什么时候有新品上。google家的语音助理也很吸引，控制全屋家电棒棒的</p>]]></description></item><item><title>回炉重铸-设计模式的领悟</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/04/30/recast_using_design_pattern.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 30 Apr 2016 13:24:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/04/30/recast_using_design_pattern.html</guid><description><![CDATA[<p>整个四月都在回炉重造之前的英雄成长系统，就因为决定换一个方向，累死。回头看看去年，没想到也是4月30号写的博客。。。</p>
<p>&nbsp;</p>
<p>重造的过程里，同时在看《head first 设计模式》这本书。作者加了很多有趣的插图进去，以前是很讨厌这么做作的书，但是现在读来觉得没那么累，挺好的，可能是老了吧。。。里面提到的开放-封闭原则很有启发意义。以前写代码，写的很老实，不够偷懒，总是一字一句把策划的文案搬进去，抽象层次不够，搞的人很累。开放-封闭原则就教导，写代码应该对扩展开放，以后策划有新需求，只要在少数几处地方加个入口就行。对修改封闭这个倒是没有想好，策划总是在改案子，而且很多时候改动的幅度很大，怎么实现不修改没想好。目前是抽取了一堆工具函数出来，将策划的需求拼凑成一张表格，然后逐项检查，有新需求加新工具函数。</p>
<p>&nbsp;</p>
<p>《head first 设计模式》里还提到了对象工厂和观察者模式。观察者模式用的还是蛮多的，玩家身上会挂一个类似公告板的东西，让各种玩法在上面注册主题。比如玩家升级，充值VIP，发起一次战斗，战斗胜利，完成造兵等等，然后其他新玩法和成就系统就可以监听这些消息了。日常任务、成就系统前后做了两版，具体玩法的代码都不需要修改，这个观察者模式挺好用的。</p>
<p>&nbsp;</p>
<p>对象工厂在程序群里其实还被喷过几次，我以前也觉得很多余，尤其是对于Lua这种动态语言来说。没有编译期进行检查，调用接口的代码不跑到就不知道接口对不对。不用工厂，多require几个文件，自己调一下new，没什么区别。现在觉得，抽象一个对象工厂出来，更多是一种减轻心理负担的做法吧。如果一个玩法的文件，里面密密麻麻的require了一堆外部文件，看起来就有点头皮发麻了。现在搞一个100行左右的工厂，将需要的类都放进来，增加创建方法，那么相关玩法的头部就可以简化了。</p>]]></description></item><item><title>python sproto支持64位有符号整数</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/03/29/python_sproto_support_64bit_integer.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 29 Mar 2016 09:35:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/03/29/python_sproto_support_64bit_integer.html</guid><description><![CDATA[<p>小伙伴需要64位整数做物品的id，之前python sproto的判断有问题，写篇日志记录一下。</p>
<p>之前有问题的代码是这样的：</p>
<div class="cnblogs_code">
<pre>             <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">PyInt_Check(data)) {
                 PyErr_SetObject(SprotoError, PyString_FromFormat(</span><span style="color: #800000;">"</span><span style="color: #800000;">type mismatch, tag:%s, expected int</span><span style="color: #800000;">"</span><span style="color: #000000;">, tagname));
                 </span><span style="color: #0000ff;">return</span> -<span style="color: #800080;">1</span><span style="color: #000000;">;
             }
             </span><span style="color: #0000ff;">long</span> i =<span style="color: #000000;"> PyInt_AsLong(data);
             </span><span style="color: #0000ff;">int</span> vh = i &gt;&gt; <span style="color: #800080;">31</span><span style="color: #000000;">;
             </span><span style="color: #0000ff;">if</span> (vh == <span style="color: #800080;">0</span> || vh == -<span style="color: #800080;">1</span><span style="color: #000000;">) {
                 </span>*(uint32_t *)args-&gt;value =<span style="color: #000000;"> (uint32_t)i;
                 </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">4</span><span style="color: #000000;">;
             } </span><span style="color: #0000ff;">else</span> {</pre>
</div>
<p>这里有两个问题。一，long只保证有32bit（via <a href="https://en.wikipedia.org/wiki/C_data_types" target="_blank">wiki</a>），有可能data是64bit的，这个时候就会丢数据。二，vh的定义是int，这里会丢数据。vh是i通过位移得到的，目的是判断高位有没有数据，如果只有符号位有意义，就不用64bit存了，可以转到32bit里放数据。但是，我把vh强转成int，这样刚好就丢掉了符号位，然后让次高位充当了符号位，这时候得到的数据是错误的。</p>
<p>&nbsp;</p>
<p>现在改成了这样：</p>
<div class="cnblogs_code">
<pre>            <span style="color: #0000ff;">if</span> (PyInt_Check(data) ||<span style="color: #000000;"> PyLong_Check(data)) {
                 </span><span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span> i =<span style="color: #000000;"> PyLong_AsLongLong(data);
                 </span><span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span> vh = i &gt;&gt; <span style="color: #800080;">31</span><span style="color: #000000;">; 
                 </span><span style="color: #0000ff;">if</span> (vh == <span style="color: #800080;">0</span> || vh == -<span style="color: #800080;">1</span><span style="color: #000000;">) {
                     </span>*(int32_t *)args-&gt;value =<span style="color: #000000;"> (int32_t)i;
                     </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">4</span><span style="color: #000000;">;
                 } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                     </span>*(int64_t *)args-&gt;value =<span style="color: #000000;"> (int64_t)i;
                     </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">8</span><span style="color: #000000;">; 
                 }</span></pre>
</div>
<p>看起来没问题了:)&nbsp;</p>]]></description></item><item><title>pysproto bug修复</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/03/25/python_sproto_unpack_bug_fix.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 25 Mar 2016 02:29:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/03/25/python_sproto_unpack_bug_fix.html</guid><description><![CDATA[<p>最近，找隔壁组的同学测试了一下我的pysproto，他们提了很多有益的建议，非常感谢。</p>
<p>&nbsp;</p>
<p>在测试中，出现了一次诡异的coredump。当数据变大的时候，就有很大的机率遇上double free。在sproto和python sproto插件里插了一堆打印点后，发现sproto在解包的时候报错了。但是unpack的代码相当简单，下意识忽略过去了。找云大侠看了一下数据，发现的确有个长度数据错了。至于是在哪一层出错了，还是要再找找。接着我们尝试了直接用lua版的sproto解包和打包，都没有问题。包的收发也是在单机进行的，不存在问题。于是又绕回到unpack上去了。仔细想想，数据越来越大的时候才会出问题。有可能跟默认缓冲区的大小有关，这个大小设置为1024了，难道Realloc的时候出错了？</p>
<p>&nbsp;</p>
<p>放狗搜索了一下，发现Realloc的用法的确有问题。对于内存已满的情况，没有做出错处理，之前的指针也被覆盖掉了，造成内存泄漏。改好这一块后发现，为sproto_unpack传入新的缓冲区的时候，忘记更新缓冲区dstsz这个变量了，导致缓冲区足够大，而sproto会认为不够。。增加单元测试后已修复～</p>]]></description></item><item><title>最近设计的反思</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/03/20/mailbox_design.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 20 Mar 2016 05:20:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/03/20/mailbox_design.html</guid><description><![CDATA[<p>最近完成了邮箱的功能。</p>
<p>&nbsp;</p>
<p>邮箱的设计参考了mmzb的设计，基于一套msgsrv来实现。msgsrv是一个消息中转的服务，这个服务是为了简化玩家之间消息传递的过程。比如邮箱要向一个离线玩家发信，为了避免对离线玩家的数据进行修改，会通过msgsrv发送到玩家对应的msgbox里。玩家上线后，会自动查询自己的msgsrv，检索未读消息。当玩家上线时，会主动在msgsrv中发起订阅。每当有新的消息进入，msgsrv会直接发送到玩家所在的agent上，实现实时通知。唯一例外的情况，是全局消息的发送。一条全局消息发送的时候，只是向一个全局的队列里插入一份数据。玩家只会在登录时检索一次这个全局队列，并记住自己的检索位置。缺点是全局消息的通知不及时，需要玩家离线再上线才能收到。需要实时的消息，可以通过聊天系统解决。</p>
<p>&nbsp;</p>
<p>这个设计相对来说还是比较简单的。但是，这个功能的提交，涉及到46个文件。我提交Pull Request的时候，自己都惊到了。当然，这其中并不是全部都是代码的修改。这些修改可以简单的分为三块。一块，是配置之类的修改，比如新增服务的参数，新增服务的数据存储对应的数据库定义，玩家数据库对象新增的结构描述。这里占了7个文件。第二块，是在lualib里提供的新api，为其他服务提供新功能的入口。其中还包含一些趁手的工具函数，方便以后功能的开发。这里占了8个文件。第三块是大头，实现了msgsrv的逻辑部分，以及邮箱的业务代码。这一块有31个文件，是这个PR的主要部分。</p>
<p>&nbsp;</p>
<p>除了玩家自身的成长系统外，其他系统基本都涉及到两部分。一部分，是挂在玩家的agent身上的，另一部分，则是对公有数据的修改。先看看agent的部分。agent身上需要有对应服务的api，供客户端通过sproto协议来远程调用。还需要有对应的api，供相应的skynet内服务的调用。一般还会有一套额外的gm api，供客户端进行测试的时候使用。这三组api，功能覆盖的面差不多，最终都会操作玩家身上的数据，通知到玩家的客户端。就这次提交的邮件PR来看，这些api占住了7个文件。玩家数据部分的管理，是由几个类完成的。这里占用了3个。总的来看，agent身上一共改了15个文件，稍微有点多。</p>
<p>&nbsp;</p>
<p>剩下的文件，集中在对公有数据的修改上，即msgsrv的主体部分。其中有4个是用于执行功能测试的测试脚本，暂且不提。剥开msgsrv，首先是一层command，然后是对全局消息的管理器，对个人msgbox的管理器，对这两者的管理器，以及管理msgsrv服务的启动脚本、退出脚本、gm指令。这里的优化空间应该比较大，按照CRUD的四字法划分，个人消息管理器和全局消息管理器都有着多个&ldquo;R&rdquo;，多个&ldquo;U&rdquo;，正交性不够好，还要锤炼一下。</p>
<p>&nbsp;</p>
<p>优化现有的设计，主要目标是希望修改能够更简洁而清晰。不再因为添加一个小小的功能，就产生数十个文件的修改。对我来说，涉及的文件数量太多，就经常记不住细节，导致api改动的时候，常常出现漏改漏测。目前看到的可以优化的地方，就是各种自发现。比如lualib里面提供一个通用的调用api封装，只要传入方法名和服务名，就能自动调用对应服务的command api。数据结构的定义，能够实现自动发现，不需要修改引用文件。（待续）</p>]]></description></item><item><title>服务器被发现存在未授权访问</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/02/20/web_unauthorized_access_bug.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 19 Feb 2016 16:58:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/02/20/web_unauthorized_access_bug.html</guid><description><![CDATA[<p>今天下午，友商的同学突然发了个确认信息过来，让我们确认一下服务器的归属。然后就抛出了个大新闻：我司服务器存在问题，所有文件都可以任意访问。根据对方反映的信息，确认是之前玩票性质的一个项目：avalon出了问题。https://github.com/ejoy/avalon/blob/master/lualib/staticfile.lua#L12-L17 这里没有做输入检查，就直接使用io.open了。</p>
<p>&nbsp;</p>
<p>另外一个地方，是因为这个项目的玩票性质，所以SA同学随便找台空的服务器丢上去了，而且还用了根用户，于是所有文件都泄露了。。。本来这个也问题不大，avalon的代码本来就是开源的，但是这台空闲服务器是测试服务器之一，于是上面还有几个私钥。。。简直是墨菲定律的绝佳例子！友商的原话：&ldquo;遍历了ssh私钥、hosts文件、passwd文件、shadow文件、crontab文件、iptables文件、bash_history文件等。&rdquo;触目惊心=_=|||</p>
<p>&nbsp;</p>
<p>经过这次事件后，希望能够对docker的推广起到推动作用。通过虚拟化实现应用间隔离，web应用输入检查要做好，外网服务器不存放私钥。还有相应的一套管控体系，包括用户登录行为检测，登录ip异常告警（非内网ip登录）等等。。另外就是，其实没必要自己撸代码啊，撸也只要撸业务层就好，静态文件交给nginx啊喂&hellip;&hellip;&hellip;&hellip;</p>
<p>&nbsp;</p>]]></description></item><item><title>RRDtool简介</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/02/06/5184443.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 06 Feb 2016 14:56:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/02/06/5184443.html</guid><description><![CDATA[<p>最近公司换了办公地址，新厂址的宽带质量不怎么样，于是用RRDTool布了一套网络质量监控的系统，来定位公司内部与机房的连接问题。RRDTool是一套经典的工具，前身是MRTG，因为其中的性能有所不足，绘图的灵活性不够，于是作者Tobias Oetiker又重新开发了一套RRDTool。这套工具包含了日志记录和图表绘制两部分，可以满足各种指标监控的用途。</p>
<p>&nbsp;</p>
<p>RRDTool的RR，指的是Round-robin，</p>]]></description></item><item><title>折腾域名的dns</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/01/10/little_course_about_DNS.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 10 Jan 2016 05:54:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/01/10/little_course_about_DNS.html</guid><description><![CDATA[<p>最近，购买域名的时候遇到了几个概念，刚开始不是很懂，最后都是直接找客服给我改好的，现在小结一下帮助理解。</p>
<p>&nbsp;</p>
<p>DNS域名管理是按后缀进行分组的，比如.com域名，作为最早的商用域名，有很高的推广价值。再比如各个国家的顶级域名，例如中国的.cn，加拿大的.ca，简单易记。我们购买的，是通常意义上，www与顶级域名之间的部分，叫二级域名。</p>
<p>&nbsp;</p>
<p>二级域名会挂在某个根域名下，各个根域名会分给各个承包商进行承包，各自销售。其中有个国际组织在掺和，叫Internet Corporation for Assigned Names and Numbers&nbsp;(ICANN)，负责协调域名包销相关事宜，所以每笔域名交易也要抽点水。</p>
<p>&nbsp;</p>
<p>DNS最主要的作用，在于用一个简单可记忆的字符串，代替一串无规律数字的IP地址，方便人们上网访问。对于一般的网站，我们添加两条A记录就好了。第一条A记录的Host域填@，表示域名就是以二级域名开始。IP地址就填入VPS对应的IP地址即可。第二条A记录的Host域是www，表示用www.yourname.info访问时，应该查询哪个IP地址。我比较懒，www都不想要，就可以设置301重定向，定位到yourname.xxx。</p>
<p>&nbsp;</p>
<p>另外，域名商一般都有自己的DNS服务器，如果懒的话可以直接用。追求国内访问速度的，可以试试DNSPOD，据说效果拔群。域名商开始时会给内置几条记录，用来把刚买下的域名指向自己的宣传页。里面有一个是CNAME记录。CNAME记录用来做什么的呢？还是用来偷懒用的。假设我有ftp.example.com，ssh.example.com，media.example.com，如果我的主机IP地址变了，我需要改三次。如果我设置了CNAME记录呢，ftp、ssh和media三个子域名都指向example.com，那么我只要改example.com指向的IP地址就好了，其他都不用改，完美！</p>
<p>&nbsp;</p>
<p>还有一个比较好玩的是TXT，可以用来写一段话，比如对域名的简介。当然，现在这个域给机器人用的比较多，比如Google家为了让你证明自己拥有这个域名，会让你添加一条TXT记录，内容是一个随机字符串，然后再核对是否设置成功。</p>]]></description></item><item><title>2015年终总结</title><link>http://www.cnblogs.com/Lifehacker/archive/2016/01/03/2015_summary.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 03 Jan 2016 03:37:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2016/01/03/2015_summary.html</guid><description><![CDATA[<p>2015年是我第一次感觉人生过得快的一年。这一年买房了，月供比较重，有种喘不过气的感觉。15年的阅读量比14年少，主要是网络小说看的少了，人文类的阅读量上来了，比较耗费时间。另外，15年计算机专业的书读的很少，那本《redis设计与实现》还没看完，有点遗憾。15年开始思考一些&ldquo;大&rdquo;问题，比如两性平等，科技进步带来的发展，比如文明发展为什么不均衡，主体与客体，人为什么会感觉愉快。</p>
<p>&nbsp;</p>
<p>15年的博客写了18篇，比14年的15篇多了一点点，基本维持在每月一篇到两篇的节奏，但是文章的质量相应有所下降。可能是去年对计算机探索的欲望减少了，空闲的用来玩代码和看新玩意的时间也少了。回顾博文，发现11月-12月和年初的4月真是事故高发期。。。去年出现了一次玩家回档事故，一次停服维护事故，影响还是比较大的，运营抱怨说日活跃玩家掉了好多。空余时间基本是在玩树莓派，云风的sproto相关的工具，bt的私下玩的比较多，思绪繁杂，只写了草稿，没发文章出来。</p>
<p>&nbsp;</p>
<p>16年希望能够发掘更多的金钱来源，让生活过的宽裕一点。身边很多朋友的博客都停更了，我希望我能够坚持下去。计算机方面，可能是毕业的时间久了，很多底层的东西没有耐心去研究，太浮躁了，热门技术呢，服务器这块还是用的比较少的，不像前端、移动端，新语言新工具层出不穷。2016年希望对网络底层，特别是TCP/IP这一块，能够搞懂一些，跟SA吵架的时候，能够理直气壮的说出问题所在XD。另外，对多核的利用和性能测量，也盼望能有点小进步，掌握一点CPU和内存这套核心系统的性能优化技巧。然后开个自己的小网站玩玩，通过实际业务来掌握网站优化知识，可能到时候分享站长相关的东西会比较多。</p>]]></description></item><item><title>mmzb游戏事故分析</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/12/20/mmzb_core_dump_analyse.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 20 Dec 2015 03:41:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/12/20/mmzb_core_dump_analyse.html</guid><description><![CDATA[<p>最近一次线上更新，老项目挂了，遍地哀嚎，日活跃掉了好多，心痛。。。</p>
<p>&nbsp;</p>
<p>这次维护时，SA为了缩减硬件资源，做了一次数据库迁移。给到开发手上的player db，只有一些索引数据，不带有任一玩家数据。玩家上线的时候，skynet自动从redis-persist服务中拉取（redis-persist是一个基于旁路监听的redis落地程序，相对独立，参见<a href="http://www.cnblogs.com/Lifehacker/p/redis_persist_publish.html" target="_blank">之前的博文</a>）。这也是RP服务的第一次高强度使用。按之前的策略，每次玩家下线都会在RP服务中存档，三个月不上线的玩家，会自动从redis数据库中移除，以节约内存。当流失玩家再度上线时，skynet先从redis中直接查询，无法加载到玩家的话，再度从RP服务中拉取，可以简单的将RP服务视作redis的一个二级缓存。玩家下线后，数据继续在redis中保留三个月。所以，设计之初，RP服务就是作为一个低频服务存在的，没有考虑到大量加载玩家的情况。</p>
<p>&nbsp;</p>
<p>这次开服前，SA有同步到这个情况，我们以为只是玩家上线登录会慢一点而已，结果换来的却是惨痛的教训。上线后，因为redis里面空空如也，而各种排行榜和群雄逐鹿玩法，需要拉取玩家的基本信息，诸如名字、uid、等级、公会、性别等等基础数据。这是依赖于一个profile服务实现的。而profile加载玩家信息的接口，又跟玩家登录所用的接口不一样，没有实现从RP服务中加载。这是当时RP服务上线时，特地干掉相应接口的，因为当时已经考虑到profile服务会是一个高频访问，容易压垮RP服务。在策划的再三要求下，开发迫不得已把这个接口加回去，免得玩家信息空白。结果，上线一个小时左右，skynet就因为占用内存太大，直接挂掉了。</p>
<p>&nbsp;</p>
<p>事后分析，应该是profile服务太慢了，需要一个个从磁盘上加载玩家数据，虽然自身有缓存，但是压上来的请求数量太多，请求也没有做去重（比如同一个uid，只对RP服务发出一次请求）。返回结果时比较缓慢，玩家就直接退出重新登录，之前查询到的数据作为临时表，已经没有接收者了（原有的session已经消失），于是变为GC的压力，最后把系统压垮了。再次启动上线后，关闭群雄逐鹿玩法，希望能减少profile服务的压力，结果轮到战斗搜索出问题了，线上搜索玩家进行攻击，依赖于redis里的数据，由于redis里玩家太少（只有刚刚登录上的），无法搜索到有价值的对手。开发这边就通过运营导出最近玩家数据，将热玩家数据重新导入redis里，解决问题。</p>
<p>&nbsp;</p>
<p>这次事故里，profile服务因为单点故障，备受诟病。但是，从一个高度依赖redis内存数据库的服务器里，转到主要依赖磁盘的数据库上，这个改动就不是一个小改动。不止profile服务，还有其他服务也依赖于redis数据库（比如战斗搜索），正因为redis的访问代价低，代码里的cache和预加载就可以少写一点。如果相关玩法的假设是，数据都从磁盘加载，排行榜和群雄逐鹿玩法就可以先单独从磁盘上加载好自己要用的玩家数据，不需要依赖profile服务了。相反，SA部署新的redis实例的时候，将那部分热门玩家先加载到内存中，让skynet直接在redis就可以取到数据，不需借道RP服务，也可以解决问题。往后这数据加热，还是应该自动化完成，只是先前数据都在内存，不需要加热，就没这个问题。</p>
<p>&nbsp;</p>
<p>退一步说，假设各个玩法依然从profile里加载基本信息，如果profile服务可以过滤重复请求，就可以释放掉RP服务的压力。这时候，压力就集中在profile服务的消息队列上了，由于磁盘加载速度慢，依然会有大量的请求积压。云风曾经提过<a href="http://blog.codingnow.com/2015/10/timeout_skynetcall.html" target="_blank">一个skynet.call的超时处理方案</a>，如果这个方案再改动一下，发现某服务大量积压请求时，自动随机抛弃新请求，profile服务就可以得到解放了。</p>]]></description></item><item><title>为sproto手写了一个python parser</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/12/13/python_sproto_parser.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 13 Dec 2015 13:54:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/12/13/python_sproto_parser.html</guid><description><![CDATA[<p>这是sproto系列文章的第三篇，可以参考前面的《<a href="http://www.cnblogs.com/Lifehacker/p/python_sproto_introduction.html" target="_blank">为sproto添加python绑定</a>》、《<a href="http://www.cnblogs.com/Lifehacker/p/add_unorder_map_support_to_sproto.html" target="_blank">为python-sproto添加map支持</a>》。</p>
<p>sproto是云风设计的序列化协议，用于高效的打包解包游戏协议数据。有点类似Google推出的protobuf，但是比protobuf要快。结构上有点类似cap'n Proto，但是没有打算直接使用其作为内存组织结构，因此少了数据对齐的部分。目前使用场景主要是在游戏客户端和服务器端的RPC协议上。</p>
<p>&nbsp;</p>
<p>sproto比较有趣的一点，是可以自描述，用sproto协议本身描述自己：（<span style="text-decoration: line-through;">摘自云风博客</span>）UPDATED:博客的是错误的，正确的在<a href="https://github.com/cloudwu/sproto/blob/master/sprotoparser.lua#L237-L262" target="_blank">代码注释</a>里：</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">.type {
    .field {
        name </span><span style="color: #800080;">0</span> : <span style="color: #0000ff;">string</span><span style="color: #000000;">
        buildin    </span><span style="color: #800080;">1</span><span style="color: #000000;"> :    integer
        type </span><span style="color: #800080;">2</span><span style="color: #000000;"> : integer
        tag    </span><span style="color: #800080;">3</span><span style="color: #000000;"> :    integer
        array </span><span style="color: #800080;">4</span><span style="color: #000000;">    : boolean
        key </span><span style="color: #800080;">5</span> : integer # If key exists, array must be <span style="color: #0000ff;">true</span>, and it<span style="color: #800000;">'</span><span style="color: #800000;">s a map.</span>
<span style="color: #000000;">    }
    name </span><span style="color: #800080;">0</span> : <span style="color: #0000ff;">string</span><span style="color: #000000;">
    fields </span><span style="color: #800080;">1</span> : *<span style="color: #000000;">field
}
.protocol {
    name </span><span style="color: #800080;">0</span> : <span style="color: #0000ff;">string</span><span style="color: #000000;">
    tag    </span><span style="color: #800080;">1</span><span style="color: #000000;"> :    integer
    request    </span><span style="color: #800080;">2</span><span style="color: #000000;"> :    integer    # index
    response </span><span style="color: #800080;">3</span><span style="color: #000000;"> : integer # index
}
.group {
    type </span><span style="color: #800080;">0</span> : *<span style="color: #000000;">type
    protocol </span><span style="color: #800080;">1</span> : *<span style="color: #000000;">protocol
}</span></pre>
</div>
<p>这么简单的结构，正好拿来练手写parser。Lua的LPEG库实在太强大，于是先试了一下pypeg2去解决这个问题。尝试的过程参见：https://github.com/spin6lock/sproto_python_parser，最后失败了。回想了一下，PEG文法其实跟上下文无关文法相当类似，只是不存在二义性，能够通过一个token来完全决定接下来的解析树。这个跟递归下降法有点类似了，便顺手撸了一发：<a href="https://github.com/spin6lock/yapsp" target="_blank">https://github.com/spin6lock/yapsp</a></p>
<p>&nbsp;</p>
<p>代码主要分成两部分，lexer和parser。lexer辨别的token可以参见<a href="https://github.com/spin6lock/yapsp/blob/master/constants.py" target="_blank">常量定义</a>，基本上用正则表达式搞定了，只花了一点点时间。Parser多花了好一段，主要是忘了要封装一些方便的函数出来使用，比如expecting和optional。Parser实现的是一个基于递归下降法的语法分析器，由于sproto的语法特别简单，所以可以透过窥视下一个token，便知晓接下来要解析的是什么结构，然后调用相应的方法解析即可。</p>]]></description></item><item><title>Lua小技巧</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/11/17/lua_little_tricks.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 17 Nov 2015 04:08:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/11/17/lua_little_tricks.html</guid><description><![CDATA[<p>来公司以后，业务逻辑都用lua写。写了好长时间了，到最近才觉得有点掌握了Lua的灵活。最近用Lua写了个类似集合一样的东西，如果两次向集合里放入同一个元素，就会报错，方便检查配置。代码如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">--</span><span style="color: #008000;"> keep data across rule</span>
<span style="color: #0000ff;">local</span> m =<span style="color: #000000;"> {}
</span><span style="color: #0000ff;">local</span> where_defines =<span style="color: #000000;"> {}
</span><span style="color: #0000ff;">local</span> getinfo = <span style="color: #ff00ff;">debug.getinfo</span><span style="color: #000000;">
name2id </span>= <span style="color: #ff00ff;">setmetatable</span><span style="color: #000000;">({}, {
        __index </span>=<span style="color: #000000;"> m,
        __newindex </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(self, key, value)
            </span><span style="color: #0000ff;">if</span> <span style="color: #0000ff;">not</span> m[key] <span style="color: #0000ff;">then</span><span style="color: #000000;">
                m[key] </span>=<span style="color: #000000;"> value
                where_defines[key] </span>= getinfo(<span style="color: #800080;">2</span><span style="color: #000000;">).short_src
            </span><span style="color: #0000ff;">else</span>
                <span style="color: #0000ff;">local</span> new_define = getinfo(<span style="color: #800080;">2</span><span style="color: #000000;">).short_src
                </span><span style="color: #0000ff;">local</span> where_define =<span style="color: #000000;"> where_defines[key]
                </span><span style="color: #ff00ff;">print</span>(where_define..<span style="color: #800000;">"</span><span style="color: #800000;"> defines </span><span style="color: #800000;">"</span>..key..<span style="color: #800000;">"</span><span style="color: #800000;"> : </span><span style="color: #800000;">"</span><span style="color: #000000;">..m[key])
                </span><span style="color: #ff00ff;">print</span>(new_define..<span style="color: #800000;">"</span><span style="color: #800000;"> defines </span><span style="color: #800000;">"</span>..key..<span style="color: #800000;">"</span><span style="color: #800000;"> : </span><span style="color: #800000;">"</span><span style="color: #000000;">..value)
                </span><span style="color: #ff00ff;">assert</span>(<span style="color: #0000ff;">false</span>, <span style="color: #800000;">"</span><span style="color: #800000;">redefinition of key:</span><span style="color: #800000;">"</span><span style="color: #000000;">..key)
            </span><span style="color: #0000ff;">end</span>
        <span style="color: #0000ff;">end</span><span style="color: #000000;">
    })
</span><span style="color: #0000ff;">local</span> M =<span style="color: #000000;"> {
    name2id </span>=<span style="color: #000000;"> name2id,
}
</span><span style="color: #0000ff;">return</span> M</pre>
</div>
<p>由于Lua的__index hook不完整，只有在数据不存在的时候，才会索引元表的__index，所以需要将数据藏起来。之前是用一个key为data，value是空表的子表去存实际数据，这样做会有一个隐患，当塞进去的key是data，就会把其他数据覆盖掉。后来同事提醒，可以用upvalue，先声明一个本地table m，然后在元表方法里引用之，这样外层就不会误改数据域了。要找回m，可以从元表中查回来。</p>]]></description></item><item><title>Techparty-广州 10 月 31 日 Docker 专场沙龙 后记</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/10/31/guangzhou_docker_salon.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 31 Oct 2015 14:42:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/10/31/guangzhou_docker_salon.html</guid><description><![CDATA[<p>华为的童鞋技术能力很强，但是两位讲师的都没听进去。重点听了两个，一个是芒果TV的Docker 之路，另一个是Coding的实践和思考。</p>
<p>&nbsp;</p>
<p>芒果TV的主讲人是一直仰慕的CMGS，从豆瓣出来后去了国企芒果台。因为内部阻力问题，无法实现PaaS。转而实现了细粒度的调度。物理机+Docker为芒果台省了不少机器，而且性能还比AWS的要强。实践上，主要用到了MacVLan，在二层网络上做网络调度。还有Devicemapper，但是dm受镜像大小的影响比较大，超过2G大小的镜像就会有明显的性能下降。Docker里跑的，主要是Redis cluster。80G的redis实例，分成了80个1G的instance来跑，分别错开AOF时机，避免触发OOM。网络设置用的是Eru-agent，自己开发的私货，同时负责监控。Docker自带的监控在早期版本里，一直是个脑残，每秒取一次metric数据，严重影响性能。</p>
<p>&nbsp;</p>
<p>Coding的主讲人是叶雨飞。叶大吐槽了Docker的种种缺点，registry废柴，dockerfile和部署用的配置混为一谈，hub上的镜像良莠不齐。然后鲜明的提出了三点：Build-Package-Run。对于运维人员来说，应该做的是运行一个build.sh，然后把packagebuild出来。具体怎么build，应该交回各项目自我管理自我实现。叶大现场还列举了3行的dockerfile，实在是大开眼界。底包由内部每天更新，然后第一行FROM 当日更新好的底包，第二行add 相应的包，第三行直接run包。叶大对动态伸缩也有明确的认识，一般公司都用不着，很多东西可以依赖原有的部署系统实现，不需要另搞一套。灵活性越高，需要的额外工作越高。容器只是当作物理隔离用的东西，就够用了。镜像的locale，timezone之类的，甚至可以直接依赖宿主机。当然，也要保证镜像能够包得起，挪得动，可以封装物理机之间的差异，不会依赖某台特定物理机来跑业务。</p>
<p>&nbsp;</p>
<p>具体的ppt还是要等<a href="http://techparty.org" target="_blank">珠三角技术沙龙</a>的官网了</p>
<p>UPDATE：</p>
<hr />
<p>&nbsp;</p>
<p>官网总结：<a href="http://techparty.org/guangzhou/2015/11/01/guangzhou-docker-event-summary.html" target="_blank">http://techparty.org/guangzhou/2015/11/01/guangzhou-docker-event-summary.html</a></p>
<p>芒果TV：<a href="http://7fvga6.com1.z0.glb.clouddn.com/techparty/gztechparty201510/ppt/Docker2.pdf" target="_blank">http://7fvga6.com1.z0.glb.clouddn.com/techparty/gztechparty201510/ppt/Docker2.pdf</a></p>
<p>码市docker总结：<a href="http://7fvga6.com1.z0.glb.clouddn.com/techparty/gztechparty201510/ppt/CodingDocker%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E4%B8%8E%E7%9A%84%E6%80%9D%E8%80%83.pdf" target="_blank">http://7fvga6.com1.z0.glb.clouddn.com/techparty/gztechparty201510/ppt/CodingDocker%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E4%B8%8E%E7%9A%84%E6%80%9D%E8%80%83.pdf</a></p>]]></description></item><item><title>1password密码库格式更新</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/10/20/how_to_switch_agilechains_to_opvault.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 19 Oct 2015 16:43:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/10/20/how_to_switch_agilechains_to_opvault.html</guid><description><![CDATA[<p>由于国内网络安全做的太差，经常发生被脱裤的事件，比如最近的网易邮箱（via <a href="http://www.wooyun.org/bugs/wooyun-2015-0147763" target="_blank">乌云</a>），所以只好用1password这类密码管理软件，实现一站一密。昨晚半夜冻醒了，刷推刷到了这个：<a href="http://myers.io/2015/10/22/1password-leaks-your-data/" target="_blank">1password-leaks-your-data</a>，整个人吓醒了=_=# 作者有点标题党，脱水版可以参见reddit的<a href="https://www.reddit.com/r/technology/comments/3p9ihw/1password_leaks_your_data/" target="_blank">这篇文章</a>，大意是1password的旧密码库格式叫agilechains，大体是json结构，里面只有密码是加密的，密码项的名字和URL并未加密。官方提到历史原因，早期计算能力弱，只好加密关键部位。官方推出的密码库更新指南在此：<a href="https://discussions.agilebits.com/discussion/39875/getting-your-data-into-the-opvault-format" target="_blank">Switching to OPVault format</a></p>
<p>&nbsp;</p>
<p>但是，今天折腾了大半天，发现官方指南其实并没有考虑到同步的情况。我在Win，iOS，以及Mac OS X上都有使用1password，使用dropbox进行同步。官方对新的数据格式OPVault有版本要求，所有设备的1password都需要升级。升级完成后，官方没有办法直接转换到OPVault上来。需要先导出一个纯文本1pif格式，完全不带加密，然后创建一个新库，选择新的OPVault格式，再导入刚刚的1pif文件。因为之前已经有和dropbox同步，于是1password就自作主张将dropbox目录里的老库和新库合并，结果所有密码变成两份。。。由于Dropbox的版本控制只针对文件而非目录，我还要一个一个文件的回滚，崩溃了。。</p>
<p>&nbsp;</p>
<p>以win平台为例，正确做法应该是这样：先停掉dropbox的同步。删掉dropbox里的备份文件，如果是iOS创建的Dropbox备份，文件位置在Apps/1Password/1password.agilechains。然后创建新的密码库，格式选择OPVault，文件保存在Apps/1Password/1password.opvault。将原来的主密码库导出一个纯文本1PIF文件，然后删掉原来旧格式的主密码库，如果UI没有提供接口，就退出1password，直接搜索所有的1password.agilechains来删除。删除时，注意使用<a href="http://sourceforge.net/projects/eraser/" target="_blank">Eraser</a>来清理数据，不然就会犯陈冠希老师的错了。在新格式的OPVault里导入原来的1PIF文件，大致检查一下数量对不对，有没有漏的，没有的话就可以用Eraser将这个最容易泄密的1PIF干掉了。一切准备停当，可以打开dropbox同步，dropbox这时候应该自动将新密码库上传上去了。</p>
<p>&nbsp;</p>
<p>win平台处理完，其他平台可以参考同样流程。不要依赖1password自己的同步，只要记住文件到了，密码库就在手上，利用dropbox完成同步即可。先把iOS的卸载掉，再重新安装，选择我是已有密码库的用户，导入dropbox里的密码库就搞定了。Mac OS X稍微有点麻烦，直接删除app不会删除备份，而且貌似1password 5是使用了sqlite来作本地数据缓存。我们需要在Finder里，前往文件夹~/Library/Application Support/1Password 4, 删除里面的数据。最新的OS X EI Capitan取消了安全清除废纸篓，可以用命令行的srm代替。然后再打开软件，就可以像iOS一样，选择已有的密码库来操作了。</p>]]></description></item><item><title>SSL加密与系统时间</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/10/18/ssl_cert_and_system_time.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 17 Oct 2015 17:12:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/10/18/ssl_cert_and_system_time.html</guid><description><![CDATA[<p>最近，家里的神州老笔记本没电池了，要拆C面才能换主板电池，懒得动手，于是搞了个Network Time来做对时。主要是未搞对时之前，所有https的站点都用不了，老人家也抱怨炒股不行，崩溃了。。。这时候才知道，原来证书也是要验证时间的。</p>
<p>&nbsp;</p>
<p>在SSL会话里，客户端需要验证服务器的身份，这是通过证书检查来完成的。证书验证中，会涉及跟时间相关的两点：</p>
<ul>
<li>服务器的证书（及涉及到的其他证书）的有效验证时间需要包含当前时间。每个证书都有notBefore（不早于）和notAfter（不晚于）字段，当前时间必须落在这两者之间。</li>
<li>客户端需要验证证书的撤销情况。这是通过从CA获取CRL（证书撤销链）来实现的。一个CRL只有在&ldquo;不太老&rdquo;的情况下才算是可接受的。同样，CRL有thisUpdate字段，标记CRL生成时间，以及一个nextUpdate字段，大致相当于CRL的过期时间。</li>
</ul>
<p>证书签发的过期时间对客户端的安全十分重要。假设服务器不幸被攻破，私钥被偷。通过CRL和证书自身有效期，大家可以及时修正泄密证书，防止被泄露的证书进行中间人攻击。所以，当主板电池挂掉的时候，安全往往难以受到保障。。</p>
<p>&nbsp;</p>
<p>参考链接：<a href="http://security.stackexchange.com/questions/72866/what-role-does-clock-synchronization-play-in-ssl-communcation" target="_blank">What role does clock synchronization play in SSL communcation</a><a title="What role does clock synchronization play in SSL communcation" href="http://security.stackexchange.com/questions/72866/what-role-does-clock-synchronization-play-in-ssl-communcation" target="_blank"><br /></a></p>]]></description></item><item><title>python和nodejs的aes128加密对比</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/10/14/nodejs_aes_encrypt_problem.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 14 Oct 2015 09:28:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/10/14/nodejs_aes_encrypt_problem.html</guid><description><![CDATA[<p>之前的机器人是用python写的，有同事想改写成nodejs版，但是验证一直通不过，于是帮忙爬了一下文档。</p>
<p>python版的代码大概是长这样：</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">encoding:utf8</span>

<span style="color: #0000ff;">from</span> Crypto.Cipher <span style="color: #0000ff;">import</span><span style="color: #000000;"> AES
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> binascii

key </span>= <span style="color: #800000;">'</span><span style="color: #800000;">abcdabcdabcdabcd</span><span style="color: #800000;">'</span><span style="color: #000000;">
plaintext </span>= <span style="color: #800000;">'</span><span style="color: #800000;">Secret Message A</span><span style="color: #800000;">'</span><span style="color: #000000;">

encobj </span>=<span style="color: #000000;"> AES.new(key, AES.MODE_ECB)
ciphertext </span>=<span style="color: #000000;"> encobj.encrypt(plaintext)

</span><span style="color: #008000;">#</span><span style="color: #008000;"> Resulting ciphertext in hex</span>
<span style="color: #0000ff;">print</span> ciphertext.encode(<span style="color: #800000;">'</span><span style="color: #800000;">hex</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p>nodejs提供了<a href="https://nodejs.org/api/crypto.html" target="_blank">两种方式创建加密</a>，一种是crypto.createCipher(algorithm, password)，另一种是crypto.createCipheriv(algorithm, key, iv)。从文档里可以看到，createCipher默认支持的是密码的加密方式，而不是key。这种方法底层会帮忙从密码推导出key和iv。而createCipheriv才是py版对应的AES.new。于是得到了nodejs版：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">var</span> crypto = require("crypto"<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> key = <span style="color: #0000ff;">new</span> Buffer('abcdabcdabcdabcd','ascii'<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> text = 'Secret Message A'<span style="color: #000000;">;

</span><span style="color: #0000ff;">var</span> cipher = crypto.createCipheriv('AES-128-ECB',key,''<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> decipher = crypto.createDecipheriv('AES-128-ECB',key,''<span style="color: #000000;">);
</span><span style="color: #0000ff;">var</span> c1 =<span style="color: #000000;"> []
</span><span style="color: #0000ff;">var</span> c2 =<span style="color: #000000;"> []
c1.push(cipher.update(text, </span>"ascii", "hex"<span style="color: #000000;">))
c1.push(cipher.final(</span>"hex"<span style="color: #000000;">))
</span><span style="color: #0000ff;">var</span> encrypted_text = c1.join(''<span style="color: #000000;">)
console.log(encrypted_text)
c2.push(decipher.update(encrypted_text, </span>"hex", "ascii"<span style="color: #000000;">))
c2.push(decipher.final(</span>"ascii"<span style="color: #000000;">))
console.log(c2.join(</span>''))</pre>
</div>
<p>但是有个问题，nodejs版加密出来的密文，总是比python版要长。感觉nodejs最后的final方法，输出了多余的东西。参考了一些网文，如果密文不够一个block，update是没有输出的，如果超过一个block，update只会输出一个block，剩余的放在final里返回。用python版解密看了一下，原来final在密文刚好一个block的情况下，会返回padding字符串。。。。</p>]]></description></item><item><title>9月补记</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/10/02/xcodeghost_server.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 02 Oct 2015 14:44:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/10/02/xcodeghost_server.html</guid><description><![CDATA[<p>9月份本来打算搞一下bt，可惜一直没时间完成种子下载的部分，暂此搁笔。</p>
<p>&nbsp;</p>
<p>由于XcodeGhost肆虐，于是顺手搞了个XcodeGhost的服务器版：https://github.com/spin6lock/XcodeGhostServer，联系SA帮忙指向本机，结果公司里大家都更新的好快，只发现一位同学中招:) 只是弹窗还有点问题，JSON里面的字段都有了，不知道是不是scheme不对，所以openUrl的时候有问题，稍后再看看。</p>
<hr />
<p>XcodeGhost的三个域名：init.icloud-analysis.com init.icloud-diagnostics.com init.crash-analytics.com 【<a href="http://36kr.com/chouti/5037721?utm_source=chouti" target="_blank">来源参考</a>】</p>
<p>&nbsp;</p>
<p>回顾了一下XcodeGhost的代码，canOpenURL返回No就会自动return，无法弹窗。理想的处理办法，是根据染毒的app，分配特定的scheme。但是如果对方是ios9以下，可以偷懒将scheme改成wechat，统一跳转到微信。</p>]]></description></item><item><title>对bt的一些想法</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/09/09/4794244.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 09 Sep 2015 04:00:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/09/09/4794244.html</guid><description><![CDATA[<p>一直想做一个像<a href="http://www.cnblogs.com/cilizhushou.com" target="_blank">磁力助手</a>这样的网站，参考了<a href="http://xiaoxia.org/2013/05/11/magnet-search-engine/" target="_blank">小虾的文章</a>。最近花了比较多的时间，自己实现了一遍，写写实验过程的体验。</p>
<p>术语：</p>
<p>DHT网络是为了</p>
<p>参考文章：</p>]]></description></item><item><title>旧梦重温</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/08/31/old_dreams_came_true.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 31 Aug 2015 14:21:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/08/31/old_dreams_came_true.html</guid><description><![CDATA[<p>这个月主要在搞两件事，其一是：https://github.com/spin6lock/pydnsproxy，其二是一个bt客户端，用来搜索磁力链接，下载种子的，还没搞好。</p>
<p>&nbsp;</p>
<p>pydnsproxy在去年的《<a href="http://www.cnblogs.com/Lifehacker/p/dns_query_and_http_proxy.html" target="_blank">忙里偷闲的八月</a>》里已经有提及，不过当时居然没发现几个明显的bug。之前是因为Queue的用法不对，初始化的时候，没有赋予有效的长度，导致每次将用完的tcp链接塞进去，都会报队列已满，然后被抛弃掉。也就是说，每一次tcp查询基本都是重新创建链接。这样查询代价会很大，一般到400-500ms了。之前的缓存方式也有问题，没有考虑到Handler类这种用法，每次收到一个请求，handler就会被实例化一次。而上一个版本的实现里，cache是放在handler类上的，依赖于handler的生命周期。现在因为TCP_HANDLE是作为一个方法类来引入，所以没问题了，下一步应该将cache变为模块变量。</p>
<p>&nbsp;</p>
<p>除了bug修复，就是给pydnsproxy添加了http dns的解析方式，这种方式的优势，可参考企鹅的<a href="http://mp.weixin.qq.com/s?__biz=MzA3ODgyNzcwMw==&amp;mid=201837080&amp;idx=1&amp;sn=b2a152b84df1c7dbd294ea66037cf262&amp;scene=2&amp;from=timeline&amp;isappinstalled=0&amp;utm_source=tuicool" target="_blank">【鹅厂网事】全局精确流量调度新思路-HttpDNS服务详解</a>。简单来说，就是抛开原有的dns协议，直接提供一个http接口，给出域名，返回对应ip。额外参数还包括请求ip，可以根据请求ip的不同解析出不同的ip地址。暂时看来，没有受到墙的干扰，可以一用。说到底，其实需要的是一根管道，可以顺利到墙外而不受干扰。具体的解析方式，反倒是其次了。像企鹅这种大公司，维持一条稳定的加密通道毫无问题，于是顺便利用其httpdns来避免投毒污染了。实现的时候，有考虑过tcp连接池的问题，貌似urllib2没有这么高级的功能，只有urllib3才提供PoolManager。但是，实测发现，httpdns的查询也就在20ms附近，虽然比缓存的5ms要慢一点，但完全可以接受，这个值得再观察一下。</p>
<p>&nbsp;</p>
<p>bt客户端的实现，组织好KTable，KBucket，KNode，似乎就差不多了。这次重拾python来实现，比之前半途而废的go版本，要顺利多了。遇到的问题有两点，一个是KBucket什么时候分裂，怎么分裂。这个会影响程序长时间运行，所占用的内存大小。另外一个，是跟其他客户端连接时，报文错误的问题，目前倾向于对方的实现有问题，因为其他客户端都能成功应答了。因为还没完成，代码就没有提交。</p>
<p>&nbsp;</p>]]></description></item><item><title>树莓派改用中山大学软件源</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/07/26/raspberry.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 26 Jul 2015 09:43:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/07/26/raspberry.html</guid><description><![CDATA[<p><strong><br /></strong>最近借了同事的第一代树莓派来玩，主要是想试试玩SDR，之前听说可以上传一个月的航班广播（ADS-B广播信息）就可以获得永久资格，随时查阅附近有什么航班飞行。后来发现flightradar24.com已经升级规则了，要持续上传数据。。。于是打算听听收音机算了，上手装了raspbian，毕竟debian系统比较熟悉。国内网速着急，先换个源&ldquo;</p>
<p>&nbsp;</p>
<p><strong>使用说明</strong><br />编辑/etc/apt/sources.list 文件，参考如下命令：</p>
<div class="cnblogs_code">
<pre>sudo vim /etc/apt/sources.list</pre>
</div>
<p><span style="line-height: 1.5;">注释原文件所有内容，用以下内容取代：</span></p>
<div class="cnblogs_code">
<pre>deb http:<span style="color: #008000;">//</span><span style="color: #008000;">mirror.sysu.edu.cn/raspbian/raspbian/ wheezy main contrib non-free</span>
deb-src http:<span style="color: #008000;">//</span><span style="color: #008000;">mirror.sysu.edu.cn/raspbian/raspbian/ wheezy main contrib non-free</span></pre>
</div>
<div>&nbsp;</div>
<p>&nbsp;</p>
<p><span style="line-height: 1.5;">编辑镜像站后，执行：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">sudo</span> apt-<span style="color: #000000;">get update
</span><span style="color: #0000ff;">sudo</span> apt-get upgrade</pre>
</div>
<p><span style="line-height: 1.5;">更新软件源列表，同时升级软件包。</span></p>
<p>&nbsp;</p>]]></description></item><item><title>[翻译]lpeg入门教程</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/06/25/lpeg_tutorial.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 25 Jun 2015 10:06:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/06/25/lpeg_tutorial.html</guid><description><![CDATA[<p>&nbsp;</p>
<h2>原文地址：<a href="http://lua-users.org/wiki/LpegTutorial%20" target="_blank">http://lua-users.org/wiki/LpegTutorial&nbsp;</a></h2>
<h2>简单匹配</h2>
<p>LPeg是一个用于文本匹配的有力表达方式，比Lua原生的字符串匹配和标准正则表达式更优异。但是，就像其他任何语言一样，你需要知道简单的词汇和如何组合他们。</p>
<p>最佳的学习方式，是通过交互式对话，熟悉基本的模式。首先，我们定义一些缩写：</p>
<pre class="code">$ lua -llpeg
Lua 5.1.4  Copyright (C) 1994-2008 Lua.org, PUC-Rio
&gt; match = lpeg.match <span class="comment">-- match a pattern against a string</span>
&gt; P = lpeg.P <span class="comment">-- match a string literally</span>
&gt; S = lpeg.S  <span class="comment">-- match anything in a set</span>
&gt; R = lpeg.R  <span class="comment">-- match anything in a range</span>
</pre>
<p>如果你不想自己创建缩写，你可以这样写：</p>
<pre class="code">&gt; <span class="library">setmetatable</span>(_ENV <span class="keyword">or</span> <span class="library">_G</span>, { __index = lpeg <span class="keyword">or</span> <span class="library">require</span><span class="string">"lpeg"</span> })
    </pre>
<p>我不建议在工作代码中这样写，但是在探索LPeg的时候，则不妨试试，十分方便。</p>
<p>匹配是从字符串的<em>起始点</em>开始，如果匹配成功，则返回成功匹配子串的后一个位置，或者返回<code>nil</code>。（这里我应用了一个简写：<code>f'x'</code> 在Lua里等价于 <code>f('x')</code> ; 单引号和双引号等价)</p>
<pre class="code">&gt; = match(P<span class="string">'a'</span>,<span class="string">'aaa'</span>)
2
&gt; = match(P<span class="string">'a'</span>,<span class="string">'123'</span>)
<span class="keyword">nil</span>
</pre>
<p>看起来就像 <code>string.find</code>一样，除了只返回一个索引。</p>
<p>你可以选择按 <em>范围</em> 匹配或者匹配一个<em>集合内</em>的字符:</p>
<pre class="code">&gt; = match(R<span class="string">'09'</span>,<span class="string">'123'</span>)
2
&gt; =  match(S<span class="string">'123'</span>,<span class="string">'123'</span>)
2
</pre>
<p>要匹配超过1个子串，可以用 <code>^</code> 操作符。 在这种情况下，匹配与Lua的 '^a+' 等价- 匹配一个或多个'a':</p>
<pre class="code">&gt; = match(P<span class="string">'a'</span>^1,<span class="string">'aaa'</span>)
4
</pre>
<p>要按顺序合并模式（pattern），可以通过 <code>*</code> 操作符。 这等价于 '^ab*' - 'a' 后跟着0个或多个 'b':</p>
<pre class="code">&gt; = match(P<span class="string">'a'</span>*P<span class="string">'b'</span>^0,<span class="string">'abbc'</span>)
4
</pre>
<p>到目前为止，lpeg只是为我们提供了一个更为灵活的方式去表达正则表达式，但是这些模式是可以 <em>组合</em> - 他们可以由简单的原语组成，避免艰深的字符串操作。因此，lpeg匹配可以比等价的正则表达式表现得更为易读。注意，你可以在构造pattern的时候保留显式的 <code>P</code> 调用。尤其是其中一个参数已经是一个pattern的时候：</p>
<pre class="code">&gt; maybe_a = P<span class="string">'a'</span>^-1  <span class="comment">-- one or zero matches of 'a'</span>
&gt; match_ab = maybe_a * <span class="string">'b'</span>
&gt; = match(match_ab, <span class="string">'ab'</span>)
3
&gt; =  match(match_ab, <span class="string">'b'</span>)
2
&gt; =  match(match_ab, <span class="string">'aaab'</span>)
<span class="keyword">nil</span>
</pre>
<p><code>+</code> 操作符表示 <em>任意</em> 一个pattern:</p>
<pre class="code">&gt; either_ab = (P<span class="string">'a'</span> + P<span class="string">'b'</span>)^1 <span class="comment">-- sequence of either 'a' or 'b'</span>
&gt; = either_ab:match <span class="string">'aaa'</span>
4
&gt; =  either_ab:match <span class="string">'bbaa'</span>
5
</pre>
<p>pattern对象还带有 <code>match</code> 方法！</p>
<p>当然, <code>S'ab'^1</code> 会更简短, 但这里的参数可以是任意的模式。</p>
<h2>基本捕获</h2>
<p>获得match后的位置非常有用, 你可以随后用 <code>string.sub</code> 来取出匹配串。 不过，我们也有显式的方法直接获取子串<em>捕获</em>:</p>
<pre class="code">&gt; C = lpeg.C  <span class="comment">-- captures a match</span>
&gt; Ct = lpeg.Ct <span class="comment">-- a table with all captures from the pattern</span>
</pre>
<p>第一个就好似 '(...)' 在Lua pattern里一样，(或者正则表达式里的 '\(...\)' )</p>
<pre class="code">&gt; digit = R<span class="string">'09'</span> <span class="comment">-- anything from '0' to '9'</span>
&gt; digits = digit^1 <span class="comment">-- a sequence of at least one digit</span>
&gt; cdigits= C(digits)  <span class="comment">-- capture digits</span>
&gt; = cdigits:match <span class="string">'123'</span>
123
</pre>
<p>所以要获得字符串，我们需要用 <code>C</code> 包裹模式。</p>
<p>这个模式没有覆盖到广义上的整型。因为整型可能包括 '+' 或者 '-' 出现在前面:</p>
<pre class="code">&gt; int = S<span class="string">'+-'</span>^-1 * digits
&gt; = match(C(int),<span class="string">'+23'</span>)
+23
</pre>
<p>不像Lua模式或者正则表达式，你不需要担心元字符的转义 - 字符串中的每一个字符都只代表自身: '(','+','*', 之类都只匹配他们在ASCII码表达里的同类。</p>
<p>有一类特殊的捕获，需要用到 <code>/</code> 操作符 - 他会将所有匹配的子串丢给一个函数或者table。 这里我会向结果加1，用来演示结果已被<code>tonumber</code>转换成number：</p>
<pre class="code">&gt; =  match(int/<span class="library">tonumber</span>,<span class="string">'+123'</span>) + 1
124
</pre>
<p>注意，一个匹配也可以返回多个捕获, 就像 <code>string.match</code>一样。 等价于 '^(a+)(b+)'：</p>
<pre class="code">&gt; = match(C(P<span class="string">'a'</span>^1) * C(P<span class="string">'b'</span>^1), <span class="string">'aabbbb'</span>)
aa	bbbb
</pre>
<h2>构建更为复杂的模式</h2>
<p>考虑到更为常见的浮点数:</p>
<pre class="code">&gt; <span class="keyword">function</span> maybe(p) <span class="keyword">return</span> p^-1 <span class="keyword">end</span>
&gt; digits = R<span class="string">'09'</span>^1
&gt; mpm = maybe(S<span class="string">'+-'</span>)
&gt; dot = <span class="string">'.'</span>
&gt; exp = S<span class="string">'eE'</span>
&gt; float = mpm * digits * maybe(dot*digits) * maybe(exp*mpm*digits)
&gt; = match(C(float),<span class="string">'2.3'</span>)
2.3
&gt; = match(C(float),<span class="string">'-2'</span>)
-2
&gt; = match(C(float),<span class="string">'2e-02'</span>)
2e-02
</pre>
<p>这个Lpeg模式比正则表达式'[-+]?[0-9]+\.?[0-9]+([eE][+-]?[0-9]+)?'<em>简单</em>得多。越短越好嘛！其中一个原因，是我们可以将模式表达为 <em>表达式</em>: 抽取出常见的模式, 编写相应的函数来提高可读性，让模式使用起来更方便。另外，这样写并没有任何代价；lpeg依然可以高效的分析文本！</p>
<p>这些基本构件可以组成更为复杂的结构。例如分析一个列表的浮点数。一个列表是指一个number接着0个或多个逗号和number：</p>
<pre class="code">&gt; listf = C(float) * (<span class="string">','</span> * C(float))^0
&gt; = listf:match <span class="string">'2,3,4'</span>
2	3	4
</pre>
<p>这样很酷，其实还可以更酷一点，直接将其转换为真正的列表。这就是<code>lpeg.Ct</code> 长处所在； 它可以将所有的捕获归集到一个table里去。</p>
<pre class="code">= match(Ct(listf),<span class="string">'1,2,3'</span>)
<span class="library">table</span>: 0x84fe628
</pre>
<p>默认的Lua不能直接打印table，但你可以使用 [? Microlight] 来完成这个工作:</p>
<pre class="code">&gt; <span class="library">tostring</span> = <span class="library">require</span> <span class="string">'ml'</span>.tstring
&gt; = match(Ct(listf),<span class="string">'1,2,3'</span>)
{<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>}
</pre>
<p>这些值依然是字符串。最佳实践是定义一个<code>listf</code>，让它转换成number:</p>
<pre class="code">&gt; floatc = float/<span class="library">tonumber</span>
&gt; listf = floatc * (<span class="string">','</span> * floatc)^0
</pre>
<p>这种捕获列表的方法非常普遍，你可以将 <em>任意</em> 表达式放到 <code>floatc</code> 的位置上去。 当然，这个列表匹配还是有局限性，一般我们都希望能够直接忽略空格。</p>
<pre class="code">&gt; sp = P<span class="string">' '</span>^0  <span class="comment">-- zero or more spaces (like '%s*')</span>
&gt; <span class="keyword">function</span> space(pat) <span class="keyword">return</span> sp * pat * sp <span class="keyword">end</span> <span class="comment">-- surrond a pattern with optional space</span>
&gt; floatc = space(float/<span class="library">tonumber</span>) 
&gt; listc = floatc * (<span class="string">','</span> * floatc)^0
&gt; =  match(Ct(listc),<span class="string">' 1,2, 3'</span>)
{1,2,3}
</pre>
<p>这里有个品味的问题，我个人喜欢将空格的匹配和 <em>匹配项</em> 写在一起, 而不是和 <em>分隔符</em> ','写在一起。</p>
<p>通过lpeg, 我们就能成为基于模式编程的程序员，并重用模式:</p>
<pre class="code"><span class="keyword">function</span> list(pat)
    pat = space(pat)
    <span class="keyword">return</span> pat * (<span class="string">','</span> * pat)^0
<span class="keyword">end</span>
</pre>
<p>所以，一个列表的识别码可以这样写 (按平常的写法):</p>
<pre class="code">&gt; idenchar = R(<span class="string">'AZ'</span>,<span class="string">'az'</span>)+P<span class="string">'_'</span>
&gt; iden = idenchar * (idenchar+R<span class="string">'09'</span>)^0
&gt; =  list(C(iden)):match <span class="string">'hello, dolly, _x, s23'</span>
<span class="string">"hello"</span>	<span class="string">"dolly"</span>	<span class="string">"_x"</span>	<span class="string">"s23"</span>
</pre>
<p>使用显式的range好像很老土，并且充满错误。一个更可移植的方案，是使用lpeg里的 <em>字符类</em>, 字符类是独立于locale设置的:</p>
<pre class="code">&gt; l = {}
&gt; lpeg.locale(l)
&gt; <span class="keyword">for</span> k <span class="keyword">in</span> <span class="library">pairs</span>(l) <span class="keyword">do</span> <span class="library">print</span>(k) <span class="keyword">end</span>
<span class="string">"punct"</span>
<span class="string">"alpha"</span>
<span class="string">"alnum"</span>
<span class="string">"digit"</span>
<span class="string">"graph"</span>
<span class="string">"xdigit"</span>
<span class="string">"upper"</span>
<span class="string">"space"</span>
<span class="string">"print"</span>
<span class="string">"cntrl"</span>
<span class="string">"lower"</span>
&gt; iden =  (l.alpha+P<span class="string">'_'</span>) * (l.alnum+P<span class="string">'_'</span>)^0
</pre>
<p>给出<code>列表</code>的定义, 就可以定义一个常用CSV格式的子类, 其中每条纪录都是一个列表，列表之间用换行符分隔:</p>
<pre class="code">&gt; rlistf =  list(float/<span class="library">tonumber</span>)
&gt; csv = Ct( (Ct(listf)+<span class="string">'\n'</span>)^1 )
&gt; =  csv:match <span class="string">'1,2.3,3\n10,20, 30\n'</span>
{{1,2.3,3},{10,20,30}}
</pre>
<p>学习lpeg的其中一个理由，是lpeg的表现十分令人满意。这种模式匹配 <em>lot</em> 比使用Lua的原始字符串匹配要快得多。</p>
<h2>字符串替换</h2>
<p>接下来，我会演示给大家看，所有<code>string.gsub</code>可以做的lpeg都可以做，并且更具有一般性，更加灵活。</p>
<p>目前有一个操作符<code>-</code>是尚未展示过的, 它可以表示'任一/或'。 考虑双引号字符串的匹配。在最简单的情况下，一般是一个双引号接着其他不是双引号的字符，最后接上一个封闭的双引号。 <code>P(1)</code> 匹配 <em>任一</em> 单个字符, 就好比字符串模式里的 '.' 。 一个字符串可以是空的，于是我们应该匹配0个或多个非引号字符：</p>
<pre class="code">&gt; Q = P<span class="string">'"'</span>
&gt; str = Q * (P(1) - Q)^0 * Q
&gt; = C(str):match <span class="string">'"hello"'</span>
<span class="string">"\"hello\""</span>
</pre>
<p>或者，你需要的是捕获字符串里的内容，不包括引号。在这种情况下，只要使用<code>1</code>来代替<code>P(1)</code>就好，而且这是一个比较常见的表达'所有不是P的x'模式：</p>
<pre class="code">&gt; str2 = Q * C((1 - Q)^0) * Q
&gt; = str2:match <span class="string">'"hello"'</span>
<span class="string">"hello"</span>
</pre>
<p>这种模式可以简单的普及到其他情形里去；结束符（结束模式）不一定是最终的模式：</p>
<pre class="code"><span class="keyword">function</span> extract_quote(openp,endp)
    openp = P(openp)
    endp = endp <span class="keyword">and</span> P(endp) <span class="keyword">or</span> openp
    <span class="keyword">local</span> upto_endp = (1 - endp)^1 
    <span class="keyword">return</span> openp * C(upto_endp) * endp
<span class="keyword">end</span>
</pre>
<pre class="code">&gt; <span class="keyword">return</span>  extract_quote(<span class="string">'('</span>,<span class="string">')'</span>):match <span class="string">'(and more)'</span>
<span class="string">"and more"</span>
&gt; = extract_quote(<span class="string">'[['</span>,<span class="string">']]'</span>):match <span class="string">'[[long string]]'</span>
<span class="string">"long string"</span>
</pre>
<p>现在，我们来尝试下把Markdown <code>代码块</code> (反斜杠包裹的文本) 转换为 Lua wiki (双花括号包裹的文本)。 最显浅的办法是抽取出字符串并连接成最终结果，但是这看起来很蠢，而且极大的限制了我们的选项（下文将解析这点）。</p>
<pre class="code"><span class="keyword">function</span> subst(openp,repl,endp)
    openp = P(openp)
    endp = endp <span class="keyword">and</span> P(endp) <span class="keyword">or</span> openp
    <span class="keyword">local</span> upto_endp = (1 - endp)^1 
    <span class="keyword">return</span> openp * C(upto_endp)/repl * endp
<span class="keyword">end</span>
</pre>
<pre class="code">&gt; =  subst(<span class="string">'`'</span>,<span class="string">'{{%1}}'</span>):match <span class="string">'`code`'</span>
<span class="string">"{{code}}"</span>
&gt; =  subst(<span class="string">'_'</span>,<span class="string">"''%1''"</span>):match <span class="string">'_italics_'</span>
<span class="string">"''italics''"</span>
</pre>
<p>我们之前曾经用过 <code>/</code> 操作符，使用 <code>tonumber</code> 函数来转换number。 它也有跟 <code>string.gsub</code>极为相似的格式，比如 <code>%n</code> 表示第n个匹配。</p>
<p>这个操作可以被表达为：</p>
<pre class="code">&gt; = <span class="library">string.gsub</span>(<span class="string">'_italics_'</span>,<span class="string">'^_([^_]+)_'</span>,<span class="string">"''%1''"</span>)
<span class="string">"''italics''"</span>
</pre>
<p>优势是我们不在需要写自定义的字符串模式，并费神去转移元字符如'('和')'。</p>
<p><code>lpeg.Cs</code> 是一个 <em>替换捕获</em>，并提供了一个更一般化的全局字符串匹配模块。 在lpeg手册里， <code>string.gsub</code>有这样一个等价的替换：</p>
<pre class="code"><span class="keyword">function</span> gsub (s, patt, repl)
    patt = P(patt)
    <span class="keyword">local</span> p = Cs ((patt / repl + 1)^0)
    <span class="keyword">return</span> p:match(s)
<span class="keyword">end</span>

&gt; =  gsub(<span class="string">'hello dog, dog!'</span>,<span class="string">'dog'</span>,<span class="string">'cat'</span>)
<span class="string">"hello cat, cat!"</span>
</pre>
<p>要理解其中的区别，可以看看只使用单纯的匹配<code>C</code>是怎么使用的:</p>
<pre class="code">&gt; p = C((P<span class="string">'dog'</span>/<span class="string">'cat'</span> + 1)^0)
&gt; = p:match <span class="string">'hello dog, dog!'</span>
<span class="string">"hello dog, dog!"</span>	<span class="string">"cat"</span>	<span class="string">"cat"</span>
</pre>
<p>这里的<code>C</code> 捕获了整个匹配，每一个 '/' 增加了一个新的捕获，捕获的值用替换字符串代替。</p>
<p>而使用<code>Cs</code>, <em>所有匹配</em>都被捕获，最后组成一个字符串。其中一些捕获会被 '/'所修改，所以我们能够获得替换过的字符串。</p>
<p>在Markdown里，区块行以 '&gt; '开始。</p>
<pre class="code">lf = P<span class="string">'\n'</span>
rest_of_line_nl = C((1 - lf)^0*lf)         <span class="comment">-- capture chars upto \n</span>
quoted_line = <span class="string">'&gt; '</span>*rest_of_line_nl       <span class="comment">-- block quote lines start with '&gt; '</span>
<span class="comment">-- collect the quoted lines and put inside [[[..]]]</span>
quote = Cs (quoted_line^1)/<span class="string">"[[[\n%1]]]\n"</span>

&gt; = quote:match <span class="string">'&gt; hello\n&gt; dolly\n'</span>
<span class="string">"[[[
&gt; hello
&gt; dolly
]]]
"</span>
</pre>
<p>这不是那么正确 - <code>Cs</code> 捕获所有东西, 包括 '&gt; '。 但我们可以强迫部分捕获返回空字符串： }}}</p>
<pre class="code"><span class="keyword">function</span> empty(p)
    <span class="keyword">return</span> C(p)/<span class="string">''</span>
<span class="keyword">end</span>

quoted_line = empty (<span class="string">'&gt; '</span>) * rest_of_line_nl
...
</pre>
<p>现在一切都可以正常工作了!</p>
<p>这是最终用来转换Markdown文档到Lua维基格式的代码:</p>
<pre class="code"><span class="keyword">local</span> lpeg = <span class="library">require</span> <span class="string">'lpeg'</span>

<span class="keyword">local</span> P,S,C,Cs,Cg = lpeg.P,lpeg.S,lpeg.C,lpeg.Cs,lpeg.Cg

<span class="keyword">local</span> test = <span class="string">[[
## A title

here _we go_ and `a:bonzo()`:

    one line
    two line
    three line
       
and `more_or_less_something`

[A reference](http://bonzo.dog)

&gt; quoted
&gt; lines
 
]]</span>

<span class="keyword">function</span> subst(openp,repl,endp)
    openp = P(openp)  <span class="comment">-- make sure it's a pattern</span>
    endp = endp <span class="keyword">and</span> P(endp) <span class="keyword">or</span> openp
    <span class="comment">-- pattern is 'bracket followed by any number of non-bracket followed by bracket'</span>
    <span class="keyword">local</span> contents = C((1 - endp)^1)
    <span class="keyword">local</span> patt = openp * contents * endp    
    <span class="keyword">if</span> repl <span class="keyword">then</span> patt = patt/repl <span class="keyword">end</span>
    <span class="keyword">return</span> patt
<span class="keyword">end</span>

<span class="keyword">function</span> empty(p)
    <span class="keyword">return</span> C(p)/<span class="string">''</span>
<span class="keyword">end</span>

lf = P<span class="string">'\n'</span>
rest_of_line = C((1 - lf)^1)
rest_of_line_nl = C((1 - lf)^0*lf)

<span class="comment">-- indented code block</span>
indent = P<span class="string">'\t'</span> + P<span class="string">'    '</span>
indented = empty(indent)*rest_of_line_nl
<span class="comment">-- which we'll assume are Lua code</span>
block = Cs(indented^1)/<span class="string">'    [[[!Lua\n%1]]]\n'</span>

<span class="comment">-- use &gt; to get simple quoted block</span>
quoted_line = empty(<span class="string">'&gt; '</span>)*rest_of_line_nl 
quote = Cs (quoted_line^1)/<span class="string">"[[[\n%1]]]\n"</span>
 
code = subst(<span class="string">'`'</span>,<span class="string">'{{%1}}'</span>)
italic = subst(<span class="string">'_'</span>,<span class="string">"''%1''"</span>)
bold = subst(<span class="string">'**'</span>,<span class="string">"'''%1'''"</span>)
rest_of_line = C((1 - lf)^1)
title1 = P<span class="string">'##'</span> * rest_of_line/<span class="string">'=== %1 ==='</span>
title2 = P<span class="string">'###'</span> * rest_of_line/<span class="string">'== %1 =='</span>

url = (subst(<span class="string">'['</span>,<span class="keyword">nil</span>,<span class="string">']'</span>)*subst(<span class="string">'('</span>,<span class="keyword">nil</span>,<span class="string">')'</span>))/<span class="string">'[%2 %1]'</span>
 
item = block + title1 + title2 + code + italic + bold + quote + url + 1
text = Cs(item^1)

<span class="keyword">if</span> arg[1] <span class="keyword">then</span>
    <span class="keyword">local</span> f = <span class="library">io.open</span>(arg[1])
    test = f:read <span class="string">'*a'</span>
    f:close()
<span class="keyword">end</span>

<span class="library">print</span>(text:match(test))
</pre>
<p>因为这篇维基的转义问题，我需要在这个文本里将'{' 替换为'[' 。请注意！</p>
<p><a href="http://lua-users.org/wiki/SteveDonovan">SteveDonovan</a>, 12 June 2012 --翻译: @spin6lock</p>
<hr />
<h2>组捕获和反向捕获</h2>
<p>本节内容将剖析组捕获和反向捕获 (<code>Cg()</code> 和 <code>Cb()</code> )。</p>
<p>组捕获有两种： 命名式及匿名式。</p>
<pre class="code">    Cg(C<span class="string">"baz"</span> * C<span class="string">"qux"</span>, <span class="string">"name"</span>) <span class="comment">-- 命名组。</span>

    Cg(C<span class="string">"foo"</span> * C<span class="string">"bar"</span>)         <span class="comment">-- 匿名组。</span>
    </pre>
<p>我们先看看简单的部分：table捕获里的命名组。</p>
<pre class="code">    Ct(Cc<span class="string">"foo"</span> * Cg(Cc<span class="string">"bar"</span> * Cc<span class="string">"baz"</span>, <span class="string">"TAG"</span>)* Cc<span class="string">"qux"</span>):match<span class="string">""</span> 
    <span class="comment">--&gt; { "foo", "qux", TAG = "bar" }</span>
    </pre>
<p>在表捕获里，第一个捕获的值 (<code>"bar"</code>) 会被分配到对应的key (<code>"TAG"</code>) 里去。 就像你看到的那样， <code>Cc"baz"</code> 丢失了。 label必须是一个字符串 (如果是数字，则会被转换为字符串)。</p>
<p>注意分组必须是table的一个直接孩子，否则table捕获不会处理:</p>
<pre class="code">    Ct(C(Cg(1,<span class="string">"foo"</span>))):match<span class="string">"a"</span>
    <span class="comment">--&gt; {"a"}</span>
    </pre>
<hr />
<h3>捕获和值</h3>
<p>在深入研究分组之前，我们需要探索一下捕获如何处理他们的子捕获。</p>
<p>有些捕获是操作它们子捕获的值，有些则是有时候这是反直觉的。</p>
<p>我们看看以下这个例子:</p>
<pre class="code">    (1 * C( C<span class="string">"b"</span> * C<span class="string">"c"</span> ) * 1):match<span class="string">"abcd"</span>
    <span class="comment">--&gt; "bc", "b", "c"</span>
    </pre>
<p>就像你看到的一样，它把三个值插入了</p>
<p>我们把它用table报装一下：</p>
<pre class="code">    Ct(1 * C( C<span class="string">"b"</span> * C<span class="string">"c"</span> ) * 1):match<span class="string">"abcd"</span>
    <span class="comment">--&gt; { "bc", "b", "c" }</span>
    </pre>
<p><code>Ct()</code> 作用于值上面。 在上一个例子里面，</p>
<p>现在，我们试试替换捕获:</p>
<pre class="code">    Cs(1 * C( C<span class="string">"b"</span> * C<span class="string">"c"</span> ) * 1):match<span class="string">"abcd"</span>
    <span class="comment">--&gt; "abcd"</span>
    </pre>
<p><code>Cs()</code> 在捕获上操作。 它扫描第一层的嵌套捕获，并只取每个捕获的第一个值。在上述的例子中， <code>"b"</code> 和 <code>"c"</code> 因此被抛弃了。这是另外一个更清晰的例子：</p>
<pre class="code">    <span class="keyword">function</span> the_func (bcd) 
        <span class="library">assert</span>(bcd == <span class="string">"bcd"</span>)
        <span class="keyword">return</span> <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span> 
    <span class="keyword">end</span>

    Ct(1 * ( C<span class="string">"bcd"</span> / the_func ) * 1):match<span class="string">"abcde"</span>
    <span class="comment">--&gt; {"B", "C", "D"}  -- All values are inserted.</span>

    Cs(1 * ( C<span class="string">"bcd"</span> / the_func ) * 1):match<span class="string">"abcde"</span>
    <span class="comment">--&gt; "aBe"   -- the "C" and "D" have been discarded.</span>
    </pre>
<p>其他章节里会更具体的讲述根据值捕获和根据行为捕获的区别。</p>
<hr />
<h3>捕获的不透明性</h3>
<p>另外一个重要的事情，大部分的捕获会抑制他们的子捕获，但不是所有都这样。就像你上一个例子看到的，<code>C"bcd"</code>的值被转到/function捕获里去，但最终捕获列表里不会出现。<code>Ct()</code>和<code>Cs()</code>在这种情形下也是透明的。他们只产生一个table或者一个字符串。</p>
<p>另一方面， <code>C()</code>也是透明的。正如我们上面所看到的，<code>C()</code>的子捕获也会被插入流中。</p>
<pre class="code">    C(C<span class="string">"b"</span> * C<span class="string">"c"</span>):match<span class="string">"bc"</span> <span class="comment">--&gt; "bc", "b", "c"</span>
    </pre>
<p>唯一透明的捕获是<code>C()</code>和匿名的<code>Cg()</code>。</p>
<hr />
<h3>匿名组</h3>
<p><code>Cg()</code> 将子捕获包装到一个单独的捕获对象里去，但不产生自身的任何产物。根据上下文不同，要么它产生的所有值都被插入，要么只插入第一项。</p>
<p>这是匿名组的一些例子：</p>
<pre class="code">    (1 * Cg(C<span class="string">"b"</span> * C<span class="string">"c"</span> * C<span class="string">"d"</span>) * 1):match<span class="string">"abcde"</span>
    <span class="comment">--&gt; "b", "c", "d"</span>

    Ct(1 * Cg(C<span class="string">"b"</span> * C<span class="string">"c"</span> * C<span class="string">"d"</span>) * 1):match<span class="string">"abcde"</span>
    <span class="comment">--&gt; { "b", "c", "d" }</span>

    Cs(1 * Cg(C<span class="string">"b"</span> * C<span class="string">"c"</span> * C<span class="string">"d"</span>) * 1):match<span class="string">"abcde"</span>
    <span class="comment">--&gt; "abe" -- "c" and "d" are dropped.</span>
    </pre>
<p>这些行为有用吗？ 在折叠模式捕获里有用。</p>
<p>我们来写一个非常简单的计算器，用来加上或减去一位数的。</p>
<pre class="code">    <span class="keyword">function</span> calc(a, op, b)
        a, b = <span class="library">tonumber</span>(a), <span class="library">tonumber</span>(b)
        <span class="keyword">if</span> op == <span class="string">"+"</span> <span class="keyword">then</span> 
            <span class="keyword">return</span> a + b
        <span class="keyword">else</span>
            <span class="keyword">return</span> a - b
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    digit = R<span class="string">"09"</span>

    calculate = Cf(
        C(digit) * Cg( C(S<span class="string">"+-"</span>) * C(digit) )^0
        , calc
    )
    calculate:match<span class="string">"1+2-3+4"</span>
    <span class="comment">--&gt; 4</span>

    </pre>
<p>捕获树看起来是这样的 [*]：</p>
<pre class="code">    {<span class="string">"Cf"</span>, func = calc, children = {
        {<span class="string">"C"</span>, val = <span class="string">"1"</span>},
        {<span class="string">"Cg"</span>, children = {
            {<span class="string">"C"</span>, val = <span class="string">"+"</span>},
            {<span class="string">"C"</span>, val = <span class="string">"2"</span>}
        } },
        {<span class="string">"Cg"</span>, children = {
            {<span class="string">"C"</span>, val = <span class="string">"-"</span>},
            {<span class="string">"C"</span>, val = <span class="string">"3"</span>}
        } },
        {<span class="string">"Cg"</span>, children = {
            {<span class="string">"C"</span>, val = <span class="string">"+"</span>},
            {<span class="string">"C"</span>, val = <span class="string">"4"</span>}
        } }
    } }
    </pre>
<p>你可能已经看出来是怎样一回事了。。。就像<code>Cs()</code>一样， <code>Cf()</code> 操作捕获对象。 它会抽出第一个捕获的第一个值，然后作为初始值。如果没有更多捕获，这些值就会成为 <code>Cf()</code> 的值。</p>
<p>但我们有更多的捕获。在我们的例子里，它会将第二个捕获（组捕获）的所有值传给<code>calc()</code>，紧跟第一个的值。这是上面<code>Cf()</code>的运算过程</p>
<pre class="code">    first_arg = <span class="string">"1"</span>
    next_ones: <span class="string">"+"</span>, <span class="string">"2"</span>
    first_arg = calc(<span class="string">"1"</span>, <span class="string">"+"</span>, <span class="string">"2"</span>) <span class="comment">-- 3, calc() returns numbers</span>

    next_ones: <span class="string">"-"</span>, <span class="string">"3"</span>
    first_arg = calc(3, <span class="string">"-"</span>, <span class="string">"3"</span>)

    next_ones: <span class="string">"+"</span>, <span class="string">"4"</span>
    first_arg = calc(0, <span class="string">"+"</span>, <span class="string">"4"</span>)

    <span class="keyword">return</span> first_arg <span class="comment">-- Tadaaaa.</span>
    </pre>
<p>[*] 实际上，在匹配的时候，捕获对象只存储他们的边界和额外的数据 (比如为<code>Cf()</code> 储存<code>calc()</code> )。实际值会在匹配完成后依次产生，但是，它可以让代码变得更清晰。在上面的例子里，嵌套的<code>C()</code>和<code>Cg(C(), C())</code>是每次输出一个，对应到折叠过程里自身的循环中。</p>
<hr />
<h3>命名组</h3>
<p>命名组<code>Cg()</code>/<code>Cb()</code>跟匿名组<code>Cg()</code>有类似的行为，但<code></code>Cg()捕获的值不是在局部插入的。他们在<code>Cb()</code>的位置插入流中。</p>
<p>举个例子:</p>
<pre class="code">    ( 1 * Cg(C<span class="string">"bc"</span>, <span class="string">"FOOO"</span>) * C<span class="string">"d"</span> * 1 * Cb<span class="string">"FOOO"</span> * Cb<span class="string">"FOOO"</span>):match<span class="string">"abcde"</span>
    <span class="comment">-- &gt; "d", "bc", "bc"    </span>
    </pre>
<p>如果有超过一个 <code>Cb()</code>，就会有副本产生。 另一个例子：</p>
<pre class="code">    ( 1 * Cg(C<span class="string">"b"</span> * C<span class="string">"c"</span> * C<span class="string">"d"</span>, <span class="string">"FOOO"</span>) * C<span class="string">"e"</span> * Ct(Cb<span class="string">"FOOO"</span>) ):match<span class="string">"abcde"</span>
    <span class="comment">--&gt; "e", { "b", "c", "d" }</span>
    </pre>
<p>为了让代码更清晰，我一般会将<code>Cg()</code> 命名为 <code>Tag()</code>。 我会在匿名组里使用前者，而在命名组里使用后者。</p>
<p><code>Cb"FOOO"</code> 会往回查找一个成功的<code>Cg()</code> 匹配。它会在捕获树里往回和往上查找，并消耗对应的捕获。换句话说，它会搜索比自己更年长的兄弟，以及父母的兄弟，但不会搜索自己的父母。也不会查找他们祖先的兄弟的孩子。</p>
<p>它是像下文一样运行的(从 <code>[ #### ] &lt;--- [[ START ]]</code> 开始，并随着数字回溯)。</p>
<p><code>[ numbered ]</code>是按顺序测试的捕获。 用 <code>[ ** ]</code> 标记的则不是，原因见下。有点千头万绪，但是在我能考虑到的范围里是完备的。</p>
<pre class="code">    Cg(<span class="comment">-- [ ** ] ... This one would have been seen, </span>
       <span class="comment">-- if the search hadn't stopped at *the one*.</span>
       <span class="string">"Too late, mate."</span>
        , <span class="string">"~@~"</span>
    )

    * Cg( <span class="comment">-- [ 3 ] The search ends here. &lt;--------------[[ Stop ]]</span>
        <span class="string">"This is *the one*!"</span>
        , <span class="string">"~@~"</span>
    )

    * Cg(<span class="comment">--  [ ** ] ... The great grand parent. </span>
                     <span class="comment">-- Cg with the right tag, but direct ancestor,</span>
                     <span class="comment">-- thus not checked.</span>

        
        Cg( <span class="comment">-- [ 2 ] ... Cg, but not the right tag. Skipped.</span>
            Cg( <span class="comment">-- [ ** ] good tag but masked by the parent (whatever its type)</span>
                <span class="string">"Masked"</span>
                , <span class="string">"~@~"</span>
            )
            , <span class="string">"BADTAG"</span>
        )

        * C( <span class="comment">-- [ ** ] ... grand parent. Not even checked.</span>

            ( 
                Cg( <span class="comment">-- [ ** ] ... This subpattern will fail after Cg() succeeds.</span>
                    <span class="comment">-- The group is thus removed from the capture tree, and will</span>
                    <span class="comment">-- not be found dureing the lookup.</span>
                    <span class="string">"FAIL"</span>
                    , <span class="string">"~@~"</span>
                ) 
                * <span class="keyword">false</span> 
            )

            + Cmt(  <span class="comment">-- [ ** ] ... Direct parent. Not assessed.</span>
                C(1) <span class="comment">-- [ 1 ] ... Not a Cg. Skip.</span>

                * Cb<span class="string">"~@~"</span>   <span class="comment">-- [ #### ]  &lt;----------------- [[ START HERE ]] --</span>
                , <span class="keyword">function</span>(subject, index, cap1, cap2) 
                    <span class="keyword">return</span> <span class="library">assert</span>(cap2 == <span class="string">"This is *the one*!"</span>)
                <span class="keyword">end</span>
            )
        )
        , <span class="string">"~@~"</span> <span class="comment">-- [ ** ] This label goes with the great grand parent.</span>
    )
    </pre>
<hr />
<p>-- <a href="http://lua-users.org/wiki/PierreYvesGerardy">PierreYvesGerardy</a>&nbsp;翻译by：@spin6lock</p>
<hr />
<p><a href="http://lua-users.org/wiki/RecentChanges">RecentChanges</a> &middot; <a href="http://lua-users.org/cgi-bin/wiki.pl?action=editprefs">preferences</a><br />
<a href="http://lua-users.org/cgi-bin/wiki.pl?action=edit&amp;id=LpegTutorial">edit</a> &middot; <a href="http://lua-users.org/cgi-bin/wiki.pl?action=history&amp;id=LpegTutorial">history</a><br />Last edited May 24, 2015 11:11 am GMT <a href="http://lua-users.org/cgi-bin/wiki.pl?action=browse&amp;diff=1&amp;id=LpegTutorial">(diff)</a>
</p>
<p>&nbsp;</p>]]></description></item><item><title>为python-sproto添加map支持</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/06/05/add_unorder_map_support_to_sproto.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 04 Jun 2015 17:03:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/06/05/add_unorder_map_support_to_sproto.html</guid><description><![CDATA[<p>上个月太忙了，做完这个修改还没写博客，现在补一下。。</p>
<p>&nbsp;</p>
<p>之前使用protobuf做协议打包的时候，经常会有个痛点，没法用具体数据的值作为key来索引数据。比如现在客户端上传了造兵协议，协议大概长这样：</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">{
   {
      troop_type </span>= <span style="color: #800080;">101</span><span style="color: #000000;">,
      amount </span>= <span style="color: #800080;">1</span><span style="color: #000000;">,
   },
   {
      troop_tyoe </span>= 10<span style="color: #800080;">2</span><span style="color: #000000;">,
      amount </span>= <span style="color: #800080;">2</span><span style="color: #000000;">,
   },    
}</span></pre>
</div>
<p>可以看到，造兵协议是一个数组，数组里每个元素是一个结构，包含troop_type（兵种类别）和amount（数量）。每次收到的时候，都需要遍历一次来建立一个以troop_type为key的字典，或者使用时根据troop_type来遍历查找。</p>
<p>&nbsp;</p>
<p>sproto添加的这个支持，就是通过添加一点语法糖，让解出来的数据可以天然的以troop_type做key，解出来的数据就变成这样：</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">{
   [</span><span style="color: #800080;">101</span>] =<span style="color: #000000;"> {
      troop_type </span>= <span style="color: #800080;">1</span><span style="color: #000000;">,
      amount </span>= <span style="color: #800080;">1</span><span style="color: #000000;">,
   },
   [10</span><span style="color: #800080;">2</span>] =<span style="color: #000000;"> {
      troop_tyoe </span>= <span style="color: #800080;">2</span><span style="color: #000000;">,
      amount </span>= <span style="color: #800080;">2</span><span style="color: #000000;">,
   },    
}</span></pre>
</div>
<p>&nbsp;</p>
<p>python绑定添加这个支持不难，但是会丧失一个错误检查的机会。当把一个Dict传给sproto的时候，如果这个域的定义是数组，将会报错退出。现在支持map后，将会兼容这种情况，直接取出Dict的value作为数组的内容。解包的时候，操作会稍微复杂一点，因为解包出来的域，根据协议应该是一个List，但是mainindex会提示需要将这个域变成一个Dict。</p>
<p>&nbsp;</p>
<p>最后，还添加了一点异常处理，若解包过程中出错，会把解出来的这个字典直接释放掉。有点担心异常处理的时候，会不会导致引用计数没有处理好，引起内存泄漏。以后有空再做一下内存泄漏分析~具体的修改可以参考：https://github.com/spin6lock/python-sproto.git</p>]]></description></item><item><title>玩家回档原因分析</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/04/30/accident_user_data_rollback.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 30 Apr 2015 07:38:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/04/30/accident_user_data_rollback.html</guid><description><![CDATA[<p>在最近一次维护后，玩家发现有较大规模的数据回档，还有一小部分玩家无法登录。现在尝试还原一下现场。</p>
<p>当天维护的时候，SA执行了一次数据库维护。维护是通过一个脚本完成的，而且执行过多次，理论上没有问题。而维护的过程中，开发组这边需要执行一个脚本，给一批玩家增加经验。这一切完成后，QC简单复测了一下，就开服了。开服后发现，服务器出现大量报错，而且都是玩家数据出现问题。定位这个问题的时候，发现玩家的数据丢掉了导致无法登录，顿时吓尿了=_=||| 论坛里也有玩家开始叫骂，定位了一下貌似是那批增加经验的玩家，于是马上复查增加经验的脚本。玩家数据存储是使用redis数据库的，脚本里就使用了一条hincrby指令，不应该会清掉数据啊</p>
<p>&nbsp;</p>
<p>接着，我们想到了一个可能，会不会是SA做迁移的过程中，我们跑脚本了，然后迁移数据的脚本看见有数据，就不再存入，导致玩家数据只剩下刷入的经验值呢？实践出真知，实验表明，redis自身是有实现保护的，正在恢复数据库的过程里，外部复写的数据会提示报错。虽然没追踪到主因，但是我们之前额外做了一套旁路备份，用golang+leveldb实现的一套redis存盘代码。里面的数据肯定是对的，只是由于redis对应uid里有数据，所以不再从leveldb里取数据而已。说时迟那时快，快刀斩乱麻将加经验那批玩家的redis数据干掉，玩家就可以登录了。</p>
<p>&nbsp;</p>
<p>慢着，报错还是没有停，还有一大票玩家遇到同样的情况。我们终于开始怀疑SA同学的脚本了。后来才发现，由于之前没有规范操作，导致备份的目录错了，SA同学启用的数据库位置是正确的，但是之前错误操作，把一个老的数据库放进正确的位置了，导致实际上跑起来的，是一个147天前的数据库。于是，加经验的那批玩家中，是这三个多月里创号的，就会只剩下一个刷入的经验值，建筑数据等等都会丢掉了。而没有刷入经验值的玩家，是通过leveldb，取到最新的档案，所以反而能够正常游戏。</p>
<p>&nbsp;</p>
<p>最终，在2130这个高峰时间，我们停服维护了。把下午维护前备份的数据库恢复回去，少部分玩家丢失了3个小时左右的游戏数据，so sad。事实证明，我们的旁路备份是坚实有效的，前提是修复故障前，先要理清头绪，不要盲目修复，才能最大限度的减少损失。另外，不要设定不可能区域，SA同学也是人，也有犯错的可能。</p>]]></description></item><item><title>为sproto添加python绑定</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/03/19/python_sproto_introduction.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 19 Mar 2015 11:26:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/03/19/python_sproto_introduction.html</guid><description><![CDATA[<p>项目地址：<a href="https://github.com/spin6lock/python-sproto" target="_blank">https://github.com/spin6lock/python-sproto</a></p>
<p>第一次写Python的C扩展，留点笔记记录一下。主要的参考文档是：<a href="https://docs.python.org/2/extending/extending.html" target="_blank">Extending Python with C/C++</a>, 之前也看过cython，但是用Python语法写C还是没学会，稍后再尝试用cython写一遍看看。</p>
<p>&nbsp;</p>
<p>作为一个C扩展，是以Module的方式import进去代码里使用的，所以需要注册一下，把自己的接口告诉Python解释器。代码如下图：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">static</span> PyMethodDef pysproto_methods[] =<span style="color: #000000;"> {
    {</span><span style="color: #800000;">"</span><span style="color: #800000;">sproto_create</span><span style="color: #800000;">"</span><span style="color: #000000;">, py_sproto_create, METH_VARARGS},
    {</span><span style="color: #800000;">"</span><span style="color: #800000;">sproto_type</span><span style="color: #800000;">"</span><span style="color: #000000;">, py_sproto_type, METH_VARARGS},
    {</span><span style="color: #800000;">"</span><span style="color: #800000;">sproto_encode</span><span style="color: #800000;">"</span><span style="color: #000000;">, py_sproto_encode, METH_VARARGS},
    {</span><span style="color: #800000;">"</span><span style="color: #800000;">sproto_decode</span><span style="color: #800000;">"</span><span style="color: #000000;">, py_sproto_decode, METH_VARARGS},
    {</span><span style="color: #800000;">"</span><span style="color: #800000;">sproto_pack</span><span style="color: #800000;">"</span><span style="color: #000000;">, py_sproto_pack, METH_VARARGS},
    {</span><span style="color: #800000;">"</span><span style="color: #800000;">sproto_unpack</span><span style="color: #800000;">"</span><span style="color: #000000;">, py_sproto_unpack, METH_VARARGS},
    {</span><span style="color: #800000;">"</span><span style="color: #800000;">sproto_protocol</span><span style="color: #800000;">"</span><span style="color: #000000;">, py_sproto_protocol, METH_VARARGS},
    {NULL, NULL}
};

PyMODINIT_FUNC
initpysproto(</span><span style="color: #0000ff;">void</span><span style="color: #000000;">){
    PyObject </span>*<span style="color: #000000;">m;
    m </span>= Py_InitModule(<span style="color: #800000;">"</span><span style="color: #800000;">pysproto</span><span style="color: #800000;">"</span><span style="color: #000000;">, pysproto_methods);
    </span><span style="color: #0000ff;">if</span> (m ==<span style="color: #000000;"> NULL) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
    }
    SprotoError </span>= PyErr_NewException(<span style="color: #800000;">"</span><span style="color: #800000;">pysproto.error</span><span style="color: #800000;">"</span><span style="color: #000000;">, NULL, NULL);
    Py_INCREF(SprotoError);
    PyModule_AddObject(m, </span><span style="color: #800000;">"</span><span style="color: #800000;">error</span><span style="color: #800000;">"</span><span style="color: #000000;">, SprotoError);
}</span></pre>
</div>
<pre>pysproto_methods是一个数组，每个元素是一个三元组{暴露给python的方法名，对应的C函数名，参数格式}，以{NULL, NULL}表示结束。<br />init模块名(void)是一个特殊的函数，当Python里输入import 模块名的时候，C层就会调用 init模块名 来执行模块的初始化工作。Py_InitModule表示将上面的模块方法数组暴露给Python，下面的代码向模块注册了一个SprotoError，表明模块自带的异常类型。<br /><br />Python传参数给C：<br />参见py_sproto_create，通过PyArg_ParseTuple函数接收参数。<br /><br /></pre>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff;">char</span> *<span style="color: #000000;">buffer;
    </span><span style="color: #0000ff;">int</span> sz = <span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">struct</span> sproto *<span style="color: #000000;">sp;
    </span><span style="color: #0000ff;">if</span> (!PyArg_ParseTuple(args, <span style="color: #800000;">"</span><span style="color: #800000;">s#</span><span style="color: #800000;">"</span>, &amp;buffer, &amp;<span style="color: #000000;">sz)) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> NULL;
    }</span></pre>
</div>
<p>&nbsp;ParseTuple有点像C的scanf，可以按指定格式读取函数的参数，还能自己设置异常，比如参数类型不对，参数个数不对之类的。所有暴露给Python解释器的C接口，只要返回NULL，解释器就知道你出错了，就会把设置好的异常抛出。</p>
<p>&nbsp;</p>
<p>C需要返回给Python的，一般有int，string和指针三类。前面两类都可以通过Py_BuildValue解决，参考如下：</p>
<div class="cnblogs_code">
<pre>PyObject *data = Py_BuildValue(<span style="color: #800000;">"</span><span style="color: #800000;">s#</span><span style="color: #800000;">"</span>, (<span style="color: #0000ff;">char</span>*)value, length);</pre>
</div>
<p>s#表示带长度参数的字符串，这样字符串里就可以包含结束符了。表示整型时，format参数用i。返回Py_BuildValue构建的PyObject指针，就能在Python代码里接收这个对象了。</p>
<p>&nbsp;</p>
<p>如果要在不同的C函数之间传递C指针，则需要用到PyCapsule_New来建立一个Capsule，把C指针包起来。这个capsule可以指定名字，方便Python代码里打印。还可以指定destructor，当这个Capsule脱出当前scope，被gc回收的时候，就会调用destructor来析构。Python还贴心的提供了一个Context，用来给这个Capsule带上额外的数据，方便后续使用。</p>
<p>&nbsp;</p>
<p>对于python-sproto来说，之前有个问题一直没处理好，sproto_type其实是对sproto的一个指针，指向其成员。所以，如果sproto被gc掉了，sproto_type就有可能出错。而且这个出错是取决于gc时机，如果gc没跑，sproto那块内存还在，就不会出错。这种隐藏的bug比较难查。简单来说，就是C扩展暴露给Python的对象，相互之间对生命周期有依赖关系。sproto_type依赖于sproto，所以sproto的生命周期至少应该和sproto_type一样长。为了向解释器说明这件事，需要用到Py_XINCREF和Py_XDECREF，当生成新的sproto_type的时候，给sproto调用Py_XINCREF，表示对sproto的引用加1，销毁的时候就在析构函数里减1，表示取消引用。</p>
<p>&nbsp;</p>
<p>更优雅的做法，应该是把这类生命周期相关的信息，写在脚本里，而不是在C里处理。对外提供的可以是一个Python的类，这个类自己管理相关对象的生命周期，只要这个类还在，就能保证生命周期正确。</p>]]></description></item><item><title>如何快速编写Vim语法高亮文件</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/03/11/vim_syntax_highlight.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 11 Mar 2015 04:43:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/03/11/vim_syntax_highlight.html</guid><description><![CDATA[<p>这里有一份<a href="http://vimcdoc.sourceforge.net/doc/syntax.html" target="_blank">中文的入门文档</a>，但是太长了，不想读，所以有本文</p>
<p>&nbsp;</p>
<ol>
<li>最快的办法，就是找一个语法相近的语法高亮文件，稍微改一下</li>
<li>自己从头写的话，首先搞定关键字：</li>
</ol>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p>
<div class="cnblogs_code">
<pre>syntax <span style="color: #0000ff;">case</span> match <span style="color: #800000;">"</span><span style="color: #800000;">是否区分大小写</span>
<span style="color: #000000;">syntax keyword 你的关键字类别名字x   关键字1 关键字2
syntax keyword 同样填x的话，不会覆盖，只追加   关键字3 关键字4</span></pre>
</div>
<p>关键字搞不定的，一般用正则匹配：</p>
<div class="cnblogs_code">
<pre>syntax match 类别名  /正则表达式/</pre>
</div>
<p>正则有个麻烦是不能部分匹配，比如我要匹配花括号前的，/[a-zA-Z_]+\s{/, Vim的语法高亮没有匹配组的概念，没法只高亮前面的字串，导致花括号也染色了。</p>
<p>这种情况下，需要用到嵌套识别，一般是region里嵌套keyword和match，也可以match里嵌套match。例如：</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">syntax keyword spTodo       contained TODO FIXME XXX
syntax cluster spCommentGrp contains</span>=<span style="color: #000000;">spTodo
syntax region  spComment start</span>=<span style="color: #800000;">"</span><span style="color: #800000;">//</span><span style="color: #800000;">"</span> skip=<span style="color: #800000;">"</span><span style="color: #800000;">\\$</span><span style="color: #800000;">"</span> end=<span style="color: #800000;">"</span><span style="color: #800000;">$</span><span style="color: #800000;">"</span> keepend contains=@spCommentGrp</pre>
</div>
<p>通过contains关键字，指定这个区域包含了哪些语法单位。</p>]]></description></item><item><title>windows调试器尝鲜</title><link>http://www.cnblogs.com/Lifehacker/archive/2015/02/23/ollyDbg200.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 23 Feb 2015 09:54:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2015/02/23/ollyDbg200.html</guid><description><![CDATA[<p>曾几何时，我也下载过看雪论坛精华看的津津有味。可惜一直没有动手去调试，学到的x86汇编指令也忘得差不多了。最近将老机器的T4200 CPU换成了更省电，温度更低的P8800，为了支援新的VT虚拟化，特地将Dell 1545的BIOS从A8升级到A14。顺带发现SLIC已经自动升级到2.0了。但是升级以后，win7开始菜单的睡眠功能就无法使用了，于是萌生了降级刷BIOS的想法。</p>
<p>&nbsp;</p>
<p>下好了1545A13的BIOS，运行后发现出现了一个warning信息，大意就是不能降级安装，点个确定就退出了。理想情况下warning应该是可以忽略的啊，网上搜索了一下，有个/forceit的命令行开关，实际执行发现没效果，决定上调试器。之前试用过windbg，有个功能很不错，可以在访问指定范围的内存时停下来，可惜没找到如何进入用户态。换了ollydbg，德国人出品的共享软件，非商用不要钱，写邮件注册下就好。</p>
<p>&nbsp;</p>
<p>围观了一下ollydbg的教程，基本上简单的破解就三板斧，首先搜索所有引用字符串，然后定位到代码里引用这个字符串的位置，在附近下个断点，最后实际运行下，观察代码路径，看看是哪个代码分支跳转到字符串的，然后改跳转就好。于是按部就班的修改一下1545A13的驱动：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201502/231715085804988.png" alt="" /></p>
<p>查找所有字符串，然后在弹出的窗口中搜索：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201502/231716058303631.png" alt="" /></p>
<p>&nbsp;</p>
<p>然后在反汇编器里面跟踪：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201502/231713532685931.png" alt="" /></p>
<p>于是很清晰的定位到显示msgbox的位置：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201502/231718305804209.png" alt="" /></p>
<p>可以看到，显示警告信息的前面几条指令里，有个条件跳转 JLE 00422E15。我们直接将其改为强制跳转，绕过警告信息的显示和接下来的退出流程。先按下F2打一个断点，然后按F9直接运行到该条指令：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201502/231722412364565.png" alt="" /></p>
<p><img src="http://images.cnitblog.com/blog/90397/201502/231723391747066.png" alt="" /></p>
<p>将指令改为JMP，地址不变</p>
<p>于是我们就看见亲爱的降级刷BIOS界面了，完。</p>
<p><img src="http://images.cnitblog.com/blog/90397/201502/231725321118395.png" alt="" /></p>]]></description></item><item><title>休斯顿，我们遇到了一个问题</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/12/27/bitsquatting_in_tcp.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 27 Dec 2014 09:14:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/12/27/bitsquatting_in_tcp.html</guid><description><![CDATA[<p>最近和前端同学聊得比较多，聊着聊着发现前端回报了一个诡异的错误，服务器端发给客户端的JSON错了，解不开。前端同学bs了一下服务器用的JSON库，居然连编码都会出错。我检查了所用的库，前后端的确用的不是同一个json.lua，于是跑了一次简单的压测。当然，没有发现问题。过了两天，又遇到同一个问题了，这次我留心了一下错误的详细内容：</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>coco/game.lua:<span style="color: #800080;">86</span>: coco/lib/json.lua:<span style="color: #800080;">525</span>: coco/lib/json.lua:<span style="color: #800080;">240</span>: expected colon at char <span style="color: #800080;">119</span> of: [{<span style="color: #800000;">"</span><span style="color: #800000;">res_amount</span><span style="color: #800000;">"</span>:<span style="color: #800080;">5</span>,<span style="color: #800000;">"</span><span style="color: #800000;">id</span><span style="color: #800000;">"</span>:<span style="color: #800080;">1</span>,<span style="color: #800000;">"</span><span style="color: #800000;">status</span><span style="color: #800000;">"</span>:<span style="color: #800080;">2</span>,<span style="color: #800000;">"</span><span style="color: #800000;">res_type</span><span style="color: #800000;">"</span>:<span style="color: #800080;">1</span>},{<span style="color: #800000;">"</span><span style="color: #800000;">res_amount</span><span style="color: #800000;">"</span>:<span style="color: #800080;">50000</span>,<span style="color: #800000;">"</span><span style="color: #800000;">id</span><span style="color: #800000;">"</span>:<span style="color: #800080;">2</span>,<span style="color: #800000;">"</span><span style="color: #800000;">status":0,"</span>res_type<span style="color: #800000;">"</span><span style="color: #800000;">:2},{</span><span style="color: #800000;">"</span>res_amount2:<span style="color: #800080;">5</span>,<span style="color: #800000;">"</span><span style="color: #800000;">id</span><span style="color: #800000;">"</span>:<span style="color: #800080;">3</span>,<span style="color: #800000;">"</span><span style="color: #800000;">status</span><span style="color: #800000;">"</span>:<span style="color: #800080;">2</span>,<span style="color: #800000;">"</span><span style="color: #800000;">res_type</span><span style="color: #800000;">"</span>:<span style="color: #800080;">1</span>},{<span style="color: #800000;">"</span><span style="color: #800000;">res_amount</span><span style="color: #800000;">"</span>:<span style="color: #800080;">50000</span>,<span style="color: #800000;">"</span><span style="color: #800000;">id</span><span style="color: #800000;">"</span>:<span style="color: #800080;">4</span>,<span style="color: #800000;">"</span><span style="color: #800000;">status</span><span style="color: #800000;">"</span>:<span style="color: #800080;">0</span>,<span style="color: #800000;">"</span><span style="color: #800000;">res_type</span><span style="color: #800000;">"</span>:<span style="color: #800080;">3</span>},{<span style="color: #800000;">"</span><span style="color: #800000;">res_amount</span><span style="color: #800000;">"</span>:<span style="color: #800080;">7</span>,<span style="color: #800000;">"</span><span style="color: #800000;">id</span><span style="color: #800000;">"</span>:<span style="color: #800080;">5</span>,<span style="color: #800000;">"</span><span style="color: #800000;">status</span><span style="color: #800000;">"</span>:<span style="color: #800080;">0</span>,<span style="color: #800000;">"</span><span style="color: #800000;">res_type</span><span style="color: #800000;">"</span>:<span style="color: #800080;">1</span>},{<span style="color: #800000;">"</span><span style="color: #800000;">res_amount</span><span style="color: #800000;">"</span>:<span style="color: #800080;">50000</span>,<span style="color: #800000;">"</span><span style="color: #800000;">i</span>d<span style="color: #800000;">"</span><span style="color: #800000;">:6,</span><span style="color: #800000;">"</span>status<span style="color: #800000;">"</span><span style="color: #800000;">:0,</span><span style="color: #800000;">"</span>res_type<span style="color: #800000;">"</span><span style="color: #800000;">:5},{</span><span style="color: #800000;">"</span>res_amount<span style="color: #800000;">"</span><span style="color: #800000;">:8,</span><span style="color: #800000;">"</span>id<span style="color: #800000;">"</span><span style="color: #800000;">:7,</span><span style="color: #800000;">"</span>status<span style="color: #800000;">"</span><span style="color: #800000;">:0,</span><span style="color: #800000;">"</span>res_type<span style="color: #800000;">"</span><span style="color: #800000;">:1}]</span></pre>
</div>
<pre><br />可以看到，具体错误：</pre>
<div class="cnblogs_code">
<pre>{<span style="color: #800000;">"</span><span style="color: #800000;">res_amount2:5,</span><span style="color: #800000;">"</span>id<span style="color: #800000;">"</span><span style="color: #800000;">:3,</span><span style="color: #800000;">"</span>status<span style="color: #800000;">"</span><span style="color: #800000;">:2,</span><span style="color: #800000;">"</span>res_type<span style="color: #800000;">"</span><span style="color: #800000;">:1}</span></pre>
</div>
<p>本来是引号的地方，变成了2。比较一下两者的二进制表示：</p>
<table style="height: 71px; width: 284px;" border="0">
<tbody>
<tr>
<td>0011 0010</td>
<td>2</td>
</tr>
<tr>
<td>0010 0010</td>
<td>"</td>
</tr>
</tbody>
</table>
<p>两者只差一个比特！再找到上一次的错误，是一个,变成了&lt;：</p>
<table style="width: 300px;" border="0">
<tbody>
<tr>
<td>0010 1100</td>
<td>,</td>
</tr>
<tr>
<td>0011 1100</td>
<td>&lt;</td>
</tr>
</tbody>
</table>
<p>看来，我们遇到了传说中的比特反转！相关的资料可以参考<a href="http://blog.jobbole.com/74149/" target="_blank">这篇文章</a>。</p>
<p>&nbsp;</p>
<p>一时好奇心起来，就写了个爬虫，爬了最近十天的日志记录（没有权限查数据库Orz），分析了约80万条日志，总共扫出了6例类似的报错。发生的机型以国产机居多，以下是点名时间（啪啪啪）：</p>
<table style="width: 300px;" border="0">
<tbody>
<tr>
<td>
<div>SM-G3502</div>
</td>
</tr>
<tr>
<td>
<div>Coolpad 8705</div>
</td>
</tr>
<tr>
<td>
<div>Coolpad 8720L</div>
</td>
</tr>
<tr>
<td>
<div>HUAWEI G521-L076</div>
</td>
</tr>
<tr>
<td>
<div>ASUS_T00F</div>
</td>
</tr>
<tr>
<td>
<div>vivo X3t</div>
</td>
</tr>
</tbody>
</table>
<p>品牌从三星到华为，再到接地气的coolpad都有。</p>
<p>相信实际上发生的比特反转几率会比这个还要多，因为发生在json字符串中间，或者json数值中间的，都不会被发现。另外，二进制打包是用protobuf做的，pb包损坏的报错其实也不少，只是这个就没法确认是1比特坏了还是多个比特坏了。据<a href="http://dinaburg.org/data/DC19_Dinaburg_Presentation.pdf" target="_blank">参考资料</a>说，4G内存的PC机，每小时3bit错误到每个月3bit错误都有，而移动设备的数量比PC要多得多，所以出现这种情况一点都不奇怪。</p>
<p>&nbsp;</p>
<p>及后，我分析了一下我们的协议收发过程，当时实现的时候没有加上验证码。如果加上了，可以补上一个包重发机制，遇到错误的包要求服务器重发。或者添加某些校验码，类似服务器内存使用的ECC，可以让只错了1bit的包恢复回来。第一次发现TCP也会不可靠，哈哈</p>
<p>&nbsp;</p>
<pre></pre>]]></description></item><item><title>糟糕的十一月</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/11/30/mail_system_in_lsg.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 30 Nov 2014 09:19:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/11/30/mail_system_in_lsg.html</guid><description><![CDATA[<p>十一月感觉就是写邮件系统和两个策划要的活动而已。。。</p>
<p>&nbsp;</p>
<p>一直觉得邮件系统十分简单，但是实现的时候却不是一回事。实现速度比预期的慢，一方面是边写边参考了礼包系统的结构，另一方面是抽象错误。就因为邮件放在礼包的位置，然后邮件看起来只是比礼包多一两个字段，所以就参考了礼包系统。这个错误实在太严重。表现层的相似性居然影响到后端的实现！！！</p>
<p>&nbsp;</p>
<p>上周的code review里，被喷了两个多小时。焦点主要是两个地方，一是对内部来说，其他子系统用邮件的时候不友好；二是协议来说，冗余太多，浪费带宽，协议之间也没有正交。解决办法是，为各种类型的邮件建立模板工厂。写邮件的时候，只需要输入所需的少数几个参数，由生成出来的方法检查参数正确性，及特定邮件的固定参数。协议方面，添加了分页加载功能。</p>
<p>&nbsp;</p>
<p>接着另一位同事，参考了其他项目的情况，抽象出一个更好用的存储层。虽然，存储层做的无非是CRUD，对于邮件系统而言，更可以缩减为CRD。具体实现上，还包含了一层cache，避免对数据库的高频读写。但是，我原来的实现，是按照显示邮件所需的各个参数来做序列化的，因此，其他系统难以复用。当然，设计之初也没有打算提供给内部系统用。。现在，把这一块变成了Json做存储，谁都可以用，底层负责数据存储和消息通知，相当于一个带持久化的消息队列。有了这个队列，写邮件系统就简单多了，无非是检查客户端输入，然后到这个消息队列进行查询即可。这个队列写起来也很简单，只需要删除过期消息，不需要管具体存储，相当于有一块字符串过来就丢一块到数据库，取出来的时候按tag和uid直接取出相应队列即可，十分高效。</p>
<p>&nbsp;</p>
<p>谢谢各位同事的包容，以后要加倍努力~</p>]]></description></item><item><title>skynet的协程</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/10/26/skynet_coroutine.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 26 Oct 2014 04:19:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/10/26/skynet_coroutine.html</guid><description><![CDATA[<p>之前对skynet的印象，主要是来自于我对golang的理解，对gevent开发的经验，以及云风的blog。对于底层的代码，并没有仔细去阅读过。最近在实现业务系统的时候，发现有同事在同一个函数里做了一个互斥的判断，才发现对skynet的理解有误。</p>
<p>&nbsp;</p>
<p>以前，用python的gevent框架实现游戏服务器的时候，会针对每个玩家建立3-5个greenlet（协程），用于处理玩家身上的定时器事件，以及IO操作。然后还有少数几个协程处理全局的定时器事件。当然，战斗是放在独立的进程中实现的，那边基本上每个怪都有1-2个greenlet，一个房间里有几十个greenlet是很正常的。总结起来，就是python+gevent为了规避全局锁，采用了多进程，每个进程多greenlet的实现方式。</p>
<p>&nbsp;</p>
<p>而对于golang，会变成底层是多线程模型，上面跑着多个goroutine，当一个goroutine发起阻塞式IO的时候，底层负责跑这个goroutine的线程，可以随之阻塞等待。系统便随即开一个新的线程，从一堆goroutine里挑一个可以执行的，继续执行。golang就相当于用多线程，取代了以前py的多进程。</p>
<p>&nbsp;</p>
<p>读完云风的blog，我对skynet的理解，就是每个线程来跑一个Lua的VM，一系列的VM组成了一个队列。然后每个VM有自己的消息队列，VM运行时，就从自己的消息队列里，拿出一条消息执行。得益于Lua的沙盒机制，即使某个VM发生traceback，也能得到有效隔离。同时，因为同处一个进程内，VM之间数据交互可以做到相当高效，字符串之类的传递只要传指针即可。</p>
<p>&nbsp;</p>
<p>但是，我之前忽略了Lua协程在其中发挥的作用。原来，一个服务（即一个VM）收到一个包req，就会新建一个协程进行处理。处理过程中，如果产生一个对外的call请求，req包是当成处理完的，当前的协程是会刮起，等待call请求返回来唤醒。这时候服务可以继续建立新的协程来处理新的消息包，而不会阻塞住。也就是说，如果处理一个包的过程中，发生了skynet.call调用，是会造成多个协程并发执行的。如果不注意用锁保护协程间的共享资源，就有可能出现问题。</p>]]></description></item><item><title>redis-persist上线</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/10/17/redis_persist_publish.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 16 Oct 2014 17:47:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/10/17/redis_persist_publish.html</guid><description><![CDATA[<p>九月份惨不忍睹，因为代码质量不够高，直接被Boss喷成了筛子。被反复教育说要高质量的代码，要可维护、高性能&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>幸而，最后一周终于在紧张的加班中，灰度上线redis-land-go了，项目也改名为redis-persist，<a href="https://github.com/xjdrew/redis-persist" target="_blank">github在此</a>。</p>
<p>&nbsp;</p>
<p>之前实现的，是redis到leveldb，以及skynet从leveldb中读取数据的接口。最后一周添加的，是SA同事可能会用到的功能。主要是：</p>
<ul>
<li>dump</li>
<li>restore_one</li>
<li>restore_all</li>
<li>sync</li>
<li>sync_all</li>
<li>count</li>
<li>diff</li>
<li>keys</li>
<li>check_all</li>
<li>fast_check</li>
</ul>
<p>这些指令可以分成三类，一类是从redis拷贝到leveldb的，比如sync开头的指令；一类是从leveldb拷贝到redis中的，典型如restore开头的指令；剩下的是用来检验两侧数据的，比如检查一个玩家数据的diff，检查数量的count，还有列出leveldb部分玩家uid的keys</p>
<p>&nbsp;</p>
<p>这里的fast_check是针对当前玩家存储做的一个特殊优化，在leveldb中用前缀分出了一个特殊的key表，里面是玩家uid-玩家数据version的key-value对。这个表足够小，可以整个放进内存里，所以对于只需比对数据版本号的情况，能够在极短时间完成。redis和leveldb通过网络连接，不在一台机器上时，12w数据不超过1分钟。</p>
<p>&nbsp;</p>
<p>同时，折腾这套工具的时候，还顺便看了一下leveldb的结构。leveldb有个sstable的概念，sstable就是内存里一块按key有序排列好的表，可以改动的时候叫memtable，准备写入磁盘的是另一个表，叫sstable。当数据比较少的时候，层级也比较少，具体哪个ldb文件对应哪一段key范围，是记录在MANIFEST里面的。写入的记录，首先记入log里，这是顺序写，所以极快。然后是定期后台整理，将sstable和磁盘上已有的ldb文件合并，使得磁盘的数据越来越有序。</p>]]></description></item><item><title>忙里偷闲的八月</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/08/30/dns_query_and_http_proxy.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 30 Aug 2014 12:00:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/08/30/dns_query_and_http_proxy.html</guid><description><![CDATA[<p>八月依然有些很狗血的策划案要做，以至于花了两周时间，周五做出来后，连策划自己都觉得配置超多超复杂。。。</p>
<p>&nbsp;</p>
<p>这个月比较过瘾的，是下决心做了dns的实验。当时为了防止DNS污染，曾经用Python写过一个DNS代理，通过TCP管道传输解析包，避免墙的干扰，地址在<a href="https://code.google.com/p/pydnsproxy/" target="_blank">google code</a>。项目原本是通过丢弃最先返回的udp包来实现的，后来改为了TCP查询。不过，当时硬着头皮读的<a href="https://www.ietf.org/rfc/rfc1035.txt" target="_blank">RFC1035</a>，只读懂了TCP的部分，只要将接收到的包体加上长度作为包头，就可以直接丢到TCP管道的另一端，解包也是根据包头解出DNS返回包，送回到查询者即可。</p>
<p>&nbsp;</p>
<p>于是，这个月就再重读了一次RFC，实现了一个基本的域名=&gt;dns查询工具，地址在<a href="https://github.com/spin6lock/dns_experiment" target="_blank">github</a>。真正实现的时候，RFC文档还是很实用的，尤其是里面查询结构的定义，相当清晰。就是在python里不大好处理位，需要自己做与运算。实现时有个问题不是很明白，为什么域名要分成label这样的短字符串来实现，搞的一个域名有可能用了3个字节，只是用来分别标记3个label各自的长度呢？后面有提到域名label的复用机制，但是这个和一个完整字符串是不矛盾的啊。Anyway，这种jump指针的实现的确很巧妙，甚为折服。调试的时候，还初步学会了使用scapy工具，碉堡了。可以输入RFC里面的各种参数来构造一个包，还能打印出包体的字符串表示，通过对比很快知道了自己实现的缺陷所在。最爽的是还能从IP包构建到UDP包，通过 IP包/UDP包 这种表示来表达payload的意思，有空用来写个TCPkill玩玩，哈哈。</p>
<p>&nbsp;</p>
<p>另一件，是参与到晓靖的<a href="https://github.com/xjdrew/levent.git" target="_blank">levent项目</a>里。levent在Lua里基本复刻出python的gevent，顺带创建了自己的类机制，还有一些非常实用的库比如struct（跟python的struct相仿）。随手写了两个示例，一个是负责端口转发的<a href="https://github.com/xjdrew/levent/blob/master/examples/portforward.lua" target="_blank">portforward</a>，另一个是<a href="https://github.com/xjdrew/levent/blob/master/examples/http_proxy_server.lua" target="_blank">http代理</a>。写端口转发的时候，竟然有种写golang的感觉，一个lua的coroutine，就好比一个golang的goroutine。针对一个socket起了两个协程，一个负责读，一个负责写，在虚拟机里跑能有2000多的qps，还算不错。对比gevent，gevent一开始能够上3000多，不过越跑越慢，最后完全跑不动了。用的是示例里的echo server，测试用的redis benchmark。http代理的实现，参考了<a href="https://code.google.com/p/python-proxy/source/browse/trunk/PythonProxy.py" target="_blank">PythonProxy</a>的实现。对于1.0的http协议，只支持了GET，POST等有限几种方法。除了CONNECT方法外，基本都是改写一下头部，丢过去服务器就可以了。CONNECT方法更简单，连接后直接作为管道转发数据，连header都不用改写了。。。</p>
<p>&nbsp;</p>
<p>希望接下来的9月顺顺利利啊</p>]]></description></item><item><title>并行的边界</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/08/02/the_edge_of_service.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 02 Aug 2014 09:44:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/08/02/the_edge_of_service.html</guid><description><![CDATA[<p>七月份忙的狗一样，还一度要12点赶回公司修bug，真累。。。</p>
<p>&nbsp;</p>
<p>入职以来的这两个月，一直在业务层摸索，苦于没有文档，rpc协议、单件服务的启动、为热更新去准备的环境变量等等，都要一一在摸索中问出来。幸而，终于走过了这一段。这也促使我开始思考，skynet、gevent、golang之间，各自的优点和缺点是什么。</p>
<p>&nbsp;</p>
<p>先从skynet说起，最直观的感受是，skynet在lua/c里几乎完全复制了python的标准库。上至打包用的serialize、json库，下至打印字典(table)的prettyprint，都实现了一遍。所以，使用过程还是比较愉快的，前提是你找到了这个库。。另外，底层rpc使用了Google的protobuf负责打包，实际使用中发现，我们基本就用int32和string，枚举和布尔值也用的不多。其实就跟上家公司一样，对rpc只要支持字符串、整型、数组和自定义结构体就够了。protobuf单个结构的定义过程和标准的一样，不同的是协议的定义。使用了一个protolist文件标记所有的协议，然后又分默认写法、请求为空写法、回复为空写法。与其支持这么多东西，倒不如直接全部自己定义，不搞默认值那一套了。</p>
<p>&nbsp;</p>
<p>最令人蛋疼的，是服务之间的交互。起服务的时候，要记得在两个地方注册，因为skynet有集群模式和单机模式的区别。然后服务之间交互，需要手动写call，告诉skynet我调的服务叫什么名字，如果没有名字就传一个固定的id进去识别。然后写完逻辑，返回数据的时候，要记得用skynet retpack一下，要不发出请求的服务就会一直卡在等待状态，而且没有任何报错提示。如果说受限于lua的语法，不方便增加新的写法以表明跨越了协程，至少我写完call，skyne返回数据的时候能打包吧？据说，这个支持是为了在函数体中间给skynet返回结果，再继续做其他事用的。但是这种想象中的灵活写法，为业务层开发带来了隐含的信息假设，而项目又没有文档说明这个事情。</p>
<p>&nbsp;</p>
<p>对于skynet的agent模式，我还是比较欣赏的。但是和gevent、golang不同，跨agent之间的通信需要显式调用底层的接口，这就比较疼了。我希望agent服务能够有自己的超时机制，如果跨agent的调用过一段时间没有返回，至少你给我个提示信息来查一下嘛。往大里做的话，还需要给agent的相互调用添加监视，控制调用频率、是否重试等等。作为分布式系统，其实是将单进程/单线程的复杂性转移到整个架构部署的复杂度上来，这样每个服务会变简单，复杂性就体现在服务的交互过程和服务本身的维护上了。</p>
<p>&nbsp;</p>
<p>golang没有显式的标记一个服务，任何函数只要用go这个关键字去跑，就可以作为一个协程单独跑起来。交互的时候，使用了channel这种东西去告诉底层，发生了一个跨越边界的消息传递。而gevent则是通过spawn这个函数去跑起一个新的greenlet作为协程。由于不会跨越线程/进程边界，gevent也不需要对消息传递进行特殊处理，只要按普通函数的调用来做就好了。</p>
<p>&nbsp;</p>
<p>综合来看，显式指定并行的边界，有助于底层并发的优化，但是没有合适的语法糖和基础设施，写业务的时候就会觉得好累了。</p>]]></description></item><item><title>初来乍到</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/06/15/join_ejoy_company.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 15 Jun 2014 13:40:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/06/15/join_ejoy_company.html</guid><description><![CDATA[<p>来到新公司后，终于有机会用git作为版本控制的工具。通过github私有仓库进行Pull Request和code review，的确十分方便。使用的时候发现自己关于分支的知识不够用了，出现过一次提交Pull Request后被merge，然后自己本地又merge了，导致git pull时版本冲突的问题。另外，客户端不希望出现merge，所有对共享配置的修改，都需要用rebase方式合并，又犯了一次错误&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>最近提交的代码里，主要是用python写的一个日志分析处理的工具。原来SA的童鞋用shell脚本搞了一个，不过对shell相关工具链用的比较深，改起来和调试也不太方便，于是我们这边主推用python重写一个版本。对于数据呈现，使用了<a href="http://dygraphs.com/">dygraphs</a>作为前端展现的工具，使用上还是比较简单的，指定一个div让它替换为图标，把数据整理成csv喂给它就可以了。这绘图还带了一个拖动条，可以重点看某一段时间的数据，十分不错。</p>
<p>&nbsp;</p>
<p>游戏的逻辑代码也开始接触了，预计下周可以ship到生产环境上。新公司的qc数量不是很够，出bug影响比较严重，所以ship代码会比较谨慎。在skynet上写逻辑，与我之前的代码写法有点像。之前做军团模块，为了抽离数据保存的细节，特别做了一层agent，负责具体操作数据。新公司里，在skynet上跑的Lua代码，也是agent，具体的数据放在redis。就好比redis是一个数据结构的库，lua只负责业务逻辑，通过redis来存储、获取和设置数据。redis的效率很高，即使是集中发礼包这种活动，也只是卡了几秒就完成了。而且，分离开不稳定的业务逻辑层后，业务逻辑层的崩溃不至于丢失业务数据，随时可重启解决问题。</p>
<p>&nbsp;</p>
<p>新同事不见得特别牛逼，也不是神一般不会犯错误，但是他们修复错误的速度很惊人，很快便找到完成目标的正确方法，这点很值得我学习。希望下周一切顺利</p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>进程daemon化</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/05/26/3754180.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 26 May 2014 15:33:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/05/26/3754180.html</guid><description><![CDATA[<p>最近跳槽，转去简悦了，新公司的技术氛围很好，我要更加努力~</p>
<p>&nbsp;</p>
<p>有些问题不写博客的时候，以为自己是懂的，但是实际讨论的时候，发现有一些细节还是没有搞清楚，这次试试讲进程怎样daemon化。</p>
<p>首先上代码，这次的代码来自于stackoverflow：http://stackoverflow.com/questions/17954432/creating-a-daemon-in-linux</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;"> * daemonize.c
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> * This example daemonizes a process, writes a few log messages,
</span><span style="color: #008080;"> 4</span> <span style="color: #008000;"> * sleeps 20 seconds and terminates afterwards.
</span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span> #include &lt;stdio.h&gt;
<span style="color: #008080;"> 8</span> #include &lt;stdlib.h&gt;
<span style="color: #008080;"> 9</span> #include &lt;unistd.h&gt;
<span style="color: #008080;">10</span> #include &lt;signal.h&gt;
<span style="color: #008080;">11</span> #include &lt;sys/types.h&gt;
<span style="color: #008080;">12</span> #include &lt;sys/stat.h&gt;
<span style="color: #008080;">13</span> #include &lt;syslog.h&gt;
<span style="color: #008080;">14</span> 
<span style="color: #008080;">15</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> skeleton_daemon()
</span><span style="color: #008080;">16</span> <span style="color: #000000;">{
</span><span style="color: #008080;">17</span> <span style="color: #000000;">    pid_t pid;
</span><span style="color: #008080;">18</span> 
<span style="color: #008080;">19</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> Fork off the parent process </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">20</span>     pid =<span style="color: #000000;"> fork();
</span><span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> An error occurred </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">23</span>     <span style="color: #0000ff;">if</span> (pid &lt; <span style="color: #800080;">0</span><span style="color: #000000;">)
</span><span style="color: #008080;">24</span> <span style="color: #000000;">        exit(EXIT_FAILURE);
</span><span style="color: #008080;">25</span> 
<span style="color: #008080;">26</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> Success: Let the parent terminate </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">27</span>     <span style="color: #0000ff;">if</span> (pid &gt; <span style="color: #800080;">0</span><span style="color: #000000;">)
</span><span style="color: #008080;">28</span> <span style="color: #000000;">        exit(EXIT_SUCCESS);
</span><span style="color: #008080;">29</span> 
<span style="color: #008080;">30</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> On success: The child process becomes session leader </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">31</span>     <span style="color: #0000ff;">if</span> (setsid() &lt; <span style="color: #800080;">0</span><span style="color: #000000;">)
</span><span style="color: #008080;">32</span> <span style="color: #000000;">        exit(EXIT_FAILURE);
</span><span style="color: #008080;">33</span> 
<span style="color: #008080;">34</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> Catch, ignore and handle signals </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">35</span>     <span style="color: #008000;">//</span><span style="color: #008000;">TODO: Implement a working signal handler */</span>
<span style="color: #008080;">36</span> <span style="color: #000000;">    signal(SIGCHLD, SIG_IGN);
</span><span style="color: #008080;">37</span> <span style="color: #000000;">    signal(SIGHUP, SIG_IGN);
</span><span style="color: #008080;">38</span> 
<span style="color: #008080;">39</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> Fork off for the second time</span><span style="color: #008000;">*/</span>
<span style="color: #008080;">40</span>     pid =<span style="color: #000000;"> fork();
</span><span style="color: #008080;">41</span> 
<span style="color: #008080;">42</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> An error occurred </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">43</span>     <span style="color: #0000ff;">if</span> (pid &lt; <span style="color: #800080;">0</span><span style="color: #000000;">)
</span><span style="color: #008080;">44</span> <span style="color: #000000;">        exit(EXIT_FAILURE);
</span><span style="color: #008080;">45</span> 
<span style="color: #008080;">46</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> Success: Let the parent terminate </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">47</span>     <span style="color: #0000ff;">if</span> (pid &gt; <span style="color: #800080;">0</span><span style="color: #000000;">)
</span><span style="color: #008080;">48</span> <span style="color: #000000;">        exit(EXIT_SUCCESS);
</span><span style="color: #008080;">49</span> 
<span style="color: #008080;">50</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> Set new file permissions </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">51</span>     umask(<span style="color: #800080;">0</span><span style="color: #000000;">);
</span><span style="color: #008080;">52</span> 
<span style="color: #008080;">53</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> Change the working directory to the root directory </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">54</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> or another appropriated directory </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">55</span>     chdir(<span style="color: #800000;">"</span><span style="color: #800000;">/</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">56</span> 
<span style="color: #008080;">57</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> Close all open file descriptors </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">58</span>     <span style="color: #0000ff;">int</span><span style="color: #000000;"> x;
</span><span style="color: #008080;">59</span>     <span style="color: #0000ff;">for</span> (x = sysconf(_SC_OPEN_MAX); x&gt;<span style="color: #800080;">0</span>; x--<span style="color: #000000;">)
</span><span style="color: #008080;">60</span> <span style="color: #000000;">    {
</span><span style="color: #008080;">61</span> <span style="color: #000000;">        close (x);
</span><span style="color: #008080;">62</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">63</span> 
<span style="color: #008080;">64</span>     <span style="color: #008000;">/*</span><span style="color: #008000;"> Open the log file </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">65</span>     openlog (<span style="color: #800000;">"</span><span style="color: #800000;">firstdaemon</span><span style="color: #800000;">"</span><span style="color: #000000;">, LOG_PID, LOG_DAEMON);
</span><span style="color: #008080;">66</span> <span style="color: #000000;">}
</span><span style="color: #008080;">67</span> 
<span style="color: #008080;">68</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
</span><span style="color: #008080;">69</span> <span style="color: #000000;">{
</span><span style="color: #008080;">70</span> <span style="color: #000000;">    skeleton_daemon();
</span><span style="color: #008080;">71</span> 
<span style="color: #008080;">72</span>     <span style="color: #0000ff;">while</span> (<span style="color: #800080;">1</span><span style="color: #000000;">)
</span><span style="color: #008080;">73</span> <span style="color: #000000;">    {
</span><span style="color: #008080;">74</span>         <span style="color: #008000;">//</span><span style="color: #008000;">TODO: Insert daemon code here.</span>
<span style="color: #008080;">75</span>         syslog (LOG_NOTICE, <span style="color: #800000;">"</span><span style="color: #800000;">First daemon started.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">76</span>         sleep (<span style="color: #800080;">20</span><span style="color: #000000;">);
</span><span style="color: #008080;">77</span>         <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">78</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">79</span> 
<span style="color: #008080;">80</span>     syslog (LOG_NOTICE, <span style="color: #800000;">"</span><span style="color: #800000;">First daemon terminated.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">81</span> <span style="color: #000000;">    closelog();
</span><span style="color: #008080;">82</span> 
<span style="color: #008080;">83</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> EXIT_SUCCESS;
</span><span style="color: #008080;">84</span> }</pre>
</div>
<p>&nbsp;</p>
<p>fork出子进程后，子进程结束时并不会马上被回收，而是形成一个僵尸进程。因为，父进程需要对子进程的尸体进行回收（以获得子进程的运行结果），如果父进程不关心子进程的状态，可以设置SIGHLD信号量的处理为忽略。考虑到不同系统实现不同，对于非Linux的系统，即使父进程设置了不关心子进程状态，依然有可能</p>]]></description></item><item><title>嵌入式课程设计--第一天</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/05/06/first_day_on_embedded_system.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 05 May 2014 17:14:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/05/06/first_day_on_embedded_system.html</guid><description><![CDATA[<p>今天花了一个早上去配置开发环境，晕死。。。</p>
<p>主要问题是找到一个合适的2410实验箱。电脑方面虽然普遍带毒，好歹还是能跑起来。但实验箱方面就比较麻烦。一个是线缆的配合，包括串行线，串行线方面有两种，一种是斜纹，一种是直纹的，它们分别是交叉线和非交叉线。另一个比较重要的线缆是JTAG线，我们见的JTAG线比较少，所以刚开始的时候拿了另一个实验箱的线。&nbsp;</p>
<p>然后是熟悉了一下vivi的操作，首先是尝试把一个helloworld的文件通过JTAG线烧进去，这个理论上机器正常都可以输出结果，不需要串行线、键盘之类的配合，应该最简单。结果试过多台机器都不行。后来partner提醒道，大于4KB的文件是跑不起来的，而helloworld有17KB&hellip;&hellip;</p>
<p>最后用老师平时演示的机器，终于把hf_vivi烧进去了。然后通过hf_vivi把vivi烧进去。最后成功了。刚下载好360杀毒，剩下的就等吧。。。</p>]]></description></item><item><title>引用计数gc机制使用不当导致内存泄漏</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/05/06/3710645.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 05 May 2014 17:09:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/05/06/3710645.html</guid><description><![CDATA[<p>上一篇文章找同事review了一下，收到的反馈是铺垫太长了，我尽量直入正题，哈哈</p>
<p>&nbsp;</p>
<p>最近dbd压测时发现内存泄漏，其实这个问题去年已经暴露了，参见这篇<a href="http://www.cnblogs.com/Lifehacker/p/stress_test_and_memory_leak_detect.html">博客【压测周】</a>。当时排查不够仔细，在此检讨下。关于dbd的内存问题，还有<a href="http://www.cnblogs.com/Lifehacker/p/thread_safe_problem_on_type_system.html">这篇博客</a>讨论线程安全，以及<a href="http://www.cnblogs.com/Lifehacker/p/dbd_structure_and_bson_format_process.html">这篇博客</a>讨论临时变量的处理。当时还存了一个尾巴，因为用到关联数组进行脏数据管理，这部分数据是怎么释放的一直没搞明白。今天算是搞明白了，这个内存泄漏的bug也源于此。</p>
<p>&nbsp;</p>
<p>基于引用计数的gc机制，应该是在引用计数为0的时候释放内存的，lpc也基本没有例外。具体详情可以参看free_svalue的实现，里面基本是引用计数减去1，然后检查是否引用计数为0，若是0就执行相关的Free操作。其中，有一半的篇幅都是讲字符串的释放的，剩下的则是object、buffer、array、mapping、class以及function的释放问题。所以，基本上，lpc不需要像golang一样，停止一切操作做mark and swap的gc操作。也不同于Lua的标记清除，不需要分步执行，只要引用计数为0，立马释放掉。</p>
<p>&nbsp;</p>
<p>为什么是基本上呢？因为对于object类型，lpc并没有对其立即释放，而是放到一个链表里面，待主循环里没有函数执行时，再行销毁。这样做，一方面是为了配合复杂的热更新机制，另一方面，则是解决object循环引用的需要。对于对象的销毁，首先调用的是destruct_object, 这个函数最终的作用是为对象打上销毁标志。在这个函数里，针对master object和simul_efun object做了热更新的处理。然后从栈上移除object的所有引用，从object#n列表里移除这个object。最后打上销毁标记，并放入待销毁列表。</p>
<p>&nbsp;</p>
<p>下一步，则调用destruct2, 首先将该object的所有变量释放。如果该对象有对自身引用，则因为这一步而引用计数减一，方便接下来释放该对象本身。接着调用free_object, 对象引用次数为0，已打上销毁标记，功成身退，成功析构。</p>
<p>&nbsp;</p>
<p>由于在dbd中，没有跑lpc脚本，所有的关联数组（mapping）都是在C层生成和使用的，因此引用计数需要手工维护，这就是万恶之源了。对于脚本层，新建的变量，引用计数都应该为1，退出变量作用域时，则引用计数减一。放入mapping时，引用次数相应加1。而在C层使用mapping时，所有变量的组织都是围绕mapping展开的，变量的生命周期就等同于mapping的生命周期。当序列化数据后，释放数据对应的mapping时，会对其中的所有变量引用计数-1，但依然计数不为0，因此无法释放。</p>
<p>&nbsp;</p>
<p>解决的办法也相当简单，变量放入mapping前，先free_svalue，将引用计数变为0，则加入mapping后，引用计数为1，生命周期就同mapping一样了。</p>]]></description></item><item><title>脚本引擎栈指针误操作引起内存泄露</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/04/24/find_out_memory_leak_by_stress_testing.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 24 Apr 2014 12:37:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/04/24/find_out_memory_leak_by_stress_testing.html</guid><description><![CDATA[<p>最近，为了确定目标部署机器的配置，我们对服务器进行了玩家登录的压力测试。在E7500 cpu，3G内存的开发机上，同一时间登录人数不能超过20人。以0.01秒间隔登录，测试人数5000人，登录时一个核心在30%-60%之间波动，另一个核心比较空闲。稳定后，CPU平均在5%一下（玩家只是登录后保持心跳），峰值内存在2.3G以内。但比较诡异的是，当玩家全部断开后，服务器的内存还是没有降下来。我觉得，可能是发生内存泄露了。</p>
<p>&nbsp;</p>
<p>发现这个问题后，我排查了底层对玩家user object的管理。user有两个部分组成，一个是外部包裹的一层网络统计相关的信息，另一个是内部的lpc object。外部的user有online_user_tbl这个哈希表负责管理，提供了遍历方法、总数统计及获取所有对象的方法。而实际数据的存放，则是在all_users里面，这个是一个大型数组，启动时按配置设定的最大在线人数进行预分配。</p>
<p>&nbsp;</p>
<p>通过dumpallobj()接口，初步发现内存泄露时，user对象虽然释放缓慢，但是在几分钟之内，已经全部释放完毕。因此排除了user对象的泄露。再加上预分配的all_users列表，大小是可以估算出来的，大概400M的样子，不可能引起那么大的问题。于是又通过memory_info(), 打印出lpc vm各种string, mapping, object的内存占用，发现还是没有异常。跟老大商量过后，他认为是内部做了内存池之类的结构，证据是内存不会无限疯长，只要没有活跃玩家，峰值就停留在2.3G左右。由于没有头绪，只好暂时放下。</p>
<p>&nbsp;</p>
<p>昨天，为了测试网关服务器的转发性能，我便写了个ping pong测试，大约是3Mb/s，1000包/s的样子。CPU占用有点高，一个核心占了50%。诡异的是，做ping pong测试没有涉及具体逻辑，但是内存一直在不停地涨。跟老大反映后，他认为是最近新加入的脚本层socket有问题。于是，花了大半天的时间，仔细审核那段代码。的确发现了有一处内存泄露，在某一处错误检测里，会直接return掉，没有处理中间分配的临时变量。不过那个条件分支没有跑到，所以内存泄露应该是别的地方。</p>
<p>&nbsp;</p>
<p>今天，又特意写了黑洞测试来考察脚本层socket。在只是打数据到远端服务器，不需要序列化，不需要处理逻辑的情况下，服务器内存占用相当稳定，看来可以排除lpc socket了。ping pong的逻辑只有100行不到，那剩下来的应该就是序列化数据和反序列化数据的地方了。当时，出于通用协议的考虑，内部服务器之间的通信，没有具体定协议，只是以req和resp两条协议做支撑，参数序列化为json字符串进行发送。没想到，单独序列化和单独反序列化都没有内存泄露。我原以为是序列化/反序列化过程中，对临时生成的字符串没处理好，造成内存泄漏的。</p>
<p>&nbsp;</p>
<p>后来，和老大一道，审读json序列化和反序列化的代码，发现栈顶指针操作有点异常。对于一般的脚本层调C层efun，会用宏SET_ALL_ARGS获得参数的个数和偏移地址，在处理完参数转换后，再通过POP_ALL_ARGS清除所有栈顶的所有参数（参数的引用计数减1）。当有返回值时，将返回值压入栈顶。没有返回值时，压入空值。但是，反序列化的函数，只是暴力的将栈顶指针指向自己生成的返回值，没有对传入的参数做任何处理。就是这个地方，导致了参数的内存泄漏。其实我早该想到的，不是序列化过程中的泄漏，也不是某一单过程的泄露，那就应该是传参出问题了。。。以后要统一规范，用对应的宏来正确处理栈指针和脚本层传来的参数。</p>]]></description></item><item><title>[译]libev和libevent的设计差异</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/03/31/whats_the_difference_between_libevent_and_libev_chinese.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 31 Mar 2014 09:48:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/03/31/whats_the_difference_between_libevent_and_libev_chinese.html</guid><description><![CDATA[<p>本文译自<a href="http://stackoverflow.com/questions/9433864/whats-the-difference-between-libev-and-libevent">what's the difference between libev and libevent?</a>&nbsp;作者是libev作者</p>
<p>&nbsp;</p>
<p>[问]两个库都是为异步io调度而设计，在Linux上都是使用epoll机制，在FreeBSD上则都是kqueue，还有诸如此类的很多相通之处。</p>
<p>&nbsp;</p>
<p>除了这些表面上的差别外，其实这两者根本的区别在哪里呢？比如架构上，或者设计哲学上。</p>
<p>&nbsp;</p>
<p>[答]就设计哲学来说，libev的诞生，是为了修复libevent设计上的一些错误决策。例如，全局变量的使用，让libevent很难在多线程环境中使用。watcher结构体很大，因为它们包含了I/O，定时器和信号处理器。额外的组件如HTTP和DNS服务器，因为拙劣的实现品质和安全问题而备受折磨。定时器不精确，而且无法很好地处理时间跳变。</p>
<p>&nbsp;</p>
<p>libev试图改进所有这些缺陷，例如避免使用全局变量，转而在所有函数中，使用上下文变量来代替。每个事件类型，使用单独的watcher类型（一个I/O watcher在64位机器上，只需要56字节。而libevent需要136字节）。允许额外的事件类型，例如基于挂钟的计时器，或者单调时间，线程内中断，准备并检查watchers来嵌入其他事件循环，或者被用于其他事件循环来嵌入。</p>
<p>&nbsp;</p>
<p>额外组件的问题，是通过直接去掉额外组件来解决的，这样libev就可以小而美，快速高效了。但你也需要从其他地方寻找http库。因为libev没有带上。（例如，有一个库叫libeio，可以完成异步IO的工作，也可以和libev配合使用)。</p>
<p>&nbsp;</p>
<p>总而言之，libev试图做好一件事而已（目标是成为POSIX的事件库），这是最高效的方法。libevent则尝试给你全套解决方案（事件库，非阻塞IO库，http库，DNS客户端）</p>
<p>&nbsp;</p>
<p>一句话总结，libev尝试追随UNIX工具箱哲学，一次只干一件事，每次都做到最好。</p>
<p>&nbsp;</p>
<p>注意，这是libev的设计哲学，我想我作为libev的设计者，有着足够的发言权。至于这些设计目标有没有实际达到，或者这些设计哲学是否坚实可靠，则交由你来评判。</p>
<p>&nbsp;</p>
<p>[译者注]第一次注意到libev，是在gevent的开发者blog上的这篇<a href="http://blog.gevent.org/2011/04/28/libev-and-libevent/">libev and libevent</a>，它简要说明了gevent从libevent切换到libev的决策过程。回顾gevent，它实际需要的只是一个负责事件循环的C库，在上面的HTTP库和DNS库，都可以交由标准库强大得不得了的python完成。因此，作者的选择还是非常明智的。</p>
<p>&nbsp;</p>
<p>从Libevent 2.0来看，libevent团队已经意识到上述的问题，也提取出了event loop这个上下文context，但是在具体的DNS解析，HTTPS连接等等，还是有种力不从心的感觉。作为libevent的使用者，我们经历了libevent的试错阶段，发现HTTPS实现不行，再切换到libcurl去，与其这样，倒不如直接不提供该功能呢</p>]]></description></item><item><title>libevent库1.4升级到2.0时无法flush的解决办法</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/03/18/libevent_upgrade_from_1-4_to_2-0-21.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 18 Mar 2014 09:10:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/03/18/libevent_upgrade_from_1-4_to_2-0-21.html</guid><description><![CDATA[<p>libevent的接口兼容性做的还算不错，基本上替换一下就转到新版本了。但是，强制flush数据的时候出了问题。目前的应用场景是，遇到顶号登录这种情形，先用bufferevent_write向客户端发送错误信息，然后再断开socket。用的flush是这样的：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">void</span> try_flush(bufferevent *<span style="color: #000000;">bev) {
    </span><span style="color: #0000ff;">int</span> size =<span style="color: #000000;"> evbuffer_get_length(bufferevent_get_output(bev));
    </span><span style="color: #0000ff;">if</span> (size &gt; <span style="color: #800080;">0</span><span style="color: #000000;">) {
        evbuffer_write(bufferevent_get_output(bev), fd);
    }  
}</span></pre>
</div>
<p>&nbsp;</p>
<p>在1.4的时候，这段代码工作良好。但是，在2.0的libevent里，这段代码不能刷出数据。看了下errno和socket_errno，错误码是EINPROGRESS。百思不得其解下，在脚本层将关闭socket放在下一次libevent事件循环里完成，结果就好了。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>大致猜测下，应该是libevent为了效率做的优化。因为write是比较昂贵的系统调用，若因为evbuffer_write的反复调用，而引起多次write，会影响性能。翻了一下libevent 2.0的代码，evbuffer_write是调用evbuffer_write_atmost的，对比下1.4 evbuffer_write和2.0的evbuffer_write_atmost:</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">int</span><span style="color: #000000;">
evbuffer_write(</span><span style="color: #0000ff;">struct</span> evbuffer *buffer, <span style="color: #0000ff;">int</span><span style="color: #000000;"> fd)
{
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n;

#ifndef WIN32
    n </span>= write(fd, buffer-&gt;buffer, buffer-&gt;<span style="color: #000000;">off);
</span><span style="color: #0000ff;">#else</span><span style="color: #000000;">
    n </span>= send(fd, buffer-&gt;buffer, buffer-&gt;off, <span style="color: #800080;">0</span><span style="color: #000000;">);
</span><span style="color: #0000ff;">#endif</span>
    <span style="color: #0000ff;">if</span> (n == -<span style="color: #800080;">1</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span> (-<span style="color: #800080;">1</span><span style="color: #000000;">);
    </span><span style="color: #0000ff;">if</span> (n == <span style="color: #800080;">0</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span> (<span style="color: #800080;">0</span><span style="color: #000000;">);
    evbuffer_drain(buffer, n);

    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (n);
}</span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">int</span><span style="color: #000000;">
evbuffer_write_atmost(</span><span style="color: #0000ff;">struct</span> evbuffer *<span style="color: #000000;">buffer, evutil_socket_t fd,
    ev_ssize_t howmuch)
{
    </span><span style="color: #0000ff;">int</span> n = -<span style="color: #800080;">1</span><span style="color: #000000;">;

    EVBUFFER_LOCK(buffer);

    </span><span style="color: #0000ff;">if</span> (buffer-&gt;<span style="color: #000000;">freeze_start) {
        </span><span style="color: #0000ff;">goto</span><span style="color: #000000;"> done;
    }

    </span><span style="color: #0000ff;">if</span> (howmuch &lt; <span style="color: #800080;">0</span> || (size_t)howmuch &gt; buffer-&gt;<span style="color: #000000;">total_len)
        howmuch </span>= buffer-&gt;<span style="color: #000000;">total_len;

    </span><span style="color: #0000ff;">if</span> (howmuch &gt; <span style="color: #800080;">0</span><span style="color: #000000;">) {
#ifdef USE_SENDFILE
        </span><span style="color: #0000ff;">struct</span> evbuffer_chain *chain = buffer-&gt;<span style="color: #000000;">first;
        </span><span style="color: #0000ff;">if</span> (chain != NULL &amp;&amp; (chain-&gt;flags &amp;<span style="color: #000000;"> EVBUFFER_SENDFILE))
            n </span>=<span style="color: #000000;"> evbuffer_write_sendfile(buffer, fd, howmuch);
        </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #0000ff;">#endif</span><span style="color: #000000;">
#ifdef USE_IOVEC_IMPL
        n </span>=<span style="color: #000000;"> evbuffer_write_iovec(buffer, fd, howmuch);
</span><span style="color: #0000ff;">#elif</span> defined(WIN32)
        <span style="color: #008000;">/*</span><span style="color: #008000;"> XXX(nickm) Don't disable this code until we know if
         * the WSARecv code above works. </span><span style="color: #008000;">*/</span>
        <span style="color: #0000ff;">void</span> *p =<span style="color: #000000;"> evbuffer_pullup(buffer, howmuch);
        n </span>= send(fd, p, howmuch, <span style="color: #800080;">0</span><span style="color: #000000;">);
</span><span style="color: #0000ff;">#else</span>
        <span style="color: #0000ff;">void</span> *p =<span style="color: #000000;"> evbuffer_pullup(buffer, howmuch);
        n </span>=<span style="color: #000000;"> write(fd, p, howmuch);
</span><span style="color: #0000ff;">#endif</span><span style="color: #000000;">
#ifdef USE_SENDFILE
        }
</span><span style="color: #0000ff;">#endif</span>

    <span style="color: #0000ff;">if</span> (n &gt; <span style="color: #800080;">0</span><span style="color: #000000;">)
        evbuffer_drain(buffer, n);

done:
    EVBUFFER_UNLOCK(buffer);
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (n);
}</span></pre>
</div>
<p>2.0有个显眼的freeze_start的检查，正是这个检查，让evbuffer_write的调用直接跳过了发送阶段。于是，在flush的时候加了一个dirty trick，直接调用了evbuffer_unfreeze：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">void</span> try_flush(bufferevent *<span style="color: #000000;">bev) {
    </span><span style="color: #0000ff;">int</span> size =<span style="color: #000000;"> evbuffer_get_length(bufferevent_get_output(bev));
    </span><span style="color: #0000ff;">if</span> (size &gt; <span style="color: #800080;">0</span><span style="color: #000000;">) {
        evbuffer_unfreeze(bufferevent_get_output(bev), </span><span style="color: #800080;">1</span><span style="color: #000000;">);
        evbuffer_write(bufferevent_get_output(bev), fd);
    } 
}</span></pre>
</div>
<p>问题解决</p>
<p>&nbsp;</p>
<p>然后跟了下libevent 2.0的文档，里面提到freeze的作用：</p>
<div class="cnblogs_code">
<pre>     You can use evbuffer_freeze() to temporarily suspend drains <span style="color: #0000ff;">from</span><span style="color: #000000;"> or adds
     to a given evbuffer.  This </span><span style="color: #0000ff;">is</span> useful <span style="color: #0000ff;">for</span> code that exposes an evbuffer <span style="color: #0000ff;">as</span><span style="color: #000000;">
     part of its </span><span style="color: #0000ff;">public</span> API, but wants users to treat it <span style="color: #0000ff;">as</span><span style="color: #000000;"> a pure source or
     sink.</span></pre>
</div>
<p>因为是从1.4移植到2.0的，所以没有理由自己freeze掉的。那么剩下的原因只会是&mdash;&mdash;libevent自己freeze了这个buffer，内部对freeze的调用集中在bufferevent_sock.c和bufferevent_pair.c两个文件里，目前没有使用socketpair，于是目标只有bufferevent_sock.c</p>
<p>&nbsp;</p>
<p>bufferevent_sock.c里，一个是bufferevent_socket_new函数调用了freeze，另一个是bufferevent_writecb。根据应用场景分析，目标应该是writecb。分析了一下libevent的流程，遇到socket为可写状态的时候，就会调用bufferevent_writecb，再调用用户设置的writecb。而这个bufferevent_writecb，主要工作就是unfreeze掉buffer，然后调用evbuffer_write_atmost刷出数据到socket里，接着重新freeze该buffer。</p>
<p>&nbsp;</p>
<p>这就解释了为什么直接调用evbuffer_write没有作用，因为这个接口似乎就没有打算直接暴露给用户使用。根据<a href="http://liuxun.org/blog/libevent-yuan-ma-shen-du-pou-xi-san-libevent-ji-ben-shi-yong-chang-jing-he-shi-jian-liu-cheng/">这篇文章</a>的分析，libevent对注册事件的检查顺序是超时事件，然后是I/O事件，并将其一一放入链表里，逐个调用回调函数进行处理。回头看应用场景，当一个玩家顶号登录时，首先触发了本轮的IO事件，解包处理逻辑，执行踢人的逻辑处理，向缓冲区写入对客户端的提示信息。注意，本轮对写缓存的修改，并不会立即触发bufferevent_writecb进行发送。因为，其触发的只是用户设置的callback和上一轮留下的deferred callback！正是因为这个原因，本次事件检查循环写入的数据，必须等到下个循环才能被执行。所以，脚本层想要发送完顶号提示信息后，立即断开socket，就会导致socket过早被断开，提示信息无法发送出去了。</p>
<p>&nbsp;</p>
<p>update:</p>
<p>其实底层的write还是有可能没发完，evbuffer_write不提供保证。所以应该是去掉读回调，在写回调里判断是否已写完，写完则断开</p>]]></description></item><item><title>游戏协议加密及身份验证</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/03/01/mobile_game_protocol_encrypt_and_authentication.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 01 Mar 2014 03:54:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/03/01/mobile_game_protocol_encrypt_and_authentication.html</guid><description><![CDATA[<p>时间如白驹过隙，一眨眼就过去了，本打算在2月份发这篇的，结果一直误以为2月有31日&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>这一块之前一直感兴趣，终于在2月份争取到机会去做这一块的工作。前辈给我留下了一个鉴权的框架：</p>
<ol>
<li>客户端连接服务器</li>
<li>服务器将随机数发给客户端</li>
<li>客户端用客户端私钥加密，发回到服务器</li>
<li>服务器端用客户端公钥解开密文，比对解开的随机数是否与原来的一致</li>
<li>如果一致，则客户端发送随机数到服务器，服务器用服务器端私钥加密，将密文发送到客户端；同时，产生新的随机数，用于稍后对会话进行rc4加密，并将这个随机数以客户端公钥加密，发送到客户端。</li>
<li>客户端用服务器端公钥解开密钥，比对随机数和自己发的是否相同，相同的话则用客户端私钥解开下一个包，取出用于rc4加密的key密文</li>
<li>至此，双方身份验证完成，会话先进行压缩，再通过rc4算法进行加密</li>
</ol>
<p>&nbsp;</p>
<p>在这里，私钥充当了一个身份的象征，只要拥有私钥，就认为对方是授信客户端。可能有朋友会问，如果客户端被破解怎么办？我觉得安全专家道哥有个观点很好，&ldquo;安全的本质是信任的问题。<span>设计任何安全方案，最终都必须要有一个东西是「假设可以信任的」，只是看这个「可信任」的东西被攻击成功的概率大小。如果不这么做，则做不出任何的安全方案。&rdquo;所以，考虑协议安全的时候，我们只能选择相信客户端密钥被安全的保管着。</span></p>
<p>&nbsp;</p>
<p><span>回头再看看这个方案，这里用到了私钥进行加密。熟悉ssh的同学应该会联想到其挑战过程，ssh服务器是用客户端公钥对随机数进行加密，再发送到客户端的。公钥加密和私钥加密的区别是，在明文相同的情况下，公钥加密出来的密文每次都不一样，而私钥加密出来的密文是每次都相同的。示例代码可以参见：&nbsp;<a href="https://github.com/spin6lock/rsa_encrypt_and_decrypt_in_c">https://github.com/spin6lock/rsa_encrypt_and_decrypt_in_c</a>&nbsp;密文和明文总是一一映射，容易被碰撞攻击，进而绕过加密过程。因此，私钥加密多用于身份验证，比如电子邮件的数字签名，首先用md5对邮件明文进行信息摘要，然后用私钥进行加密，公钥是公开的，保证任何看到这封邮件的人都可以进行解密，获取md5信息进行验证，确保邮件没有被纂改。</span></p>
<p>&nbsp;</p>
<p>于是，我花了一周左右的时间修改了验证流程。新的验证流程如下：</p>
<ol>
<li>客户端连接服务器</li>
<li>服务器用客户端公钥加密随机数，发给客户端</li>
<li>客户端用客户端私钥解密，发回服务器</li>
<li>服务器对比随机数，不一样的话就断开连接</li>
<li>客户端用服务器端公钥加密随机数，发送到服务器</li>
<li>服务器用私钥解密，发送回客户端</li>
<li>客户端验证通过</li>
<li>服务器用客户端公钥加密rc4会话所用密钥，发送到客户端</li>
<li>客户端用公钥解开，接下来在rc4加密下上传</li>
</ol>
<p>&nbsp;</p>
<p>接下来，想针对手机网络模块的工作特点进行协议优化。由于手机受限于电量，网络芯片工作时会有启动，半速，全速，半速，设备待机这个速度曲线，如果能够在应用层对包进行打包发送，能够大大提高手机的待机时间，参见这篇<a href="http://developer.android.com/training/efficient-downloads/efficient-network-access.html">开发指南</a>。协议压缩放在下一篇吧~</p>]]></description></item><item><title>初探groupcache</title><link>http://www.cnblogs.com/Lifehacker/archive/2014/01/09/groupcache_inside.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 09 Jan 2014 09:51:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2014/01/09/groupcache_inside.html</guid><description><![CDATA[<p>groupcache是用于dl.google.com的一个memcached的替代品，相对于memcached，提供更小的功能集和更高的效率，以第三方库的形式提供服务。</p>
<p>groupcache的常见部署可参考下图：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201401/091629188481.jpg" alt="" /></p>
<p>不同于memcached，groupcache面向的是静态的缓存系统，比如google家的下载站，用来缓存对应的文件区块。一经set操作，key对应的value就不再变化。使用的时候，需要自定义缓存缺失时使用的set操作。当发生miss的时候，首先会从根据key的consist hash值找到对应的peer，去peer里寻找对应的value。如果找不到，则使用自定义的get函数从慢缓存（比如db，文件读取）获取alue，并填充对应peer。下一次获取，就直接从cache里取出来，不再访问慢缓存。另外，为避免网络变成瓶颈，本地peer获取cache后，会存在本地的localCache里，通过LRU算法进行管理。</p>
<p>&nbsp;</p>
<p>groupcache的代码分为consistenhash, groupcachepb, lru, singleflight等几个目录，分别存放一致性哈希，groupcache的protobuf协议，lru算法实现，用来保证求值操作只执行一次的singleflight。本篇主要看看singleflight。</p>
<p>&nbsp;</p>
<p>23 // call is an in-flight or completed Do call<br />   24 type call struct {<br />   25     wg  sync.WaitGroup<br />   26     val interface{}<br />   27     err error<br />   28 }</p>
<p>这里定义了一个call结构，包含了用来同步的wg等待组，一个用于承载任意值的val，以及err错误信息。</p>
<p>&nbsp;</p>
<p> 32 type Group struct {<br />   33     mu sync.Mutex       // protects m<br />   34     m  map[string]*call // lazily initialized<br />   35 }</p>
<p>这里定义的是Group结构，一个Group内key是唯一的，类似于命名空间。groupcache使用了Mutex保护map变量。</p>
<p>&nbsp;</p>
<p>41 func (g *Group) Do(key string, fn func() (interface{}, error)) (interface{}, error) {<br />   42     g.mu.Lock()<br />   43     if g.m == nil {<br />   44         g.m = make(map[string]*call)<br />   45     }<br />   46     if c, ok := g.m[key]; ok {<br />   47         g.mu.Unlock()<br />   48         c.wg.Wait()<br />   49         return c.val, c.err<br />   50     }<br />   51     c := new(call)<br />   52     c.wg.Add(1)<br />   53     g.m[key] = c<br />   54     g.mu.Unlock()<br />   55<br />   56     c.val, c.err = fn()<br />   57     c.wg.Done()<br />   58<br />   59     g.mu.Lock()<br />   60     delete(g.m, key)<br />   61     g.mu.Unlock()<br />   62<br />   63     return c.val, c.err<br />   64 }</p>
<p>&nbsp;</p>
<p>这里Do定义的就是一个带锁保护的保证单次执行的函数。因为consistent hash定位到的peer是唯一的，因此这里只需要同步该进程内的goroutine即可。为了减少锁的影响，锁控制的范围被切成了好几段。整个完整流程包括3步：1. 初始化g.m变量 2. 赋值g.m[key]变量为val 3.删除g.m的key。第一步会加锁，第一个进入的go程会走到第二步进行赋值操作，到其他go程进入1的时候，第二步key对应的值已经有了，可以直接释放锁了。然后到第三步，第一个进入的go程会加锁，然后删除key，再解锁。前面尽早释放锁，就是为了第三步这里不需要长久的等待。</p>]]></description></item><item><title>systemtap折腾笔记</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/11/22/how_to_install_systemtap_on_centos.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 22 Nov 2013 09:17:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/11/22/how_to_install_systemtap_on_centos.html</guid><description><![CDATA[<p>在这货上花费了不少时间，都是受了@agentzh 大神的蛊惑:) 他写的nginx-systemtap-toolkit监测的数据很有价值，对于系统优化实在是利器。</p>
<p>&nbsp;</p>
<p>最早折腾systemtap，是在Ubuntu 12.04上搞的，内核版本是3.8.0-29-generic，流程参考<a href="https://sourceware.org/systemtap/wiki/SystemtapOnUbuntu" target="_blank">官方教程</a>。因为12.04版本比较新，所以不需要重新编译内核了。然后添加带调试信息的内核，以及相关的Linux头文件。整个过程还算顺利，就是公司网速比较慢。下载完成后，用ubuntu官方仓库自带的systemtap 1.6，却出现各种奇怪的C编译错误，于是换到了git clone下来的最新版本。这次错误信息友好了很多，但tapset的脚本跟内核的dwarf信息似乎对应不上，报semantic error: not accessible at this address [man error::dwarf]。至此，ubuntu上的systemtap只能打出hello world，其他脚本都跑不了，遂放弃。教训是，systemtap要新版，内核要老版，若用老systemtap和新内核，一般是会挂的。</p>
<p>&nbsp;</p>
<p>对systemtap的用户态监控还是很口水，虽然我司用的是自己写的定制语言，但是-g编译后应该可以监控私有语言的脚本栈，进而分析性能瓶颈。于是，死皮赖脸抢夺了一台CentOS的机器做测试。机器版本如下：</p>
<div class="cnblogs_code">
<pre>[root@localhost systemtap]# <span style="color: #0000ff;">uname</span> -<span style="color: #0000ff;">rm</span>
<span style="color: #800080;">2.6</span>.<span style="color: #800080;">32</span>-<span style="color: #800080;">279</span><span style="color: #000000;">.el6.x86_64 x86_64
　
[root@localhost systemtap]# </span><span style="color: #0000ff;">cat</span> /etc/redhat-<span style="color: #000000;">release
CentOS release </span><span style="color: #800080;">6.3</span> (Final)</pre>
</div>
<p>&nbsp;</p>
<p>用的systemtap版本是最新的。跟Ubuntu相比，CentOS的包管理就比较差了，内核的调试信息包需要自己手动下载安装。参考<a href="https://sourceware.org/systemtap/wiki/SystemTapOnCentOS" target="_blank">官方教程</a>，安装debuginfo-common和debuginfo后，就可以开搞了。还好，这次不需要编译内核。安装好systemtap后，跑起来却出现这个问题：</p>
<p>stap -e 'probe begin { log("hello world") exit() }'</p>
<p>提示：</p>
<p>Checking "/lib/modules/2.6.32-279.el6.x86_64/build/.config" failed with error: 没有那个文件或目录</p>
<p>&nbsp;</p>
<p>检查了一下相关的目录，/lib/modules/2.6.32-279.el6.x86_64/是一个软连接，链接到/usr/src/kernels/里去的。而2.6.32-358.23.2.el6.x86_64这个目录是真的没有，有的是2.6.32-358.23.2.el6.x86_64。谷歌了一下，这个目录是kernel-devel包的，通过yum安装的是最新的2.6.32-358.23.2.el6.x86_64，跟当前运行的内核不符。继续放狗，找到2.6.32-279.el6.x86_64的kernel-devel rpm包，安装完就有对应目录了。试了一下iotop终于成功了。</p>
<p>&nbsp;</p>
<p>看了一下，systemtap似乎是根据写的probe编译成二进制模块，加载到内核里执行的。所以systemtap会在home目录下建立一个cache目录，避免重复编译相同的脚本。而nginx-systemtap-toolkit对Lua的栈探测，是通过监视LuaL开头的函数实现的，接下来准备按他的思路搞一下我们的私有语言。</p>]]></description></item><item><title>Mongodb在NUMA机器上的优化</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/11/15/database_swap_insanity_on_Linux.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 15 Nov 2013 13:22:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/11/15/database_swap_insanity_on_Linux.html</guid><description><![CDATA[<p>10gen在mongodb的部署指南上，提到了在NUMA机器上，mongodb可能会出现问题，参见：http://docs.mongodb.org/manual/administration/production-notes/#production-numa</p>
<p>里面引用了一篇博客，主要讲MySQL的swap insanity，而mongodb也会遇到类似的问题，博客地址：http://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/。</p>
<p>这篇博客有点长，我这里简单概括一下。</p>
<p>&nbsp;</p>
<p>对于单CPU，多核心的情况，每个核心访问内存的速度是一样的，这种架构称为SMP（Symmetric multiprocessing， 对称多处理器），又叫UMA(Uniform Memory Architecture，与NUMA相对，一致性内存访问架构)。</p>
<p>&nbsp;</p>
<p>对于多CPU，多核心的情况，如下图：</p>
<p><img title="NUMA，图片来自 https://computing.llnl.gov/tutorials/linux_clusters/" src="https://computing.llnl.gov/tutorials/linux_clusters/images/motherboard1.jpg" alt="多CPU主板" width="304" height="358" /></p>
<p>可以看到，每个CPU都有一组配套的内存槽。每个CPU访问自身的内存插槽，速度都很快，但对于主板上的其他内存插槽，访问速度就会下降。这种架构被称为NUMA。</p>
<p>&nbsp;</p>
<p>对于Linux来说，加载的时候就会检测内存，计算CPU到内存的访问开销，将CPU和内存分成一组组的。每个进程和线程，都会继承父进程的NUMA策略，这种策略包括这个进程/线程会在哪个CPU上运行，分配的内存应该用哪组插槽的。</p>
<p>&nbsp;</p>
<p>面对内存分配，只要一经分配到指定的CPU&mdash;内存槽，就不会再挪动了。对于数据库这类应用，理想情况下是一个单一的多线程进程，吃掉了几乎所有的系统内存，并尽可能多的消耗其余的系统资源例如IO。</p>
<p>&nbsp;</p>
<p>对于两个CPU的NUMA架构来说，如果一个核心分配的内存超过系统内存的一半，就会出现问题。而Linux的分配策略是，首先使用CPU 0，然后再使用CPU 1。这时候就会出现一种情况，CPU 0的内存组已经率先使用完了，但系统还有很多空闲内存，都在CPU 1上。这时候，Linux会选择将CPU 0的内存刷到磁盘上，以换取可用内存。但是，swap过程远比跨CPU访问内存要慢啊。这就会造成内存还没用光，但数据库疯狂刷盘的现象了。</p>
<p>&nbsp;</p>
<p>解决办法是用numactl指定分配策略，将数据库需要的内存分散在各个CPU/内存组上，保证不会出现一个核心已满而另一个核心空闲的情况。</p>
<div class="cnblogs_code">
<pre>#numactl --interleave all command</pre>
</div>
<p>&nbsp;</p>]]></description></item><item><title>[转]设置Android手机以使用ARM Streamline进行性能分析（二）</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/10/31/enable_arm_ds_5_part_two.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 31 Oct 2013 07:04:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/10/31/enable_arm_ds_5_part_two.html</guid><description><![CDATA[<div class="entry_header">
<h2 class="blogtitle_blogview">&nbsp;</h2>
<div class="entry_author_bloglist">原文因为arm社区改版访问不到了，原作者鲍方，<a href="http://blogs.arm.com/software-enablement/732-%E8%AE%BE%E7%BD%AEandroid%E6%89%8B%E6%9C%BA%E4%BB%A5%E4%BD%BF%E7%94%A8arm-streamline%E8%BF%9B%E8%A1%8C%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%EF%BC%88%E4%BA%8C%EF%BC%89/">原文地址</a>，这篇是从google cache里挖出来的，希望能帮到要对cocos2dx优化的各位</div>
<div class="entry_author_bloglist">&nbsp;</div>
<div class="entry_author_bloglist">Posted by&nbsp;<a href="http://forums.arm.com/index.php?/user/114542-fang-bao/">Fang Bao</a>,
<div class="entry_comments_bloglist"><a href="http://blogs.arm.com/software-enablement/732-%e8%ae%be%e7%bd%aeandroid%e6%89%8b%e6%9c%ba%e4%bb%a5%e4%bd%bf%e7%94%a8arm-streamline%e8%bf%9b%e8%a1%8c%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90%ef%bc%88%e4%ba%8c%ef%bc%89/#comments">Leave Comment</a></div>
<div class="entry_date_bloglist">11 June 2012</div>
</div>
</div>
<div class="share_links">&nbsp;
<div id="bmark_email">&nbsp;</div>
</div>
<div class="post entry_content entry_content_entryview">2从手机中获得内核配置文件和Android init.rc启动脚本 现在，可以开始正式工作了。&nbsp;<br />编译Linux内核前，通过USB电缆连接Android设备与PC，然后在终端窗口内获得如下的内核配置文件：&nbsp;<br /><br />$ cd /path/to/android-sdk/tools&nbsp;<br />$ ./adb pull /proc/config.gz&nbsp;<br />$ gunzip ./config.gz&nbsp;<br />$ cp config /path/to/kernel/.config<br /><br />从手机的Android根文件夹中获得init.rc启动脚本：<br /><br />$ cd /path/to/android-sdk/tools&nbsp;<br />$ ./adb pull /init.rc<br /><br />3 编译Linux内核和gator模块<br />下一步，将Linux内核源代码包解压至PC的工作文件夹。将目录更改为刚刚解压的内核文件夹，然后输入此命令进入内核配置菜单。<br /><br />$ make ARCH=arm menuconfig<br /><br />使用箭头键到达目标子菜单，然后按下&ldquo;Enter&rdquo;。以下所列出的每个子菜单内包含了所需要的动作说明。
<ul class="bbc">
<li>General Setup(常规设置)，确保启用了Profiling Support (分析支持)选项。</li>
<li>Kernel Hacking(内核开发)，在子菜单中，导航至Tracers子菜单，然后按下&ldquo;Enter&rdquo;。确保启用Trace进程上下文开关选项。</li>
<li>Kernel Features(内核功能)，确保启用High Resolution Timer Support (高分辨率定时器支持)。如果正在使用对称多处理器(SMP)设备，则启用Use local timer interrupts （使用本地定时器中断）。</li>

</ul>

<br />保存并退出配置菜单后，必须重新编译内核和相关模块，如下所示：&nbsp;<br /><br />$ make ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabi- zImage -j4<br />$ make ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabi- modules -j4<br /><br />要在Android目标手机使用Streamline，还必须构建gator内核模块gator.ko。gator内核模块源代码位于DS-5安装文件夹：&nbsp;<br /><br />installdir/arm/gator/driver-src/gator-driver.tar.gz<br /><br />在安装DS-5 CE Eclipse时，可通过Help（帮助）-&gt;ARM Extras&hellip;（ARM附加选项）菜单来确定源文件的位置。将源代码包转移至工作文件夹，并进行解压。输入下列命令来编译gator模块：&nbsp;<br /><br />$ make -C &lt;path/to/kernel/source&gt; M=`pwd` ARCH=arm&nbsp;<br />CROSS_COMPILE=arm-none-linux-gnueabi- modules<br /><br />要在Android系统上使用Streamline，还需运行gator守护程序。预先编译好的gatord二进制程序位于DS-5安装文件夹：&nbsp;<br /><br />installdir/arm/gator/android/gatord<br /><br />在DS-5 CE中，通过再次选择Help（帮助）-&gt;ARM Extras&hellip;（ARM附加选项）菜单来确定源文件的位置。要在Android文件系统运行该程序，将gatord复制到Android手机，并放置在相同路径（例如：/system/xbin 或/system/bin）下作为gator驱动程序gatord.ko即可。<br /><br />（可选）要Android手机启动时启用gator服务，则必须修改init.rc脚本文件，该文件可从Android设备中的根目录获得。并在该文件末尾添加下列行<br /><br />service ds5_gatord /system/xbin/gatordexec /system/xbin/gatord &amp;oneshot<br />如果不希望在启动时运行gatord的守护程序，也可以在Android设备启动后再运行gatord。例如，可以在启动后使用adb shell命令来运行/system/xbin/gatord&amp;。<br /><br />4创建Android update.zip程序包来刷机<br />update.zip放置于SD卡根文件夹上的压缩文件，在手机启动时由Android恢复系统加载。该文件通常具有供应商的数字签名，在紧急情况或系统升级时使用该文件可用来恢复系统。Android手机处于解锁状态时，则可以使用自定义的压缩包来升级系统。现在，我向您展示如何创建update.zip程序包来更新Linux内核和init.rc脚本。
<ul class="bbc">
<li>为加快工作速度，先下载一个内核更新包作为模板。对于HTC Sensation 4G手机，可通过Google来查找某些<a class="bbc_url" title="External link" href="http://forum.xda-developers.com/showthread.php?t=1200403" rel="nofollow external">kernel update packages</a>（内核更新包）。</li>
<li>将其解压至工作文件夹&lt;workdir&gt;</li>
<li>用重新编译的内核文件zImage来替换&lt;workdir&gt;/kernel文件夹中的zImage文件。</li>
<li>将init.rc复制到&lt;workdir&gt;/kernel 文件夹</li>
<li>在&lt;workdir&gt;/kernel文件夹中编辑或创建mkbooting.sh脚本来更新启动镜像</li>

</ul>

<br />#!/sbin/sh<br /># repleace init.rc in ramdisk<br />mkdir /tmp/newramdisk<br />cd /tmp/newramdisk<br />busybox gunzip -c /tmp/boot.img-ramdisk.gz | busybox cpio -i<br />busybox cp /tmp/init.rc /tmp/newramdisk/<br />chmod 750 /tmp/newramdisk/init.rc<br />busybox find . | busybox cpio -o -H newc | busybox gzip &gt; /tmp/newramdisk.gz<br />cd /tmp<br />rm -r /tmp/newramdisk<br /># generate createnewboot.sh<br />echo \#!/sbin/sh &gt; /tmp/createnewboot.sh<br />echo /tmp/mkbootimg --kernel /tmp/zImage --ramdisk /tmp/newramdisk.gz --cmdline \"$(cat /tmp/boot.img-cmdline)\" --base $(cat /tmp/boot.img-base) --output /tmp/newboot.img &gt;&gt; /tmp/createnewboot.sh<br />chmod 777 /tmp/createnewboot.sh<br />/tmp/createnewboot.sh<br />return $?
<ul class="bbc">
<li>将重新编译的内核模块（wifi驱动程序）复制到&lt;workdir&gt;/system/lib/modules文件夹</li>
<li>将gator.ko和gatord复制到&lt;workdir&gt;/system/xbin 文件夹</li>
<li>在&lt;workdir&gt;/META-INF/com/google/android/updater-script文件夹中编辑updater-script文件。添加下列行来更新系统分区，并将gatord程序的权限设置成可执行。</li>

</ul>

<br />ui_print("Extracting system files...");<br />package_extract_dir("system", "/system");<br />set_perm(0, 0, 0755, "/system/xbin/gatord");<br />unmount("/system");
<ul class="bbc">
<li>在&lt;workdir&gt;/META-INF/com/google/android/updater-script文件夹中编辑updater-script文件。添加下列行来更新启动分区（内核及init.rc）。</li>

</ul>

<br />ui_print("Building new boot.img...");<br />run_program("/tmp/dd", "if=/dev/block/mmcblk0p20", "of=/tmp/boot.img");;<br />run_program("/tmp/unpackbootimg", "/tmp/boot.img", "/tmp/");<br />run_program("/tmp/mkbootimg.sh");<br />
<ul class="bbc">
<li>将&lt;workdir&gt;文件夹压缩为update.zip文件。请注意！切勿将&lt;workdir&gt;文件夹本身包括在内。</li>
<li>将update.zip文件复制到目标手机的SD卡根文件夹下。</li>

</ul>

<br />注意！在继续操作前，请为手机充满电！！！&nbsp;<br /><br />关闭手机电源，然后以HBOOT模式开启。（同时按下电源按钮和音量调低按钮）&nbsp;<br /><br />进入Recovery(恢复)菜单。系统会提示您，并自动进行更新。&nbsp;<br /><br />在重新启动后，Streamline准备就绪，可进行性能分析。&nbsp;<br /><br /><br />5使用Streamline对Android手机进行性能分析<br />Streamline支持通过以太网与目标手机的连接。使用Android Debug Bridge (ADB)实用程序，可通过USB连接将TCP端口从目标手机网络转发到PC localhost本机网络。ADB也可配置用于以太网或Wi-Fi环境。有关Android SDK以及ADB设置的详细信息，请参见Android网站。一旦设置好了ADB，就使用下列命令将Streamline使用的网络端口转发到localhost网络上。<br /><br />adb forward tcp:8080 tcp:8080<br /><br />现在运行PC上的DS-5程序，并打开Streamline数据视图窗口。如果在Window（窗口）-&gt;Show View（显示视图）菜单处未显示，则选择Window（窗口）-&gt;Show View（显示视图）-&gt;Other（其他），在对话框中找到&ldquo;ARM Streamline&rdquo;，然后打开ARM Streamline Data(数据采集对话框)。在Eclipse或DS-5的ARM Streamline数据视图的Capture Options (采集选项)对话框中输入设备的以太网地址。如果通过USB使用Android Debug Bridge (ADB)来转发端口，则在地址字段中输入localhost，如图2所示。<br /><br />图2 ARM Streamline Data数据采集对话框<br /><br />
<div><a id="ipb-attach-url-1451-0-89794000 1381830939" class="resized_img" title="Figure 2 Streanline Data Capture Dialog.PNG - Size: 23.62K, Downloads: 182" href="http://forums.arm.com/index.php?app=core&amp;module=attach&amp;section=attach&amp;attach_rel_module=blogentry&amp;attach_id=1451" rel="lightbox[732]">Attached Image</a></div>

<br /><br />最后，按照ARM网站上的<a class="bbc_url" title="External link" href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0482e/index.html" rel="nofollow external">ARM DS-5 Using ARM Streamline</a>使用说明，使用Streamline对Android手机开始进行性能分析。图3是使用Streamline对Android手机进行性能分析的截图。<br /><br />图3 Streamline性能分析窗口&nbsp;<br /><br />
<div><a id="ipb-attach-url-1452-0-89825200 1381830939" class="resized_img" title="Figure 3 Streamline Profiling Window.PNG - Size: 154.73K, Downloads: 202" href="http://forums.arm.com/index.php?app=core&amp;module=attach&amp;section=attach&amp;attach_rel_module=blogentry&amp;attach_id=1452" rel="lightbox[732]">Attached Image</a></div>

<br /><br />6 总结<br />Streamline是一款功能强大、经济高效的解决方案，用于对ARM Linux和Android平台进行系统级性能分析。希望本文能助您一臂之力，通过Streamline加快您的Android开发工作。一旦开始使用，您很快会喜欢上这款工具。如需进一步了解使用Streamline的方法，请访问<a class="bbc_url" title="External link" href="http://www.arm.com/products/tools/software-tools/ds-5/streamline.php" rel="nofollow external">ARM Streamline website</a>&nbsp;和&nbsp;<a class="bbc_url" title="External link" href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.subset.swdev.ds5/index.html" rel="nofollow external">ARM DS-5 info center</a>&nbsp;</div>]]></description></item><item><title>[转]设置Android手机以使用ARM Streamline进行性能分析（一）</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/10/31/enable_ds_5.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 31 Oct 2013 06:47:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/10/31/enable_ds_5.html</guid><description><![CDATA[<div class="entry_header">
<h2 class="blogtitle_blogview">&nbsp;</h2>
<div class="entry_author_bloglist">本博客第一次转载的文章，原文访问不到了，这篇是从google cache里挖出来的，为有需要的同学准备。<a href="http://blogs.arm.com/software-enablement/731-%E8%AE%BE%E7%BD%AEandroid%E6%89%8B%E6%9C%BA%E4%BB%A5%E4%BD%BF%E7%94%A8arm-streamline%E8%BF%9B%E8%A1%8C%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%EF%BC%88%E4%B8%80%EF%BC%89/">原文地址</a></div>
<div class="entry_author_bloglist">&nbsp;</div>
<div class="entry_author_bloglist">&nbsp;</div>
<div class="entry_author_bloglist">Posted by&nbsp;<a href="http://forums.arm.com/index.php?/user/114542-fang-bao/">Fang Bao</a>,（鲍方）
<div class="entry_comments_bloglist"><a href="http://blogs.arm.com/software-enablement/731-%e8%ae%be%e7%bd%aeandroid%e6%89%8b%e6%9c%ba%e4%bb%a5%e4%bd%bf%e7%94%a8arm-streamline%e8%bf%9b%e8%a1%8c%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90%ef%bc%88%e4%b8%80%ef%bc%89/#comments">4 Comments</a></div>
<div class="entry_date_bloglist">11 June 2012</div>
</div>
</div>
<div class="share_links">&nbsp;</div>
<div class="post entry_content entry_content_entryview">本文讲述如何设置<a class="bbc_url" title="External link" href="http://www.arm.com/zh/community/software-enablement/google/solution-center-android/index.php" rel="nofollow external">Android</a>手机来运行<a class="bbc_url" title="External link" href="http://www.arm.com/zh/products/tools/software-tools/ds-5/streamline.php" rel="nofollow external">ARM Streamline性能分析器</a>的各项步骤。<br /><br />对于运行ARM<a class="bbc_url" title="External link" href="http://www.arm.com/zh/community/software-enablement/linux.php" rel="nofollow external">&nbsp;Linux</a>或Android原生应用程序和代码库的手机来说，ARM Streamline性能分析器是一款系统级的可视化分析工具。它结合了ARM Linux内核模块、守护程序以及图形用户界面，可将系统跟踪和采样数据转换为以可视化和统计式的报告来呈现数据。<br /><br />Streamline支持运行ARM Linux或Android系统的<a class="bbc_url" title="External link" href="http://www.arm.com/zh/community/software-enablement/linux.php" rel="nofollow external">Cortex&trade;-A8、Cortex-A9、Cortex-A15、ARM9&trade;</a>以及<a class="bbc_url" title="External link" href="http://www.arm.com/products/processors/classic/arm11/index.php" rel="nofollow external">ARM11&trade;</a>处理器。在本文中，目标ARM设备为<a class="bbc_url" title="External link" href="http://www.htc.com/us/products/sensation4g-tmobile" rel="nofollow external">HTC Sensation 4G</a>&nbsp;Android&nbsp;<a class="bbc_url" title="External link" href="http://www.arm.com/zh/markets/mobile/smartphones.php" rel="nofollow external">手机。</a>开始设置前，你有必要了解以下重要信息。&nbsp;<br />
<ul class="bbc">
<li>Streamline 5.7版。Streamline是<a class="bbc_url" title="External link" href="http://www.arm.com/zh/products/tools/software-tools/ds-5/index.php" rel="nofollow external">ARM Development Studio 5</a>的一个组成模块。因此，可通过下载<a class="bbc_url" title="External link" href="http://www.arm.com/zh/products/tools/software-tools/ds-5/ds-5-downloads.php" rel="nofollow external">ARM DS-5</a>专业版、基础版或免费的DS-5公众版（针对Android系统）来获得它。</li>
<li>目标ARM设备，HTC Sensation 4G
<ul class="bbc">
<li><a class="bbc_url" title="External link" href="http://www.arm.com/zh/markets/mobile/qualcomm-snapdragon-chipset.php" rel="nofollow external">Qualcomm&reg; Snapdragon&trade;&nbsp;</a>1.2-GHz双核处理器，ARMv7架构</li>
<li>Android 2.3.4版</li>
<li>Linux内核2.6.35.13版</li>

</ul>

</li>

</ul>

<br />1 准备工作&nbsp;<br />首先需要做一些准备工作。&nbsp;<br /><br />1.1 备份Android手机的数据<br />请务必注意!我有责任提醒您，本文所述内容对您的Android手机而言存在风险。最糟糕的情况就是&ldquo;手机变砖&rdquo;。<br /><br />在继续操作前，请再三考虑，并且首先应当备份Android手机内的数据！&nbsp;<br /><br />1.2 检查并解锁Android手机<br />为了开展我们的工作，应当选用合适的Android手机作为目标ARM设备。例如，选择HTC Sensation 4G Android手机。<br /><br />第1步（也是必不可少的一步）是禁用快速启动（如果HTC手机已启用了该功能）。方法为：进入Android setting（Android设置）&gt; Power（电源）&gt; Fast boot（快速启动）（取消选中该框）。&nbsp;<br /><br />第2步则是启动手机进入HBOOT（引导加载程序）界面：关闭手机电源。确认手机完全关闭后，同时按住&lt;POWER（电源）&gt;按钮和&lt;VOL-DOWN（音量调低）&gt;按钮，直到出现白色的HBOOT屏幕，如下图1所示。&nbsp;<br /><br />图1 HBOOT屏幕<br /><br />
<div><a id="ipb-attach-url-1453-0-11429300 1382756303" class="resized_img" title="Figure 1 HBOOT Screen.png - Size: 958.24K, Downloads: 162" href="http://forums.arm.com/index.php?app=core&amp;module=attach&amp;section=attach&amp;attach_rel_module=blogentry&amp;attach_id=1453" rel="lightbox[731]">Attached Image</a></div>

<br /><br />在HBOOT屏幕中，应当确认如下必要信息。&nbsp;<br /><br />
<ul class="bbc">
<li>HTC手机的内部代码。如果是HTC sensation 4G手机，那么内部代码是图中红框标示的PYRAMID。内部代码是HTC Android手机的标识，通过它可搜索到HTC发布的正确Linux内核源代码包。</li>
<li>安全锁的状态。目前我这台手机的安全锁状态为S-OFF（安全锁关闭），在图1中用红框标示。安全锁对实现本文目的十分重要。S-OFF表示设备的NAND Flash ROM处于解锁状态并且可写，这也就意味着无需进行签名检查就可以更新Android系统的某些分区；例如，通过自定义镜像文件来更新启动分区。HTC设备的默认设置为S-ON，这表示只能使用HTC官方的固件镜像文件来更新系统（因为启用了签名检查）。</li>

</ul>

<br />如果HTC手机的安全锁状态为S-ON，无需担忧。您可访问HTC的官方网站<a class="bbc_url" title="External link" href="http://htcdev.com/bootloader/" rel="nofollow external">Unlock Bootloader</a>。按照网页所提供的内容，来解锁您的HTC手机。&nbsp;<br /><br />1.3 下载并安装ARM DS-5<br />由于Streamline是<a class="bbc_url" title="External link" href="http://www.arm.com/products/tools/software-tools/ds-5/index.php" rel="nofollow external">ARM Development Studio 5</a>的一个组成模块，因此可下载免费的<a class="bbc_url" title="External link" href="http://www.arm.com/products/tools/software-tools/ds-5/index.php" rel="nofollow external">ARM DS-5</a>公众版来进行安装。当然，我假设您已经预装了<a class="bbc_url" title="External link" href="http://www.eclipse.org/" rel="nofollow external">Eclipse</a>（到本文撰写时为止，仅Eclipse的Windows版以及32位Linux JVM版支持DS-5 CE）。<br /><br />1.4 下载Linux内核源代码<br />Streamline使用了内核级的硬件性能计数器来精确记录系统资源。必须启用某些Linux内核配置选项后，才能在Android系统上运行Streamline。如果要进行下一步，那么一份Linux内核源代码拷贝是必不可少的。HTC Sensation 4G手机的用户，可从HTC的网站<a class="bbc_url" title="External link" href="http://htcdev.com/devcenter/downloads" rel="nofollow external">Kernel Source Code</a>下载Linux内核源代码。通过在一份较长的网页清单上寻找相匹配的HTC内部代码PYRAMID，可以找到正确的代码包&ldquo;<a class="bbc_url" title="External link" href="http://www.htc.com/www/" rel="nofollow external">HTC Sensation 4G &ndash; MR &ndash; 2.6.35 kernel source code (2.6.35.13)</a>&rdquo;。<br /><br />1.5 设置Android开发环境<br />最后要做的准备工作是设置Android开发环境。这并非用于常规Android应用程序开发，而是专用于Android和Linux系统的内核级开发。我列出以下参考环境：&nbsp;<br />
<ul class="bbc">
<li>在x86 PC上运行的64位Ubuntu 10.10 版本</li>
<li>Linux系统下的GNU ARM Toolchain，本文所使用的是下载自<a class="bbc_url" title="External link" href="https://sourcery.mentor.com/sgpp/lite/arm/portal/release1803" rel="nofollow external">Mentor Graphics</a>.的CodeSourcery ARM GNU/Linux Toolchain。</li>
<li>从<a class="bbc_url" title="External link" href="http://developer.android.com/sdk/index.html" rel="nofollow external">Android开发者网站</a>下载的Android SDK r16-linux安装程序。</li>
<li>通过Android SDK r16-linux安装程序下载安装的Android SDK平台工具包</li>
<li>USB电缆 &ndash;电缆两端为USB插头（A型）和微型USB插头（B型）</li>
<li>空的SD卡，容量为1GB或更大。</li>
<li>在Linux PC上配置通过USB访问HTC Android手机，方法如下：</li>

</ul>

<br />创建一条适用于所有HTC手机和所有模式的规则。该规则改编自<br /><a class="bbc_url" title="External link" href="http://developer.android.com/guide/developing/device.html" rel="nofollow external">http://developer.and...ing/device.html</a>。使用root权限来创建或修改/etc/udev/rules.d/51-android.rules<br /><br />文件。在文件中加入下列行：<br />SUBSYSTEM=="usb", SYSFS{idVendor}=="0bb4", MODE="0666"&nbsp;<br />保存文件，然后将文件权限修改为允许任何用户读取：&nbsp;<br />$ chmod a+r /etc/udev/rules.d/51-android.rules</div>]]></description></item><item><title>FreeBSD打开DTrace支持</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/10/29/FreeBSD_9_DTrace_support.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 29 Oct 2013 09:53:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/10/29/FreeBSD_9_DTrace_support.html</guid><description><![CDATA[<p>主要翻译自：<a href="https://wiki.freebsd.org/DTrace">https://wiki.freebsd.org/DTrace</a></p>
<p>FreeBSD跟Linux发行版一个比较大的差异，就是提倡源码构建。因此这里提到比较多的编译开关设置。自2012年5月后，DTrace支持默认是打开的，因此以下步骤不再需要了。留意uname -a输出的日期即可。</p>
<p>&nbsp;</p>
<p>添加内核编译选项，打开DTrace支持</p>
<p>1.打开调试符号</p>
<div class="cnblogs_code">
<pre>makeoptions DEBUG=<span style="color: #800000;">"</span><span style="color: #800000;">-g</span><span style="color: #800000;">"</span>       # build kernel with gdb(<span style="color: #800080;">1</span>) debug symbols</pre>
</div>
<p>2.对于10.0之前的FreeBSD，添加：</p>
<div class="cnblogs_code">
<pre>options KDTRACE_HOOKS      # all architectures -<span style="color: #000000;"> enable general DTrace hooks
options DDB_CTF            # all architectures </span>- kernel ELF linker loads CTF data</pre>
</div>
<p>3.对于AMD64（64位处理器），添加：</p>
<div class="cnblogs_code">
<pre>options KDTRACE_FRAME        # amd64 - ensure frames are compiled <span style="color: #0000ff;">in</span></pre>
</div>
<p>4.对于9.0或之后的系统，WITH_CTF=1需要在内核设置里添加：</p>
<div class="cnblogs_code">
<pre>makeoptions WITH_CTF=<span style="color: #800080;">1</span></pre>
</div>
<p>（关于编译内核的步骤，可以参考：http://tthtlc.wordpress.com/2012/08/12/enabling-dtrace-on-freebsd-9/，内核的代码都在/usr/src, 拿一份比如/usr/src/sys/amd64/conf里的GENERIC复制以下，添加上面的选项就可以了。）</p>
<p>&nbsp;</p>
<p>重编译并安装内核</p>
<p>1.对于FreeBSD 9及以后的系统</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">make</span> buildkernel KERNCONF=DTRACE</pre>
</div>
<p>2.对于FreeBSD 8-STABLE及更老的系统</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">make</span> buildkernel WITH_CTF=<span style="color: #800080;">1</span> KERNCONF=DTRACE</pre>
</div>
<p>3.安装内核并重启</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">make</span> installkernel KERNCONF=<span style="color: #000000;">DTRACE
shutdown </span>-r now</pre>
</div>
<p>&nbsp;</p>
<p>查看安装效果</p>
<p>sudo su切换到root用户</p>
<p>1.加载内核DTrace模块</p>
<p>kldload dtraceall</p>
<p>2.确认dtrace安装正确：</p>
<p>dtrace -l|head</p>
<p>3.尝试添加DTrace监控：</p>
<p>dtrace -n 'syscall:::entry { @num[execname] = count(); }'</p>
<p>如果你看到输出是：</p>
<div class="cnblogs_code">
<pre>dtrace: invalid probe specifier syscall:::entry { @num[execname] = count(); }: <span style="color: #800000;">"</span><span style="color: #800000;">/usr/lib/dtrace/psinfo.d</span><span style="color: #800000;">"</span>, line <span style="color: #800080;">37</span>: failed to copy type of <span style="color: #800000;">'</span><span style="color: #800000;">pr_uid</span><span style="color: #800000;">'</span>: Type information is <span style="color: #0000ff;">in</span> parent and unavailable</pre>
</div>
<p>说明前面没做好，重头再来吧</p>
<p>&nbsp;</p>
<p>用户空间的DTrace</p>
<p>对于FreeBSD 9.0及以后的版本</p>
<p>&nbsp;</p>
<p>1.对于用户态的DTrace支持，需要在你的/etc/make.conf文件里添加：</p>
<p>STRIP=</p>
<p>CFLAGS+=-fno-omit-frame-pointer</p>
<p>这是用以提供栈跟踪的，可以提供更多信息</p>
<p>2.重新安装world：</p>
<p>make WITH_CTF=1 buildworld</p>
<p>shutdown -r NOW</p>
<p>make installworld</p>]]></description></item><item><title>压测周</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/10/27/stress_test_and_memory_leak_detect.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 27 Oct 2013 14:11:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/10/27/stress_test_and_memory_leak_detect.html</guid><description><![CDATA[<p>本周主要工作是解决dbd的多线程bug，可是失败了。</p>
<p>&nbsp;</p>
<p>为了重现这个多线程的bug，准备模拟多用户登录的情景，当多个用户需要保存数据的时候，就会跑到多线程序列化数据的部分，应该可以重现这个bug。于是，从周一到周三，花了三天时间，用python+gevent写了一个模拟客户端，实现了客户端连接服务器和登录的流程。其实这个测试工具，在上一个项目里已经写了一点了，基本数据类型的解包比如整型，字符串解包已经有了。但是，我翻看代码才发现，当时没有写打包协议的实现&hellip;&hellip;写的过程比较流畅，用了mixin的方式将rpc协议独立出来一个RpcMixin类，这个类最后会被SimulateUser类继承，而SimualteUser则负责提供连接好的socket，以及相应的greenlet协程、登录用户名。唯一比较严重的bug，是启动时并发多个greenlet协程的时候，用了range而非xrange，又手残多填了几个0，结果CPU和内存都耗在了产生range(1000000000)这个巨大无比的整数列表上了。</p>
<p>&nbsp;</p>
<p>解决完以上的问题，周四到周六就开始正式的压测过程。压测出来的结果比较诡异，主要情况是多玩家登录后，再断开连接，而gamed（游戏逻辑进程）和dbd（游戏数据储存进程）依然保持着高水位内存。有一次还显示2000多个在线玩家，但模拟客户端已经全部断开连接了。这个有可能是进程最大fd连接数引起的，错误处理没做好，fd最大值设成200000后就没重现过这个问题了。</p>
<p>&nbsp;</p>
<p>维持高水位内存，目前猜测是两种可能。一是内部实现了内存池之类的设施，一经申请后再不释放，因为上到高水位后，断掉模拟客户端，再重新连接进行压测，内存也不再增长，只保留在高水位。二是有内存泄露，因为高水位后断开模拟客户端，过一晚上之后内存还有轻微增长。翻看了一下引擎的文档，里面有一点前辈留下的关于内存泄露排查的记录。里面提到的主要是脚本层的内存泄露排查，提供了一些simul_efun去dump出所有内存里的脚本object，各个object的引用数和大小。排查了一遍object，只有一屏幕不到的类型，很快确定没有问题。单纯客户端连接登录，不做任何操作，脚本层对象的大小才600+MB，这时候已经差不多11000的模拟用户登录了。然后再排查了一下基本类型，主要是字符串，mapping，array这三种。数据也比较正常，无法拼凑出gamed 1G多的内存占用。</p>
<p>&nbsp;</p>
<p>EDIT:gamed引擎里的确有pool的概念，一经申请再不释放。在玩家管理里，用到了user_stack，断线释放的玩家结构数据块都会放在这里。</p>]]></description></item><item><title>类型系统线程安全</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/10/21/thread_safe_problem_on_type_system.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 20 Oct 2013 16:42:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/10/21/thread_safe_problem_on_type_system.html</guid><description><![CDATA[<p>最近情绪有点失控，跟很欣赏的同事吵架了，真难过。有些话，可能真的只有吵架才会说出口，只好安慰自己，这未尝不是一次难得的交流。究其原因，就是一段代码由我开发，他接手维护，然后交给我继续跟进；最近频繁报bug，他觉得在替我擦屁股，收拾代码，我也觉得我在替他擦屁股，大家心里有气，但是谁也没有说出口。多点面对面交流，多点讨论，工作压力小一点，可能就可以避免了。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>最近修复的dbd的bug，一个是字符串管理上面的，<a href="http://www.cnblogs.com/Lifehacker/p/dbd_structure_and_bson_format_process.html">上一篇博文</a>已经提到了mapping_to_bson的，这周还发现了bson_to_mapping过程中的问题。由于dbd的对象管理采用了LPC虚拟机带的那套，包括hash表和字符串管理，而这套东西默认是在单线程运行的，没有考虑线程安全，所以dbd作为唯一一个多线程运行的进程，就有线程安全的隐患了。我翻看了原始实现，在替换mongodb前，dbd实现反序列化的时候，很机智的避开了共享字符串，不管这个用作mapping key的字符串是否已经使用过，直接从系统里分配内存。我理解另一位同事用共享字符串的理由，维基里提到<a href="http://en.wikipedia.org/wiki/String_interning">string interning</a>，就是为了节省内存和时间。因为dbd作为玩家数据的缓存，存储的玩家一定有很多key是相同的，这部分内存如果节省下来应该蛮可观的。为了线程安全，可能需要牺牲掉这个优化了。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>另外一个是mapping结点的管理。新建mapping结点的时候，会从一个mapping空闲结点池里取，如果没有空结点则malloc一个新的，放到池里，最后从池里取。由于这个空结点池是全局的，没有加锁保护，同样会导致多线程上出现问题。如果不用锁，就只能像string那样，不依赖自己实现的结点池，每次使用均向系统申请了。但如果加锁，由于gamed这个游戏逻辑引擎也会用到，到时候就有可能影响游戏逻辑的运行效率了。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>但是，反观最近的修改，除了通过网络将dbd的数据打到mongo去，其余与最早的实现差别不多，字符串那个问题可以说是共享字符串引起，为什么mapping这个冲突问题以前没有暴露呢？我留意了一下原有的锁设置。原有的全局锁是一把pthread的读写锁，在接到gamed发过来的脏数据后，往脏数据队列里插入，这时候会加上写锁。如果写锁加上了，读锁自会处于等待状态。当写锁释放，读锁加上的时候，可以有多个读线程同时读。这时候，应该有可能出现读线程之间同时创建mapping的情况啊，为什么当时会没出现问题呢？待查</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>目前看来，只要在这些涉及到全局变量的点上，主要是mapping和字符串管理，加上可靠的锁保护，应该能够有效解决线程冲突的问题。只是，前提是能够重现线程冲突这个bug&hellip;&hellip;</p>]]></description></item><item><title>dbd到mongo的序列化问题及稳定性</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/10/14/dbd_structure_and_bson_format_process.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 13 Oct 2013 16:08:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/10/14/dbd_structure_and_bson_format_process.html</guid><description><![CDATA[<p>最近工作压力有点大，情绪偶然会失控，要好好反省一下自己。</p>
<p>&nbsp;</p>
<p>上周本来打算写CSP相关的东西，但是目前做得还不够多，积累的经验不足，就放弃了。中间找到很好的参考资料，一并放在这里。一篇是比较短的论文，可以观其大略：http://www.cs.ucf.edu/courses/cop4020/sum2009/CSP-hoare.pdf，另一个链接是hoare写的关于进程演算的书：https://dl.dropboxusercontent.com/u/5660734/CSPbook_2004_Hoare.rar 对于理解CSP这个模型的数学基础很有帮助。不过书好长，还没看完。。。</p>
<p>&nbsp;</p>
<p>本周合并了另一个项目组对mongodb改造的修改，对方完全重写我的代码，但没有配套单元测试，合并当天就测出bug了，有点碎碎念啊。没办法，硬着头皮剥离一部分依赖，独立出一个可执行文件来测bson_format的问题。正如之前写的<a href="http://www.cnblogs.com/Lifehacker/p/add_mongodb_support.html">这篇</a>博客提到的，难点在于类型系统的对接。本次修改增加了一个array迭代，保证初次在引擎这边分配array的时候，已经是一块足够长的内存，而不是我原来实现时，迭代bson，有一个元素就合并一个。另外，上次序列化为bson时，我错将array当mapping来序列化了，原有的测试只针对长度，没针对具体内容，本次修改已经修正。</p>
<p>&nbsp;</p>
<p>另外一个地方，是关于内存对象的生命周期的。本次修改直接重写了dbo_new, dbo_load, dbo_unload等方法，这些方法控制了dbd内存中，存放在apr_list里的一系列db对象。gamed通过rpc调用，以dbo_new或者dbo_load方法创建对象后，除非调用dbo_unload，否则对象是不会被释放的，整个生命周期非常清晰。虽然dbd启动过程中初始化了vm虚拟机，实际上并没有跑lpc脚本，所有工作都是在c层实现的。本次修改中，在序列化过程里，用到的字符串局部变量，都是通过vm虚拟机来申请和释放的。个人对此持保留看法。在序列化过程中，所用到的key值都是临时性的，bson化后就没有意义。一个简单粗暴的做法，就是直接在函数内定义定长字符串数组，然后每次需要序列化bson key的时候，都复制/格式化到这个数组上。这一方面可以避免堆区内存分配，另一方面避免无谓的内存泄露，以及可能出现的二次释放问题。</p>
<p>&nbsp;</p>
<p>稍后，通过单元测试，修正了当天测试暴露出来的，反序列化array嵌套mapping对象时，array元素没有初始化好，导致序列化嵌套mapping时，引擎core dump的问题。接着，对方又抛出了一个新的修改，依然是没有单元测试。。目标是修正引擎的概率性崩溃，依据是序列化mapping过程中，对key做字符串化操作时，会改动到原有的mapping，然后造成内存泄露和/或mapping元素的二次释放问题，引致引擎崩溃。经单元测试发现，这个理由不成立，但代码里的确会有误释放的问题。至于误释放为什么没有引起单元测试崩溃，这个还需要看看gc那一块的代码。这次bug fix就没有吸合了，稍后通过在函数内定义一个局部定长字符串数组，加上key的复制来解决吧。</p>
<p>&nbsp;</p>
<p>通过这几次引擎的修改，越来越发现，没有单元测试的代码，真的会没有信心的。不是说你用这个代码跑了两周，没有发现存储有问题，这个代码就是没有问题的。不同项目组里，用到的储存结构不一样，也许你的代码嵌套3层以后就会崩掉呢？或者就是这次暴露出的，复合类型的嵌套储存bug呢？没有办法用单元测试重现的bug，只靠看代码猜测，我觉得是不靠谱的，因为修好后你也没办法重现bug的环境，看看本次修改是否有效。希望大伙能够早日认同这个道理</p>
<p>&nbsp;</p>
<p>做完底层又要赶逻辑代码，差点回不了家，残念&hellip;&hellip;</p>]]></description></item><item><title>进程演算中的事件概念</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/10/07/3355515.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 07 Oct 2013 07:17:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/10/07/3355515.html</guid><description><![CDATA[<p>最近将军团模块的bug修的差不多了，可以准备下一步的分布式改造了。只是每次想起这工程量，就有够头大的了。</p>
<p>&nbsp;</p>
<p>在修改军团的时候，除了不断增补单元测试，就是思考分布式的交互。不同进程间的交互，一个rpc协议就是一个消息，消息间是有严格的先后顺序的，</p>]]></description></item><item><title>青春请你归来，再伴我一会</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/09/28/overtime_working.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 28 Sep 2013 10:24:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/09/28/overtime_working.html</guid><description><![CDATA[<p>加班到12点，走出公司的时候，发现大街上伴我同行的，只有一大帮小姐了，so sad</p>
<p>&nbsp;</p>
<p>持续加班获得的效率红利已经渐渐消失，前面留下的技术债越来越成为前进的障碍。发版本的前一晚，提交频率非常高，经常有人抱怨更新后进不去游戏。客户端没有人搞单元测试，偏偏脚本又无法通过静态编译消灭一部分低级错误。于是，就变成了《唐伯虎点秋香》那一幕：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201309/28180549-13696b09c42c4140ac6fd4b4a9c0619d.jpg" alt="" width="453" height="254" /><img src="http://images.cnitblog.com/blog/90397/201309/28180622-8feb1fc94f274084a66bdc4a0609c936.jpg" alt="" width="455" height="256" /></p>
<p>&nbsp;</p>
<p>本周主要做的是公会的公告板系统。一般公会的聊天都是纯文本，只要记得记录就好，但是coc的公会还有同意和拒绝这种操作，以及捐兵，而且这两项还是实时推送。推送消息的时候，需要考虑到接受消息人的公会位置，普通成员要过滤掉部分信息。操作主要分成两步，一是修改原有的消息记录，另一个是发消息操作到客户端去。</p>
<p>&nbsp;</p>
<p>同时，客户端还解决了一个内存越界访问的bug。这个bug出现在地图寻路的时候，将地图块从脚本层传到C层，由于地图块的错误，导致访存越界。这个错误在真机上会不定时崩，在win下的模拟器上跑，会报堆访问出错。最终改为在栈上分配这个空间解决。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>再堕噩梦，斩龙之旅</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/09/15/thoughts_on_api_design.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 15 Sep 2013 15:04:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/09/15/thoughts_on_api_design.html</guid><description><![CDATA[<p><img src="http://images.cnitblog.com/blog/90397/201309/15230418-6041b6a9e63a4f429ffeb0ccaa1a0975.jpg" alt="" /></p>
<p>本周继续做公会功能，有点乏味。</p>
<p>&nbsp;</p>
<p>这次主要是基于上周完成的框架，进行具体功能的协议对接。原本以为对接会很简单，毕竟之前的功能模块都已经写过单元测试了，虽然覆盖率不高，好歹还是能跑通happy path的。实际用的时候，才发现上周设计的api粒度太细了。隐约记得第一次做公会，也是犯了这个错误，api之间是十分正交，每一个完成的功能也很简单，方便测试。但是，用的时候需要调用多个api，因此需要处理多种错误情况，而没有goto语句，又导致需要将同一段错误处理代码多次复制粘贴。</p>
<p>&nbsp;</p>
<p>另一个比较头痛的问题，是目前的网络流是异步IO模型的，导致一段正常的逻辑需要断开多个函数来写，搞得我思维负担很大，有时候还需要在多个文件间来回切换，工作效率不高。异步回调这个无法解决了，除非引入coroutine的模型，可惜目前能力有限，无法向领导层推动这个事情。连游戏的自动测试，都无法推动到商业合作的阶段，真的有点失落。多个文件切换这个，最后用单元测试部分解决了，测好一个函数，对接一个，避免首尾应接不暇轮番报bug。</p>
<p>&nbsp;</p>
<p>为了方便开发，避免频繁更新协议，内部协议采用了JSON作为序列化的工具。因此，很多回调函数的参数都是mapping，类似python里的dict，漏参数在编译器不会报错，运行期会出现各种诡异问题。当年用python写公会的时候，没有想到解决办法，总觉得熬过去就好，反正有QC保证。现在学聪明了一点，写了个入口检查函数，既然不能在编译期检查，就在运行期加上吧，实际尝试后，发现效果拔群！虽然没有做类型检查，只是检查了key值是否有缺失，已经很有帮助了。</p>
<p>&nbsp;</p>
<p>另，最近同事在研习bt软件，用了一个从网上扒拉过来的SHA1算法，然后老是说这个算法改了他的全局变量，导致变量变成一个巨大无比的值。我检查了一下代码，SHA1里没用全局变量，不可能是别人的误改动。后询问得知，这个错误在Linux上不会发生，在mac上编译才会出现。前段时间，引擎从Freebsd迁移到CentOS上的时候，也出现了类似的错误。有可能是内存越界访问导致的，<span style="text-decoration: line-through;">也有可能是某个unsigned的类型定义不一样，</span>（不可能，溢出绕回的话不会变成大于max的值，如果可以大于max就不会溢出了）只是，网上找到的教程都是Unix向Linux移植，没有反方向的，比较囧</p>
<p>&nbsp;</p>
<p>ps:题图是经典的编译原理之龙书，勇士手握LALR文法之剑，持语法制导翻译之盾，向编译器复杂度之真龙发起殊死斗争，题中的斩龙指斩复杂度之龙</p>]]></description></item><item><title>抄作业的一周</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/09/08/bad_copy_of_clans.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 08 Sep 2013 04:00:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/09/08/bad_copy_of_clans.html</guid><description><![CDATA[<p>本周主要处理军团的抄袭工作。。。</p>
<p>&nbsp;</p>
<p>第二次做类似公会模块的东东了，分功能的时候还算轻车熟路，只是几个管理器之间概念层次不同，组装的时候还真费神。这一块的东西，技术上倒谈不上有什么难度，但是比较繁琐，就怕某个功能点没做好，以后填坑就痛苦了。这次配合着单元测试来搞，每个功能组件都有单元测试配套，然后自己写了一点文档，说明这个模块的组成，各个功能需要实现的目标，希望以后修改会比较方便。</p>
<p>&nbsp;</p>
<p>本质上，公会是双向映射的结构，需要公会能查询到会员，还能根据会员属性排序。而会员不仅要能索引到公会，还需要能得到自己的权限表。权限表本身，也是一个可被修改的属性，也就是说，会遇到别人修改你的权限，而你正通过权限表执行某一操作这种情况。刚开始实现的时候，为这问题绕进去了，没想到现在游戏已经是串行化的，不需要考虑同步发生的情况。同一时间，只有一个人能够操作公会，只要处理好串行的情况就好了。</p>
<p>&nbsp;</p>
<p>另外一个问题，是功能服务器之间通讯的问题。目前内部RPC协议的分发，只提供了一个json域给我。这样子可以避免频繁修改内部协议，经常重启服务器。至于这个JSON域怎么使用，怎么能够更好的表达业务逻辑，目前还没想好。也许，JSON里包含操作指令及操作数就可以了？</p>
<p>&nbsp;</p>
<p>另，最近朋友做爬虫，遇到一个全flash构建的，无从入手，我帮忙搜了一下，原来adobe当年推出过swf2html这个神器，虽然偶然bug掉，但是用来做爬虫实在合适不过了，而且还有C++代码提供。</p>
<p>&nbsp;</p>
<p>又另，发现构造md5相同的可执行文件已经渐渐变成现实了，参考<a href="http://www.mscs.dal.ca/~selinger/md5collision/">http://www.mscs.dal.ca/~selinger/md5collision/</a>，很过瘾，<span>方法有点取巧，evil逻辑和good逻辑都放在同一个exe里面，通过一个开关值进行控制，然后开关值构造一下，用两个不同但hash一样的pair来完成&nbsp;</span></p>]]></description></item><item><title>supervisor很赞！</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/08/29/supervisor_and_architecture_of_server_design.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 29 Aug 2013 07:02:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/08/29/supervisor_and_architecture_of_server_design.html</guid><description><![CDATA[<p>最近，公司进行了新的架构设计，原来一个区服一组进程，变成了对外只有一台服，后面N组多进程进行服务的模式。于是，管理进程就变成了一个头痛的问题。原来是在写代码的目录里放置各种脚本解决的，关闭脚本，开启脚本，重启脚本，更新脚本，还有一打用来看各种日志的脚本。这些脚本还是严重目录相关的，要执行某些命令，只能cd到指定目录执行（或者用硬连接+设置脚本所在目录为当前目录解决？whatever）。遇到实际部署的时候，还需要ssh到指定机器上，运行指定脚本，有时候还担心服务器起不来，需要人肉ssh过去看status或者tail日志看。</p>
<p>&nbsp;</p>
<p>现在，有supervisor，将所有这些烦恼一扫而光！supervisor有两个组件：supervisord和supervisorctl，组成了client/server结构。supervisord负责读入配置文件，然后以子进程方式启动配置中定义的程序，将对应的program进行后台化（daemonize）处理。supervisorctl则负责和supervisord进行沟通，获取运行中的进程信息，包含pid，uptime等信息。supervisorctl既可以通过命令行参数进行控制，又能够直接进入一个特有的shell，通过这个shell管控进程组。这样，既能够让部分同学准确把握进程状况，又能避免放开shell权限，一举多得。</p>
<p>&nbsp;</p>
<p>以前做服务器逻辑的多并发，采用gevent可以很自然对应到逻辑上的并发微线程，但是处理部分游戏逻辑，需要用到锁，有时候还需要跨进程的锁。所以，当时一直很渴望有个网关进程顶在前头，将网络通信先行串行化，然后后台跑起多个不同工作任务的进程，消化不同的数据包。这样，每个进程处理的任务简单，比较容易做到正确和高效。然后没有并发事件，可以避免锁。现在想来，其实这种架构，是将部分业务逻辑的压力，压在了多进程上，名曰&ldquo;分布式处理&rdquo;，实际运行时，对进程的管控需求会提高，增加了运行时管理的难度。比如，一般需要一个master管理这种异质进程，控制其生生灭灭。</p>
<p>&nbsp;</p>
<p>使用supervisor，可以简化进程管理这方面的压力。但是，部分跟业务逻辑相关的进程生命周期，还是需要主动干预。哪些情况下，进程被关闭是正常，什么情况下需要重启进程，还是需要费心搞清楚的。幸而supervisor给了一个不错的思路。剩下的就是多服务器配置的生成和管理了，希望能找到可靠的开源工具。</p>]]></description></item><item><title>添加mongodb支持</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/08/18/add_mongodb_support.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 18 Aug 2013 14:00:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/08/18/add_mongodb_support.html</guid><description><![CDATA[<p>最近花了些时间，将引擎的存储换成了mongodb。</p>
<p>&nbsp;</p>
<p>私下，我觉得现有的存储机制极为落后。现在写数据的操作交由单独的进程完成，该进程兼当数据缓冲与持续化数据的责任。此次引擎的更换，只是简单的利用mongo的官方c驱动，将数据打到mongo里面，代替写文件的做法而已。该进程的数据缓冲角色，还是没有变化。mongodb的优势在于对内存的高效利用，增加一层作为中转，就会失去这个速度上的优势。</p>
<p>&nbsp;</p>
<p>往引擎里添加mongo，比较头大的是跟引擎脚本的类型系统打交道。比较了一下BSON支持的数据格式，能够比较好的容纳引擎的数据。但是引擎的关联数组（类似python的dict）和异构数组，在C层用起来不太方便。引擎这边的类型，都是用一个svalue进行封装，里面用union包装int、float等基础类型，以及字符串指针和数组等引用类型。但是，svalue的打包却需要手工做，没有封装方便的打包函数。关联数组的使用还算方便，只要构造好key和value的svalue值，调用find_for_insert，然后assign_svalue就可以了。</p>
<p>&nbsp;</p>
<p>bson到引擎和引擎到bson的格式转换搞定之后，就找了个开源的带锁队列，用来作数据库连接池的管理。目前有个问题未解决，如果连接不到数据库，程序就会崩掉。。然后测试了一下读写，基本没问题了。主要是有部分储存使用了整型的key，而mongodb不接受整型key。</p>
<p>&nbsp;</p>
<p>剩下的主要是对象的生命周期管理。连接对象由数据库连接池进行管理，如果多线程读写时有线程hang住，该连接就不会被释放了。用于传送数据到数据库的bson对象，会在每次传送完成后被释放，这里应该没有问题。从数据库序列化为引擎的数据对象时，产生的关联数组等数据交由vm进行管理，这块是通过引用计数做的，要分析泄漏的问题，可能要结合具体的脚本进行分析了。</p>
<p>&nbsp;</p>
<p>性能方面，还没有进行测量，打算通过Dtrace或者SystemTap进行，顺便用valgrind做做内存泄漏检测。瞎猜测一下，socket进行数据中转和序列化对象可能会是瓶颈。</p>]]></description></item><item><title>The implementation of Lua 5.0 阅读笔记（二）</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/07/17/the_implementation_of_lua5_review_part2.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 17 Jul 2013 10:14:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/07/17/the_implementation_of_lua5_review_part2.html</guid><description><![CDATA[<p>6 线程和协程</p>
<p>读完这篇文章我才意识到python的协程到底缺了什么，这个就是coroutine和semi-coroutine的区别了。区别就是，semi-coroutine只能返回（yield）到调用者所在位置，不能将控制权交到任意其他协程上去。具有这个特征的，都是semi-coroutine。</p>
<p>&nbsp;</p>
<p>Lua实现协程的时候，充分利用了其C栈和Lua栈。进行协程调用的时候，解释器会在C栈上会进行一次递归调用，然后协程自身的栈在新建立的Lua栈里消长。当一个协程结束的时候，解释器会退出，返回调用者（即上一个解释器）。注意，这里是一个协程对应C栈上的一帧。与之相反，参考经典的<a href="http://www.python.org/workshops/2000-01/proceedings/papers/tismers/spcpaper.htm#_Toc470444065">CPython实现</a>，每一次python的函数调用都会产生一层新的C栈，因此，python的函数调用受C堆栈大小的限制。Stackless Python之所以声名大噪，就是因为解决了这个问题，只有tasklet才会在C栈上产生新的栈帧。</p>
<p>&nbsp;</p>
<p>作者还提到，这里实现协程的时候，比较棘手的地方是嵌套调用时如何处理外部的局部变量，因为存在协程时，很可能会出现一个函数引用的局部变量存在于另一个协程栈中。而这个问题，因为Lua的upvalue而被完美解决了。</p>
<p>&nbsp;</p>
<p>7 Lua的虚拟机</p>
<p>Lua5.0之前的版本，使用的都是基于栈的虚拟机，直到5.0才转为基于寄存器的虚拟机，Lua是第一门大规模使用寄存器虚拟机的工业级语言。</p>
<p>&nbsp;</p>
<p>不过要注意的是，不是说基于寄存器的虚拟机就不需要使用栈，Lua5依然有使用栈。栈上会分配栈帧用来存放寄存器，局部变量也都在寄存器中。基于寄存器的意思是，对于Lua函数的参数传递，不再需要繁琐的入栈和出栈操作了。作者顺带讨论了一下寄存器虚拟机的两个性能问题，包括生成的虚拟机代码大小以及指令解码的开销。和Java的jvm做了对比，结果是难分伯仲之间，寄存器机器会稍胜一筹。</p>
<p>&nbsp;</p>
<p>Lua的一条指令是32位，指令的布局可以参考下图：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201307/17165122-903595e629364e5ab9abbf92429518ec.png" alt="" /></p>
<p>指令是三地址码的格式，A是存放结果的寄存器，B和C就是操作数。由于指令长度的限制，如果想在一个指令里完成一个跳转语句，跳转的范围就会受到限制。因此，Lua将条件语句变成一个test语句和紧接着的jump语句来解决（跟汇编很像^_^）。</p>
<p>&nbsp;</p>
<p>这节里还提到寄存器窗口，不过没看懂。维基了一下，寄存器窗口是指实际寄存器数目会比可用寄存器数目要多，不同的函数调用，他们看到的同名寄存器可以是不同的寄存器。比如func1使用了AX和BX，func2也同样使用AX和BX，不过实际上寄存器有4个，func1递归调用func2的时候，func2使用的AX和BX是func1以外的两个。</p>]]></description></item><item><title>The Implementation of Lua 5.0 阅读笔记（一）</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/07/16/the_implementation_of_lua5_review.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 16 Jul 2013 08:10:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/07/16/the_implementation_of_lua5_review.html</guid><description><![CDATA[<p>没想到Lua的作者理论水平这么高，这篇文章读的我顿生高屋建瓴之感。云风分享了一篇中译：<a href="http://www.codingnow.com/2000/download/The%20Implementation%20of%20Lua5.0.pdf">http://www.codingnow.com/2000/download/The%20Implementation%20of%20Lua5.0.pdf</a></p>
<p>&nbsp;</p>
<p>全篇的主题有4个：1.基于寄存器的虚拟机；2.用于将table作为数组使用的新算法；3.闭包的实现；4.以及协程。第二点我关注不多，会写的比较简略。</p>
<p>&nbsp;</p>
<p>1 简介</p>
<p>简介主要就是说，我们搞Lua嘛，就是一个实验室出来的产品，没想到今天在工业界特别是游戏界红得发紫，这主要是得益于Lua轻灵小巧，注重可移植性。除了上面提到的4点，这篇文章还有一些铺垫的章节，帮助你们理解我们这个牛逼哄哄的东西。（这些铺垫的东东也很牛逼，建议参考中译）</p>
<p>&nbsp;</p>
<p>2 Lua的设计和实现</p>
<p>我们写的Lua简洁，高效，可移植，非常容易嵌入。</p>
<p>&nbsp;</p>
<p>3 Lua的类型系统</p>
<p>这段看代码比较简洁：</p>
<div class="cnblogs_code">
<pre>typedef <span style="color: #0000ff;">struct</span><span style="color: #000000;"> {
   </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> t;
  Value v; 
} TObject;

typedef union {
  GCObject </span>*<span style="color: #000000;">gc;
  </span><span style="color: #0000ff;">void</span> *<span style="color: #000000;">p;
  lua_Number n;
  </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> b;
} Value;</span></pre>
</div>
<p>作者顺便扯了一下对象的装箱拆箱，嘲笑python的实现比Lua要慢。</p>
<p>&nbsp;</p>
<p>4 Lua的Table</p>
<p>牛逼的地方在于，如果table是当array用，数字的key比较紧凑，我们就会拿一个真实的数组去储存它，即省空间又快速，如果是当成单纯的关联组来用，那么数组部分则不会分配，避免浪费</p>
<p>&nbsp;</p>
<p>5 函数和闭包的实现</p>
<p>闭包在lua里应用得非常广泛。每一个函数都会被编译成一个prototype作为原型。实际执行的时候，则会为其生成一个闭包，包含了对函数原型的引用，对全局变量的引用表，以及对upvalue的引用（用来访问外部的局部变量）。</p>
<p>&nbsp;</p>
<p>以函数为第一类对象，以及带词法作用域的语言，大多会遇到外部局部变量访问的问题。考虑下面的例子：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">function</span><span style="color: #000000;"> add(x)
    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">function</span><span style="color: #000000;">(y)
                   </span><span style="color: #0000ff;">return</span> x +<span style="color: #000000;"> y
               </span><span style="color: #0000ff;">end</span>
<span style="color: #0000ff;">end</span><span style="color: #000000;">

add2 </span>= add(<span style="color: #800080;">2</span><span style="color: #000000;">)
</span><span style="color: #ff00ff;">print</span>(add2(<span style="color: #800080;">5</span>))</pre>
</div>
<p>当调用add2的时候，add函数已经返回，那么add2函数体内的x会不会随着add函数的退栈而被销毁呢？如果不被销毁，又应该如何保存这个变量呢？</p>
<p>Lua巧妙的使用了upvalue解决这一问题，参考下图：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201307/16115447-3d58f97b68d044a5aae91c0a2f1c63da.png" alt="" width="648" height="469" /></p>
<p>每当创建一个新闭包，Lua就会检查外部定义的局部变量是否有加入upvalue链表，如果没有就创建一个upvalue加入双向链表里。所有对外部定义的局部变量访问，都是通过upvalue的指针进行间接访问的。当外部函数退出时，因为函数退栈，局部变量被清理，这时候局部变量就会被转存在upvalue的值域里，然后把upvalue的指针指向自身的值域。对于定义局部变量的函数，这些局部变量还是栈上的元素，不许通过upvalue访问。</p>
<p>&nbsp;</p>
<p>对于多层函数嵌套的情况，当一个函数需要访问的变量不在上一层函数的局部变量，就访问上一层函数的闭包。闭包具有传递性，会由外部函数传递到内部。</p>
<p>&nbsp;</p>
<p>下篇：<a id="homepage1_HomePageDays_DaysList_DayItem_0_DayList_0_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/Lifehacker/p/the_implementation_of_lua5_review_part2.html">The implementation of Lua 5.0 阅读笔记（二）</a></p>]]></description></item><item><title>移动安卓端网络库开发</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/06/29/enter_lua_cocos_world.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 29 Jun 2013 07:31:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/06/29/enter_lua_cocos_world.html</guid><description><![CDATA[<p>最近在协助客户端做网络通讯和登录流程，增进了对Lua的了解，捣鼓Libevent的静态库编译，掌握了部分Android NDK的开发技巧。真机调试遇到一个比较大的问题，由于资源较大，打包出来的apk有100Ｍ大小，每次因为一个语法错误或者路径大小写问题，导致重新写apk，都有种吐血的感觉。因此，想搞个热更新的框架和联机远程调试的Lua调试器。</p>
<p>&nbsp;</p>
<p>另外，由于项目预期只有短短3个月的开发时间，时间管理方面遇到比较大的问题。客户端的主程又死抱着C++的那套对象思想，跟其他开发人员有冲突，如何协调好人际关系，以最大限度发挥大家的能力才干，完成开发目标，实在是前所未有之挑战。</p>
<p>&nbsp;</p>
<p>目前，主力使用的客户端引擎，是依赖cocos-2dx开发的quick-cocos2dx，它将所有底层系统相关的内容都打包成一个player，方便页游的同学转过来进行开发。只是，内置的cocos-2dx有点老旧，部分新功能没有，需要等待每月一度的quick-cocos2dx版本更新，而且开发人员较少，活跃开发者似乎只有3个，有点忧心。未来希望能有时间投入该开源项目的开发，而不是只提issue。</p>]]></description></item><item><title>从lua调用C函数</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/05/26/calling_C_function_from_Lua.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 26 May 2013 10:11:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/05/26/calling_C_function_from_Lua.html</guid><description><![CDATA[<p>最近在进入Lua编程的状态，一度令我困惑的是，Lua提供的功能少的可怜，跟自备电池的python相比，可说是简陋了。连table的打印，都需要自己实现，也因此有了一打的第三方方案。后来我想明白了，以Lua和C如此紧密的关系，只需要建立Lua的binding，那么丰富而性能强大的C库资源完全可以为Lua所用，这样就不愁功能缺失了。</p>
<p>&nbsp;</p>
<p>关于C调用Lua，前段时间已经写过一篇短文了：<a href="http://www.cnblogs.com/Lifehacker/archive/2013/03/26/Lua_C_interact.html">《多语言协作与二进制交互》</a>，现在补上从Lua调用C的这一篇。先上一段Lua代码：</p>
<div class="cnblogs_code">
<pre>#!/usr/bin/<span style="color: #000000;">lua
</span><span style="color: #ff00ff;">require</span>(<span style="color: #800000;">"</span><span style="color: #800000;">power</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #ff00ff;">print</span>(square(<span style="color: #800080;">1.414213598</span><span style="color: #000000;">))
</span><span style="color: #ff00ff;">print</span>(cube(<span style="color: #800080;">5</span>))</pre>
</div>
<p>在这段代码里，我引用了一个power模块，并且调用了power模块里的square函数和cube函数。由此可知，在C语言编写的power模块里面，需要有相关的函数可以注册本模块提供的函数，并且让Lua可以&ldquo;感知&rdquo;到自身是一个模块。回忆一下Lua的路径搜索，可以看到除了后缀名为*.lua的文件之外，还有*.so文件，所以C扩展是编译为.so的。实际情况是，在执行require语句的时候，系统会调用luaopen_power函数，这个函数名是通过luaopen_与power这个模块名拼接得到的。</p>
<p>&nbsp;</p>
<p>现在看看luaopen_power函数的定义：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">int</span> luaopen_power(lua_State *<span style="color: #000000;">L){
    lua_register(
            L,               </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Lua 状态机 </span><span style="color: #008000;">*/</span>
            <span style="color: #800000;">"</span><span style="color: #800000;">square</span><span style="color: #800000;">"</span>,        <span style="color: #008000;">/*</span><span style="color: #008000;">Lua中的函数名 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
            isquare          </span><span style="color: #008000;">/*</span><span style="color: #008000;">当前文件中的函数名 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
            );  
    lua_register(L,</span><span style="color: #800000;">"</span><span style="color: #800000;">cube</span><span style="color: #800000;">"</span><span style="color: #000000;">,icube);
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
</div>
<p>可以看到，通过调用lua_register函数，我们在L这个lua虚拟机里面注册了两个函数，一个是square，一个是cube，他们分别对应到isquare和icube这两个C函数。</p>
<p>&nbsp;</p>
<p>回过头来看一看，lua脚本里，这条简单的require语句，执行了两个步骤：一是先把名字为power.so的文件加载起来，二是调用其中的luaopen_power函数。下面来看一下具体的函数如何定义：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> isquare(lua_State *L){              <span style="color: #008000;">/*</span><span style="color: #008000;"> C中的函数名 </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">float</span> rtrn = lua_tonumber(L, -<span style="color: #800080;">1</span>);      <span style="color: #008000;">/*</span><span style="color: #008000;"> 从Lua虚拟机里取出一个变量，这个变量是number类型的 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">Top of square(), nbr=%f\n</span><span style="color: #800000;">"</span><span style="color: #000000;">,rtrn);
    lua_pushnumber(L,rtrn</span>*rtrn);           <span style="color: #008000;">/*</span><span style="color: #008000;"> 将返回值压回Lua虚拟机的栈中 </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">return</span> <span style="color: #800080;">1</span>;                              <span style="color: #008000;">/*</span><span style="color: #008000;"> 这个返回值告诉lua虚拟机，我们往栈里放入了多少个返回值 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
}</span></pre>
</div>
<p>注释的讲解比较详细了，可以看到为Lua定义的C函数格式都是比较统一的，首先接受一个Lua虚拟机变量L，然后从L里取出相应的参数（需要指定数据类型），最后将返回值再次压回虚拟机里面，通过返回int告诉Lua虚拟机，自己的返回值有多少个。</p>
<p>&nbsp;</p>
<p>好，到这里就只差最后一步了，现在把这段C代码编译成.so文件。使用如下的编译参数：</p>
<div class="cnblogs_code">
<pre>ubuntu@ubuntu:~$ <span style="color: #0000ff;">gcc</span> -Wall -shared -fPIC -o power.so  -I/usr/include/lua5.<span style="color: #800080;">1</span> -llua5.<span style="color: #800080;">1</span>   hellofunc.c</pre>
</div>
<p>（hellofunc.c记得要include lua.h, lauxlib.h, lualib.h三个头文件哦）</p>
<p>这里解释一下两个参数的意思，-shared是告诉gcc，需要编译成.so文件，并且这个源文件里面不会有main函数，不要大惊小怪。另一个-fPIC，是Position Independent Code的意思，具体的含义可以参考<a href="http://bbs.chinaunix.net/thread-1285426-1-1.html">这篇</a>，主要用来避免同一份代码因为重定位位置不同而在内存中存在多个实例。</p>
<p>调用的结果：</p>
<div class="cnblogs_code">
<pre>ubuntu@ubuntu:~$ ./<span style="color: #000000;">hellofunc.lua
Top of square(), nbr</span>=<span style="color: #800080;">1.414214</span>
<span style="color: #800080;">2.0000002687177</span><span style="color: #000000;">
Top of cube(), number</span>=<span style="color: #800080;">5.000000</span>
<span style="color: #800080;">125</span></pre>
</div>
<p>当然，如果机器安装有多个版本的Lua，需要指定执行hellofunc.lua的lua解释器版本。因为本篇教程是针对Lua5.1的，所以需要指定Lua5.1来执行，例如lua5.1 hellofunc.lua，否则用lua5.2调用会引起core dump</p>]]></description></item><item><title>新的开始</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/05/17/turn_to_mobile_development.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 17 May 2013 08:00:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/05/17/turn_to_mobile_development.html</guid><description><![CDATA[<p>原项目没有上线的机会了，停止开发，伤心了好久。目前转到手机开发上去了，使用开源的cocos-2dx引擎，貌似坑比较多啊</p>]]></description></item><item><title>外服部署时遇到的问题</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/04/20/server_code_public_problem.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 20 Apr 2013 10:51:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/04/20/server_code_public_problem.html</guid><description><![CDATA[<p>吐槽一下，公司的权限给的很死，部署的时候麻烦事比较多，趁手的工具需要自己手动编译，无法利用port安装。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>昨天遇到一个外服部署的问题，表现为外服不能登陆，用部署工具重新发布代码后，仍然如此。于是联系运维的同学进行处理，运维的同学帮助排障时发现引擎启动报错，提示rc/simul_efun must be loadable，认为是代码的问题。回去检查代码后，没有发现问题，而且这个文件已经很长时间没有更改了，怀疑是编译的问题。后来，手动连接外服，将验证服务器跑起来了，但是游戏服依然提示同样的错误。最后通过备份代码，然后用验证服的代码加游戏服的配置启动成功。但是，对于这个错误还是很耿耿于怀，于是找公司的前辈帮忙排错，发现发布代码的过程里漏了一个关键的步骤，补上后似乎没有问题了。</p>
<p>&nbsp;</p>
<p>今天回想一下，感觉下次还是有机会出现上述的问题。首先，是引擎的报错太具有误导性，如果是代码缺失，就应该提示文件不存在或代码缺失，而不是代码有错误。（究竟是不是代码的问题，周一回去以后还要再次确认）其次，是我发布的时候粗心大意，这个应该通过更傻瓜化的工具解决，内网发布时我已经写了点bash脚本进行一键发布了，但是外服运行环境不同，还需要修改一下。再次，是发布工具的效率问题，一个是提示信息含糊不清，第二个是杀进程时只会sleep等待，不会主动监控进程运行状态。</p>
<p>&nbsp;</p>
<p>关于外服内服环境不同，这个还要再吐槽一下。外服上运行的是9.0的Freebsd，内部测试服则是8.2的，内部测试服同时兼任打包服务器、发布服务器的角色。在9.0的系统上编译得到的引擎，无法在8.2的系统上面运行。而指定发布机器时，外服和内服又是同一个标签之下的，也就是说，更新外服的话内服的引擎版本就错了，内服更新时，外服的引擎版本也会错。这个问题已经足够致命了，更致命的是打包发布脚本提示信息是可以通过hostnum指定机器的，但实际上却不可以，真让人抓狂。以后打算把游戏逻辑的svn版本和引擎代码的svn版本都打包到代码里面，可以在运行时查询，否则发布脚本的错误会导致大问题。</p>
<p>&nbsp;</p>
<p>另外，公司的svn服务器证书过期，最近一段时间至少引起了3次问题，主要是策划利用热更新通过svn拉取数据表更新时出现。因为svn密码不允许明文保存，所以设置了<span>store-passwords = no。面对证书问题，会出现拒绝，暂时接受，永久接受。选择永久接受后，就一直出现svn: E175002: Unable to connect to a repository at URL，但是证书错误的原因反而没有提示。干掉~/.subversion 目录后，再次出现证书的问题，每次选择暂时接受就可以正常checkout了。store-password选项影响到subversion对证书的选择，好奇怪</span></p>]]></description></item><item><title>迅捷 FAST FWR171-3G 实战OpenWRT</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/04/13/failure_on_fwr171-3g_with_openwrt.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 13 Apr 2013 15:52:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/04/13/failure_on_fwr171-3g_with_openwrt.html</guid><description><![CDATA[<p>FAST是TP-LINK的一个子品牌，所推出的FWR171-3G与TP-LINK wr703n的硬件采用相同规格，而前者要便宜20块，区别只在品牌、外观与软件界面。于是果断入手，然后尝试OpenWRT。</p>
<p>&nbsp;</p>
<p>上手后第一件事，就是通过官方界面进行线路测试。目前的网络连接是，通过RJ45接口接入光猫进行PPPOE拨号，然后利用wifi信号完成无线路由功能。遗憾的是，通过官方界面进行拨号连接时提示密码错误，无法联通。于是，去找到了wr703n的固件刷上，文件是<a id="1" class="disk_icon compress-icon" title="wr703nv1_cn_3_12_11_up(110926)(Fast-FWR171-3G).bin" href="http://dl.vmall.com/c0zm3y2wb9">wr703nv1_cn_3_12_11_up(110926)(Fast-FWR171-3G).bin</a>&nbsp;注意上传过程比较慢，上传和设备重启中不要断电或断开连接。</p>
<p>&nbsp;</p>
<p>上传完成后，登入看到经典的蓝色TPlink界面，继续进行线路测试。经过测试，成功通过光猫PPPOE拨号。接下来就要进行OpenWRT的刷写了，首先下载文件&nbsp;<a href="http://115.com/file/aqv8bukv">openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-factory.bin</a> 升级，注意，升级完后就没有web界面了，若对命令行有畏难情绪，请谨慎操作。刷入后，就只能通过telnet连上，然后通过passwd指令设置root的密码，输入密码的时候默认没有回显，是正常情况，提示密码较弱的可以忽略或更换更高强度密码。使用passwd设置密码后，以后就不能用telnet进行连接，需要用ssh，在windows下操作建议用<a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">putty</a>。</p>
<p>&nbsp;</p>
<p>当时走到这一步，由于懒/疏忽，没有进行squashfs-sysupgrade.bin的刷写，然后就直接接入网络了，结果pppoe死活拨不上号。要实现前文所述的拨号方案（pppoe+wifi路由），需要修改/etc/config/wireless 文件：</p>
<div class="cnblogs_code">
<p>　config wifi-device 'radio0'<br />	　　option type 'mac80211'<br />	　　option hwmode '11ng'<br />	　　option path 'platform/ar933x_wmac'<br />	　　option htmode 'HT20'<br />	　　list ht_capab 'SHORT-GI-20'<br />	　　list ht_capab 'SHORT-GI-40'<br />	　　list ht_capab 'RX-STBC1'<br />	　　list ht_capab 'DSSS_CCK-40'<br />	　　option txpower '17'<br />	　　option channel '6'</p>
<pre>config wifi-<span style="color: #000000;">iface
    option device </span><span style="color: #800000;">'</span><span style="color: #800000;">radio0</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option network </span><span style="color: #800000;">'</span><span style="color: #800000;">lan</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option mode </span><span style="color: #800000;">'</span><span style="color: #800000;">ap</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option ssid </span><span style="color: #800000;">'路由无线ssid</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option encryption </span><span style="color: #800000;">'</span><span style="color: #800000;">psk2</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option key </span><span style="color: #800000;">'</span><span style="color: #800000;">密码</span><span style="color: #800000;">'</span></pre>
</div>
<p>当然，radio0的disable一行需要删掉或注释掉，注意文件中的注释即可。</p>
<p>以及修改/etc/config/network:</p>
<div class="cnblogs_code">
<pre>config interface <span style="color: #800000;">'</span><span style="color: #800000;">loopback</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option ifname </span><span style="color: #800000;">'</span><span style="color: #800000;">lo</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option proto </span><span style="color: #800000;">'</span><span style="color: #800000;">static</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option ipaddr </span><span style="color: #800000;">'</span><span style="color: #800000;">127.0.0.1</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option netmask </span><span style="color: #800000;">'</span><span style="color: #800000;">255.0.0.0</span><span style="color: #800000;">'</span><span style="color: #000000;">

config interface </span><span style="color: #800000;">'</span><span style="color: #800000;">lan</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option type </span><span style="color: #800000;">'</span><span style="color: #800000;">bridge</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option proto </span><span style="color: #800000;">'</span><span style="color: #800000;">static</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option ipaddr </span><span style="color: #800000;">'</span><span style="color: #800000;">192.168.1.1</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option netmask </span><span style="color: #800000;">'</span><span style="color: #800000;">255.255.255.0</span><span style="color: #800000;">'</span><span style="color: #000000;">
    
config interface </span><span style="color: #800000;">'</span><span style="color: #800000;">wan</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option ifname </span><span style="color: #800000;">'</span><span style="color: #800000;">eth0</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option proto </span><span style="color: #800000;">'</span><span style="color: #800000;">pppoe</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option username </span><span style="color: #800000;">'</span><span style="color: #800000;">帐号</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option password </span><span style="color: #800000;">'</span><span style="color: #800000;">密码</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option peerdns </span><span style="color: #800000;">'</span><span style="color: #800000;">1</span><span style="color: #800000;">'</span><span style="color: #000000;">
    option defaultroute </span><span style="color: #800000;">'</span><span style="color: #800000;">1</span><span style="color: #800000;">'</span></pre>
</div>
<p>（有博客表示eth0就是wan口，这是不对的，eth0表示的只是以太网口，eth1是另一个以太网口，对于wr703n来说不存在，wlan0则是无线网卡口）</p>
<p>设置后一直无法上网，也没有办法装luci web管理界面。因为没有刷入sysupgrade的时候，内核不支持PPPOE！！！可以通过lsmod查看当前加载的内核模块，insmod安装内核模块。openwrt的模块管理位置有点奇怪，还没找到。。。</p>
<p>由于一直卡在这步，我就反复改这两个文件，结果改错了进不了路由器。于是，只好自己焊接ttl线进行救砖。救砖前已经尝试过开机时快速插拔reset孔，无果。。。</p>
<p>&nbsp;</p>
<p>手残只能焊成这样：</p>
<p><img src="http://images.cnitblog.com/blog/90397/201304/13234137-73c2d3642dc540e18c0226e73b10c2a8.jpg" alt="" /></p>
<p>（左侧是信号地，右侧黑色是TP_IN, 黄色是TP_OUT, 对应的是RX, TX）</p>
<p>通过USB转ttl线，成功连入路由器改回正确的配置，然后通过dhcp先安装好luci，刷入<a href="http://pan.baidu.com/share/link?shareid=265600&amp;uk=587667030#dir/path=%2F%E5%85%B1%E4%BA%AB%E6%96%87%E6%A1%A3%2FOpenWrt%2FTL-WR703N%2F%E6%8A%8ATL-WR703N%E6%89%93%E9%80%A0%E6%88%90%E7%9C%9F%E6%AD%A3%E7%9A%84AirPlay%E6%92%AD%E6%94%BE%E5%99%A8%EF%BC%88%E7%BB%AD%EF%BC%89%E4%B8%8D%E9%9C%80U%E7%9B%98%E7%9B%B4%E8%A3%85%E7%89%88">sysupgrade</a>即可。当然，更好的办法应该是在本机开启http文件共享，利用路由器的wget进行下载，用mtp进行刷写。</p>
<p>&nbsp;</p>
<p>现在，路由器已经可以通过rj45接口顺利pppoe拨号，并通过wifi共享，不过挂载硬盘有问题，估计是驱动的问题，但rom太小装不下驱动了，以后试试u盘增加容量后再刷驱动。。。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>游戏服务器设计的思考</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/04/10/3012945.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 10 Apr 2013 10:58:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/04/10/3012945.html</guid><description><![CDATA[<p>gevent并发模型：缺点：多玩家交互的时候需要使用锁，bug比较隐蔽。进行耗时较长的查询时有可能某些资源已经过期，也需要使用锁保护。</p>
<p>Mudos Like: 优点：游戏逻辑进程同一时间只处理一个玩家的一个请求 缺点：与玩家交互比较密集的时候需要用到异步回调，需要从磁盘读数据的时候要异步回调，搞得写函数很恶心。而且回调函数里需要把前面的检查再做一次，跟gevent的并发模型比较没有了优势。</p>
<p>展望erlang: 将游戏的功能按服务的方式提供，不提供服务时就关闭进程，进程间用消息机制解耦合，方便处理服务重启的情况。能够保证最小服务提供的情况下稳定长时间运行。</p>]]></description></item><item><title>多语言协作与二进制交互</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/03/26/Lua_C_interact.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 26 Mar 2013 03:47:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/03/26/Lua_C_interact.html</guid><description><![CDATA[<p>最近刚刚完成了服务器端rpc协议的python封装，理论上说，后续的开发可以以python继续进行了。只是代码热更新还没好，项目进度又吃紧，暂时先放下了。利用rpc协议连接不同进程，各个进程就可以自由选择语言去开发，不局限于C、LPC了。让项目能够充分利用各个语言的优势，在不同的场景下选择特长语言进行开发，这图景不错。</p>
<p>&nbsp;</p>
<p>而客户端所用的Lua脚本，则是以另一种方式实现了多语言协作开发。通过精巧的Lua API，C层可以将一些灵活多变的逻辑操作转交给上层的Lua逻辑去完成，而Lua里的计算密集型的东西也可以放到C层去完成。</p>
<p>&nbsp;</p>
<p>我一直很好奇的是，C到底要怎么告诉Lua，我调用的是XXX，我给你传递一下参数A，类型是YYY，值是ZZZ。这跟我刚实现的RPC协议是十分类似的，但是Lua面向的是嵌入式设备，计算能力受限，估计不会采用socket进行中转。尤其是，当需要传递的不单是基础类型如int、string，还有映射表，列表等较为复杂的数据对象时，怎么实现这种转换呢？</p>
<p>&nbsp;</p>
<p>Lua采取的是利用栈进行交互，利用各种Lua_pushXXX将不同的值压入栈中，然后调用Lua脚本时自然会退栈取出参数运行，对于Lua的虚拟机来说，就像是发生了一次正常的函数调用。（这里采用的栈是Lua栈，因为若是C栈的话调用Lua的C API就会出错了。）需要注意的是，Lua栈状态需要自己进行维护，若发生多线程同时对Lua栈操作，没有加锁保护的话会导致栈状态混乱然后出很诡异的bug。</p>
<p>&nbsp;</p>
<p>关于Lua调用C的函数，还没做完实验，稍后再补充。</p>]]></description></item><item><title>从一段代码里看FreeBSD与Linux内存分配的不同</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/02/23/memory_allocation_difference_between_freebsd_and_linux.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 23 Feb 2013 15:21:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/02/23/memory_allocation_difference_between_freebsd_and_linux.html</guid><description><![CDATA[<p>唉，拖延症无以复加了。</p>
<p>&nbsp;</p>
<p>最近，公司移植服务器端游戏引擎到Linux上的时候，遇上了段错误。问题代码大略如下：</p>
<div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">char</span> *arr =<span style="color: #000000;"> malloc(len);
...
</span><span style="color: #0000ff;">if</span> (IsInvalid(arr[<span style="color: #800080;">0</span><span style="color: #000000;">])){
    arr</span>++<span style="color: #000000;">;
}
...
free(arr);</span></pre>
</div>
<p>很明显，对操作系统分配的内存块进行了指针操作后，再扔回到free函数进行释放，是会导致异常行为的。但是，该引擎的代码已经有较长的历史了，为什么在FreeBSD上没有遇到问题呢？</p>
<p>&nbsp;</p>
<p>这主要是因为FreeBSD与Linux的内存分配机制不同引起的。</p>
<div>
<div>Linux的内存分配实现：采用双向链表，每个节点是一大块可以使用的空闲内存，节点头部含有块大小信息。</div>
<div>&nbsp;</div>
<div>FreeBSD的内存分配实现：应该是采用bitmap图配合数组实现的，通过bitmap标记这块内存已经分配。</div>
<div>&nbsp;</div>
<div>Linux严格要求，free时传入的ptr，一定是malloc分配的内存（否则找不回来这个块的大小）。</div>
<div>&nbsp;</div>
<div>FreeBSD没有这个要求，但是当free的指针与malloc的指针距离比较远的时候，泄漏会很严重，甚至比分配的内存还要多，这个要查查。</div>
<div>&nbsp;</div>
<div>因此，多一个字节，少一个字节，对于依赖bitmap图进行标记的FreeBSD来说，不会影响到系统正常的运行，但是这种纰漏不查出来，以后导致的危险会更大。</div>
</div>
<p>&nbsp;</p>
</div>]]></description></item><item><title>存储器性能测试</title><link>http://www.cnblogs.com/Lifehacker/archive/2013/01/23/memory_mountain.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 23 Jan 2013 11:36:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2013/01/23/memory_mountain.html</guid><description><![CDATA[<p><img title="Xeon E5620" src="http://images.cnitblog.com/blog/90397/201301/10173657-887f5131eb5f4b2eadd5c8e928991dd6.png" alt="Xeon E5620" /></p>
<p>Xeon E5620</p>
<p>&nbsp;</p>
<p><img title="E7500" src="http://images.cnitblog.com/blog/90397/201301/10173913-6f9281a5a57640db8587da6fdf13050d.png" alt="E7500" /></p>
<p>E7500</p>
<p>&nbsp;</p>
<p><img src="http://images.cnitblog.com/blog/90397/201301/10173942-4cb3a0c4ec094a52ab707ba3a9280200.png" alt="" /></p>
<p>In virtual machine, E7500</p>
<p>&nbsp;</p>
<p>最近做了个存储器性能测试，结果如上图。z轴表示速度，单位是MB/s, x轴和y轴一个表示步长，即两次访问数据之间的距离；另一个是读写的数据总量，单位是字节。源代码可以通过&nbsp;<a href="http://csapp.cs.cmu.edu/public/1e/public/mountain.tar">http://csapp.cs.cmu.edu/public/1e/public/mountain.tar</a>&nbsp;获取。</p>
<p>&nbsp;</p>
<p>这个测试是CSAPP书里用来说明存储器山的一个实验。关于这个测试，有两个基本的概念：时间局部性与空间局部性。</p>
<p>&nbsp;</p>
<p>时间局部性：</p>
<div><span>被引用过一次的存储器位置在未来会被多次引用（通常在循环中）。</span></div>
<div>&nbsp;</div>
<p>空间局部性：</p>
<div><span>如果一个存储器的位置被引用，那么将来他附近的位置也会被引用</span><strong>。</strong></div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>从步长的轴上取出一个切面进行分析，x轴对应的是读写数据集的大小，y轴对应的是访问速度。这个切面表示的就是空间局部性。</div>
<div>从数据集大小的轴上取出一个切面，x轴对应的是for循环访问数组时，步长的大小，y轴对应的是访问速度。这个切面表示的就是时间局部性。</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>这两个特性，是由于CPU的分级缓存机制造成的。由于CPU速度越来越快，跟内存的读写速度拉开的差距也越来越大。为此，工程师们在硬件上引入了L1和L2 缓存层。L1、L2的读写速度很快，但是价格很贵，所以容量很小。</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>CPU需要读写内存的时候，就往缓存里面找，找不到就会发生一次缓存缺失。缺失发生时，有多种应对的策略，具体可以参见&nbsp;http://en.wikipedia.org/wiki/CPU_cache。缓存缺失时采用的策略，决定了什么样的数据块会留在缓存里，影响着时间局部性。在一个循环里，由于循环变量在每次循环时都会用到，长留在缓存里，不会发生缓存缺失，因此具有很好的时间局部性。</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>读取内存时，并非只读取一个元素，而是读取所需元素及附近的元素到缓存中。若以后对数组的访问都是以步长为1进行访问的话，所需的数据已经先行进入缓存了，就会获得较好的空间局部性。</div>
<div>&nbsp;</div>
<div>好的程序，应该充分利用时间局部性和空间局部性，也就是说，需要将相关的数据尽可能相邻的放在一起，提高空间局部性。同时，优化逻辑，复用部分控制变量，实现短时间内多次访问，让变量始终在缓存中存在，提高读写性能。</div>
<div>&nbsp;</div>
<div>参见：</div>
<div>http://zh.wikipedia.org/wiki/%E5%AD%98%E5%82%A8%E5%99%A8%E5%B1%B1</div>
<div>&nbsp;</div>]]></description></item><item><title>欢送2012</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/12/31/2_interesting_post.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 31 Dec 2012 15:47:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/12/31/2_interesting_post.html</guid><description><![CDATA[<p>新年快乐！2012年就要过去了，本月看代码为主，少动手了，分享两篇文章给大家：</p>
<p>第一篇是varnish作者Poul henning写的，题为<a href="https://www.varnish-cache.org/trac/wiki/ArchitectNotes">Notes from the Architect</a>，作者的观点可以总结为三点：</p>
<ul>
<li>相信虚拟存储系统，不要手动进行内存分页管理，而是依赖虚存系统做这件事。不要和虚存系统作对。</li>
<li>减少内存的访问次数，最小化多核心之间对于cache的争夺。</li>
<li>合理调度线程，按最近工作时间来安排，尽可能保证cache已处于热身状态。</li>
</ul>
<p>另一篇是LuaJit的作者Josh Haberman在邮件列表里提到的，<a href="http://article.gmane.org/gmane.comp.lang.lua.general/75426">为什么手写的汇编码会比编译器的好</a>。作者着重讨论的，是编译器的主循环实现。由于编译器难以预测数以百计的可执行路径中，那个是快速路径，那个是慢速路径，走哪一个路径的概率比较大，所以无法很好的生成优化的汇编码。由于条件分支判断失败引致的惩罚较大，因此手写汇编码的确有可能做得比编译器好。</p>
<p>&nbsp;</p>
<p>这两篇文章的启迪在于，现代意义上的编程，已经不再是单纯业务逻辑的考虑，而要通盘考虑计算机系统的储存器结构和CPU指令优化。看来还是要看底层一点的东西了。</p>]]></description></item><item><title>tig支持中文搜索</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/11/29/fix_tig_utf8_issue.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 29 Nov 2012 03:26:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/11/29/fix_tig_utf8_issue.html</guid><description><![CDATA[<p>tig是一个基于ncurses库的git log、status的浏览器，看log的时候非常方便，可以非常简单的查看每次log的diff，同时方便的切换到其他视角例如diff、blame、tree等等。但是，tig有一个问题，不支持搜索中文。</p>
<p>&nbsp;</p>
<p>检查了相关的issue以后，确认了链接时使用-lncursesw，支持中文这种宽字符的显示，实际应用中也可以显示，但就是没办法搜索中文。于是，我向作者报告了这个bug：<a href="https://github.com/jonas/tig/issues/99">https://github.com/jonas/tig/issues/99</a></p>
<p>&nbsp;</p>
<p>似乎作者不太在意i18n的问题，等了好几天都没有给答复，只好自己动手了。遇到问题的是搜索，按search关键字查找，定位到REQ_SEARCH上面去，这应该是tig内部状态机的一个状态。在main函数里，是一个很清晰的状态机，用switch语句切换不同的状态。可以看到，REQ_SEARCH与REQ_SEARCH_BACK都调用到read_prompt,最终落到prompt_input读取输入。</p>
<p>&nbsp;</p>
<p>看来prompt_input就是无法输入中文搜索的罪魁祸首了。得益于tig代码清晰的结构，定位这个bug还是比较容易的。为了确定用户输入的结束，prompt_input通过一个外部参数handler确定一个字符是否是可见字符，如果是不可见字符，则不加入到buf中来。由于utf8的字符是变长的，兼容ASCII码，剩下的都是两字节字符和三字节字符。区分字长，则由第一个字符（又称引导字符）决定。</p>
<p>&nbsp;</p>
<p>关于utf8的字符是如何区分两个字节和三个字节，可以参考这篇文章：</p>
<p><a href="http://blog.csdn.net/cscmaker/article/details/7986968（">http://blog.csdn.net/cscmaker/article/details/7986968</a>&nbsp;（囧，看完才发现我修复的不完美）</p>
<p>&nbsp;</p>
<p>根据这篇文章，我做了一个小的修复：</p>
<p><a href="https://github.com/spin6lock/tig/commit/159eff692b24aa05f766f76922b0f2515fbbf415#tig.c">https://github.com/spin6lock/tig/commit/159eff692b24aa05f766f76922b0f2515fbbf415#tig.c</a>&nbsp;</p>
<p>这里将utf8字符单独处理了，但是没有处理utf8标准里4个字节字符的情况。</p>
<p>&nbsp;</p>
<p>不过作者一直没有merge到主分支上，残念啊。</p>]]></description></item><item><title>为什么go语言适合开发网游服务器端</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/09/11/why_golang_is_suitable_for_game_server_development.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 11 Sep 2012 07:37:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/09/11/why_golang_is_suitable_for_game_server_development.html</guid><description><![CDATA[<div>前段时间在golang-China读到这个贴：<a href="https://groups.google.com/forum/?fromgroups=#!searchin/golang-china/%E6%B8%B8%E6%88%8F/golang-china/meRGBDEUb3M/FNHBvBId7lUJ%20" target="_blank">有木人用(或打算)golang做游戏服务器端?</a>&nbsp;&nbsp;个人觉得golang十分适合进行网游服务器端开发，写下这篇文章总结一下。</div>
<div>&nbsp;</div>
<div>从网游的角度看：</div>
<div>要成功的运营一款网游，很大程度上依赖于玩家自发形成的社区。只有玩家自发形成一个稳定的生态系统，游戏才能持续下去，避免鬼城的出现。而这就需要多次大量导入用户，在同时在线用户量达到某个临界点的时候，才有可能完成。因此，多人同时在线十分有必要。</div>
<div>&nbsp;</div>
<div>再来看网游的常见玩法，除了排行榜这类统计和数据汇总的功能外，基本没有需要大量CPU时间的应用。以前的项目里，即时战斗产生的各种伤害计算对CPU的消耗也不大。玩家要完成一次操作，需要通过客户端-服务器端-客户端这样一个来回，为了获得高响应速度，满足玩家体验，服务器端的处理也不能占用太多时间。所以，每次请求对应的CPU占用是比较小的。</div>
<div>&nbsp;</div>
<div>网游的IO主要分两个方面，一个是网络IO，一个是磁盘IO。网络IO方面，可以分成美术资源的IO和游戏逻辑指令的IO，这里主要分析游戏逻辑的IO。游戏逻辑的IO跟CPU占用的情况相似，每次请求的字节数很小，但由于多人同时在线，因此并发数相当高。另外，地图信息的广播也会带来比较频繁的网络通信。磁盘IO方面，主要是游戏数据的保存。采用不同的数据库，会有比较大的区别。以前的项目里，就经历了从MySQL转向MongoDB这种内存数据库的过程，磁盘IO不再是瓶颈。总体来说，还是用内存做一级缓冲，避免大量小数据块读写的方案。</div>
<div><br />针对网游的这些特点，golang的语言特性十分适合开发游戏服务器端。<br /><br /><span>首先，go语言提供goroutine机制作为原生的并发机制。每个goroutine所需的内存很少，实际应用中可以启动大量的goroutine对并发连接进行响应。goroutine与gevent中的greenlet很相像，遇到IO阻塞的时候，调度器就会自动切换到另一个goroutine执行，保证CPU不会因为IO而发生等待。而goroutine与gevent相比，没有了python底层的GIL限制，就不需要利用多进程来榨取多核机器的性能了。通过设置最大线程数，可以控制go所启动的线程，每个线程执行一个goroutine，让CPU满负载运行。</span></div>
<div><span>&nbsp;</span></div>
<div><span>同时，go语言为goroutine提供了独到的通信机制&mdash;&mdash;channel。channel发生读写的时候，也会挂起当前操作channel的goroutine，是一种同步阻塞通信。这样既达到了通信的目的，又实现同步，用CSP模型的观点看，并发模型就是通过一组进程和进程间的事件触发解决任务的。虽然说，主流的编程语言之间，只要是图灵完备的，他们就都能实现相同的功能。但go语言提供的这种协程间通信机制，十分优雅地揭示了协程通信的本质，避免了以往锁的显式使用带给程序员的心理负担，确是一大优势。进行网游开发的程序员，可以将游戏逻辑按照单线程阻塞式的写，不需要额外考虑线程调度的问题，以及线程间数据依赖的问题。因为，线程间的channel通信，已经表达了线程间的数据依赖关系了，而go的调度器会给予妥善的处理。</span></div>
<div><span>&nbsp;</span></div>
<div><span>另外，go语言提供的gc机制，以及对指针的保护式使用，可以大大减轻程序员的开发压力，提高开发效率。</span></div>
<div><span>&nbsp;</span></div>
<div><span>展望未来，我期待go语言社区能够提供更多的goroutine间的隔离机制。个人十分推崇erlang社区的脆崩哲学，推动应用发生预期外行为时，尽早崩溃，再fork出新进程处理新的请求。对于协程机制，需要由程序员保证执行的函数不会发生死循环，导致线程卡死。如果能够定制goroutine所执行函数的最大CPU执行时间，及所能使用的最大内存空间，对于提升系统的鲁棒性，大有裨益。</span></div>]]></description></item><item><title>LPC及MudOS简介(一)</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/08/19/lpc_and_mudos_part1.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 19 Aug 2012 10:30:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/08/19/lpc_and_mudos_part1.html</guid><description><![CDATA[<p>天下盛境这个项目让我萌生退意了，拖延了一个多月，没想到公司居然先解散了。接着是面试，入职新公司，回头看来，还是感慨人算不如天算阿。</p>
<p>&nbsp;</p>
<p>新公司也是游戏行业的，初看了下项目的架构，与以前的有较大差别，是一套脱胎于MudOS的异步IO、多进程的游戏架构。于是最近在研究Mudos的相关知识。刚刚入门，挑了最简单的Lil Mudlib进行学习，Mudos的版本为v22.2b14，既能够成功跑起来接受玩家的链接，又不会有复杂的功能阻碍理解，正好动手边改边学。</p>
<p>&nbsp;</p>
<p>LPC是一门专门为Mudos而设的脚本语言，类c语法，而且后缀名均为c（这点比较让我困惑，搞不清什么是c什么是LPC）。已经习惯了Python的我不太适应变量声明，幸好最近用go做了点小东西，不至于对类型系统太生疏。这门脚本语言主要是用来写逻辑的，所以很多接口都是基于底层用c写就的mudos接口。基本的hash表，字符串处理等都有了，可惜提供的库实在太少，不利于基于这门语言自身去了解它。比如说，python里用globals()和locals()就可以查看当前的变量空间，有比较丰富的反射机制。而LPC不是没有，而是没有直接提供出来供调用，它是利用mudos做解释器的，类似的反射功能都需要调用mudos来完成。进一步来说，LPC是用来定义和管理对象的，而这些对象的相互作用最终还是要通过mudos来完成。</p>
<p>&nbsp;</p>
<p>LPC的OO跟go语言有点相似，就是函数和变量组成。函数就是可以用名字来引用的一组指令，而变量则是供函数使用的储存信息用的容器，一个lpc文件对应的就是一个类的定义（这点非常喜欢）。它的类型系统还提供了一个特殊类型mixed，类似于go语言的万能接口，可以存放任意类型的变量，同时可以在后期查到该变量的真正类型。</p>
<p>&nbsp;</p>
<p>LPC的虚拟机，即Mudos，还提供了一个有用的功能，任何对象的执行都会被进行统计，同一调用链中，若某对象用完了所分配的时间线，就会被强制停止。这个功能有点类似python的gil，任何线程都不能长期占用gil，即使只有单线程，还是有gil的获取和释放过程。</p>
<p>&nbsp;</p>]]></description></item><item><title>大面积断线原因分析</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/06/15/many_client_drop_connection_at_the_same_time.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 15 Jun 2012 07:12:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/06/15/many_client_drop_connection_at_the_same_time.html</guid><description><![CDATA[<p>昨天，在台服上运行的服务器爆发了大面积断线。从时间点上看，跟一个副本活动高度重合，因此，今天早上就紧急屏蔽了该活动模块。</p>
<p>&nbsp;</p>
<p>拿到log进行分析，看到的异常大部分是从战斗副本返回主城时发生的。副本活动产生的异常倒是没有看到，而且这个副本在国内也经历过几个运营商实际运营的测试，出现问题的机会应该比较少。</p>
<p>&nbsp;</p>
<p>从战斗副本返回主城的过程经过一次调整，原有的流程是副本退出时保存到mysql，再在主城里从数据库恢复过来。现有的流程，是先把所需数据打包，然后通过tcp发送到主城，由主城进行解包并恢复到角色身上。</p>
<p>&nbsp;</p>
<p>个人猜测，是因为序列化过程有性能问题，导致序列化过程缓慢。这个副本活动有个特点，就是同时返回主城的角色会比较多。因此，当多个角色同时返回时，主城进程就会因为序列化而卡住。客户端与主城间有保持心跳连接，当发生心跳包超时，客户端就自动断开连接。断开连接后，需要将角色数据保存至数据库，这无疑加重了主城进程的负担。于是，雪崩效应就形成了。</p>
<p>&nbsp;</p>
<p>下午，主程发布了修复，是序列化过程里，用于标识序列化属性的列表不断增长导致的。于是，每次检查属性是否需要序列化的时候，都要遍历一个极长的列表，所以极为缓慢。问题解决</p>]]></description></item><item><title>断线与资源释放</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/06/14/2549392.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 14 Jun 2012 07:24:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/06/14/2549392.html</guid><description><![CDATA[<p>断线先不释放资源，待刚刚收到的请求完成后，再统一回收资源</p>
<p>开发框架应该提供一套通用的日志监控接口和资源分配接口，以确定资源的消耗情况，确定性能热点。</p>
<p>&nbsp;</p>]]></description></item><item><title>RPC的思考</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/06/12/2546154.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 12 Jun 2012 03:48:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/06/12/2546154.html</guid><description><![CDATA[<p>#基于google protobuf的rpc框架介绍系列文章</p>
<p>&nbsp;</p>
<p>#目前，基于消息包的消息收发</p>
<p>步骤：确定前端需要的相关信息</p>
<p>定义交互步骤</p>
<p>编写相应的proto文件</p>
<p>编译，分别生成前后端代码</p>
<p>层次太低。对前后端交互的思考，是在函数调用的层面上的，但是实际上做的，却是将函数调用手动转为数据包。针对具体传递的消息编写消息包的proto，本无可厚非。但是，每次都要编写内容为空的Request包让我很蛋疼。究其原因，是每次都需要重写Request/Response语义的东东。</p>
<p>&nbsp;</p>
<p>#语义：基于函数调用</p>
<p>空参数的函数调用</p>
<p>空返回的函数调用</p>]]></description></item><item><title>【翻译】How we make GitHub fast (我们如何让github更快)</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/05/20/translation_how_we_make_github_fast.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 20 May 2012 11:21:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/05/20/translation_how_we_make_github_fast.html</guid><description><![CDATA[<p>译者注：我是一名开源爱好者，十分喜爱github，github也是一个乐于分享的站点。这篇文章介绍了github为应对更高访问量而搭建的架构，虽然已经是09年的文章，仍有一定的参考价值，因此翻译此文分享给大家</p>
<div id="wrapper">
<div class="site clearfix">
<div id="site-container" class="container">
<div class="pagehead">
<div id="posts">
<div class="list">
<ul>
<li id="post_530" class="hentry post">
<h2><a class="reverse url entry-title" href="https://github.com/blog/530-how-we-made-github-fast" rel="bookmark">我们如何让github变得更快</a> <small></small></h2>
<div class="meta">
<div class="who_when"><img src="http://www.cnblogs.com/Lifehacker/admin/我们如何让github变得更快_files/25c7c18223fb42a4c6ae1c8db6f50f9b" alt="" width="16" height="16" /> <span class="author vcard fn"><a href="https://github.com/mojombo">mojombo</a></span> <span class="published" title="2009-10-20T11:54:03-07:00"><a href="https://github.com/blog/530-how-we-made-github-fast#comments">October 20, 2009</a></span></div>
<div class="respond">&nbsp;</div>
</div>
<div class="entry-content">
<p>Translations: <a href="http://www.fatcow.com/edu/how-we-made-github-fast-be-be/">Беларускі</a>, <a href="http://www.leiste.de/science/wie-we-made-github-schnelle">Deutsch</a>, <a href="http://web-meister.ru/science/kak-my-sdelali-github-bystrym">Русский</a>.</p>
<p>现在工作已经上了轨道，我想和各位分享一下，为了让github更快速，更具扩展性，我们在github架构上作的改动。</p>
<p>&nbsp;</p>
<p>在这篇文章的第一版里，我花了相当长的篇幅，仔细解释我们所做的每一个技术选择。但是，这篇文章迅速变得混乱，演讲与关于架构的讨论混在一起。所以我决定先简单的解释架构本身，再通过随后的文章详细解释我们做出的技术选择。</p>
<p>&nbsp;</p>
<p>现代web应用有很多扩展的方式。我这里描述的只是我们所选择的那种。这不应该被视为唯一的扩展方式。请将之视为一个独特的案例，满足我们单一需求的案例。</p>
<h3>理解所用协议</h3>
<p>我们向最终用户开放了三种协议: <span class="caps">HTTP</span>, <span class="caps">SSH</span>, 和Git. 当使用网页浏览器上网时, 你使用的是<span class="caps">HTTP</span>协议. 当你clone，pull或者push去一个私有的 <span class="caps">URL</span> 例如 <span style="background-color: #ddd; font: 90% Monaco,'Courier New','DejaVu Sans Mono','Bitstream Vera Sans Mono',monospace; padding: 0 .2em;">git@github.com:mojombo/jekyll.git</span> 时，你在使用<span class="caps">SSH</span>协议. 当你clone或者pull一个公开的 <span class="caps">URL</span>时，例如 <code>git://github.com/mojombo/jekyll.git</code>， 你在使用Git协议。</p>
<p>要了解这个体系，最简单的方法是跟踪这些请求是如何在系统内传递的。</p>
<h3>跟踪 <span class="caps">HTTP</span> 请求</h3>
<p>在这个例子里，我将向你展示，对 <a href="http://github.com/mojombo/jekyll">http://github.com/mojombo/jekyll</a> 请求一页树状图时发生了什么。</p>
<p>&nbsp;</p>
<p>从互联网上来的请求，首先会到达负载均衡器。对于这个任务，我们使用了一对跑着<a href="http://www.vergenet.net/linux/ldirectord/">ldirectord</a>的Xen实例来完成。暂且将其称为 <code>lb1a</code> 和 <code>lb1b</code>. 任何时间里，这两台机器都有一个处于活动状态，另一个时刻准备进行故障切换。负载均衡器没有做什么神奇的事。它只是负责把 <span class="caps">TCP</span> 数据包根据来源IP和端口转发到不同的服务器，并且负责清理负载池里的异常服务器。当池里没有任何可用的服务器时，负载均衡器将返回一个简洁的静态页面（而非拒绝连接）。</p>
<p>&nbsp;</p>
<p>对于主站的请求，负载均衡器会把你的请求传到4个前端机器的一个。这些机器的配置，都是8核心，16G内存的裸机环境（bare metal server）它们称为 <code>fe1</code>, &hellip;, <code>fe4</code>。<a href="http://nginx.net/">Nginx</a> 负责接受连接，并将其发往Unix socket，这个socket是通过16个<a href="http://github.com/blog/517-unicorn">Unicorn</a> 工作进程支持的。16个Unicorn工作进程的其中一个，会调用<a href="http://rubyonrails.org/">Rails</a> 代码完成请求。</p>
<p>&nbsp;</p>
<p>很多页面需要数据库查询。我们的MySQL数据库运行在两台 8 核心, 32GB <span class="caps">内存</span>的裸机服务器上，配备有15k <span class="caps">RPM</span> <span class="caps">SAS</span> 硬盘。 它们是<code>db1a</code> 和 <code>db1b</code>.。它们在任何时候，均处于一主一从的状态。MySQL同步是通过<a href="http://www.drbd.org/"><span class="caps">DRBD</span></a>完成的。</p>
<p>&nbsp;</p>
<p>如果一个页面需要Git仓库的信息，而这个信息不在缓存中，那就会调用我们的<a href="http://github.com/mojombo/grit">Grit</a> 库获取数据。为了适应我们的Rackspace设置，我们对Grit做了一点修改。我们首先把所有需要访问文件系统的调用都封装到 Grit::Git对象身上。 然后将 Grit::Git 替换为一个通过<span class="caps">RPC</span>调用Smoke服务的桩(stub) Smoke对仓库有直接的磁盘访问权限，从而把 Grit::Git 封装成一个服务。Smoke意即云中的Grit。</p>
<p>&nbsp;</p>
<p>Grit桩对<code>smoke</code>发起<span class="caps">RPC</span>调用，经过负载均衡发送到<code>fe</code> 上。每一个前端跑了四个<a href="http://github.com/mojombo/proxymachine">ProxyMachine</a> 实例，处在<a href="http://haproxy.1wt.eu/">HAProxy</a> 后，扮演着Smoke调用的路由代理的角色。ProxyMachine是一层内容敏感的 (OSI第7层) <span class="caps">TCP</span> 路由代理， 我们可以通过它使用Ruby编写路由算法。 代理服务器将每个请求中的仓库所属用户名抽出。然后我们会调用一个鉴权库Chimney (意为烟囱，与前文的smoke语带相关) 来定位到用户。一个用户的路由表项就是用户仓库所在的文件服务器的主机名(hostname)</p>
<p>&nbsp;</p>
<p>Chimney的路由项是向 <a href="http://code.google.com/p/redis/">Redis</a>查询得到的。Redis在数据库服务器上面运行。我们将Redis用作一个key/value对持续化储存的数据库，储存路由信息和其他丰富的信息。</p>
<p>&nbsp;</p>
<p>一旦Smoke代理发现了用户的路由项，就会建立一个到文件服务器的透明代理。我们有四对文件服务器。他们的名字是 <code>fs1a</code>, <code>fs1b</code>, &hellip;, <code>fs4a</code>, <code>fs4b</code>。这都是8核心、16GB <span class="caps">内存</span> 裸机服务器，每一个配备有6个300GB 15K <span class="caps">RPM</span> <span class="caps">SAS</span> 硬盘， 组织为<span class="caps">RAID</span> 10磁盘队列。任何时间里，每对机器都处于双机热备的主备方式。所有的仓库数据都会定期通过<span class="caps">DRBD</span>进行主从备份。</p>
<p>&nbsp;</p>
<p>每个文件服务器运行着两个<a href="http://github.com/mojombo/ernie">Ernie</a> <span class="caps">RPC</span> 服务，它们都处在HAProxy之后。每一个Ernie拥有15个Ruby workers。这些工作进程接受 <span class="caps">RPC</span> 调用并进行 Grit 调用。返回值是通过Smoke 代理返回到Rails应用的，对应的Grit桩则返回预期的Grit响应。</p>
<p>&nbsp;</p>
<p>当Unicorn完成了Rails的调用后，响应包通过Nginx直接传回到客户端（期间不经过负载均衡器）。</p>
<p>&nbsp;</p>
<p>最后，你看到了一个相当漂亮的网页。</p>
<p>&nbsp;</p>
<p>上面的场景是缓存没有命中时发生的。在多数情况下，Rails的代码会使用Evan Weaver的Ruby <a href="http://github.com/fauna/memcached/">memcached</a> 客户端查询 <a href="http://www.danga.com/memcached/">Memcache</a> 服务器， 每个从(slave)文件服务器上都会运行。因为这些机器相当空闲，我们在每台机上放置了12GB的Memcache。暂且称它们为 <code>memcache1</code>, &hellip;, <code>memcache4</code>.</p>
<h3><span class="caps">BERT</span> 和<span class="caps">BERT</span>-<span class="caps">RPC</span></h3>
<p>对于我们的数据串行化和<span class="caps">RPC</span> 协议，我们使用 <span class="caps">BERT</span> 和<span class="caps">BERT</span>-<span class="caps">RPC</span>。你从前从未听说过它们，因为它们是全新的。我对我尝试过的所有可选项都不满意，我也希望实现萦绕在心头的一个想法，所以我创造了它们。在你对<span class="caps">NIH</span>综合征生厌之前 (或帮助你解决这个症状)，请阅读我与之相关的另一篇文章：<a href="http://github.com/blog/531-introducing-bert-and-bert-rpc">Introducing <span class="caps">BERT</span> and <span class="caps">BERT</span>-<span class="caps">RPC</span></a>（对BERT和BERT-RPC的简介）。文章里会介绍这些技术是怎么来的，以及我希望用它们来解决什么样的问题。</p>
<p>&nbsp;</p>
<p>如果你只想看看规范说明，请点击 <a href="http://bert-rpc.org/">http://bert-rpc.org</a>。</p>
<p>&nbsp;</p>
<p>对于代码狂，请check out我的Ruby <span class="caps">BERT</span> 串行库<a href="http://github.com/mojombo/bert"><span class="caps">BERT</span></a>， 我的Ruby <span class="caps">BERT</span>-<span class="caps">RPC</span> 客户端 <a href="http://github.com/mojombo/bertrpc"><span class="caps">BERTRPC</span></a>，以及我的Erlang/Ruby混合 <span class="caps">BERT</span>-<span class="caps">RPC</span> 服务器 <a href="http://github.com/mojombo/ernie">Ernie</a>。这就是我们Github用于储存所有仓库数据的库，经过实战检验:)</p>
<p>&nbsp;</p>
<h3>跟踪 <span class="caps">SSH</span> 请求</h3>
<p>Git使用<span class="caps">SSH</span>作为加密通讯协议，用于你和服务器之间的通讯。为了了解我们的架构是如何处理 <span class="caps">SSH</span> 连接的，首先需要知道SSH是如何运作的。</p>
<p>&nbsp;</p>
<p>Git 依赖于 <span class="caps">SSH</span> 提供的在远端服务器执行命令的功能。例如，执行 <span style="background-color: #ddd; font: 90% Monaco,'Courier New','DejaVu Sans Mono','Bitstream Vera Sans Mono',monospace; padding: 0 .2em;">ssh tom@frost ls -al</span> 会在tom的home目录上运行 <code>ls -al</code> ，home目录所在的机器是<code>frost</code> 。我可以在我的本地终端上得到结果。<span class="caps">SSH</span> 实际上把远程服务器上的 <span class="caps">STDIN</span>, <span class="caps">STDOUT</span>, 以及<span class="caps">STDERR</span> 挂接到我本地终端上来了。</p>
<p>&nbsp;</p>
<p>如果你执行 <span style="background-color: #ddd; font: 90% Monaco,'Courier New','DejaVu Sans Mono','Bitstream Vera Sans Mono',monospace; padding: 0 .2em;">git clone tom@frost:mojombo/bert</span>, Git实际执行的会是，SSH到 <code>frost</code>，以<code>tom</code> 的身份登录，然后远程执行 <code>git upload-pack mojombo/bert</code> 命令。然后你的客户端就能和远程服务器在 <span class="caps">SSH</span> 连接里通讯。很简洁是吧？</p>
<p>&nbsp;</p>
<p>当然，允许任意执行指令是很危险的。所以<span class="caps">SSH</span> 有个功能，用于限制能够远程执行的命令。简单来说，可以限制为<a href="http://www.kernel.org/pub/software/scm/git/docs/git-shell.html">git-shell</a> ，一个Git附带的小玩意。这些脚本会保证，你执行的是以下 <code>git upload-pack</code>, <code>git receive-pack</code> 或者 <code>git upload-archive</code> 这三者中的一个。如果真的是其中之一，则会调用 <a title="3" href="http://linux.die.net/man/3/exec">exec</a> 用新进程替换当前进程。然后，就能够得到相应结果，就像你直接执行那个命令一样。</p>
<p>&nbsp;</p>
<p>现在你知道了 Git的 <span class="caps">SSH</span> 的基本原理了，接下来我会向你介绍这一切是怎么在Github架构里完成的。</p>
<p>&nbsp;</p>
<p>首先，你的Git客户端会初始化一个<span class="caps">SSH</span> 会话这个连接首先到达我们的负载均衡器。</p>
<p>然后，这个连接会到达其中一个前端，由 <a href="http://www.au.kernel.org/software/scm/git/docs/git-daemon.html"><span class="caps">SSHD</span></a> 接受。 我们对 <span class="caps">SSH</span> 守护精灵做了patch（补丁），使其可以在MySQL数据库里进行公钥查找。你的公钥标示了你的用户身份，这个信息会和原始命令参数一起送达到我们的专有脚本&mdash;&mdash;Gerve (Git sERVE)。请将Gerve理解为 <code>git-shell</code> 的超级智能版。</p>
<p>&nbsp;</p>
<p>Gerve 可以检测你是否对仓库有相应的执行权限。如果你是仓库属主，则拥有所有权限。否则， 会发起多个 <span class="caps">SQL</span> 查询去定位你的权限。</p>
<p>&nbsp;</p>
<p>当访问被允许后， Gerve 使用 Chimney 来查找仓库的路由。现在的目标，已经变成在合适的文件服务器上执行你的原始命令，并且将你的本地机器挂接到那上面来。免去了另一次<span class="caps">SSH</span> 的启动，牛吧？</p>
<p>&nbsp;</p>
<p>或许这听起来有些疯狂，但是这方案工作的很好！Gerve 只是使用 <code>exec(3)</code> 来将自己的进程替换为<span style="background-color: #ddd; font: 90% Monaco,'Courier New','DejaVu Sans Mono','Bitstream Vera Sans Mono',monospace; padding: 0 .2em;">ssh git@&lt;路由&gt; &lt;命令&gt; &lt;参数&gt;</span>. 这次调用之后，你的客户端就挂接在一个前端机器的进程上，而前端机器的进程则挂接在一个文件服务器的进程上。</p>
<p>&nbsp;</p>
<p>想想这种解决方案有多么美妙：在确认了权限和仓库的位置之后，前端机器在会话的剩余时间里，只充当一个透明代理。这个方案唯一的缺陷，就是内部的<span class="caps">SSH</span> 需要进行无谓的加解密操作（内网安全，无必要加解密）。我们可以将内部的<span class="caps">SSH</span> 替换为某种更为简单高效的连接，但是原方案实在是太简单直接（而且还非常快！），所以目前我们还没有太大的动力去做这个优化。</p>
<h3>跟踪一个git请求</h3>
<p>执行公共仓库的clone和pull操作就跟 <span class="caps">SSH</span> 的一样。 不需要 <span class="caps">SSH</span> 进行鉴权和加密，只需一个服务器端的 <a href="http://www.au.kernel.org/software/scm/git/docs/git-daemon.html">Git Daemon</a>。这个daemon负责接受连接，检验所需运行的命令， 然后使用<code>fork(2)</code> 和 <code>exec(3)</code> 来产生子命令进程。</p>
<p>记住这个概念，下文我将为你展示一个公开的clone操作是怎么进行的。</p>
<p>首先，你的Git客户端发起了一个 <a href="http://github.com/mojombo/egitd/blob/master/docs/protocol.txt">请求</a> ，这个请求包含了你需要执行的命令和对应的仓库名。请求首先进入我们的负载均衡系统。</p>
<p>&nbsp;</p>
<p>从那里开始，请求将发往其中一个前端。每个前端跑4个 ProxyMachine 实例，前面则有 HAProxy 挡着作为Git协议的路由代理。代理会从请求中抽取出仓库名（或者gist的名字）。然后使用Chimney查询路由表。如果没有发生其他的错误，代理就会通过Git协议向Git客户端发回合适的信息。当路由查询完毕，仓库名（例如<code>mojombo/bert</code>）就会转换为磁盘路径名(例如<code>a/a8/e2/95/mojombo/bert.git</code>). 以前的配置里，我们没有使用代理，所以我们需要一个修改过的daemon，使其能够将对应的用户/仓库转换为合适的文件路径。通过代理完成这一步骤，我们就能使用一个未经修改的daemon，使得升级路径变得更简单。</p>
<p>&nbsp;</p>
<p>然后，Git代理建立了一个到文件服务器的透明代理，转发（经过修改仓库路径）的请求。每个文件服务器运行着两个Git Daemon进程，均处于HAProxy后面。Daemon会使用文件打包协议，将数据流打回到Git代理，直接和你的Git客户端通信。</p>
<p>&nbsp;</p>
<p>当你的代理得到了所有数据，你就已经克隆了仓库，而且可以开始工作了！</p>
<h3>子系统和网站系统</h3>
<p>除了主要的web应用程序和Git系统外，我们还运行着多种子系统和网站系统。子系统包括工作队列，打包下载，账单管理，镜像系统，svn导入等。网站系统包括GitHub网页，Gist，gem服务器，还有一打的内部工具。这些子系统的一部分是如何在新架构下运行的，我们创造了哪些新技术，去让应用跑得更为平稳，将会在未来的一系列文章中讲解，敬请期待</p>
<h3>总结</h3>
<p>这里描述的架构很好的适应了我们对网站架构的扩展，而且还让整个站点的性能得到了质的提升。以前，我们的Rails应用平均响应时间是500ms到数秒，取决于系统的负载。转移到裸机和Rackspace的联合储存(federated storage)以后，我们的Rails应用响应时间降到了100ms以下。而且，工作队列可以轻松应付每天28000个背景作业而游刃有余了。当前的硬件集威力还没有完全发挥，我们有更大的成长空间，而且当需要扩展时，我们能够轻易加入更多的服务器。我对这一切感到惬意，如果你像我一样，你一定在每天享受崭新的GitHub了！</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="context-overlay">&nbsp;</div>
</div>
<div id="footer-push">&nbsp;</div>
</div>]]></description></item><item><title>tricks: 如何把sqlalchemy的数据转化为json格式</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/02/22/how_to_convert_sqlalchemy_rowproxy_to_json.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 22 Feb 2012 02:32:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/02/22/how_to_convert_sqlalchemy_rowproxy_to_json.html</guid><description><![CDATA[<p>sqlalchemy最恶心的对象，就是通过execute得到的结果，那是rowproxy列表。为了优化，rowproxy使用了__slot__，使其失去了动态性，而又经常要转换成json格式，于是可以这样：</p>
<p>&nbsp;</p>
<p>d=dict(rowproxy.items())</p>
<p>json.dumps(d)</p>]]></description></item><item><title>项目总结</title><link>http://www.cnblogs.com/Lifehacker/archive/2012/02/15/my_first_fulltime_job_project_review.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 15 Feb 2012 03:03:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2012/02/15/my_first_fulltime_job_project_review.html</guid><description><![CDATA[<p>入职一年有余了。</p>
<p>收获</p>
<p>　　第一次参加实战项目，也是第一次参加多人协作的项目，感觉很新鲜。回头看，学校应该多开展这样的训练。多人协作跟个人开发最大的不同，是需要大量阅读他人的项目代码，在实现功能的时候，也需要不断的进行妥协。要阅读一个新项目的代码，从最初的版本checkout进行阅读往往是比较好的选择，可以比较清晰的看到项目的架构思想，把握模块开发的惯用法。另外，首先阅读核心工具库帮助很大，一是能够很清晰看到老大的功力（笑），二是对于阅读他人的新模块，尽快投入开发，能够有较大帮助。</p>
<p>　　在学校学习python，我只是掌握了基本语法和少数几个库。来到公司后，基本把python自带的库都用过一次了。第一次理解了什么叫做Battery-Included，python果然强大。除了官方库外，项目里还用到一些优秀的第三方开源库，例如Google的protobuf，还有gevent协程库，项目的前任老大也向开源社区贡献了两个包，little and shiny，很不错。我发现我真的很享受开源社区的开发工作。</p>
<p>　　参加实战项目后，第一次发现，操作系统和计算机网络里的内容，很多都涉及到了，恰好当年对这两门课最感兴趣，因此开发还算顺利。回想起来，这一年里干的龌龊事还是不少的XD，比如说将数据库当消息总线，满足多进程通讯的需要；又比如利用内建的rpc机制做了个bug重重的两层包转发；再比如那个利用Mysql的InnoDB行锁实现的多进程锁。当年操作系统课上，对于纤程只是一带而过，而Gevent的协程机制就很有点纤程的意味。Gevent就是一个异步IO事件响应的框架+高性能定时器阵列，并发性能相当惊人，当然也有部分缺陷，容后再述。</p>
<p>发现的问题</p>
<p>　　当然，在项目中也受过不少苦头，例如策划拍脑袋改需求的事，还有各种上线前爆发的疑难bug侦错，真个是步步惊心。于是私下总结了一些经验教训，希望将来的自己能记住。</p>
<p>　　架构上</p>
<p>　　　　从初期版本上看来，设计的时候还是比较注意单一职责原则的。IO层，业务逻辑层分野明显，业务逻辑开发也颇有点插件式增量开发的味道。可惜后来自乱阵脚，不知道是策划、老板催的太紧，还是人本身的惰性使然，后来的功能开发，都是东插一块，西垒一堆，每次提交都差不多十个文件，code review的时候很难发现重点。</p>
<p>　　　　如果能够重来，我会把消息队列作为业务逻辑开发的基础。在游戏操作的关键点前后都pub出消息，以后的插件只要监听消息就能够进行了，不需要再到处插代码。资源的申请与释放应该有一个统一的地方完成，内存泄露也容易查，功能代码上也不需要做很多冗余的错误处理。开发新功能时，尽量以插件的方式提供，资源则由框架提供。</p>
<p>　　　　当然，这一切都取决于项目的概念完整性。整个项目的架构设计 ，应该由一到两个人完成，其他人的好建议可以吸收，但总的概念和走向应该由这一到两个架构师把握，从全局上统筹开发风格，避免项目变成大杂烩。</p>
<p>　　gevent</p>
<p>　　　　gevent的并发性能相当优异，而且结构简洁，对我等开发者而言实属福音。但是，游戏里遇到一种情况，例如打击计算、ai逻辑等部分，希望越快执行越好，而数据查询类的操作，例如排行榜，则可以接受较大的延迟。Gevent的调度器没有优先级的概念，这里可能需要自己hack一下，或者更进一步的分离开数据查询操作，以此提高打击判定的速度。</p>
<p>　　版本控制</p>
<p>　　　　在项目的开发过程中，越来越感到版本控制的重要性。新功能提交和bug的提交不要混淆，尽量做到每次只提交一个功能点，普及code review，bug tracker和code commit可以考虑联动。如果用上git或者hg做开发支持，每个新功能作为一个分支，若发现影响很大的bug，就可以整个分支抽离，将对其他功能的影响降低，也提高了版本发布时的代码稳定性。</p>]]></description></item><item><title>智能去除选定区域</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/12/23/smart_remove_selection_algorithm_in_gimp_and_photoshop.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 23 Dec 2011 07:20:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/12/23/smart_remove_selection_algorithm_in_gimp_and_photoshop.html</guid><description><![CDATA[<p>这篇文章缘起于这篇博客：http://xiaoxia.org/2011/12/03/shocked-by-gimp-filter-smart-remove-selection/</p>
<p>看完以后着实震惊了，这下要去掉照片里的东西实在太简单了。在群里吼了一声以后，美术表示Photoshop CS5很淡定。于是我找来了<a href="http://v.youku.com/v_show/id_XMTY1MDU3OTMy.html">Photoshop CS5 (PS CS5)教程 </a>看看，大约9分钟的时候，CS5潇洒地P掉了背景中的一个人，神奇了！</p>
<p>&nbsp;</p>
<p>这项工作原来是要靠人手完成的，自己选取一块相近的纹理，通过PS的图章工具补上去，但是人手补上的话会有个问题，一个是纹理不对，一个是光线不对，反映在图上就是修补的区域没有过渡，变成很生硬的一块。</p>
<p>&nbsp;</p>
<p>而通过软件完成这项工作，不仅大大节省了时间，而且效果与人手修补毫不逊色，比我本人ps更是好的多了XD</p>
<p>&nbsp;</p>
<p>于是找来了resynthesizer源码分析，似乎最关键的就是以下这段代码：</p>
<div class="cnblogs_code">
<pre> <span style="color: #008000;">/*</span><span style="color: #008000;"> Setup </span><span style="color: #008000;">*/</span><br />  <br />  make_offset_list();<br />  <br />  <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">0</span>;i&lt;<span style="color: #800080;">256</span>;i++)<br />    <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j=<span style="color: #800080;">0</span>;j&lt;<span style="color: #800080;">256</span>;j++)<br />      diff_table[i][j] = (i-j)*(i-j);<br /><br />  <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">0</span>;i&lt;<span style="color: #0000ff;">int</span>(data_points.size());i++) {<br />    <span style="color: #0000ff;">int</span> j = rand() % data_points.size();<br />    Coordinates temp = data_points[i];<br />    data_points[i] = data_points[j];<br />    data_points[j] = temp;<br />  }<br />  <br />  <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> n=data_points.size();n&gt;<span style="color: #800080;">0</span>;) {<br />    n = n/<span style="color: #800080;">2</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> &lt;- note magic number... the more repetition, the higher the quality, maybe</span><span style="color: #008000;"><br /></span>    <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">0</span>;i&lt;n;i++)<br />      data_points.push_back(data_points[i]);<br />  }</pre>
</div>
<p>这段代码是GIMP的resynthesizer插件进行取样的过程，取样最特别的地方，在于对自身进行复制，形成一段纹理。具体的工作原理，可以参考作者的论文：《A NON-HIERARCHICAL PROCEDURE FOR RE-SYNTHESIS OF COMPLEX TEXTURES》</p>
<p>&nbsp;</p>
<p>我简略地翻译一下概要：</p>
<p>&nbsp;</p>
<p>&ldquo;这篇文章主要描述了如何利用给定输入图像，以其纹理合成一幅新的图像。输出图像来源于原图的部分像素，通过特定顺序相继添加而合成。使用的像素，是在输入的图像中，与输出图像的纹理最为接近的。实验表明，对输入纹理的精确重现，取决于将像素添加到输出图像的顺序。同时，这篇文章描述了如何选择一个合适的顺序，以复制一个复杂庞大的特征到输出图像。&rdquo;</p>
<p>&nbsp;</p>
<p>再看photoshop CS5，里面有个关键词，content aware， 这个概念可以参考这篇文章：http://dl.acm.org/citation.cfm?id=1276390 不过毕业以后就看不到ACM的全文了。。。content aware的神奇之处，在于不仅根据几何形状，还根据图像中的能量进行识别。至于能量函数，abstract里说的很抽象，印象中是利用图像中的熵这类东西解决的。所以，PS CS5的智能去除，应该是通过content aware的SEAM将目标物盖住吧，可惜ps没有开源，没办法得到确切答案了。</p>]]></description></item><item><title>分享三个好用的装饰器</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/12/20/3_useful_python_decorator.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 20 Dec 2011 03:57:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/12/20/3_useful_python_decorator.html</guid><description><![CDATA[<div><span style="border-collapse: separate; color: #000000; font-family: Tahoma; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; font-size: medium;">最近都是跟遗留代码打交道，理解代码逻辑上遇到了不少的瓶颈，因此琢磨了几个小工具帮助一下</span></div>
<div><span style="border-collapse: separate; color: #000000; font-family: Tahoma; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; font-size: medium;"><br /></span></div>
<div><span style="border-collapse: separate; color: #000000; font-family: Tahoma; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; font-size: medium;">模块之间联调的时候，经常会出现扯皮的情况，双方都指责是对方的输出（输入）有问题。于是搞了这个用于调试用的包装器，可以显示输入的参数和输出的结果，这下不可以扯皮了吧</span></div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">def</span> log_wrapper(func):<br /><span style="color: #008080;">2</span>      @functools.wraps(func)<br /><span style="color: #008080;">3</span>      <span style="color: #0000ff;">def</span> log_func_name(self, *args, **kws):<br /><span style="color: #008080;">4</span>           logger.debug(<span style="color: #800000;">"</span><span style="color: #800000;">调用函数[%s]</span><span style="color: #800000;">"</span>, func.func_name)<br /><span style="color: #008080;">5</span>           logger.debug(<span style="color: #800000;">"</span><span style="color: #800000;">参数为:%s, %s</span><span style="color: #800000;">"</span>, [arg.<span style="color: #800080;">__unicode__</span>() <span style="color: #0000ff;">for</span> arg <span style="color: #0000ff;">in</span> args], kws)<br /><span style="color: #008080;">6</span>           result = func(self, *args, **kws)<br /><span style="color: #008080;">7</span>           logger.debug(<span style="color: #800000;">"</span><span style="color: #800000;">返回的结果是:%s</span><span style="color: #800000;">"</span>, result.<span style="color: #800080;">__str__</span>())<br /><span style="color: #008080;">8</span>           <span style="color: #0000ff;">return</span> result<br /><span style="color: #008080;">9</span>      <span style="color: #0000ff;">return</span> log_func_name</pre>
</div>
<p><span style="border-collapse: separate; color: #000000; font-family: Tahoma; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; font-size: medium;"><br />这个用于缓存计算量比较大或者需要IO的情况，用的时候只要@Memorized(10)这样就行了，不用更改原代码的逻辑，看起来比较干净清晰<br /></span></p>
<div><span style="border-collapse: separate; color: #000000; font-family: Tahoma; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; font-size: medium;">用于包装类方法的包装器</span></div>
<div>&nbsp;</div>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">class</span> Memorized(object):<br /><span style="color: #008080;"> 2</span>      <span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span>(self, ttl = 300):<br /><span style="color: #008080;"> 3</span>           self.ttl = ttl<br /><span style="color: #008080;"> 4</span>          <br /><span style="color: #008080;"> 5</span>      <span style="color: #0000ff;">def</span> <span style="color: #800080;">__call__</span>(self, func):<span style="color: #008000;">#</span><span style="color: #008000;">只会调用一次</span><span style="color: #008000;"><br /></span><span style="color: #008080;"> 6</span>           <span style="color: #0000ff;">def</span> wrapper(obj, *args):<br /><span style="color: #008080;"> 7</span> <br /><span style="color: #008080;"> 8</span>          cache = obj.<span style="color: #800080;">__dict__</span>.setdefault(<span style="color: #800000;">"</span><span style="color: #800000;">cache</span><span style="color: #800000;">"</span>, {})<br /><span style="color: #008080;"> 9</span>          now = time.time()<br /><span style="color: #008080;">10</span>          key_name = self.func.func_name + str(args)<br /><span style="color: #008080;">11</span>          <span style="color: #0000ff;">try</span>:<br /><span style="color: #008080;">12</span>              value, timestamp = cache[key_name]<br /><span style="color: #008080;">13</span>              <span style="color: #0000ff;">if</span> now - timestamp &gt; self.ttl:<br /><span style="color: #008080;">14</span>                   <span style="color: #0000ff;">raise</span> KeyError<br /><span style="color: #008080;">15</span>          <span style="color: #0000ff;">except</span> KeyError:<br /><span style="color: #008080;">16</span>             value = self.func(obj, *args)<br /><span style="color: #008080;">17</span>             cache[key_name] = (value, now)<br /><span style="color: #008080;">18</span>          <span style="color: #0000ff;">return</span> value<br /><span style="color: #008080;">19</span>     <span style="color: #0000ff;">return</span> wrapper</pre>
</div>
<p><br /><br style="border-collapse: separate; color: #000000; font-family: Tahoma; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; font-size: medium;" /></p>
<div><span style="border-collapse: separate; color: #000000; font-family: Tahoma; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; font-size: medium;">遗留代码中有个问题，有些类的内部变量值被作为开关值，外部很粗暴地直接修改了，这很明显破坏了类的封装原则。因此搞了这个装饰器查一下谁改的值XD<br /></span></div>
<p><span style="border-collapse: separate; color: #000000; font-family: Tahoma; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; font-size: medium;">用于记录谁修改了指定值</span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">import</span> traceback<br /><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">def</span> trace_back(func):<br /><span style="color: #008080;"> 3</span>     <span style="color: #0000ff;">def</span> wrapper(*args):<br /><span style="color: #008080;"> 4</span>        infos = traceback.format_stack()<br /><span style="color: #008080;"> 5</span>        infos = <span style="color: #800000;">''</span>.join(infos)<br /><span style="color: #008080;"> 6</span>        <span style="color: #0000ff;">print</span> infos<br /><span style="color: #008080;"> 7</span>        <span style="color: #0000ff;">return</span> func(*args)<br /><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">return</span> wrapper<br /><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">class</span> a(object):<br /><span style="color: #008080;">10</span>    <span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span>(self, x):<br /><span style="color: #008080;">11</span>        self._x = x<br /><span style="color: #008080;">12</span>    @property<br /><span style="color: #008080;">13</span>    <span style="color: #0000ff;">def</span> x(self):<br /><span style="color: #008080;">14</span>       <span style="color: #0000ff;">return</span> self._x<br /><span style="color: #008080;">15</span>    @x.setter<br /><span style="color: #008080;">16</span>    @trace_back<br /><span style="color: #008080;">17</span>    <span style="color: #0000ff;">def</span> x(self, val):<br /><span style="color: #008080;">18</span>       self._x = val<br /><span style="color: #008080;">19</span> <span style="color: #0000ff;">def</span> foo():<br /><span style="color: #008080;">20</span>    b = a(1)<br /><span style="color: #008080;">21</span>    b.x = 2<br /><span style="color: #008080;">22</span> <span style="color: #0000ff;">def</span> bar():<br /><span style="color: #008080;">23</span>    foo()<br /><span style="color: #008080;">24</span> bar()</pre>
</div>]]></description></item><item><title>根据python protobuf自动生成protobuf包收发接口</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/11/07/code_generator_for_protobuf_py.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 07 Nov 2011 07:05:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/11/07/code_generator_for_protobuf_py.html</guid><description><![CDATA[<p>利用protobuf进行串行化和反串行化处理，封装出来的rpc服务很好用。但是有个缺点，就是测试时，一些很简单的接口都要重新实现一次，程序体内就一些简单的赋值语句。写了个代码生成器，用来生成protobuf对应的请求函数和回应函数，请求函数根据req的内容，生成赋值函数体；回应函数只是负责把服务器返回的包进行打印。</p>
<p>先用.proto文件生成protobuf的xxx_pb2.py文件，将其放入protobuf目录</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">!/usr/bin/env python</span><span style="color: #008000;"><br />#</span><span style="color: #008000;"> -*- coding:utf8 -*-</span><span style="color: #008000;"><br /></span><br /><span style="color: #0000ff;">import</span> sys<br /><span style="color: #0000ff;">import</span> protobuf #生成的protobuf python文件目录<br /><br /><span style="color: #0000ff;">def</span> dir_class(obj):<br />    <span style="color: #800000;">"""</span><span style="color: #800000;"> dir_class(obj) -&gt; list of string </span><span style="color: #800000;">"""</span><br />    names = dir(obj)<br />    names = [name <span style="color: #0000ff;">for</span> name <span style="color: #0000ff;">in</span> names <span style="color: #0000ff;">if</span> <span style="color: #0000ff;">not</span> name.startswith(<span style="color: #800000;">'</span><span style="color: #800000;">_</span><span style="color: #800000;">'</span>)]<br />    names = [name <span style="color: #0000ff;">for</span> name <span style="color: #0000ff;">in</span> names <span style="color: #0000ff;">if</span> <span style="color: #0000ff;">not</span> name.isupper()]<br />    request_class = [name <span style="color: #0000ff;">for</span> name <span style="color: #0000ff;">in</span> names <span style="color: #0000ff;">if</span> <span style="color: #800000;">"</span><span style="color: #800000;">Req</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">in</span> name]<br />    response_class = [name <span style="color: #0000ff;">for</span> name <span style="color: #0000ff;">in</span> names <span style="color: #0000ff;">if</span> <span style="color: #800000;">"</span><span style="color: #800000;">Resp</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">in</span> name]<br />    <span style="color: #0000ff;">return</span> request_class, response_class     #返回接收包和发送包的对应类名称列表<br /><br /><span style="color: #0000ff;">def</span> dir_attr(obj):<br />    <span style="color: #800000;">"""</span><span style="color: #800000;"> dir_attr(obj) -&gt; list of string </span><span style="color: #800000;">"""</span><br />    names = dir(obj)<br />    names = [name <span style="color: #0000ff;">for</span> name <span style="color: #0000ff;">in</span> names <span style="color: #0000ff;">if</span> <span style="color: #0000ff;">not</span> name.startswith(<span style="color: #800000;">'</span><span style="color: #800000;">_</span><span style="color: #800000;">'</span>)]<br />    names = [name <span style="color: #0000ff;">for</span> name <span style="color: #0000ff;">in</span> names <span style="color: #0000ff;">if</span> name.islower()]<br />    <span style="color: #0000ff;">return</span> names                             #返回一个类的内部属性<br /><br /><span style="color: #0000ff;">def</span> gen_req(obj, class_name):<br />    text = []<br />    attrs = dir_attr(obj)<br />    line = gen_func_def(camercase_to_underscore(class_name), attrs)<br />    text.append(line)<br />    cp_statement = gen_cp(class_name, attrs)<br />    text.extend(cp_statement)<br />    line = <span style="color: #800000;">"</span><span style="color: #800000;">\tsingle_request(req)</span><span style="color: #800000;">"</span><br />    text.append(line)<br />    <span style="color: #0000ff;">return</span> text                              #生成请求类的函数体<br /><br /><span style="color: #0000ff;">def</span> gen_func_def(func_name, arglist):<br />    line = <span style="color: #800000;">"</span><span style="color: #800000;">def </span><span style="color: #800000;">"</span> + func_name + <span style="color: #800000;">"</span><span style="color: #800000;">(</span><span style="color: #800000;">"</span><br />    <span style="color: #0000ff;">if</span> <span style="color: #0000ff;">not</span> arglist:<br />        line += <span style="color: #800000;">"</span><span style="color: #800000;">):</span><span style="color: #800000;">"</span><br />        <span style="color: #0000ff;">return</span> line<br />    line += <span style="color: #800000;">"</span><span style="color: #800000;">, </span><span style="color: #800000;">"</span>.join(arglist) + <span style="color: #800000;">"</span><span style="color: #800000;">):</span><span style="color: #800000;">"</span><br />    <span style="color: #0000ff;">return</span> line<br /><br /><span style="color: #0000ff;">def</span> gen_cp(class_name, attrs):<br />    text = []<br />    text.append(<span style="color: #800000;">"</span><span style="color: #800000;">\treq = </span><span style="color: #800000;">"</span> + class_name + <span style="color: #800000;">"</span><span style="color: #800000;">()</span><span style="color: #800000;">"</span>)<br />    <span style="color: #0000ff;">for</span> attr <span style="color: #0000ff;">in</span> attrs:<br />        line = <span style="color: #800000;">"</span><span style="color: #800000;">\treq.</span><span style="color: #800000;">"</span> + attr + <span style="color: #800000;">"</span><span style="color: #800000;"> = </span><span style="color: #800000;">"</span> + attr<br />        text.append(line)<br />    <span style="color: #0000ff;">return</span> text<br /><br /><span style="color: #0000ff;">def</span> camercase_to_underscore(var_name):<br />    result = []<br />    start = 0<br />    <span style="color: #0000ff;">for</span> i, char <span style="color: #0000ff;">in</span> enumerate(var_name):<br />        <span style="color: #0000ff;">if</span> char.isupper():<br />            result.append(var_name[start:i])<br />            start = i<br />    result.append(var_name[start:])<br />    underscore_name = <span style="color: #800000;">"</span><span style="color: #800000;">_</span><span style="color: #800000;">"</span>.join([var.lower() <span style="color: #0000ff;">for</span> var <span style="color: #0000ff;">in</span> result])<br />    underscore_name = underscore_name[1:]<br />    <span style="color: #0000ff;">return</span> underscore_name                  #驼峰命名法到下划线分割的命名<br /><br /><span style="color: #0000ff;">def</span> underscore_to_camercase(var_name):<br />    result = var_name.split(<span style="color: #800000;">"</span><span style="color: #800000;">_</span><span style="color: #800000;">"</span>)<br />    result = [word.capitalize() <span style="color: #0000ff;">for</span> word <span style="color: #0000ff;">in</span> result]<br />    <span style="color: #0000ff;">return</span> <span style="color: #800000;">""</span>.join(result)                  #下划线分割的命名到驼峰法命名<br /><br /><span style="color: #0000ff;">def</span> main():<br />    with open(sys.argv[1]) as fh:<br />        lines = fh.readlines()<br />        <span style="color: #0000ff;">for</span> line <span style="color: #0000ff;">in</span> lines:<br />            line = line.strip()<br />            <span style="color: #0000ff;">if</span> line.startswith(<span style="color: #800000;">"</span><span style="color: #800000;">protobuf</span><span style="color: #800000;">"</span>):<br />                <span style="color: #008000;">#</span><span style="color: #008000;">import package</span><span style="color: #008000;"><br /></span>                <span style="color: #800080;">__import__</span>(line, globals(), locals(), [], -1)<br />                <span style="color: #008000;">#</span><span style="color: #008000;">analysis class</span><span style="color: #008000;"><br /></span>                protobuf_package = eval(line)    <br />                pb2_req, pb2_resp = dir_class(protobuf_package)<br />                <span style="color: #008000;">#</span><span style="color: #008000;">gen request function and resp printer</span><span style="color: #008000;"><br /></span>                req_funcs = []<br />                <span style="color: #0000ff;">for</span> req <span style="color: #0000ff;">in</span> pb2_req:<br />                    req_func = gen_req(eval(line + <span style="color: #800000;">"</span><span style="color: #800000;">.</span><span style="color: #800000;">"</span> + req + <span style="color: #800000;">"</span><span style="color: #800000;">()</span><span style="color: #800000;">"</span>), req)<br />                    req_funcs.extend(req_func)<br />                    req_funcs.append(<span style="color: #800000;">""</span>)<br />                <span style="color: #008000;">#</span><span style="color: #008000;">write file</span><span style="color: #008000;"><br /></span>                filename = line[len(<span style="color: #800000;">"</span><span style="color: #800000;">protobuf</span><span style="color: #800000;">"</span>) + 1:]<br />                filename = filename[:-4]<br />                import_statement = <span style="color: #800000;">"</span><span style="color: #800000;">from </span><span style="color: #800000;">"</span> + line + <span style="color: #800000;">"</span><span style="color: #800000;">"</span> + <span style="color: #800000;">"</span><span style="color: #800000;">import *</span><span style="color: #800000;">"</span><br />                body = <span style="color: #800000;">"</span><span style="color: #800000;">\n</span><span style="color: #800000;">"</span>.join(req_funcs)<br />                with open(filename+<span style="color: #800000;">"</span><span style="color: #800000;">.py</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">w</span><span style="color: #800000;">"</span>) as f:<br />                    <span style="color: #0000ff;">print</span> filename<br />                    f.write(<span style="color: #800000;">"</span><span style="color: #800000;">\n</span><span style="color: #800000;">"</span>.join([import_statement, body]))<br /><br /><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span>:<br />    main()</pre>
</div>
<p><br /><br /></p>]]></description></item><item><title>台电k6你立功了</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/09/21/word_wrap_in_two_ways_with_python.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 21 Sep 2011 01:53:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/09/21/word_wrap_in_two_ways_with_python.html</guid><description><![CDATA[<p>等了一年，还是停留在v2.11的固件上，英文就一渣排版。只能自己动手了</p>
<p>写了个英文排版的，两种排版方式，一是按<a href="http://zh.wikipedia.org/wiki/%E8%87%AA%E5%8A%A8%E6%8D%A2%E8%A1%8C#.E6.9C.80.E5.B0.8F.E7.A0.B4.E6.8D.9F.E5.BA.A6">最小破损度</a>进行排版，最小破损度追求的是文章排版的整齐性，也就是行尾空格数目尽可能相等。这样外观上就会比较平整，当然，行尾的空格可以移到行内，使得每行刚好满足给定宽度。另一种是按<a href="http://zh.wikipedia.org/wiki/%E8%87%AA%E5%8A%A8%E6%8D%A2%E8%A1%8C#.E6.9C.80.E5.B0.8F.E9.95.BF.E5.BA.A6">最小行数</a>进行排版。这种排版相当直观，就是把原文一个词一个词地放入一行中，当不能再放入时，就进行换行。</p>
<p>源码：</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">!/usr/bin/env python</span><span style="color: #008000;"><br />#</span><span style="color: #008000;">encoding=utf8</span><br /><br /><span style="color: #008000;">#</span><span style="color: #008000;">最小破损度排版</span><br /><span style="color: #0000ff;">import</span><span style="color: #000000;"> sys<br /><br />cache </span><span style="color: #000000;">=</span><span style="color: #000000;"> {}<br /></span><span style="color: #0000ff;">def</span><span style="color: #000000;"> cache_wrapper(func):<br />    </span><span style="color: #0000ff;">global</span><span style="color: #000000;"> cache<br />    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> cache_loader(</span><span style="color: #000000;">*</span><span style="color: #000000;">args):<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> args </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> cache:<br />            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> cache[args]<br />        cache[args] </span><span style="color: #000000;">=</span><span style="color: #000000;"> func(</span><span style="color: #000000;">*</span><span style="color: #000000;">args)<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> cache[args]<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> cache_loader<br /><br /></span><span style="color: #0000ff;">def</span><span style="color: #000000;"> min_cost_cache_wrapper(func):<br />    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> loader(alist, jth):<br />        </span><span style="color: #0000ff;">global</span><span style="color: #000000;"> cache<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> jth </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> cache:<br />            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> cache[jth]<br />        cache[jth] </span><span style="color: #000000;">=</span><span style="color: #000000;"> func(alist, jth)<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> cache[jth]<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> loader    <br /><br />@cache_wrapper<br /></span><span style="color: #0000ff;">def</span><span style="color: #000000;"> total_cost(jth_word):<br />    word_in_one_line </span><span style="color: #000000;">=</span><span style="color: #000000;"> cost(0, jth_word) <br />    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> word_in_one_line </span><span style="color: #000000;">!=</span> <span style="color: #000000;">2</span><span style="color: #000000;">**</span><span style="color: #000000;">32</span><span style="color: #000000;">:<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> word_in_one_line<br />    cost_list </span><span style="color: #000000;">=</span><span style="color: #000000;"> []<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> k </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> range(0, jth_word):<br />        cost_list.append(total_cost(k) </span><span style="color: #000000;">+</span><span style="color: #000000;"> cost(k</span><span style="color: #000000;">+</span><span style="color: #000000;">1</span><span style="color: #000000;">, jth_word))<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> min_cost(cost_list, jth_word)<br /><br />@cache_wrapper<br /></span><span style="color: #0000ff;">def</span><span style="color: #000000;"> cost(from_ith, to_jth):<br />    </span><span style="color: #0000ff;">global</span><span style="color: #000000;"> linewidth<br />    </span><span style="color: #0000ff;">global</span><span style="color: #000000;"> len_words<br />    result </span><span style="color: #000000;">=</span><span style="color: #000000;"> linewidth </span><span style="color: #000000;">-</span><span style="color: #000000;"> (to_jth </span><span style="color: #000000;">-</span><span style="color: #000000;"> from_ith) </span><span style="color: #000000;">-</span><span style="color: #000000;"> sum([len_words[k] </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> k </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> range(from_ith, to_jth </span><span style="color: #000000;">+</span> <span style="color: #000000;">1</span><span style="color: #000000;">)])<br />    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> result </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> 0:<br />        </span><span style="color: #0000ff;">return</span> <span style="color: #000000;">2</span><span style="color: #000000;">**</span><span style="color: #000000;">32</span><br />    <span style="color: #0000ff;">return</span><span style="color: #000000;"> result</span><span style="color: #000000;">*</span><span style="color: #000000;">result<br /><br />@min_cost_cache_wrapper<br /></span><span style="color: #0000ff;">def</span><span style="color: #000000;"> min_cost(cost_list, jth_word):<br />    min_val </span><span style="color: #000000;">=</span> <span style="color: #000000;">2</span><span style="color: #000000;">**</span><span style="color: #000000;">32</span><span style="color: #000000;"><br />    min_index </span><span style="color: #000000;">=</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span><br />    <span style="color: #0000ff;">for</span><span style="color: #000000;"> index, cost </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> enumerate(cost_list):<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> min_val </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> cost:<br />            min_val </span><span style="color: #000000;">=</span><span style="color: #000000;"> cost    <br />            min_index </span><span style="color: #000000;">=</span><span style="color: #000000;"> index<br />    </span><span style="color: #0000ff;">global</span><span style="color: #000000;"> choose<br />    choose[jth_word] </span><span style="color: #000000;">=</span><span style="color: #000000;"> min_index<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> min_val<br /><br /></span><span style="color: #0000ff;">def</span><span style="color: #000000;"> print_paragraph(choose_dict):<br />    divided_points </span><span style="color: #000000;">=</span><span style="color: #000000;"> get_divided_point(choose_dict)<br />    </span><span style="color: #008000;">#</span><span style="color: #008000;">print "divided_points: ", divided_points</span><br /><span style="color: #000000;">    print_lines(divided_points)<br /><br /></span><span style="color: #0000ff;">def</span><span style="color: #000000;"> get_divided_point(choose_dict):<br />    </span><span style="color: #0000ff;">global</span><span style="color: #000000;"> words<br />    </span><span style="color: #008000;">#</span><span style="color: #008000;">print "choose dict:", choose_dict</span><br /><span style="color: #000000;">    word_index </span><span style="color: #000000;">=</span><span style="color: #000000;"> len(words) </span><span style="color: #000000;">-</span> <span style="color: #000000;">1</span><span style="color: #000000;"><br />    indexes </span><span style="color: #000000;">=</span><span style="color: #000000;"> [word_index]<br />    </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> True:<br />        </span><span style="color: #0000ff;">try</span><span style="color: #000000;">:<br />            indexes.append(choose_dict[word_index])<br />            word_index </span><span style="color: #000000;">=</span><span style="color: #000000;"> choose_dict[word_index]<br />        </span><span style="color: #0000ff;">except</span><span style="color: #000000;"> KeyError:<br />            indexes.reverse()<br />            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> indexes<br /><br /></span><span style="color: #0000ff;">def</span><span style="color: #000000;"> print_lines(indexes):<br />    pre </span><span style="color: #000000;">=</span><span style="color: #000000;"> 0<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> i </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> indexes:<br />        </span><span style="color: #008000;">#</span><span style="color: #008000;">print "print words:(%d, %d)" %(pre, i)</span><br /><span style="color: #000000;">        print_words(pre, i)<br />        pre </span><span style="color: #000000;">=</span><span style="color: #000000;"> i </span><span style="color: #000000;">+</span> <span style="color: #000000;">1</span><br /><br /><span style="color: #0000ff;">def</span><span style="color: #000000;"> print_words(ith, jth):<br />    </span><span style="color: #0000ff;">global</span><span style="color: #000000;"> words<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> k </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> range(ith, jth </span><span style="color: #000000;">+</span> <span style="color: #000000;">1</span><span style="color: #000000;">):<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> k </span><span style="color: #000000;">!=</span><span style="color: #000000;"> jth:<br />            </span><span style="color: #0000ff;">print</span><span style="color: #000000;"> words[k],<br />        </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:<br />            </span><span style="color: #0000ff;">print</span><span style="color: #000000;"> words[k]<br /><br /></span><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> <span style="color: #000000;">==</span> <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:<br />    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> len(sys.argv) </span><span style="color: #000000;">!=</span> <span style="color: #000000;">2</span><span style="color: #000000;">:<br />        </span><span style="color: #0000ff;">print</span> <span style="color: #800000;">"</span><span style="color: #800000;">usage: ./wordwrap width 1&lt;content</span><span style="color: #800000;">"</span><span style="color: #000000;"><br />        exit(</span><span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">)<br />    linewidth </span><span style="color: #000000;">=</span><span style="color: #000000;"> int(sys.argv[</span><span style="color: #000000;">1</span><span style="color: #000000;">])<br />    lines </span><span style="color: #000000;">=</span><span style="color: #000000;"> sys.stdin.readlines()<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> content </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> lines:<br />        cache </span><span style="color: #000000;">=</span><span style="color: #000000;"> {}    <br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> len(content) </span><span style="color: #000000;">==</span><span style="color: #000000;"> 0:<br />            </span><span style="color: #0000ff;">continue</span><span style="color: #000000;"><br />        words </span><span style="color: #000000;">=</span><span style="color: #000000;"> content.split()<br />        len_words </span><span style="color: #000000;">=</span><span style="color: #000000;"> [len(word) </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> word </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> words]<br />        choose </span><span style="color: #000000;">=</span><span style="color: #000000;"> {}<br />        penalty </span><span style="color: #000000;">=</span><span style="color: #000000;"> total_cost(len(words) </span><span style="color: #000000;">-</span> <span style="color: #000000;">1</span><span style="color: #000000;">)<br />        print_paragraph(choose)    <br />    </span><span style="color: #008000;">#</span><span style="color: #008000;">print cache</span><br />    <span style="color: #008000;">#</span><span style="color: #008000;">print choose</span></pre>
</div>
<p>上述代码按动态规划做应该能够进一步提升效率，现在只是用了记忆化搜索，仔细想来调用函数的次数还是会比动态规划要多得多，而且函数调用的代价还是比较高的。另外一个问题，是无法直接对全文进行排版，估计是效率太低，一直没有输出，我是分段切开再行排版的，有可能出现上下两段间宽度不一致的情况。<br /><br /></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">!/usr/bin/env python</span><span style="color: #008000;"><br />#</span><span style="color: #008000;">encoding=utf8</span><br /><br /><span style="color: #008000;">#</span><span style="color: #008000;">贪心法求最小行数排版，看来还是greedy is good啊</span><br /><span style="color: #0000ff;">import</span><span style="color: #000000;"> sys<br /><br /></span><span style="color: #0000ff;">def</span><span style="color: #000000;"> print_lines(content):<br />    </span><span style="color: #0000ff;">global</span><span style="color: #000000;"> linewidth<br />    words </span><span style="color: #000000;">=</span><span style="color: #000000;"> content.split()<br />    space_width </span><span style="color: #000000;">=</span> <span style="color: #000000;">1</span><span style="color: #000000;"><br />    space_left </span><span style="color: #000000;">=</span><span style="color: #000000;"> linewidth<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> word </span><span style="color: #0000ff;">in</span><span style="color: #000000;"> words:<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> len(word) </span><span style="color: #000000;">+</span><span style="color: #000000;"> space_width </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> space_left:<br />            sys.stdout.write(</span><span style="color: #800000;">"</span><span style="color: #800000;">\n</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br />            sys.stdout.write(word)<br />            space_left </span><span style="color: #000000;">=</span><span style="color: #000000;"> linewidth </span><span style="color: #000000;">-</span><span style="color: #000000;"> len(word)<br />        </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:<br />            space_left </span><span style="color: #000000;">=</span><span style="color: #000000;"> space_left </span><span style="color: #000000;">-</span><span style="color: #000000;"> (len(word) </span><span style="color: #000000;">+</span><span style="color: #000000;"> space_width)<br />            sys.stdout.write(</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span> <span style="color: #000000;">+</span><span style="color: #000000;"> word)<br /><br /></span><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> <span style="color: #000000;">==</span> <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:<br />    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> len(sys.argv) </span><span style="color: #000000;">!=</span> <span style="color: #000000;">2</span><span style="color: #000000;">:<br />        </span><span style="color: #0000ff;">print</span> <span style="color: #800000;">"</span><span style="color: #800000;">usage: ./wordwrap width 1&lt;content</span><span style="color: #800000;">"</span><span style="color: #000000;"><br />        exit(</span><span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">)<br />    linewidth </span><span style="color: #000000;">=</span><span style="color: #000000;"> int(sys.argv[</span><span style="color: #000000;">1</span><span style="color: #000000;">])<br />    content </span><span style="color: #000000;">=</span><span style="color: #000000;"> sys.stdin.read()<br />    print_lines(content)    <br />    sys.stdout.write(</span><span style="color: #800000;">"</span><span style="color: #800000;">\n\n</span><span style="color: #800000;">"</span><span style="color: #000000;">)</span></pre>
</div>
<p><br /><br /><br /></p>]]></description></item><item><title>python实现的简单的epub2txt</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/09/13/yet_another_epub2txt_with_python.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 13 Sep 2011 11:08:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/09/13/yet_another_epub2txt_with_python.html</guid><description><![CDATA[<p>等了1年，还是没等到台电k6的固件更新，好失望。</p>
<p>由于k6不支持epub的目录跳转、内嵌字体，且每次阅读均需要重新解压epub，既浪费电又浪费时间，因此干脆转成txt算了。<br />&nbsp;</p>
<p>先用zipfile进行解压</p>
<p>然后用HTMLParser进行正文提取</p>
<p>最后输出同名txt<br />&nbsp;</p>
<p>代码在 <a href="http://code.google.com/p/yaepub2txt">http://code.google.com/p/yaepub2txt </a>上托管，google code上的另外一个epub2txt似乎也是国内的兄弟写的，是基于html2txt的库和xml解析做的，我懒，直接解压，读html文件了事了B-)</p>]]></description></item><item><title>vim定制配色方案</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/07/30/vim_terminal_colorscheme.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 30 Jul 2011 05:03:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/07/30/vim_terminal_colorscheme.html</guid><description><![CDATA[<p>个人一直比较喜欢内置的desert配色，无奈安装了pyflakes之后语法错误的地方老是看不清楚，纠结了很久。在muzuiget的指点下，有所进展。可以参考他写的<a href="http://qixinglu.com/archives/tools_for_terminal_vim_color_scheme">《Vim终端配色转换工具》</a>。但是转换色彩之后，还是无法转到自定义的颜色方案。</p>
<p><br /><br /></p>
<p>我使用的终端是ubuntu自带的gnome-terminal,既然不是古董级产品，不应该有色彩支援上的问题。为了验证这一点，我参考了arch维基的<a href="https://wiki.archlinux.org/index.php/X_resources#Color_scheme_scripts">这一篇</a>，还有<a href="https://bbs.archlinux.org/viewtopic.php?id=120325">这一篇</a>。一语惊醒梦中人，原来vim需要开启256色方案才可以。输入set t_Co=256 开启256色支援。</p>
<p><br /><br /></p>
<p>要设置为默认方案，需要在~/.vimrc 中添加一行<br />&nbsp;</p>
<p>colorscheme your_color_scheme_name</p>
<p><br /><br /><br /></p>
<p>附上我的方案：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:false;">" 本配色方案由 gui2term.py 程序增加彩色终端支持。
" Maintainer:	Lars H. Nielsen (dengmao@gmail.com)
" Last Change:	January 22 2007

set background=dark

hi clear

if exists("syntax_on")
  syntax reset
endif

let colors_name = "wombat"


" Vim &gt;= 7.0 specific colors
if version &gt;= 700
  hi CursorLine guibg=#2d2d2d ctermbg=236 cterm=none
  hi CursorColumn guibg=#2d2d2d ctermbg=236 cterm=none
  hi MatchParen guifg=#f6f3e8 guibg=#857b6f gui=bold ctermfg=230 ctermbg=101 cterm=bold
  hi Pmenu 		guifg=#f6f3e8 guibg=#444444 ctermfg=230 ctermbg=238 cterm=none
  hi PmenuSel 	guifg=#000000 guibg=#cae682 ctermfg=16 ctermbg=150 cterm=none
endif

" General colors
hi Cursor 		guifg=NONE    guibg=#656565 gui=none ctermfg=230 ctermbg=241 cterm=none
hi Normal 		guifg=#f6f3e8 guibg=#242424 gui=none ctermfg=230 ctermbg=235 cterm=none
hi NonText 		guifg=#808080 guibg=#303030 gui=none ctermfg=244 ctermbg=236 cterm=none
hi LineNr 		guifg=#857b6f guibg=#000000 gui=none ctermfg=101 ctermbg=16 cterm=none
hi StatusLine 	guifg=#f6f3e8 guibg=#444444 gui=italic ctermfg=230 ctermbg=238 cterm=NONE
hi StatusLineNC guifg=#857b6f guibg=#444444 gui=none ctermfg=101 ctermbg=238 cterm=none
hi VertSplit 	guifg=#444444 guibg=#444444 gui=none ctermfg=238 ctermbg=238 cterm=none
hi Folded 		guibg=#384048 guifg=#a0a8b0 gui=none ctermfg=103 ctermbg=60 cterm=none
hi Title		guifg=#f6f3e8 guibg=NONE	gui=bold ctermfg=230 ctermbg=235 cterm=bold
hi Visual		guifg=#f6f3e8 guibg=#444444 gui=none ctermfg=230 ctermbg=238 cterm=none
hi SpecialKey	guifg=#808080 guibg=#343434 gui=none ctermfg=244 ctermbg=236 cterm=none

" Syntax highlighting
hi Comment 		guifg=#99968b gui=italic ctermfg=246 ctermbg=235 cterm=NONE
hi Todo 		guifg=#8f8f8f gui=italic ctermfg=245 ctermbg=235 cterm=NONE
hi Constant 	guifg=#e5786d gui=none ctermfg=167 ctermbg=235 cterm=none
hi String 		guifg=#95e454 gui=italic ctermfg=113 ctermbg=235 cterm=NONE
hi Identifier 	guifg=#cae682 gui=none ctermfg=150 ctermbg=235 cterm=none
hi Function 	guifg=#cae682 gui=none ctermfg=150 ctermbg=235 cterm=none
hi Type 		guifg=#cae682 gui=none ctermfg=150 ctermbg=235 cterm=none
hi Statement 	guifg=#8ac6f2 gui=none ctermfg=117 ctermbg=235 cterm=none
hi Keyword		guifg=#8ac6f2 gui=none ctermfg=117 ctermbg=235 cterm=none
hi PreProc 		guifg=#e5786d gui=none ctermfg=167 ctermbg=235 cterm=none
hi Number		guifg=#e5786d gui=none ctermfg=167 ctermbg=235 cterm=none
hi Special		guifg=#e7f6da gui=none ctermfg=194 ctermbg=235 cterm=none
</pre>
</div>
<p>　　</p>]]></description></item><item><title>ubuntu下访问E72</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/07/16/how_to_connect_to_e72_with_ubuntu.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 16 Jul 2011 03:14:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/07/16/how_to_connect_to_e72_with_ubuntu.html</guid><description><![CDATA[<p>由于家里的电脑没有蓝牙，每次传送文件都十分麻烦，像我这种懒人又不甘心去找数据线，只能够在wifi上打主意了。</p>
<p><br /><br /></p>
<p>E72采用的是s60v3版FP2的系统，虽然是sb系统，不过比较实用。要完成这次跨系统文件传输的任务，还需要一个</p>
<p>好工具：SymSMB 4.0。 它可以模拟win的共享模式，方便其他系统进行访问。我使用的是dospy论坛汉化的版本，</p>
<p>参考过<a href="http://bbs.dospy.com/viewthread.php?tid=2322791&amp;bbsid=77">这篇教程</a>。大致的流程是：在SymSMB的控制面板里，找到帐号，新建一个用户，建议设置密码（免得酿成</p>
<p>一个男人不会修电脑，后来大家都知道了的悲剧）。然后在SymSMB根目录的&ldquo;我的移动电话&rdquo;里新建共享，用户设</p>
<p>置为刚新建的用户，读写权限请按需设置。最后在连接里找到刚刚新建的用户，点击启动，选择连接到你的无线路</p>
<p>由器上。手机端就此设置完毕。</p>
<p><br /><br /></p>
<p>ubuntu自带有SMB client,我使用的是ubuntu 11.04，使用nautilus随便打开一个文件夹，点击菜单栏的文件，点</p>
<p>击连接到服务器，选择windows共享，输入在手机上看到的ip地址（若看不到可以通过路由器的客户端列表找），然</p>
<p>后会提示输入用户名密码。输入成功后，即可看到手机的文件夹。大功告成！</p>]]></description></item><item><title>python实现的最近最少使用算法</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/07/12/python_implement_LFU_memcache.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 12 Jul 2011 10:34:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/07/12/python_implement_LFU_memcache.html</guid><description><![CDATA[<p>LFU(Least Frequently Used，最少使用)是一种缓存管理算法，其过期策略为替换出缓存中最少使用项。若各项使用次数相等，则参考LRU(Least Recently Used，最近最少使用)进行替换。</p>
<p><br /><br /></p>
<p>实现过程中，一直希望绕开链表去实现。尝试过用优先队列，但是优先队列对于优先级的调整处理很复杂，而当替换某些缓存项时，优先队列里保存的索引值又会过期，暂时未想到解决方法。一个比较拙劣的实现是使用sort()对使用次数进行排序，Python内置的sort相当独特，是一种运用了merge sort(合并排序)和insertion sort(插入排序)的混合排序，因其作者Tim Peter而命名。据说实际运行效果中，因为利用了子表的有序性，实际比较次数往往远小于O(nlogn)。</p>
<p><br /><br /></p>
<p>目前的实现，采用了双向链表进行管理。链表中的位置表明了该项的使用次数在全体成员中的序号。通过一个dict直接找到链表中的项，然后通过比较相邻项的访问次数决定是否调整位置。<br /><br /></p>
<p>代码见：</p>
<p><a href="https://github.com/spin6lock/my_memory_cache_with_NFU">http://github.com/spin6lock/my_memory_cache_with_NFU</a></p>]]></description></item><item><title>GreaseMonkey渐进</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/06/28/greaseMonkey_101_for_me.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 28 Jun 2011 03:32:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/06/28/greaseMonkey_101_for_me.html</guid><description><![CDATA[<div class="cnblogs_code">
<div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;==UserScript==</span><span style="color: #008000;"><br />//</span><span style="color: #008000;">&nbsp;@name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test</span><span style="color: #008000;"><br />//</span><span style="color: #008000;">&nbsp;@namespace&nbsp;&nbsp;&nbsp;&nbsp;test</span><span style="color: #008000;"><br />//</span><span style="color: #008000;">&nbsp;@description&nbsp;&nbsp;&nbsp;&nbsp;test</span><span style="color: #008000;"><br />//</span><span style="color: #008000;">&nbsp;@include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.google.cn/*</span><span style="color: #008000;"><br />//</span><span style="color: #008000;">&nbsp;@exclude&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.ibm.com/developerworks/cn/java/*</span><span style="color: #008000;"><br />//</span><span style="color: #008000;">&nbsp;==/UserScript==</span><span style="color: #008000;"><br /></span><span style="color: #0000ff;">var</span><span style="color: #000000;">&nbsp;zPara&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;document.getElementsByTagName(</span><span style="color: #000000;">"</span><span style="color: #000000;">div</span><span style="color: #000000;">"</span><span style="color: #000000;">);<br /></span><span style="color: #0000ff;">for</span><span style="color: #000000;">&nbsp;(</span><span style="color: #0000ff;">var</span><span style="color: #000000;">&nbsp;i</span><span style="color: #000000;">=</span><span style="color: #000000;">0</span><span style="color: #000000;">;i</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">zPara.length;i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;zPara[i].style.backgroundColor&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">"</span><span style="color: #000000;">#000000</span><span style="color: #000000;">"</span><span style="color: #000000;">;<br />&nbsp;&nbsp;&nbsp;&nbsp;zPara[i].style.color&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">"</span><span style="color: #000000;">#FFFFFF</span><span style="color: #000000;">"</span><span style="color: #000000;">;<br />}&nbsp;</span></div>
</div>
<p>&nbsp;我的第一个greaseMonkey脚本！参考了IBM 的developworks中的文章，发现了firebug的妙用。《深入浅出greasemonkey》很有用！</p>
<p>此段代码是从document中取出所有标签为div的节点，放入zPara数组中，然后通过for循环统一改变其背景色和前景色。&nbsp;</p>]]></description></item><item><title>新浪微博显示原创图片</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/06/28/sina_microblog_ori_pic_filter.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 28 Jun 2011 03:30:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/06/28/sina_microblog_ori_pic_filter.html</guid><description><![CDATA[<p>鉴于我跟室友都比较渴求这个功能，尤其是观察美女时用，特别写了这个userscript：</p>
<p><a href="http://userscripts.org/scripts/show/105670">http://userscripts.org/scripts/show/105670</a></p>]]></description></item><item><title>如何组织文件</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/03/17/how_to_organize_your_file.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 17 Mar 2011 15:31:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/03/17/how_to_organize_your_file.html</guid><description><![CDATA[<p>最近想入手个1T的移动硬盘，但是想到如何组织文件，就觉得十分头痛。</p>
<p><br /><br /></p>
<p>自我总结下文件组织的经历：</p>
<p>Windows</p>
<p>windows天然的不稳定性，每每让我胆战心惊，很可能忽然在周末&ldquo;跪低&rdquo;，然后父亲大人就把C盘格式化了。因此，历史经验表明，C盘是不能放资料的。惯常的组织方法是：&nbsp;</p>
<p>　　C盘 &nbsp;只安装系统</p>
<p>　　D盘 &nbsp;安装软件，放我的文档和收藏夹</p>
<p>　　E盘 &nbsp;安装游戏或作为备份盘</p>
<p>　　F盘 &nbsp;BT下载</p>
<p><br /><br /></p>
<p>如此组织，一是方便系统重装的时候，常用软件和日常数据能够得到妥善保存；二是避免BT下载之类带来频繁磁盘整理的压力。</p>
<p><br /><br /></p>
<p>随着使用时间的增加，各盘的剩余空间迅速减少，但是剩余空间之和却是相当大的，这就造成了一种变相的浪费。另外，XP SP2开始稳定性有了较大的进展，终于不用再频繁重做系统了。因此，后来就直接变成</p>
<p>　　C盘 系统和各种软件</p>
<p>　　D盘 私人数据和下载的数据</p>
<p><br /><br /></p>
<p>软件方面，可以利用云端软件平台进行管理，既能够享受绿色安装的快感，又不需要费神找下载文件，担心病毒问题。收藏夹方面，主流的浏览器都带有收藏夹备份功能，因此可直接放在C盘。（另外，chrome取消了书签管理器的快捷键，似乎希望淡化书签这个概念，代之以历史记录。细想，其实翻收藏夹的机会真的极少极少）增加下载的缓存大小，允许创建临时文件，足可以避免BT下载对硬盘造成的损害。</p>
<p><br /><br /></p>
<p>至于具体的文件夹组织，依个人习惯而不同。按项目分类，再在项目里按时间分子目录，似乎是一个不错的选择。分层则不宜过多，我觉得，超过3层的目录就会变得很冗余，也许你只是想把某些文件藏起来而已。同一目录下，子目录及子文件过多，也十分不雅。后来，厌烦了分类的我直接用Everything来进行搜索，文件直接放在同一个目录下，基本上用Everything的搜索视图来代替原始的Explorer界面。 若你有组织多层目录的习惯，Total Commander会是一个不错的选择。</p>
<p><br /><br /></p>
<p>关于文件命名的问题，可以参考善用佳软的《三段式命名》，我反对那种文件名前还要加序号的方法，但是审慎命名文件，始终如一坚持一套有效的命名规则，的确能够带来极大的效率提高。于我个人而言，采取tag cloud的方式管理文件才是最天然合理的，一个文件可能有多重身份，或许是某个团队项目的一部分，或许属于下载来的文件，或许存在于某年的备份中。要体现文件的这种复杂身份，基于目录的管理方式太落后，tag cloud才是最佳选择。只是基于tag cloud进行搜索定位文件的软件迟迟未出现，也许需要在文件系统上提供更多属性的支持？</p>
<p><br /><br /></p>
<p>Linux：</p>
<p>linux的目录树管理方式十分灵活，而且有利于进行优化。有时候不禁YY下，代码文件都在/src目录下，编译出来的文件放在/bin，然后/bin目录使用更大的文件簇，/src目录则使用reiserFS和更小的文件簇，减小空间的浪费。更进一步，可以把/boot目录及/bin挂在SSD上，提高系统的响应速度，同时这两个目录较小的写入次数应该能够延长SSD的使用寿命。</p>
<p><br /><br /></p>
<p>对于各个系统而言，良好的命名是一个通用的习惯。毕竟，真正负责思考的是计算机前的你，而不是冷冰冰的电子回路。</p>
<p><br /><br /></p>
<p><img src="http://www.reynoldsbusiness.com/filing%20supplies%20-%20file%20folders%20&amp;%20indexes_files/RBSFoldersForWeb%20014%20%202.jpg" width="600" style="vertical-align: bottom;" alt="file and folder" /></p>]]></description></item><item><title>在cygwin上安装gevent</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/02/18/how_to_install_gevent_on_cygwin.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 18 Feb 2011 08:29:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/02/18/how_to_install_gevent_on_cygwin.html</guid><description><![CDATA[<p>由于公司点餐要用QQ，只能寄身于WinXP下做开发。但是win下各种不能折腾很不爽，幸而有Cygwin</p>

<p>然而，使用easy_install 居然安装不了Cygwin，弹出一大堆core.c的错误，一直没搞懂。只好与win的丑陋的命令行相伴，还设置了PATH指向cygwin的bin，为的就是能顺利ls。</p>

<p>遍寻不获后，今天看到这篇日志<a href="http://d.hatena.ne.jp/ymotongpoo/20110108/1294494273">http://d.hatena.ne.jp/ymotongpoo/20110108/1294494273</a>，终于醒悟过来了。。。我没有装libevent，cygwin的源里也没有这个东东。</p>

<p>剩下的就简单了，./cofigure、 make、 make install安装libevent，使用</p>
<pre class="syntax-highlight">python setup.py install -I /opt/local/include -L /opt/local/lib</pre>
<pre class="syntax-highlight"><br /></pre>
<pre class="syntax-highlight">安装gevent。</pre>
<pre class="syntax-highlight"><br /></pre>
<pre class="syntax-highlight">done！</pre>]]></description></item><item><title>使用python对txt格式的小说进行处理</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/02/04/python_txt_novel_process.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 04 Feb 2011 14:09:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/02/04/python_txt_novel_process.html</guid><description><![CDATA[<p>vim的确是神器，可惜sed与vim不完全通用。这篇文章受<a href="http://hi.baidu.com/%C8%CB%BC%E4%CA%C0%E5%D0%D2%A3%D3%CE/blog/item/51f5ec1db41cffe51bd57630.html">《
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
用vim对txt格式的小说重新排版》</a>的启发，在此致谢！</p>
<p>&nbsp;</p>
<p>经常下载txt的电子书，格式却不合心意，只好自己再处理。首要的就是处理段内换行。</p>
<p>&nbsp;</p>
<p>原来的打算是定制一个vim模式，到时候处理小说时进入该模式，再使用各种快捷键。以此避免txt快捷键对日常编程的干扰。后来发现，vim不像emacs，可以定制自己的模式。（可能可以定制专用的vimrc解决，未经尝试）</p>
<p>&nbsp;</p>
<p>于是转向脚本寻求解决办法。sed与awk是此中翘楚，首先试试。可惜早些日子学的sed已经忘的差不多了，找不到比较简洁清晰的解决办法。sed与grep类似，先读入一行，删除\n，进行各种处理，最后写入文件，再添上\n。 N可以读入下一行到当前模式匹配空间再行处理。但是我需要对整个文件进行匹配，暂时未找到解决办法。</p>
<p>&nbsp;</p>
<p>只好再次转投python。Python有自己的re模块，应该没问题。re.sub可以进行替换。费了些时间的，是对中文的匹配。在vim中，可以用[^\x00-\xff]匹配双字节字符，然而python中却行不通。经过一番google，发现可以用[\x80-\xff]匹配汉字（perl同此，似乎两者对中文的正则支持还是有待改进）。</p>
<p>&nbsp;</p>
<p>至此，问题初步解决：</p>
<p>
<div class="cnblogs_Highlighter">
<pre class="brush:python">#!/usr/bin/env python
#encoding=utf-8
import re
from sys import argv


if __name__ == '__main__':
	if len(argv) != 2:
		print 'usage: filename'
	else:
		fh = open(argv[1], 'r')
		content = fh.read()
		out = re.sub('\n([\x80-\xff])', r'\1', content)
		print out
</pre>
</div>
</p>
<p>规范行首：</p>
<p>
<div class="cnblogs_Highlighter">
<pre class="brush:python">#!/usr/bin/env python
#encoding=utf-8
import re
from sys import argv


if __name__ == '__main__':
	if len(argv) != 2:
		print 'usage: filename'
	else:
		fh = open(argv[1], 'r')
		content = fh.read()
		out = re.sub(' +([\x80-\xff])', r'     \1', content)
		print out
</pre>
</div>
</p>
<p>当然，下载来的文档通常是GB2312，需要自己转换为utf8再行处理，可以参考我的<a href="http://www.cnblogs.com/Lifehacker/archive/2010/08/10/python_encode_decode.html">《python 中文编码笔记》</a></p>
<p>&nbsp;</p>
<p>在win下，有个优秀的文本处理工具可以利用，叫cnbook。在百度的fmddlmyy贴吧可以下载到最新版本。</p>]]></description></item><item><title>RLE游程长度编码</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/01/16/run_length_encoding_demo.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 16 Jan 2011 01:33:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/01/16/run_length_encoding_demo.html</guid><description><![CDATA[<p>昨天看心情好，就花了两个小时写了个RLE的demo，可是p7zip帮我删了。。。晚上再写，用gcc rle.c -o rle.c 脑抽啊我&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>今天不死心，再写了一个！【<a target="_blank" href="http://files.cnblogs.com/Lifehacker/rleFile.7z">RLE压缩</a>】</p>
<p>&nbsp;</p>
<p>RLE是基于这样一种思路：如果整个文件由A构成，那么我们只需要用A 次数去表示该文件就可以了。 为了表示序列开始，需要一个标识符，我选择了0xff。这样，每个序列就表示为0xff 字符 次数。 当单个字符出现次数少于3的时候，压缩就得不偿失，因此对小于3个字符的不处理而直接输出。</p>
<p>&nbsp;</p>
<p>详见维基百科：<a href="http://zh.wikipedia.org/zh/%E6%B8%B8%E7%A8%8B%E7%BC%96%E7%A0%81">http://zh.wikipedia.org/zh/%E6%B8%B8%E7%A8%8B%E7%BC%96%E7%A0%81</a></p>]]></description></item><item><title>SICP 与函数式编程</title><link>http://www.cnblogs.com/Lifehacker/archive/2011/01/05/sicp_sum_up.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 05 Jan 2011 09:53:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2011/01/05/sicp_sum_up.html</guid><description><![CDATA[<p>马马虎虎地看完了第四章跟第五章，终于可以为SICP这本书画上一个句号。</p>
<p>&nbsp;</p>
<p>似乎GCD跟fibonacci这两个程序在每门语言里都会被实现一遍。这应该是涉及到递归的定义吧，对于函数式编程来说，递归是深刻而基础的，循环可以没有，递归不可或缺。特别是fibonacci的双递归，一方面考验了编程使用者的技巧，另一方面考验了这门编程语言的实现。（参见<a href="http://zh.wikipedia.org/zh-cn/%E7%BC%96%E8%AF%91%E5%99%A8%E9%80%92%E5%BD%92%E6%B5%8B%E8%AF%95" target="_blank">维基百科</a>）</p>
<p>&nbsp;</p>
<p>其中印象比较深刻的，是将函数作为参数和返回值。而且在scheme的语法中，显得非常自然。C中也有函数指针，相对地就显得复杂。</p>
<p>&nbsp;</p>
<p>另外，就是引入表作为一种通用的数据界面进行处理了。得益于后台运行的GC，使用表的时候不用担心自动增长的问题，可以专注于工作本身。而且，对于表的操作也只有两个原语：CAR与CDR。 通过这两个原语的结合，再配合前述的递归，scheme就能发挥出它的强大威力，令人叹为观止。</p>
<p>&nbsp;</p>
<p>数据抽象一节，很容易联想起C的结构体一节与C++的对象，利用带标志数据，在表上实现了多样的抽象对象。后面接的就是模块化，作者煞费苦心搞出了set！来配合讲解与C++相若的对象概念，以及用计算机中的对象模拟现实世界运行的OO思想。那个数字电路的模拟器写得很棒，特别是约束传播，很有感觉。</p>
<p>&nbsp;</p>
<p>数据抽象里最有力的一节，是引入流和时间解耦。流的实现居然只是简单的在cdr上加了一个简单的壳，用一个许诺代替了具体数据。通过引入流，作者轻松地将循环等等抛弃掉，连带的还有局部变量。对象的状态看作是一组跟时间相关的值的流，漂亮地解决了并发冲突后（实际上，时间与通信似乎有着天然的联系，参见相对论中关于火车、隧道与闪电的例子），状态就跟时间本身解耦了！ 状态跟时间解耦，意味着并发性不再受到限制，这就是函数式编程天生支持高并发的原因吧。</p>
<p>&nbsp;</p>
<p>流的另一大惊喜，是对（发生器-过滤器-累加器）这一编程模型的优化。通过流，这三者的配合可以交替执行，因此节省了中间结果所占据的巨大空间和时间。我很好奇Linux下的管道是否也用上了类似的优化。（流的自身迭代也很美，特别是欧拉加速器！）</p>
<p>&nbsp;</p>
<p>第4和第5章没看懂，暂不发表意见了。以后有时间就看看the little schemer XD</p>
<p>&nbsp;</p>]]></description></item><item><title>视频数据编解码技术</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/12/29/video_encoding.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 29 Dec 2010 09:23:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/12/29/video_encoding.html</guid><description><![CDATA[<p>我真的很难专心持续做一件事情呢，最近因为课程需要写了篇文章应付，博诸君一笑</p>
<p>&nbsp;</p>
<p><strong>视频编码与文件格式的常见误区</strong></p>
<p>&nbsp;&nbsp; &nbsp; &nbsp;在日常使用中，经常会接触到AVI、MOV以及MP4之类的格式，一般认为这就是视频编码。这是一个常见的误区。以所提到的三种格式为例，他们应该称为视频容器，即容纳各种不同编码数据的容器。（视频容器格式只定义如何储存数据，而不定义所存储的数据类型）。负责具体编码工作的，是codec。Codec是由coder/decoder组合而成，意为编解码器。在视频容器中负责编解码工作的，就是codec。</p>
<p>&nbsp;</p>
<p>常见的视频编码</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp;MPEG1MPEG-1是为CD光盘介质定制的视频和音频压缩格式。一张70分钟的CD光盘传输速率大约在1.4Mbps。而MPEG-1采用了块方式的运动补偿、离散余弦变换（DCT）、量化等技术，并为1.2Mbps传输速率进行了优化。MPEG-1随后被Video CD采用作为核心技术。MPEG-1的输出质量大约和传统录像机VCR，信号质量相当，这也许是Video CD在发达国家未获成功的原因。MPEG-1音频分三层，其中第三层协议被称为MPEG-1 Layer 3，简称MP3。MP3目前已经成为广泛流传的音频压缩技术。</p>
<p>&nbsp;</p>
<p>MPEG2</p>
<p>MPEG-2是MPEG工作组于1994年发布的视频和音频压缩国际标准。MPEG-2通常用来为广播信号提供视频和音频编码，包括卫星电视、有线电视等。MPEG-2经过少量修改后，也成为DVD产品的核心技术。MPEG-2的系统描述部分（第1部分）定义了传输流，它用来一套在非可靠介质上传输数字视频信号和音频信号的机制，主要用在广播电视领域。MPEG-2的第二部分即视频部分和MPEG-1类似，但是它提供对隔行扫描视频显示模式的支持（隔行扫描广泛应用在广播电视领域）。MPEG-2视频并没有对低位速率（小于1Mbps）进行优化，在3Mbit/s及以上位速率情况下，MPEG-2明显优于MPEG-1。MPEG-2向后兼容，也即是说，所有符合标准的MPEG-2解码器也能够正常播放MPEG-1视频流。MPEG-2技术也应用在了HDTV传输系统中。MPEG-2的第三部分定义了音频压缩标准。该部分改进了MPEG-1的音频压缩，支持两通道以上的音频。MPEG-2音频压缩部分也保持了向后兼容的特点。MPEG-2的第七部分定义了不能向后兼容的音频压缩。该部分提供了更强的音频功能。通常我们所说的MPEG-2AAC指的就是这一部分。</p>
<p>&nbsp;</p>
<p>MPEG4</p>
<p>MPEG-4是一套用于音频、视频信息的压缩编码标准，由国际标准化组织（ISO）和国际电工委员会（IEC）下属的&ldquo;动态图像专家组&rdquo;（Moving Picture Experts Group，即MPEG）制定，第一版在1998年10月通过，第二版在1999年12月通过。MPEG-4格式的主要用途在于网上流、光盘、语音传送（视频电话），以及电视广播。MPEG-4包含了MPEG-1及MPEG-2的绝大部份功能及其他格式的长处，并加入及扩充对虚拟现实模型语言（VRML ， Virtual Reality Modeling Language）的支持，面向对象的合成文件（包括音效，视频及VRML对象），以及数字版权管理（DRM）及其他交互功能。MPEG-4大部份功能都留待开发者决定采用是否。这意味着整个格式的功能不一定被某个程序所完全函括。因此，这个格式有所谓&lsquo;profiles&rsquo;及&lsquo;层次（levels）&rsquo;，定义了MPEG-4用于某些特定应用的某些功能的集合。</p>
<p>&nbsp;</p>
<p>H.264</p>
<p>H.264，或称MPEG-4第十部分，是由ITU-T视频编码专家组（VCEG）和ISO／IEC动态图像专家组（MPEG）联合组成的联合视频组（JVT，Joint Video Team）提出的高度压缩数字视频编解码器标准。</p>
<p>&nbsp;</p>
<p>MPEG7&nbsp;</p>
<p>MPEG-7标准被称为&ldquo;多媒体内容描述接口&rdquo;，为各类多媒体信息提供一种标准化的描述，这种描述将与内容本身有关，允许快速和有效的查询用户感兴趣的资料。它将扩展现有内容识别专用解决方案的有限的能力，特别是它还包括了更多的数据类型。换而言之，MPEG-7规定一个用于描述各种不同类型多媒体信息的描述符的标准集合。该标准于1998年10月提出。&nbsp;</p>
<p>&nbsp;</p>
<p><strong>视频解码的常见过程</strong></p>
<p>视频解码的4个过程，通常包括获取文件、分离音视频流、解码、输出。</p>
<p>　　获取文件</p>
<p>　　　　视频流的来源可以是文件，也可以是UDP等数据流，主要是将视频流放入内存缓冲区中。</p>
<p>　　分离音视频流</p>
<p>　　　　正如前述，视频文件只是一个容器。视频数据与音频数据按照一定的标准组合在一起。为了下一步的解码，首先要把视频和音频分离开。</p>
<p>　　解码工作</p>
<p>　　　　分离开的音频和视频，由各自的codec负责进行解码，得到原始数据流。</p>
<p>　　输出</p>
<p>　　　　将得到的原始数据流在窗口里进行渲染，使之变成可以看到的图像。</p>
<p>&nbsp;</p>
<p><strong>视频编码的核心过程</strong></p>
<p>下面以现时的MPEG1编码为例，试讲述视频编码的核心过程。通过摄影机、摄像头等得到的图像，首先会进行模数转换，变成数字码流。但是，在时间尺度上和空间范围上，均有大量的冗余信息，得到的比特流会占用大量的空间，不利于储存和播放。因此，就需要对原始视频流进行编码压缩。常见的方法是，对原始视频流进行色彩空间转换。由于人眼对于亮度的敏感大大优于对色度的敏感，转化为YCbCr色彩空间能够缩小体积而视频质量仍保持在较高质素（同时，这也去除了色彩方面的冗余）。接着进行DCT离散余弦变换，由于离散视频变换具有很强的能量集中特性，大多数自然信号（包括声音和图像）都会集中在离散余弦变换后的低频部分。（这意味着系数矩阵的大多数元素均为0）通过量化，就可以进行熵编码。上一步得到的数据往往具有较高的冗余量，对其进行熵编码（如常见的霍夫曼编码）就会有较好的压缩效果。</p>
<p>　　对于视频来说，往往会进行运动补偿，使用已经编码的帧对当前帧进行预测。最简单的运动编码可以是将当前帧减去参考帧，对剩余部分（只剩下较少能量的残差）进行较低码流的编码。比较常用的是分块运动补偿，通过对宏块的平移预测当前帧。其中，涉及到探测并计算最优平移向量。当然，还有通过向前向后预测来优化的（向前向后是指同时使用前后两个参考帧进行预测）。</p>
<p>&nbsp;</p>
<p>参见：</p>
<p>　　维基百科</p>]]></description></item><item><title>C程序设计语言答案 chapter3</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/12/10/solutionOfTheCProgrammingLanguageCH3.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 10 Dec 2010 08:45:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/12/10/solutionOfTheCProgrammingLanguageCH3.html</guid><description><![CDATA[<p><a href="http://files.cnblogs.com/Lifehacker/ch3.7z">第三章答案</a>&nbsp;主要围绕itoa做文章，加深对整数类型的理解和字符串数组的操作。</p>
<p>第三章貌似是一个转折点，前面的练习更加像一些玩具，后面的会更有挑战性。</p>]]></description></item><item><title>C程序设计语言答案 chapter2</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/11/30/solutionOfTheCProgrammingLanguageCH2.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 30 Nov 2010 15:50:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/11/30/solutionOfTheCProgrammingLanguageCH2.html</guid><description><![CDATA[<p>时不时练习一下还是蛮过瘾的，不过后面的习题应该会挺有难度吧，期待ing</p>
<p>&nbsp;</p>
<p><a href="http://files.cnblogs.com/Lifehacker/ch2.7z">第二章答案</a></p>]]></description></item><item><title>C程序设计语言答案 chapter1</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/11/09/theAnswerOfTheCProgrammingLanguage.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 09 Nov 2010 10:16:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/11/09/theAnswerOfTheCProgrammingLanguage.html</guid><description><![CDATA[<p>最近面试屡屡受挫，搞得颇为狼狈。断断续续地看完了K＆R的C Bible，刚把第一章的习题完成了。不得不说，这本薄薄的小书习题很有质量。对于指针的运用很有启发，给了我很多的灵感。看完很想说：原来C语言还可以这样用！</p>
<p>&nbsp;</p>
<p>习题都是自己做的，若有错漏，还请不吝赐教。</p>
<p><a href="http://files.cnblogs.com/Lifehacker/ch1.7z">ch1</a></p>]]></description></item><item><title>ubuntu下svn上传到google code</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/10/19/svn_upload_to_google_code.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 19 Oct 2010 12:52:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/10/19/svn_upload_to_google_code.html</guid><description><![CDATA[<p>在Google code上也混迹了一段时间，提交patch和issue都试过了，可惜一直没找到哥们给个commitor当当。今天特地去挖了个坑，试试owner的滋味。</p>
<p>&nbsp;</p>
<ol>
<li>在source下的checkout里，可以很清晰地看到需要填写的命令。可是ubuntu的svn有点诡异，以ownership checkout一个project，居然也不需要输入密码，搞了我很长时间。</li>
<li>更纠结的还在后头，svn add添加完文件，svn commit进行提交，发现首先要输入的是一个Gnome keyring(null)的密码，我输了很多遍google code的密码和邮箱密码，都不对，原来那是本机用户的密码。</li>
<li>接下来google code的服务器就会问你要帐号，若是gmail账户的话直接输入用户名即可，不用添加@gmail。</li>
<li>接下来输入的是google code的密码。可以在http://code.google.com/hosting/settings里找到，这个密码十分复杂的说，在命令行下输入相当有难度。</li>
</ol>
<p>&nbsp;</p>
<div>接下来就提示上传中啦，最近还是做些跟twitter相关的project，比较有趣味性。</div>
<div>p.s. 我一般用git来进行管理的，死活没找到办法用git跟google code沟通，囧一个</div>
<div></div>
<div>参考：<a href="http://kakst.blogspot.com/2010/03/svngoogle-code.html">http://kakst.blogspot.com/2010/03/svngoogle-code.html</a></div>]]></description></item><item><title>操作系统 逻辑地址与物理地址的转换</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/10/12/logicalAddress_to_physicalAddress.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 12 Oct 2010 01:38:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/10/12/logicalAddress_to_physicalAddress.html</guid><description><![CDATA[<p>
<div>逻辑地址/页面大小=页号</div>
<div>逻辑地址 mod 页面大小=页内偏移</div>
<div>通过页号查找页表得到对应的物理区块</div>
<div>物理地址=物理区块x页大小+页内偏移</div>
<div></div>
<div>页号也可以通过位映射的方法实现，例如页表只有4项，则只需逻辑地址的前两位就可以确定页号。</div>
<div></div>
<div>参考：</div>
<div>
<div>http://goo.gl/iGYn</div>
</div>
</p>]]></description></item><item><title>入手台电K6</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/10/07/e_ink_ebook.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 07 Oct 2010 10:04:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/10/07/e_ink_ebook.html</guid><description><![CDATA[<p>最近入手了电纸书，折腾了好久，感觉有点浪费时间阿，这时间和钱拿去买书读书该多好&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>期间遇到一个问题，6寸屏幕的电纸书看pdf相当痛苦，幸好新固件有pdf重排。但换行依然不知所谓不明就里不能人道&hellip;&hellip;于是需要自己处理下，网上流行一个<a href="http://bbs.mobread.com/thread-872-1-1.html">wps处理法</a>，大意就是将txt文本粘贴进wps的6寸模板里，然后另存为pdf。这样可以设置自己喜爱的字体，的确是不错的选择。此外还有通过虚拟打印机打印成pdf的。</p>
<p>&nbsp;</p>
<p>txt源不是那么容易找的，万一找回来的已经是pdf，怎么办呢？可以通过pdfcrop进行切边，这款软件在ubuntu下是一个perl脚本，原理大概是直接提取文本外的那个&ldquo;盒子&rdquo;，再以之为页面大小，这样白边自然而然就没有了。但速度非常慢，转换后体积扩大10倍，不够实用。还有一个pdfnup，是pdfjam的一个工具，可以将两页pdf做成1页，拿去打印就方便了。也附带有切白边的功能，原理却不一样。它是新建一个latex文件，将原文pdf像图片一样嵌入其中，然后进行缩放处理。通常都能减少体积，而且速度也快，但切多少就要靠自己手动控制了。另外切完白边后放进机器中似乎不能重排了，这点待验证。</p>
<p>&nbsp;</p>
<p>不由得又想起TAOUP里面提到的，纯文本最好。当然，这里不包括为了营造格式随便断行的txt。如果pdf有相应的ps或者tex文件，要变6寸pdf还不简单？相信改个模板就行了，像pdf带盒子是最难处理的，将html直接dump成txt似乎也带有换行，比较麻烦。总的来说，数据是文本流这种模式最好，图片之类的应该是处于漂浮状态的，由排版方决定图片的位置，这也是html的思想。</p>
<p>&nbsp;</p>
<p>关于机器，台电K6似乎是市场上最便宜的6寸E-ink机器了。然而，似乎易万卷的S600更好一些。上市日期差了3个月，硬件方面却有较大区别。k6用的是arm7的，瑞芯微的解决方案，而S600用的是arm9，而且用的是linux系统。买之前没考察清楚阿，嵌入式设备上的固件也很重要，需要列入考虑方案。虽然K6也支持16灰阶，但仅仅是硬件上，要等到相应固件不知何年何月，另外还有pdf切白边的功能，不知道台电还打不打算继续做出来。易万卷的Linux系统起码让人看到了那么一丝可以hack的机会啊&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>总结：6寸电纸书看文学类的书最好，epub格式不错，本身基于xml结构，排版方面没有什么问题。要看扫描版pdf，还是等10寸吧，10寸携带不方便，如果那种可以卷曲的电子纸可以普及，那么阅读扫描版电子书的时代就真正来临了。</p>]]></description></item><item><title>arch linux 安装quick-init导致根目录可读的修复</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/09/17/quick_init_failure.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 17 Sep 2010 05:24:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/09/17/quick_init_failure.html</guid><description><![CDATA[<p>不得不说，Arch Linux真的非常快！搭积木式的构建方式可以给我一种掌控感。后来听说quick-init可以4秒启动，禁不住去试试，结果。。。失败了，只好卸载之，结果根文件系统变成只读，无法上网。。。</p>
<p>&nbsp;</p>
<p>经过一轮google，锁定在/etc/inittab和/etc/rc.conf文件上，首先把这两个文件恢复原样。/etc中可以看到inittab.pacsave或inittab.original的备份文件，恢复即可。</p>
<p>&nbsp;</p>
<p>若重启依然无法解决，通常是因为把initscripts这个包也卸载了。如果pacman无法上网，则需要minimalCD帮忙，按照新手安装指南配置好网络，然后将/etc/resolv.conf复制到硬盘相应目录上，再利用硬盘的pacman更新解决。</p>
<p>&nbsp;</p>
<p>现在大约20s就可以看到Google首页了，很期待新一代chrome OS的成绩！话说基于suse构建的chrome OS真的很慢&hellip;&hellip;</p>]]></description></item><item><title>virtualbox 安装gentoo</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/09/14/1825719.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 14 Sep 2010 03:11:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/09/14/1825719.html</guid><description><![CDATA[<p>一直想尝试一下fvwm，又不想搞坏现在的ubuntu，顺便就搞个gentoo玩玩。</p>
<p>&nbsp;</p>
<p>基本的安装顺序照官方的guidebook就可以了，但配置内核的时候要注意如下选项：</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp">Processor type and features  ---&gt;
    [*] Tickless System (Dynamic Ticks)
    [ ] High Resolution Timer Support
    [ ] Symmetric multi-processing support
        Subarchitecture Type (PC-compatible)  ---&gt;
    [ ] Machine Check Exception
Power management and ACPI options  ---&gt;
    [*] Power Management support
    [ ] Suspend to RAM and standby
    [ ] Hibernation (aka 'suspend to disk')
    [*] ACPI (Advanced Configuration and Power Interface) Support  ---&gt;
Device Drivers  ---&gt;
    &lt; &gt; ATA/ATAPI/MFM/RLL support
    &lt;*&gt; Serial ATA and Parallel ATA drivers
        &lt;*&gt; AHCI SATA Support
        [*] ATA SFF support
        &lt;*&gt; Intel ESB, ICH, PIIX3, PIIX4 PATA/SATA support
    [*] Network device support  ---&gt;
        [*] Ethernet (10 or 100Mbit)  ---&gt;
            [*] EISA, VLB, PCI and on board controllers
            &lt;M&gt;   AMD PCnet32 PCI support
        [*] Ethernet (1000 Mbit)  ---&gt;
            &lt;M&gt; Intel(R) PRO/1000 Gigabit Ethernet support
        [ ] Ethernet (10000 Mbit)  ---&gt;
    Graphics support ---&gt;
        &lt;*&gt; Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)  ---&gt;
            &lt; &gt; all options can be empty
    &lt;M&gt; Sound card support ---&gt;
        &lt;M&gt; Advanced Linux Sound Architecture ---&gt;
            [*] PCI sound Devices ---&gt;
                &lt;M&gt; Intel/SiS/nVidia/AMD/ALi AC97 Controller
    Input device support ---&gt;
        [*] Mice ---&gt;
           &lt;*&gt; PS/2 mouse
</pre>
</div>
<p>按以上配置的时候就可以得到virtualbox-friendly 的kernel了</p>
<p>&nbsp;</p>
<p>配置完成后继续按照官方指南做就可以了。</p>
<p>&nbsp;</p>
<p>有两个地方花了我很多时间，一个是文件系统，一个是网卡驱动，照以上配置应该可以顺利完成。网络方面，我采用NAT共享，所以在minimal CD的时候就要顺道把dhcpcd装上，免得启动以后上不了网emerge。</p>
<p>&nbsp;</p>
<p>mirrorselect貌似不起作用，检查配置的时候记得顺手加上，我用的是163的源，速度蛮快的。</p>
<p>&nbsp;</p>
<p>我的最终目标是安装X，所以还要麻烦一点。基本的virtualbox Guest addition要装上，然后是</p>
<p>xfree86-input-virtualbox</p>
<p>xfree86-video-virtualbox</p>
<p>最后配置/etc/X11/xorg.conf</p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp">Section "Device"
   Identifier   "Configured Video Device"
   Driver      "vboxvideo"
EndSection

Section "Monitor"
   Identifier   "Configured Monitor"
EndSection

Section "Screen"
    Identifier   "Default Screen"
   Monitor      "Configured Monitor"
   Device      "Configured Video Device"
   DefaultDepth    24
   SubSection      "Display"
      Depth           24
      Modes           "1280x1024"
   EndSubSection
EndSection

Section "InputDevice"
        Identifier  "vboxmouse"
        Driver          "vboxmouse"
        Option          "CorePointer"
        Option          "Device"        "/dev/input/mice"
EndSection

Section "ServerLayout"
        Identifier      "Default Layout"
        Screen          "Default Screen"        0 0
        InputDevice     "vboxmouse"
EndSection
</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>官方指南里说xorg-x11和xorg-server是等效的，只是xorg-x11带了很多字体，推荐用xorg-server。</p>
<p>没想到x-term、xclock、tvm等等都要自己手动装&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>参考：</p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<a href="http://www.cnblogs.com/likun/archive/2009/10/15/1584208.html">http://www.cnblogs.com/likun/archive/2009/10/15/1584208.html</a></p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<a href="http://www.ha97.com/2333.html">http://www.ha97.com/2333.html</a></p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<a href="http://en.gentoo-wiki.com/wiki/Virtualbox_Guest">http://en.gentoo-wiki.com/wiki/Virtualbox_Guest</a></p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<a href="http://forums.virtualbox.org/viewtopic.php?t=15679">http://forums.virtualbox.org/viewtopic.php?t=15679#</a></p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<a href="http://www.gentoo.org/doc/en/xorg-config.xml">http://www.gentoo.org/doc/en/xorg-config.xml</a></p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<a href="http://ubuntuforums.org/showthread.php?t=777759">http://ubuntuforums.org/showthread.php?t=777759</a></p>]]></description></item><item><title>Ubuntu 下利用expect脚本自动登录ssh作代理</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/09/05/linux_ssh_with_expect.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 05 Sep 2010 13:40:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/09/05/linux_ssh_with_expect.html</guid><description><![CDATA[<p>这类文章网上已经有很多了，实在不想再重复，可惜一直没有一个双击就连上ssh的，要不写个GUI？putty很搞，还是弹出一个命令行出来填用户名密码，那我干脆直接在terminal搞定啦。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="cnblogs_Highlighter">
<pre class="brush:Perl">#!/usr/bin/expect -f   
#auto ssh login    
  
set timeout 20   
spawn ssh login_name@host_name   
expect &ldquo;*password:&rdquo;    
send &ldquo;123456\r&rdquo;    
interact  
</pre>
</div>
<p>&nbsp;</p>
<p>网上流传的大多都是上面一段代码，问题就在最后一句上面：</p>
<p>interact</p>
<p>即交互模式，我用ssh只是拿来做代理的话，只需要后台运行就可以了，哪来interact呢？还有考虑更周到的，加了个timeout，每分钟发送一个空格防止被踢，我严重怀疑这个脚本的可行性，特别是ssh用上了-n的时候。另外还有ssh的-f，我以为这个是用于作Daemon运行的，结果发现只是暂时将ssh放在后台了。</p>
<p>&nbsp;</p>
<p>最后，我将interact改成了expect eof，世界清静了。</p>
<p>&nbsp;</p>
<p>当然，还是建议采取公钥加密的，这样就不用每次都输入密码了。</p>
<p>&nbsp;</p>
<p>推荐：<a href="http://ssorc.tw/rewrite.php/read-600.html">http://ssorc.tw/rewrite.php/read-600.html</a></p>]]></description></item><item><title>着迷twitter ing</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/09/04/hack_gtap_birdnest_fusion.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 04 Sep 2010 10:16:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/09/04/hack_gtap_birdnest_fusion.html</guid><description><![CDATA[<p>似乎最近迷上了翻过伟大的长城这项体育活动，而且还是为翻墙而翻墙那一种。。。</p>
<p>&nbsp;</p>
<p>继twip之后，又迷上了gtap这个twitter api proxy。这个代理架设在gae上，用的还是我熟悉的python语言，非常亲切。当然，那坨Django的代码也不是我暂时能够捣鼓出来的，hack的时候用了点拙劣的手法。</p>
<p>&nbsp;</p>
<p>twitter这种思维碎片，我总喜欢将其归为短信一类，因此手机发推才比较接近我的习惯。鉴于非智能机hack的难度较高，没有vpn和ssh可用，只好用gae做proxy了。既然gtap支持Oauth，当然是一个不错的选择（我对于第三方要求原始帐号和密码都比较反感。。。）。但手机界最节省流量的twitter proxy，应该算是birdnest了，号称50% off。参考过birdnest的代码进行测试，我觉得50%这个数字太保守，一般情况下能省掉三分之二的流量。原理其实很简单，每条推只传输基本元素，例如What、Who、When，这样省下的流量就很可观了。另外，这需要客户端的配合，假如你的客户端需要多媒体的支持，例如显示对方推友的头像，推中的图片自动显示缩略图，这种纯文字的api proxy就不合适了。</p>
<p>&nbsp;</p>
<p>可惜的是，birdnest不支持Oauth认证，而twitter已经停止了basic authorization的认证方式，于是我就参考了birdnest的代码将textOnly的特性加入了gtap。（<a href="http://code.google.com/p/gtap/issues/detail?id=71">via issue 71</a>）这几天回顾了一下，又加了一个过滤特定Client的功能。某君用了Google2Tweet这款插件，但我已经在Greader上follow了，不需要接收这些冗余信息了，再屏蔽之。结果是50条推基本在35-48KB之间（开启gzip）。我很好奇这离&ldquo;压缩&rdquo;的极限有多远，有位laobubu的网友自己写了服务端和客户端，采用了自己的数据格式进行传输，据称每次可以在1KB左右，参见其作品快速推FastTwitter。</p>
<p>&nbsp;</p>
<p>我用来配套的是jibjib，基本的读推、发推、锐推、mention以及私信都支持，但我follow的人不多，获取最流行的信息有点难度。加上没有列表和搜索的支持，着实让人头痛。不过Java于我一向比较头大，hack这个暂时有点难度。非智能机似乎还真没有多少好用的java客户端，稍后可能会投靠奶瓶推这种web版客户端，当然要在有可用php空间的情况下了。话说jibjib的作者更新很勤快，twip的cnyegle狐狸也是！坦白说，狐狸你的VPN让我动心了，尤其是可以蹭CMCC这点~~~</p>]]></description></item><item><title>python-twitter与第三方api协作</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/08/25/twip_work_with_python-twitter.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 25 Aug 2010 05:16:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/08/25/twip_work_with_python-twitter.html</guid><description><![CDATA[<p>上回讲到搭建了twip作为twitter api proxy，那当然要好好地利用一下。正好最近做了一个twitter的机器人，每次都要翻代理上推实在麻烦，另外一个问题是twitter对http basic authorization的限制逐渐收紧，现在的api限制为60 per hour，稍后会再次缩减到45，而oauth则相反，准备在150/h的基础上逐渐推到1500/h（<a href="https://groups.google.com/group/twitter-development-talk/browse_thread/thread/a1076d83d70d0450">via</a>）。因此，利用twip的oauth特性进行中转会是相当不错的选择。</p>
<p>&nbsp;</p>
<p>这个机器人以前是通过proxychains，以ssh直连到twitter官网进行操作的，服务器端需要执行</p>
<p>&nbsp;</p>
<p>screen proxychains python code.py|tee log</p>
<p>&nbsp;</p>
<p>这命令十分头痛，似乎tee没有发挥到应有的作用，screen也不能detach了。现在，使用twip进行中转后，只需</p>
<p>&nbsp;</p>
<p>screen python code.py</p>
<p>&nbsp;</p>
<p>就可以了。</p>
<p>&nbsp;</p>
<p>当然，python-twitter 0.6还不支持api proxy，但python twitter都是采用http basic authorization，那么理论上只需要更改api的地址即可。我checkout了最新的代码，欣喜地发现了原来的http://twitter.com已经被basic_url参数取代了，兴冲冲地试试，沮丧地发现这个参数是留给Oauth的。 &nbsp; &nbsp;&nbsp;这个有点不解，如果python-twitter本身直接采用oauth，那么没有必要修改base_url。如果采取的第三方api，难道python-twitter也通过oauth跟第三方进行认证吗？ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 后来采取了最直接的方法，直接拿了一个twitter.py放在code目录里改，将所有的twitter.com都改成自己的twip地址，世界清静了。。。注意，要将python-twitter 的api认证里面的密码改成twip里的密码，否则会遇到HTTP 401。</p>
<p>&nbsp;</p>
<p>这个问题已经有同胞反映过，追踪google code上issue89可以跟进该问题的进一步发展。</p>]]></description></item><item><title>Oauth与twip杂感</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/08/22/twip_Oh_yeah.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 22 Aug 2010 13:49:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/08/22/twip_Oh_yeah.html</guid><description><![CDATA[<p>今天帮忙搭建twip了，主要参考了<a href="http://yht.in/archives/90">http://yht.in/archives/90</a>这篇文章。</p>
<p>&nbsp;</p>
<p>twip的主要原理，就是通过一台在墙外而国内又可以访问的独立主机作为跳板，国内用户首先连接到该独立主机上，然后再通过主机与twitter交换数据。为了提高安全性，twitter今年6月份停止了http basic authorize，取而代之的是Oauth的认证。用户的登录过程由twitter完成，最后twitter将用户的认证结果和授权告诉应用。得益于twitter api的简洁，以及标准的数据交互方式（可选择xml、json和atom其中一种），大量的第三方应用如雨后春笋般涌现出来，极大地丰富了twitter的表现形式（我终于可以手机上推啦XD）。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>发觉Oauth这套认证真的很不错，无需用户重复繁琐的注册步骤，即可对用户进行认证。稍后考虑一下用上这套认证，到时候注册就方便多了，反正面向的主要用户群都是twitter的老用户&hellip;&hellip;顺便扯一句，这年头连twitter和digg都不用MySQL了，也是，对于key-value这种字典型的应用，吞吐量又大，传统的关系数据库经常需要多表联合查询，的确会拖慢效率。</p>
<p>&nbsp;</p>
<p>最后打开了服务器的gzip，twitter真的是流量大户，更新一次就20多kb了&hellip;&hellip;</p>]]></description></item><item><title>ssh tunnel翻过伟大的长城</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/08/19/ssh_tunnel_concept.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Thu, 19 Aug 2010 09:56:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/08/19/ssh_tunnel_concept.html</guid><description><![CDATA[<p>&nbsp;</p>
<p>项目进入到一个稳定期，就等词库的扩张了。我打算在twitter上架设一个twitter机器人，搞搞新意思。看了下twitter api的文档，发现python的twitter库还真不少，看中的有两款：python-twitter和
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
tweepy,稍微看了看，python-twitter首页就有示例了，就你吧。</p>
<p>&nbsp;</p>
<p>以迅雷不及掩耳盗铃之势装好了simlejson和oauth的依赖，就可以开始工作了。本地测试通过～～由于众所周知的原因，不能直接访问到twitter，似乎python-twitter这个库也找不到设置代理的接口。不想hardcode，跑去问google大神了。google说proxychains是个好东西：通过设置LD_PRELOAD环境变量，使所有TCP连接都经过代理出去。（奇怪的是我找不到这个变量，却能够使用代理。。。）</p>
<p>&nbsp;</p>
<p>既然要处理代理的事，顺便就把ssh tunnel搞定了。以前一直没搞懂，究竟执行ssh -D以后，forward的是服务器端还是本地。后来终于想通了，本地通过ssh加密连接到服务器上，服务器负责转发功能。假设执行的是ssh -D 12345，则设置socks代理后，数据就发往本地的12345，这些数据通过加密的ssh信道传到服务器，服务器上再通过非加密通道forward出去。因为代理的TCP连接都通过ssh传输到远端服务器，就像在ssh隧道中通行一样，所以称为ssh tunnel.</p>]]></description></item><item><title>python 中文编码笔记</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/08/10/python_encode_decode.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 10 Aug 2010 09:06:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/08/10/python_encode_decode.html</guid><description><![CDATA[<p>最近碰了很多钉子。。。</p>
<p>&nbsp;</p>
<p>不得不说，python2.6相较于之前发布的版本，就编码方面来说，有明显的进步。本机使用的是python2.6，同样的代码根本没有遇到问题。到了服务器上部署时，一台服务器的python2.5和另一台服务器的python2.4，都折磨得我苦不堪言。</p>
<p>&nbsp;</p>
<p>先厘清几个概念：python内置的字符类型是unicode，当需要进行编码转换时，都要先转成unicode，然后再转换成目标编码。而str类型是二进制类型，例如</p>
<p>　　声明变量uniStr=u'的'，uniStr的类型为Unicode</p>
<p>　　执行gbStr=uniStr.encode('gb2312')，则gbStr的类型为str，长度为18字节（gb2312标准里用两个字节表示一个汉字）。</p>
<p>　　若执行gbStr.encode('gb2312')，则会报错，因为'ascii' codec can't decode byte 0xd3 in position 0: ordinal not in range(128)。</p>
<p>&nbsp;</p>
<p>关于unicode：unicode可以想象成一个比ascii大得多的码表，能够包含所有现存字符。每个字符有一个对应的编码，编码的范围是0到0x10ffff，那么我们可以使用32位的int来储存一个unicode字符。但这样比较浪费空间，人们就提出了别的编码方案，例如utf-8。简而言之，编码方案就是把unicode值映射成字节流，术语是encoding。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>python默认的编码方案是ascii，所有超过128的unicode编码都会报UnicodeEncodeError。</p>
<p>utf-8方案编码方案是应用较广的一种，编码规则如下：</p>
<ul>
<li>unicode编码值小于128，原封不动；</li>
<li>unicode编码值在128到7ff，将转换为2个字节，每字节值范围在128到255之间；</li>
<li>unicode编码值大于7ff的，将转换为3-4个字节，每字节值范围在128到255之间。</li>
</ul>
<div></div>
<div>为了应付编码问题，可以用repr()函数，type()函数来一探究竟。type能够告诉你这是unicode还是str，如果通过repr看到形如u'\ua000'的串，一般就是unicode了。\u和\U的区别是一个用4位16进制数表示，一个是8位16进制数表示。ord()函数可以返回一个unicode字并返回它的unicode编码（还记得上面提到的那张大码表吗？这编码就是在表中的索引值）。</div>
<div></div>
<div></div>
<div>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<p>参见：</p>
<p><a href="http://www.b-list.org/weblog/2007/nov/10/unicode/">http://www.b-list.org/weblog/2007/nov/10/unicode/</a></p>
<p><a href="http://boodebr.org/main/python/all-about-python-and-unicode">http://boodebr.org/main/python/all-about-python-and-unicode</a></p>
<p><a href="http://www.cl.cam.ac.uk/~mgk25/unicode.html">http://www.cl.cam.ac.uk/~mgk25/unicode.html</a></p>
<p><a href="http://docs.python.org/howto/unicode.html">http://docs.python.org/howto/unicode.html</a></p>
<p><a href="http://hi.baidu.com/a370500904/blog/item/9ff8aff49d8344d5f3d38534.html">http://hi.baidu.com/a370500904/blog/item/9ff8aff49d8344d5f3d38534.html</a></p>
</div>]]></description></item><item><title>分布式有感</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/08/03/cgi_fastcgi_and_servlet.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 03 Aug 2010 08:02:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/08/03/cgi_fastcgi_and_servlet.html</guid><description><![CDATA[<p>最近有点疲于奔命的感觉，孤军作战不是好事阿。</p>
<p>&nbsp;</p>
<p>以前学分布式计算原理与应用，一直对老师和教材有不满。教材虽然写的中规中矩，可是对java的偏向性无疑是一个败笔。书中的Java代码起个helloworld的作用还可以，真要用起来总觉得生涩无比，整天就在流里面转来转去。实验方面，socket的相关代码没有c的清晰，要不是string类封装了一些应手的函数，真不知道有什么优点。RMI看上去很美好，只是这种美好是建立在实验的基础上的。要真的应用起来，单单异常处理就会要命，网络的不确定性太多了，不是随便架起一层就能抹平的。</p>
<p>&nbsp;</p>
<p>最讨厌的是老师整天在吹嘘servlet的高性能，喋喋不休简直是Java活脱脱的营销人员。servlet相对于cgi的优点，在于两点：一是持续运行，可以轻松维护session信息；二是可以拥有线程池，启动快速，不需频繁启动关闭进程，减少系统消耗。</p>
<p>&nbsp;</p>
<p>有时候真的很难理解他的思维，多个cgi进程就需要加载多份程序？Linux早就实现了多个副本共享一个代码段了。没有线程池方便？可以用进程池啊。而多进程抗崩溃的能力不是多线程能够轻易赶上的。fastcgi的出现，也使得cgi的持续运行成为了可能，维护session不再遥不可及。</p>
<p>&nbsp;</p>
<p>最重要的一点是，cgi模型非常清晰易懂。前端的服务器做一个dispatch的作用，将请求分发到不同程序，并可以应付一定的IO请求。cgi程序自身从环境变量读取请求信息（get）或从标准输入流读入（post方法），最后将结果输出到标准输出流，服务器轻松地将cgi的标准输出流重定向到自己身上，再返回给Browser端。 &nbsp; &nbsp; &nbsp;而fastcgi则采取了一种更为激进一点的方式，fastcgi具有daemon进程，服务器端与fastcgi端通过socket进行通讯。</p>
<p>&nbsp;</p>
<p>ajax的出现，使程序的行为变得更加灵活。原来的动态网页，流程一般是从Browser发起请求，服务器端接受请求转发给cgi，cgi程序与数据库交互，返回动态构造的网页，服务器再转发给Browser。而ajax则可以通过在Browser端运行的js，直接在客户端动态构建网页，切实减轻了服务器端的负载。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>Cross Site Request Forgeries 跨站伪请求</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/07/09/cross_site_request_forgeries.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 09 Jul 2010 03:22:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/07/09/cross_site_request_forgeries.html</guid><description><![CDATA[<p>今天看Django的tutorial，里面提到了这样一种跨站攻击：</p><p>&nbsp;</p><p>假设有客户Bob 在浏览论坛页面（Bob真可怜～～～），Alice发布了一个很热的帖子，里面有</p><p>&lt;img src="http://abcbank.com/<meta http-equiv="content-type" content="text/html; charset=utf-8" /><span class="Apple-style-span" style="font-family: monospace, sans-serif; line-height: 34px; font-size: 15.9722px; ">/withdraw?account=bob&amp;amount=1000000&amp;for=mallory</span>"&gt; ,若Bob的银行cookies没有过期，则相当于Bob提交了这次交易。</p><p>&nbsp;</p><p>而在这个场景里，论坛和银行都是Bob所信任的，这就是csrf的可怕之处 。Django推荐凡是影响服务器端数据的动作，均使用post，另外还引入了csrf_token预防事故。</p>]]></description></item><item><title>chrome关于404的错误处理</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/07/03/chrome_404_friendly_page_error.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 03 Jul 2010 09:23:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/07/03/chrome_404_friendly_page_error.html</guid><description><![CDATA[chrome 的开发者工具的确很好用，但chrome对于404错误有个问题：只有大于512bytes的错误页面才会被显示，否则显示chrome的内置友好错误页。详见http://code.google.com/p/chromium/issues/detail?id=1695]]></description></item><item><title>web.py+gae=我的第一个留言板【二】</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/06/30/webpy_with_gae.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 30 Jun 2010 04:38:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/06/30/webpy_with_gae.html</guid><description><![CDATA[<p>下面接着说说google application engine和webpy配套的问题。在我完成留言板的时候，这方面的资料还是很少，中文资料更少，希望webpy社区能够壮大啊。</p><p>&nbsp;</p><p>gae据说很有Django的风格，也是内置Django的，而web.py则需要自备。因此，在应用目录中应该放入web.py解压后得到的web目录。否则会导致Import error: no module named web</p><p>&nbsp;</p><p>详细的发布过程，可以参考chinaunix的这篇文章：<a href="http://bbs.chinaunix.net/viewthread.php?tid=1487470" target="_blank">http://bbs.chinaunix.net/viewthread.php?tid=1487470</a>&nbsp;<span class="Apple-style-span" style="font-family: song, Verdana; line-height: normal; font-size: 12pt; "><strong style="word-wrap: break-word; ">[笔记]Google App Engine上试用web.py</strong></span>&nbsp;</p><p>&nbsp;</p><p><span style="font-size: 12pt; ">由于gae的限制，应用的模板文件需要编译后才能在gae上执行读取，否则会导致No module named templates 。上面的文章有具体的解决办法。</span></p><p>&nbsp;</p><p><span style="font-size: 12pt; ">&nbsp;注意，</span><span style="color: red; font-size: 12pt; ">源代码的app.run()需要改成main=app.cgirun()才能正常工作。</span>&nbsp;否则会导致<span class="Apple-style-span" style="font-family: monospace; line-height: normal; font-size: medium; white-space: pre; ">ImportError: No module named flup.server.fcgi</span></p><p>&nbsp;</p><p>&nbsp;另外，我在Ubuntu下多次上传都失败了，提示Import error: no module named web，无奈之下转到win中就成功上传了，不确定是图形界面的google app engine launcher比较厉害还是python sdk的appserver有问题。</p><p>&nbsp;</p><p>gae上面只能使用google的数据库，使用称为gql的查询语言。</p><p>要定义一个表：&nbsp;</p><p>from google.appengine.ext import db&nbsp;</p><p>&nbsp;class data(db.Model):</p><p><span class="Apple-tab-span" style="white-space:pre">	</span>content=db.StringProperty(multiline=True)</p><p><span class="Apple-tab-span" style="white-space:pre">	</span>date=db.DataTimeProperty(auto_now_add=True)</p><p><span class="Apple-tab-span" style="white-space:pre">	</span>title=db.StringProperty(multiline=False)</p><p><span class="Apple-tab-span" style="white-space:pre">	</span>myKey=db.StringProperty(multiline=False)</p><p>&nbsp;</p><p>&nbsp;为了索引记录，我用了一个笨方法，在记录中增加一个myKey字段来记录每个记录的Key值。Key是google用来定位每一条记录的内置属性。通过str函数，可以从key得到唯一的字串。</p><p>&nbsp;&nbsp;</p><p>&nbsp;查询一条记录：</p><p>db.get(db.Key(myKey))</p><p>&nbsp;</p><p>批量查询：</p><p>db.GqlQuery("SELECT * FROM data ORDER BY date DESC")&nbsp;</p><p>&nbsp;</p><p>&nbsp;插入记录：</p><p>record=data()</p><p>#设置record的相关属性</p><p>record.put()&nbsp;</p><p>&nbsp;</p><p>删除记录：</p><p>q=db.get(db.Key(myKey))</p><p>db.delete(q)</p><p>&nbsp;</p><p>&nbsp;更多关于gae的数据库信息，可以参考gae的官方文档（<a href="http://code.google.com/intl/zh-CN/appengine/docs/python/datastore/" target="_blank">有中文版</a>）。</p><p>&nbsp;</p><p>与python自带的web server不同，在gae中print语句也是直接输出到浏览器而不是服务器的日志中。 像是一个典型的cgi应用。</p><p>比较有参考价值的文章：<a href="http://hi.baidu.com/xusx/blog/item/801704fa5d84259258ee90dd.html" target="_blank">http://hi.baidu.com/xusx/blog/item/801704fa5d84259258ee90dd.html</a>&nbsp;手把手教程，没读完</p><p>　　　　　　　　　　　&nbsp;<a href="http://baiduer.net/2010/03/05/%E4%BD%BF%E7%94%A8webpy%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAblog/" target="_blank">http://baiduer.net/2010/03/05/使用webpy创建一个blog/</a>&nbsp;&nbsp; 另一个手把手。。。</p><p>&nbsp;</p><p>&nbsp;</p><p>最后推荐几个用python写的blog： &nbsp;<span class="Apple-tab-span" style="white-space:pre">	</span><a href="http://maoxingxu.appspot.com/" target="_blank">http://maoxingxu.appspot.com</a>&nbsp;这个是国内的技术人写的。</p><p><span class="Apple-tab-span" style="white-space:pre">						</span><a href="http://www.k4ml.com/archive/old/page165.html" target="_blank">http://www.k4ml.com/archive/old/page165.html</a>&nbsp;这个风格很简洁。。。</p><p><span class="Apple-tab-span" style="white-space:pre">						</span><a href="http://webpy.appspot.com/" target="_blank">http://webpy.appspot.com</a> &nbsp; 这个非常值得参考，似乎就是webpy的人写出来的。</p><p><span class="Apple-tab-span" style="white-space:pre">						</span><a href="http://micolog.appspot.com/zh-cn" target="_blank">http://micolog.appspot.com/zh-cn</a>&nbsp;目前比较通用的blog，可以直接使用。&nbsp;</p><p>&nbsp;　　　　　　　　　　　　　　　　 &nbsp;</p><p>我的留言本源代码：<a href="http://files.cnblogs.com/Lifehacker/myApp.7z" target="_blank">/Files/Lifehacker/myApp.7z</a>&nbsp;</p><p>ps：appspot需要翻墙访问&nbsp;</p><p><span class="Apple-tab-span" style="white-space:pre"></span></p><p><span class="Apple-tab-span" style="white-space:pre">						</span>&nbsp;</p><p><span class="Apple-tab-span" style="white-space:pre">						</span>&nbsp;</p><p><span class="Apple-tab-span" style="white-space:pre"></span></p><p>&nbsp;</p><p>&nbsp;</p>]]></description></item><item><title>web.py+gae=我的第一个留言板【一】</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/06/30/webpy_workingflow.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 30 Jun 2010 02:38:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/06/30/webpy_workingflow.html</guid><description><![CDATA[<p>最近体验了一把web.py开发的便捷。</p><p>建议在看web.py的cookbook之前，对http协议的get方法和post方法先了解一下，html最好也要有基本的知识。</p><p>&nbsp;</p><p>web.py的工作流程，一般是从URL映射开始，然后把请求分派给不同的处理类处理，处理类比较像一个粘合层，负责从数据层拿数据，以及告诉render如何形成最后的页面效果。同时，它也负责控制整个交互的过程。数据层封装了数据库相关的操作，有了它，可以很方便的更换不同的数据库。当然，在具体的字段属性上，可能会有一定的差异，需要注意一下。</p><p>&nbsp;</p><p>render是一个模板渲染系统，它使html变成了类似函数一样的东西，可以通过变量填充形成最终的页面。通过$符号，就能直接在html中写python语句，方便扩展功能。&nbsp;为了控制网站的整体风格，可能需要一个统一的layout.html和css去控制一些公共的框架。</p><p>&nbsp;</p><p>因此，遇到问题的时候，请从URL映射开始，遵循工作流程查找问题所在。特别是500服务器内部错误，很有可能是改动的时候只改了一处地方，相配合的负责展现的html模板或者数据层没有进行对应的修改。</p><p>&nbsp;</p><p>&nbsp;web.py还是比较简便的，我不太喜欢厚厚的粘合层，像structs什么的，最讨厌了^^ 不过python的确有点慢，即使web.py已经自动编译成pyc，速度上还是有待提高啊。另外还有一个问题没有解决，我定义不了404notfound信息:(</p><p>&nbsp;</p><p>参考：<a href="http://www.cnblogs.com/Lifehacker/admin/webpy.org" target="_blank">http://webpy.org</a> 建议参照tutorial和cookbook动手做做， 还是挺有趣的。另外，codeExample还有几个比较简单的例子可以参考，有助于快速建立自己的应用。我的留言板也参考了里面的blog例子。python自带了web server，所以即使你没有安装Apache之类的，还是能直接访问到自己的成果。</p><p>&nbsp;　　　<a href="http://www.cs.tut.fi/~jkorpela/forms/methods.html" target="_blank">http://www.cs.tut.fi/~jkorpela/forms/methods.html</a>&nbsp;The difference between post and get</p><p>　　若遇到attributeError的问题，可以参考上一篇我的上一篇<a href="http://www.cnblogs.com/Lifehacker/archive/2010/06/18/1759958.html" target="_blank">文章</a>&nbsp;，主要是web.py 0.3的某些调用方式改变了，而webpy.org的例子还是0.2版本。</p>]]></description></item><item><title>Datagram socket with connection-oriented in Java</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/06/22/datagram_with_connection_oriented_in_Java.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 22 Jun 2010 13:24:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/06/22/datagram_with_connection_oriented_in_Java.html</guid><description><![CDATA[<p>数据报通常采用udp协议进行传输，UDP相较于TCP协议能够节省带宽，相应的获得较高速度，但不能保证包的安全抵达和顺序不变。</p><p>Java关于datagram提供有connect方法，该方法绑定了远端的IP地址和端口号，即该socket以后只能向绑定目标主机发送数据或接受数据。</p><p>当目标地址不可达，且收到了该地址不可达的ICMP包时，会抛出<span class="Apple-style-span" style="font-family: Simsun; line-height: normal; font-size: medium; ">PortUnreachableException异常，但不能保证一定抛出该异常。</span></p><p>&nbsp;</p><p><span style="color: red; "><strong>该方法也不能保证包的顺序和安全抵达</strong></span>，只是为了发送的时候简便一点而已。。。&nbsp;</p>]]></description></item><item><title>the truth about sessions择译</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/06/20/1761432.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sun, 20 Jun 2010 08:43:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/06/20/1761432.html</guid><description><![CDATA[<p>cookie</p><p>get parameter</p><p>cookie+fingerprint generated by user agent</p>]]></description></item><item><title>web.py 0.3版本tutorial示例</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/06/18/1759958.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 18 Jun 2010 02:11:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/06/18/1759958.html</guid><description><![CDATA[<p>我承认我看中文了。。。中文安装指南导向的是web.py 0.2版本的tutorial翻译，版本有点旧，且0.3与0.2的tutorial不兼容。</p><p>&nbsp;</p><p>首先是下载压缩包，然后解压，最后sudo ./setup.py &nbsp;（我用的是ubuntu ）&nbsp;</p><p>示例代码如下，主要是run方法的方式有点不同。&nbsp;</p><p>&nbsp;</p><div class="cnblogs_code"><div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #008080;">&nbsp;1</span>&nbsp;<span style="color: #0000FF;">import</span><span style="color: #000000;">&nbsp;web<br /></span><span style="color: #008080;">&nbsp;2</span>&nbsp;<span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;3</span>&nbsp;<span style="color: #000000;">urls</span><span style="color: #000000;">=</span><span style="color: #000000;">(<br /></span><span style="color: #008080;">&nbsp;4</span>&nbsp;<span style="color: #000000;"></span><span style="color: #800000;">'</span><span style="color: #800000;">/</span><span style="color: #800000;">'</span><span style="color: #000000;">,</span><span style="color: #800000;">'</span><span style="color: #800000;">index</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;5</span>&nbsp;<span style="color: #000000;">)<br /></span><span style="color: #008080;">&nbsp;6</span>&nbsp;<span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;7</span>&nbsp;<span style="color: #000000;"></span><span style="color: #0000FF;">class</span><span style="color: #000000;">&nbsp;index:<br /></span><span style="color: #008080;">&nbsp;8</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">def</span><span style="color: #000000;">&nbsp;GET(self):<br /></span><span style="color: #008080;">&nbsp;9</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">return</span><span style="color: #000000;">&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello,world!</span><span style="color: #800000;">"</span><span style="color: #000000;"><br /></span><span style="color: #008080;">10</span>&nbsp;<span style="color: #000000;"><br /></span><span style="color: #008080;">11</span>&nbsp;<span style="color: #000000;">app</span><span style="color: #000000;">=</span><span style="color: #000000;">web.application(urls,globals())<br /></span><span style="color: #008080;">12</span>&nbsp;<span style="color: #000000;"><br /></span><span style="color: #008080;">13</span>&nbsp;<span style="color: #000000;"></span><span style="color: #0000FF;">if</span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">__name__</span><span style="color: #000000;">==</span><span style="color: #800000;">"</span><span style="color: #800000;">__main__</span><span style="color: #800000;">"</span><span style="color: #000000;">:<br /></span><span style="color: #008080;">14</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;app.run()<br /></span><span style="color: #008080;">15</span>&nbsp;<span style="color: #000000;"></span></div></div><p>&nbsp;</p><p>&nbsp;</p><p>好简洁的一个web app，感觉比java servelet的一大堆概念要清晰多了。&nbsp;</p>]]></description></item><item><title>apache-tomcat-6.0.26的cgi配置过程</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/05/24/apache_tomcat6_cgi_config.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 24 May 2010 01:53:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/05/24/apache_tomcat6_cgi_config.html</guid><description><![CDATA[<p>这东西折磨我太久了，写篇笔记。</p><p>&nbsp;</p><p>Apache的目录很好认，我下的是zip绿色版，解压开就看见running这个说明文件了，建议大家读读。</p><p>&nbsp;</p><p>conf目录是放置配置文件的，bin则是可执行文件的位置，只需双击startup.bat，即可启动Apache。</p><p>&nbsp;</p><p>要运行cgi，主要是改两个文件，一个是web.xml，一个是context.xml。</p><p>&nbsp;</p><p>context.xml主要是改这么一行：</p><div class="cnblogs_code"><div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">Context&nbsp;</span><span style="color: #FF0000;">privileged</span><span style="color: #0000FF;">="true"</span><span style="color: #0000FF;">&gt;</span></div></div><p>&nbsp;</p><p>直接在context后加上privileged就可以了，用于放行可执行文件。</p><p>&nbsp;</p><p>web.xml修改的是cgi那一段，其实默认也带有cgi的配置的，只是被注释掉而已。</p><div class="cnblogs_code"><div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #000000;">&nbsp;&nbsp; &nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">servlet</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">servlet-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">cgi</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">servlet-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">servlet-class</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">org.apache.catalina.servlets.CGIServlet</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">servlet-class</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">init-param</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">param-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">debug</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">param-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">param-value</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">0</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">param-value</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">init-param</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">init-param</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">param-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">passShellEnvironment</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">param-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">param-value</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">true</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">param-value</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">//<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">init-param</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">init-param</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">param-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">cgiPathPrefix</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">param-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">param-value</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">WEB-INF/cgi-bin</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">param-value</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">init-param</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">init-param</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">param-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">executable</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">param-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">param-value</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">cmd&nbsp;/c</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">param-value</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//c++的cgi解析方式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">init-param</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">load-on-startup</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">5</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">load-on-startup</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">servlet</span><span style="color: #0000FF;">&gt;</span></div></div><p>&nbsp;</p><p>还有：</p><div class="cnblogs_code"><div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #000000;">&nbsp;&nbsp; &nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">servlet-mapping</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">servlet-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">cgi</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">servlet-name</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;</span><span style="color: #800000;">url-pattern</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;">/cgi-bin/*</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">url-pattern</span><span style="color: #0000FF;">&gt;</span><span style="color: #000000;"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">&lt;/</span><span style="color: #800000;">servlet-mapping</span><span style="color: #0000FF;">&gt;</span></div></div><p>&nbsp;</p><p>&nbsp;</p><p>配置过程中遇到一个问题，就是静态网页可以正常显示，但点击其中的cgi连接时，cgi就被当成文件下载了，而不是由服务器解释执行。</p><p>&nbsp;</p><p>这个问题需要html文件、目录结构和以上web.xml配置的紧密配合才可以解决。</p><p>&nbsp;</p><p>假设当前目录结构是：</p><p>cookie&nbsp;</p><p>&#9474; &nbsp;cookie.html</p><p>&#9474; &nbsp;</p><p>&#9492;&#9472;WEB-INF</p><p>&nbsp;&nbsp; &nbsp;&#9492;&#9472;cgi-bin</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cookie.cgi</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cookie2.cgi</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cookie3.cgi</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp;</p><p>&nbsp;则：</p><p>&nbsp;</p><p>&nbsp;&lt;FORM method="POST" action=<span style="color: red; ">"cookie.cgi"&gt;</span></p><p>What is your customer id: &lt;input name="id"&gt;&lt;P&gt;</p><p>Press &lt;input type="submit" value="here"&gt; to submit your query.</p><p>&lt;/FORM&gt;</p><div><br /></div><p>上述的html代码，是无法正常工作的。点击按钮时，Apache会在html所在当前文件夹下寻找cgi文件。但默认的cgi前缀是WEB-INF/cgi-bin，路径不对，无法执行。改成/cookies/cgi-bin/cookie.cgi以后就可以了。</p><p>&nbsp;</p><p>至于cgi没有执行，变成文件下载了，主要是因为web.xml中servlet-mapping那一段的问题，只有路径中带有/cgi-bin/*的cgi文件才会被执行的。</p><p>&nbsp;</p><p>因此，只有web.xml的配置、目录结构以及html文件中指定的路径三者紧密配合，才有可能成功执行一个cgi。&nbsp;</p>]]></description></item><item><title>Matlab Cell功能</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/05/15/matlab_cell_mode.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 15 May 2010 12:43:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/05/15/matlab_cell_mode.html</guid><description><![CDATA[<p>　　最近完成模式分类的作业，需要大量使用matlab,期间发现了一个问题，是matlab代码的复用程度。</p><p>　　在面向过程编程里， 基本的复用单位是函数，程序的复杂度籍此下放到函数的接口上。设计好函数间的接口，基本上就成功了一半。在面向对象编程里， 基本的复用单位是对象，对象使得数据具有了一定程度的自维护。而在matlab里， 我很长时间都没有找到方向，因为我搞不清楚复用的单位是什么。</p><p>　　matlab中，基本的单位是矩阵，针对矩阵系统有一大堆的函数供你调用。但是，想自己写程序还是有一定的麻烦的。for循环语句在matlab里似乎是一个禁忌，所有老师都敦敦告诫，不要轻易使用for。而函数调用也是同样的低效， 有兴趣的同学可以参见<a href="http://dahua.spaces.live.com/blog/cns!28AF4251DF30CA42!2459.entry#trackback" target="_blank">此文</a>。那么我们应该基于什么模块进行复用呢？</p><p>　　答案是Cell模式。 Cell是matlab的一个特色功能，将一段代码以%%标记为cell以后，就可以重复执行了，相当于在命令行输入该代码块。以前，为了测试不同参数的结果，往往要用up arrow执行上一条指令。遇到需要多条指令的地方，就很容易出错。而算法又没有完善到可以封装成函数的地步，整天来回跑代码让人不堪其烦。通过cell模式，可以非常方便地在不同的代码块之间跳转，或重复执行一个代码块。</p><p>　　对于我来说，matlab中的编程越来越趋向于bash编程，所用到的语言只是起到一个粘合剂的作用，负责把系统内置的高性能函数组合起来。这种对语句块的复用方式能够快速地调试出需要的功能，有点类似传统的goto，但是可以一直观察着执行的结果，事前无须编译 ，也不用考虑函数的接口问题。当算法稳定下来，就可以考虑用一个接口轻易地封装成函数了。同时也可以直接保存为mfile供以后使用。</p><p><br /></p>]]></description></item><item><title>浅论函数式语言的环境，兼谈闭包</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/05/03/lisp-environment.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 03 May 2010 14:46:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/05/03/lisp-environment.html</guid><description><![CDATA[<p>函数式语言与命令式语言的一个根本不同，就是下面这个两个数交换的例子居然是正确的：</p><pre class="brush: py; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;">a=1
b=2
a,b=b,a
print a ,b
</pre>
<p>输出2 1</p>
<p>究其原因，是环境造成的。什么是环境呢？通俗点讲，你可以将环境看成是一个栈，栈单元的内容就是各个变量的值。可见，上述a和b赋值时的环境均是a=1，b=2。再看一个lisp的例子：</p>
<p>设环境r为 r=( (X.(A B)) (Y.(C D)))</p>
<p>则&#956;r((EXPR (X Y) (CONS X Y)) (CDR Y) (CAR X))</p>
<p>=&#956;r1 (CONS X Y)</p>
<p>其中r1=( (X.(D)) (Y .A) (X .(A B)) (Y . (C D)))</p>
<p>可见列表求值跟上述赋值的结果是一样的，环境决定了自变量的值。</p>
<p>&nbsp;</p>
<p>而闭包，则是打包了环境，相当于内部函数是在外层函数的环境下运行的。因此，又有人称JavaScript中的闭包是没有释放的资源（若释放了相关资源，调用内部函数就无法得到正确结果了）。</p>]]></description></item><item><title>最近要跟函数式语言干一仗！</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/05/01/using-clisp-for-the-first-time.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 01 May 2010 14:50:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/05/01/using-clisp-for-the-first-time.html</guid><description><![CDATA[<p>本来打算先征服ML（meta language）的，结果可耻地失败了，并且归结为译者水平太低。</p> <p>&nbsp;</p> <p>然后拿了本《Lisp语言》回来看，语言很平实，的确比较适合我，可惜作者马希文教授已经作古了，天妒英才啊。</p> <p>但是看完表之后还是卡住了，思维的转变的确不是一朝一夕的事。不过马教授比ML作者出色的地方，是开卷即讲述s表达式的概念，教你分清原子与s表达式。然后介绍简写法，流畅地引入了表的概念。而且表的描述非常生动（&#8220;没有右支是非nil原子结束的s表达式&#8221;），接下来的append、car、cdr都很入神了。</p> <p>&nbsp;</p> <p>下面讲讲配置的经过吧：</p> <p>lisp其实主要是一个技术标准，具体实现的时候允许不同版本之间的合理歧义。我选择的方言（即lisp的具体实现）是clisp，主要是因为它受众面比较广一点。</p> <p>&nbsp;</p> <p>刚刚配置的时候是采用cgywin升级安装clisp的，大约16MB。安装完之后，发现输入clisp出现了一个类似shell的对话式交互，解释执行的意思吧。</p> <p>&nbsp;</p> <p>后来采用vim配合的方法，先把函数定义写入文本文件，然后再在lisp中编译。不过好像没有语法高亮，而且运行的时候刷的一声就过去了。不清楚是否有main方法可以调用自己的函数进行测试。</p> <p>&nbsp;</p> <p>最后，选择了lispbox作为配合的IDE。lispbox带有slime，却一点都不slime&#8230;&#8230;要26MB多，安装完成后就可以得到一个分割窗口，上部显示跟clisp的交互，下部显示错误信息。需要注意的是，不要选择带有空格的路径进行安装。</p> <p>&nbsp;</p> <p>Emacs的快捷键很多，可我是vimer，再记一套快捷键有点记忆负担啊，现在最常用的是M-p（m表示meta，是alt键的意思，这是Emacs继承下来的快捷键表示法），键入上一条。</p>]]></description></item><item><title>RBF、 K-NN 与Decision tree</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/03/24/notes_about_neural_network.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 24 Mar 2010 05:13:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/03/24/notes_about_neural_network.html</guid><description><![CDATA[<p>要做一个classifier，的确不易。面对需要训练的classifier，是否training error越少越好呢？显然不是，因为虽然training error降低了，但test error不见得就会降低，实际表现为一个拐点。如下图：</p><p><img src="http://images.cnblogs.com/cnblogs_com/lifehacker/%E6%A8%A1%E5%BC%8F%E8%AF%86%E5%88%AB-training-error%E4%B8%8Etest-error.png" width="489" height="308" alt="" />&nbsp;</p><p>为了平衡error的权重，我们引入了额外的函数lambda*&#952;，训练效果由error和 lambda*&#952;共同评价。下面讨论一下lambda的取值：</p><p><img src="http://images.cnblogs.com/cnblogs_com/lifehacker/lambda_is_0.png" width="453" height="298" border="5" alt="" />&nbsp;</p><p><img src="http://images.cnblogs.com/cnblogs_com/lifehacker/lambda_is_between_0and1.png" width="453" height="298" border="5" alt="" />&nbsp;（存疑）</p><p>&nbsp;<img src="http://images.cnblogs.com/cnblogs_com/lifehacker/lambda_is_infinite.png" width="453" height="298" border="5" alt="" />&nbsp;</p><p>&nbsp;</p><p>&nbsp;通过加入额外的评价函数，我们对模型的训练应该是比较到位的。但是用一个函数对所有样本分类，在样本比较复杂的时候就会有点吃力。</p><p>因此，我们采取多个函数综合评估的方式进行，即RBF（radial base function）</p><p>RBF采取多个正态分布函数进行评估，各函数的均值和方差不一样。</p><p>&nbsp;</p><p>（待续）</p><p>&nbsp;</p><p>K-NN 最近邻算法。俗话说物以类聚，人以群分。该算法就是采用离目标点最近的k个邻居，对目标点进行分类。但k值的选取非常关键，而且易受干扰。</p><p>&nbsp;</p><p>&nbsp;decision tree：决策树，根据不同的决策选择不同的路径。</p><p><img src="http://images.cnblogs.com/cnblogs_com/lifehacker/decisionTree.png" width="453" height="298" alt="" />&nbsp;</p><p><img src="http://images.cnblogs.com/cnblogs_com/lifehacker/decisionTree2.png" width="453" height="298" alt="" />&nbsp;</p>]]></description></item><item><title>java路径设置</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/03/16/could-not-find-main-class-program-will-exit.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 16 Mar 2010 11:48:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/03/16/could-not-find-main-class-program-will-exit.html</guid><description><![CDATA[<p>这个问题简直是痛中之痛，为什么如此现代，标榜人性化的java居然会让我等在环境变量的设置上反复煎熬？！</p><p>&nbsp;</p><p>&#8220;计算机（右键）-属性-高级设置&#8221;，设置系统变量中，添加变量JAVA_HOME，</p><div class="cnblogs_code"><div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #000000;">JAVA_HOME</span><span style="color: #000000;">=</span><span style="color: #000000;">C:\Program&nbsp;Files\Java\jdk1.</span><span style="color: #000000;">6</span><span style="color: #000000;">.0_13<span class="Apple-style-span" style="font-family: verdana, 'courier new'; font-size: 14px; ">&nbsp;</span></span></div></div><p>在path变量中 （没有则新建），添加</p><p>&nbsp;<span class="Apple-style-span" style="font-family: 'Courier New'; font-size: 13px; "><span style="color: #000000;">;</span><span style="color: #000000;">%</span><span style="color: #000000;">JAVA_HOME</span><span style="color: #000000;">%</span><span style="color: #000000;">\bin</span></span></p><p>新建CLASSPATH变量 ,添加</p><p>&nbsp;</p><div class="cnblogs_code"><div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #000000;">CLASSPATH</span><span style="color: #000000;">=</span><span style="color: #000000;">.;</span><span style="color: #000000;">%</span><span style="color: #000000;">JAVA_HOME</span><span style="color: #000000;">%</span><span style="color: #000000;">\lib&nbsp;</span></div></div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;最后，利用史上最常用helloworld测试：</p><div class="cnblogs_code"><div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #0000FF;">class</span><span style="color: #000000;">&nbsp;Hello&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">public</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000FF;">static</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000FF;">void</span><span style="color: #000000;">&nbsp;main(String&nbsp;args[])&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(</span><span style="color: #000000;">"</span><span style="color: #000000;">Hello,&nbsp;world!</span><span style="color: #000000;">"</span><span style="color: #000000;">);&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br />}</span></div></div><p>&nbsp;</p><p>文件名保存为Hello.java，当前目录进入命令行，输入命令：</p><p>javac Hello.java</p><p>java Hello</p><p>&nbsp;</p><p>今天花了差不多一个小时，正常编译通过，就是因为敲了"java Hello.class"，所以一直报错&#8220;could not find main class program will exit&#8221;，悲剧&#8230;&#8230;</p>]]></description></item><item><title>同步与异步</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/03/09/1682061.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 09 Mar 2010 14:51:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/03/09/1682061.html</guid><description><![CDATA[在服务器与客户端通讯过程中，即典型的web应用，同步的意思是等待连接的另一端某事件发生后，本地再继续执行；异步则是发出某事件之后不待连接另一端响应，即马上进行下一步工作。]]></description></item><item><title>最长公共子序列---从动态规划说起</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/03/09/1681822.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 09 Mar 2010 08:42:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/03/09/1681822.html</guid><description><![CDATA[<p>我比较不长记性，你要我马上写一个动态规划给你是比较有难度的。在我眼里，动态规划就是一个优化程序的手段，适合于有大量重复子计算问题的时候用，原理就跟缓冲有点像，把需要重复计算的东西都放进内存里，需要的时候通过索引之类的东西直接查询，节省重新计算的时间。</p><p>下面来看一幅图：&nbsp;</p><p><img src="http://images.cnblogs.com/cnblogs_com/lifehacker/%E5%B8%A6%E6%9D%83%E5%9B%BE%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84.png" alt="" />&nbsp;</p><p>假设要从A到H，在这个带权图中求最短路径。那么有：</p><p>min(H)=min(min(F)+FH,min(G)+GH)</p><p>min(F)=min(min(D)+DF,min(E)+EF)</p><p>min(G)=min(min(D)+DG,min(E)+EG)</p><p>&#8230;&#8230;</p><p>从前三步，我们可以发现，min(D)、min(E) 均是重复计算了的，那么如果将其存起来，下次计算的时候就可以节省时间了。</p><p>从这个例子可以发现，动态规划要求问题必须要有最优子结构，即原问题可以递归到规模降低的子问题进行求解。</p><p>&nbsp;</p>]]></description></item><item><title>JavaScript中的闭包</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/03/08/JavaScript-closure.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 08 Mar 2010 00:06:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/03/08/JavaScript-closure.html</guid><description><![CDATA[<p>一看到闭包这个词，我就会想起线性代数中的封闭空间，也就是说，这个空间中的所有向量，无论经过何种运算，最终结果还是会落在该空间中。那么JavaScript中会不会也是类似的概念呢？</p><p>我们来看一个定义：</p><span class="Apple-style-span" style="font-family: ����, sans-serif; line-height: 23px; color: #666666; "><dt>Closure</dt></span><p><span class="Apple-style-span" style="font-family: ����, sans-serif; line-height: 23px; color: #666666; ">所谓&#8220;闭包&#8221;，指的是一个拥有许多变量和绑定了这些变量的环境的表达式（通常是一个函数），因而这些变量也是该表达式的一部分。</span></p><p>&nbsp;</p><p>这说明了，JavaScript中的闭包是包含了上下文的函数，也就是说，这个函数的作用基础，是它所处的环境，这是不能超越的，跟线性代数是不是有一点似曾相识的感觉呢？</p><p>&nbsp;</p><p>换个角度看，闭包的作用是为了实现OO。JavaScript中，没有像C++那样的public、private、protect属性标识， 建立起类比较困难。&#8220;类是带行为的数据，而闭包是带数据的行为&#8221;，在JavaScript中我们用函数的定义代替类的定义，用闭包代替了setter/getter方法。请看一段livecode：</p><div class="cnblogs_code"><div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #0000FF;">function</span><span style="color: #000000;">&nbsp;f1(){<br /><br />　　　　</span><span style="color: #0000FF;">var</span><span style="color: #000000;">&nbsp;n</span><span style="color: #000000;">=</span><span style="color: #000000;">1</span><span style="color: #000000;">;<br /><br />　　　　</span><span style="color: #0000FF;">function</span><span style="color: #000000;">&nbsp;getter(){<br />　　　　　　alert(n);<br />　　　　}<br /><br />　　　　</span><span style="color: #0000FF;">return</span><span style="color: #000000;">&nbsp;getter;<br /><br />　　}</span></div></div><p>&nbsp;</p><p>上文中n的声明和函数getter组成了一个典型的闭包。最终返回的函数，即刚刚所讲的&#8220;行为&#8221;，其实目的就是为了得到n的值，所以说闭包就是带有数据的行为。</p><p>另外，我觉得阮一峰说的闭包也是很简洁的：&#8220;<span class="Apple-style-span" style="font-family: Georgia, serif; line-height: 27px; font-size: 16px; ">我的理解是，闭包就是能够读取其他函数内部变量的函数。<span class="Apple-style-span" style="font-family: verdana, 'courier new'; line-height: 21px; font-size: 14px; ">&#8221;</span></span></p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;另一篇更为学术的解释：<a href="http://www.cn-cuckoo.com/2007/08/01/understand-javascript-closures-72.html#clClose" target="_blank">http://www.cn-cuckoo.com/2007/08/01/understand-javascript-closures-72.html#clClose</a></p><p>我希望各位能够真正从学术上的定义理解闭包，因为所有对闭包定义的诠释和简化都是对JavaScript的片面解读。</p><p>&nbsp;</p><p>&nbsp;</p>]]></description></item><item><title>Standard ML语言（一）</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/02/06/ML_program_notes.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 06 Feb 2010 03:45:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/02/06/ML_program_notes.html</guid><description><![CDATA[<p>在Windows平台下推荐使用Moscow ML解释器，主要是安装比较方便，其他有Standard ML of New Jersey,安装后需要设置环境变量（即bin目录所在位置）。</p><p>&nbsp;</p><p>要引用系统模块，请使用 load "module", 例如：</p><p>-load "Math";&nbsp;</p><p>&gt;it = ():unit&nbsp;</p><p>-Math 4.0;</p><p>&gt;it = 2.0 : real&nbsp;</p><p>&nbsp;</p><p>函数名后需要空一格。</p><p>&nbsp;</p><p>从C/C++语言转来的同学，请多多练习andalso与orelse，另外，条件表达式</p><p>　　　　　　　　　　if E then E1 else E2&nbsp;</p><p>else部分必须存在（即else需要严格匹配，一个if对应一个else）。</p><p>附上ML程序设计教程 <a href="http://files.cnblogs.com/Lifehacker/exercises.7z" target="_blank">课后习题答案</a><a></a></p>]]></description></item><item><title>初探Git</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/02/05/first_time_I_use_git.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Fri, 05 Feb 2010 15:59:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/02/05/first_time_I_use_git.html</guid><description><![CDATA[<p>今天闷着头看了半天git，终于明白了git的基本工作原理。想提高你对git的认识，请移玉步到<a href="http://progit.org/book/zh" target="_blank">http://progit.org/book/zh</a>，中文翻译很不错，感谢先行的兄弟们！</p><p>&nbsp;</p><p>以前项目组进行版本管理的时候，采用的是tortoiseSVN，正如某君所说，SVN并非一无是处，但是总有又痛又痒的感觉。学习SVN，我有了和其他人进行版本协作的经验，不过发生合并冲突的机会还是比较少的（一般每个人负责一个单元），常用的操作就是checkout然后coding。不得不说，由于和服务器的交换速度太慢，且小文件居多，每次checkout和commit都非常痛苦。那时候就幻想，为什么版本管理不能放在本地呢&#8230;&#8230;</p><p>&nbsp;</p><p>后来，做另一个项目的时候，更加晕菜。其实真正写代码的人就两三个，但在实验室写的代码经常要带回宿舍看，一来二去的比较混乱。我们又是那种想到哪改哪的人，出错的时候总想回到原来，要有时光机多好啊。最后实在没办法，想出了一个笨办法，每次成功运行就打包一次，标上日期。那段日子简直是中世纪！！！</p><p>&nbsp;</p><p>最后，git慢慢进入了我的视野。我开始明白到，分布式版本管理是需要的，但不是最急迫的。我最需要的，是一个版本管理系统协助我进行coding。git有tag，代码每次成熟到一定阶段，就可以打上一个tag，灰常方便。 当然，git最强大的是branch。</p><p>&nbsp;</p><p>branch是形成git独特的树式管理结构的关键。每次想开始新工作的时候，首先定下一个目标，然后为这个目标新建一个branch，之后的工作就可以在这个branch上开展。忽然，你有冒出了一个更好的点子，没问题，git master能够把你带回到工作的起点。赶快新建一个branch并为之coding，完成！好了，这时候这两个branch可能需要合并了，git merge帮你忙！当一天辛勤工作结束后，就可以执行commit了，注意commit是针对当前branch的。</p><p>&nbsp;</p><p>&nbsp;</p>]]></description></item><item><title>Linux 超级块</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/02/03/Linux_superblock_structure.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 03 Feb 2010 07:23:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/02/03/Linux_superblock_structure.html</guid><description><![CDATA[<p>Linux 超级块的结构</p><div class="cnblogs_code"><div><!--<br/ /><br/ />Code highlighting produced by Actipro CodeHighlighter (freeware)<br/ />http://www.CodeHighlighter.com/<br/ /><br/ />--><span style="color: #008080;">&nbsp;1</span>&nbsp;<span style="color: #008000;">//</span><span style="color: #008000;">come&nbsp;from&nbsp;/usr/src/kernel/'uname&nbsp;&#8211;r'/include/linux/fs.h&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">&nbsp;2</span>&nbsp;<span style="color: #008000;"></span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;super_block&nbsp;{&nbsp;<br /></span><span style="color: #008080;">&nbsp;3</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;list_head&nbsp;s_list;&nbsp;</span><span style="color: #008000;">/*</span><span style="color: #008000;">&nbsp;Keep&nbsp;this&nbsp;first&nbsp;</span><span style="color: #008000;">*/</span><span style="color: #000000;">&nbsp;<br /></span><span style="color: #008080;">&nbsp;4</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dev_t&nbsp;s_dev;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">/*</span><span style="color: #008000;">&nbsp;search&nbsp;index;&nbsp;_not_&nbsp;kdev_t&nbsp;</span><span style="color: #008000;">*/</span><span style="color: #000000;">&nbsp;<br /></span><span style="color: #008080;">&nbsp;5</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;</span><span style="color: #0000FF;">long</span><span style="color: #000000;">&nbsp;s_blocksize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">数据块大小&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">&nbsp;6</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;</span><span style="color: #0000FF;">char</span><span style="color: #000000;">&nbsp;s_blocksize_bits;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">块大小占用的位数&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">&nbsp;7</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;</span><span style="color: #0000FF;">char</span><span style="color: #000000;">&nbsp;s_dirt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">脏位，如果该位置位，说明超级块被修改&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">&nbsp;8</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;</span><span style="color: #0000FF;">long</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000FF;">long</span><span style="color: #000000;">&nbsp;s_maxbytes;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">单个文件最大体积&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">&nbsp;9</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;file_system_type&nbsp;</span><span style="color: #000000;">*</span><span style="color: #000000;">s_type;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">文件系统结构&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">10</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;super_operations&nbsp;</span><span style="color: #000000;">*</span><span style="color: #000000;">s_op;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">超级块支持的操作</span><span style="color: #008000;"><br /></span><span style="color: #008080;">11</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;dquot_operations&nbsp;</span><span style="color: #000000;">*</span><span style="color: #000000;">dq_op;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//<br /></span><span style="color: #008080;">12</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;quotactl_ops&nbsp;</span><span style="color: #000000;">*</span><span style="color: #000000;">s_qcop;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">用户配额限制</span><span style="color: #008000;"><br /></span><span style="color: #008080;">13</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;export_operations&nbsp;</span><span style="color: #000000;">*</span><span style="color: #000000;">s_export_op;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//<br /></span><span style="color: #008080;">14</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;"><br /></span><span style="color: #008080;">15</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;longs_flags;&nbsp;<br /></span><span style="color: #008080;">16</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;</span><span style="color: #0000FF;">long</span><span style="color: #000000;">&nbsp;s_magic;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">区块的magic数</span><span style="color: #008000;"><br /></span><span style="color: #008080;">17</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;dentry&nbsp;</span><span style="color: #000000;">*</span><span style="color: #000000;">s_root;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">根目录</span><span style="color: #008000;"><br /></span><span style="color: #008080;">18</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;rw_semaphore&nbsp;s_umount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//<br /></span><span style="color: #008080;">19</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;mutex&nbsp;s_lock;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//<br /></span><span style="color: #008080;">20</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">int</span><span style="color: #000000;">&nbsp;s_count;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//<br /></span><span style="color: #008080;">21</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">int</span><span style="color: #000000;">&nbsp;s_syncing;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//<br /></span><span style="color: #008080;">22</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">int</span><span style="color: #000000;">&nbsp;s_need_sync_fs;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//<br /></span><span style="color: #008080;">23</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;atomic_t&nbsp;s_active;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">是否活动</span><span style="color: #008000;"><br /></span><span style="color: #008080;">24</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">void</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">*</span><span style="color: #000000;">s_security;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//<br /></span><span style="color: #008080;">25</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;xattr_handler&nbsp;</span><span style="color: #000000;">**</span><span style="color: #000000;">s_xattr;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//<br /></span><span style="color: #008080;">26</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;"><br /></span><span style="color: #008080;">27</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;list_head&nbsp;s_inodes;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">所有inode&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">28</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;list_head&nbsp;s_dirty;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">脏inode&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">29</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;list_head&nbsp;s_io;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">用于写回的缓存&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">30</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;hlist_head&nbsp;s_anon;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">nfs匿名入口&nbsp;</span><span style="color: #008000;"><br /></span><span style="color: #008080;">31</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;list_head&nbsp;s_files;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">文件链表头</span><span style="color: #008000;"><br /></span><span style="color: #008080;">32</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;"><br /></span><span style="color: #008080;">33</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;block_device&nbsp;</span><span style="color: #000000;">*</span><span style="color: #000000;">s_bdev;&nbsp;<br /></span><span style="color: #008080;">34</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;list_head&nbsp;s_instances;&nbsp;<br /></span><span style="color: #008080;">35</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;quota_info&nbsp;s_dquot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">配额定制选项</span><span style="color: #008000;"><br /></span><span style="color: #008080;">36</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;"><br /></span><span style="color: #008080;">37</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">int</span><span style="color: #000000;">&nbsp;s_frozen;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080;">38</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wait_queue_head_t&nbsp;s_wait_unfrozen;<br /></span><span style="color: #008080;">39</span>&nbsp;<span style="color: #000000;"><br /></span><span style="color: #008080;">40</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">char</span><span style="color: #000000;">&nbsp;s_id[</span><span style="color: #800080;">32</span><span style="color: #000000;">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">名字</span><span style="color: #008000;"><br /></span><span style="color: #008080;">41</span>&nbsp;<span style="color: #008000;"></span><span style="color: #000000;"><br /></span><span style="color: #008080;">42</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">void</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">*</span><span style="color: #000000;">s_fs_info;&nbsp;</span><span style="color: #008000;">/*</span><span style="color: #008000;">&nbsp;Filesystem&nbsp;private&nbsp;info&nbsp;</span><span style="color: #008000;">*/</span><span style="color: #000000;">&nbsp;<br /></span><span style="color: #008080;">43</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">/*</span><span style="color: #008000;">*&nbsp;The&nbsp;next&nbsp;field&nbsp;is&nbsp;for&nbsp;VFS&nbsp;*only*.&nbsp;No&nbsp;filesystems&nbsp;have&nbsp;any&nbsp;business&nbsp;<br /></span><span style="color: #008080;">44</span>&nbsp;<span style="color: #008000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;even&nbsp;looking&nbsp;at&nbsp;it.&nbsp;You&nbsp;had&nbsp;been&nbsp;warned.&nbsp;</span><span style="color: #008000;">*/</span><span style="color: #000000;">&nbsp;<br /></span><span style="color: #008080;">45</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">struct</span><span style="color: #000000;">&nbsp;mutex&nbsp;s_vfs_rename_mutex;&nbsp;</span><span style="color: #008000;">/*</span><span style="color: #008000;">&nbsp;Kludge&nbsp;</span><span style="color: #008000;">*/</span><span style="color: #000000;">&nbsp;<br /></span><span style="color: #008080;">46</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">/*</span><span style="color: #008000;">&nbsp;Granularity&nbsp;of&nbsp;c/m/atime&nbsp;in&nbsp;ns.&nbsp;Cannot&nbsp;be&nbsp;worse&nbsp;than&nbsp;a&nbsp;second&nbsp;</span><span style="color: #008000;">*/</span><span style="color: #000000;">&nbsp;<br /></span><span style="color: #008080;">47</span>&nbsp;<span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u32&nbsp;s_time_gran;&nbsp;<br /></span><span style="color: #008080;">48</span>&nbsp;<span style="color: #000000;">};</span></div></div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>嵌入式系统概念笔记</title><link>http://www.cnblogs.com/Lifehacker/archive/2010/02/03/embeddedSystem.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Wed, 03 Feb 2010 03:31:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2010/02/03/embeddedSystem.html</guid><description><![CDATA[<a href="https://embededsystem.wikispaces.com/" target="_blank">https://embededsystem.wikispaces.com/</a>]]></description></item><item><title>watchdog</title><link>http://www.cnblogs.com/Lifehacker/archive/2009/11/03/1595621.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 03 Nov 2009 15:34:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2009/11/03/1595621.html</guid><description><![CDATA[嵌入式系统中用于监视系统正常运行，防止宕机而拒绝服务。系统需定时重置watchdog，否则watchdog会自动重启系统。Linux下也有watchdog，若watchdog没有对应的硬件设备，则通过RTC来软件模拟。watchdog需要在编译内核的时候打开相应选项才能使用。使用时，打开/dev/watchdog，系统即自动启动一个60s的watchdog，进程需定时写入watchdog以重置它，否则watchdog会重启系统；当然，watchdog也可以设置相应的故障处理程序，只要系统不至于完全失去响应，相关故障处理程序可以主动卸载文件系统再重启，防止数据丢失。]]></description></item><item><title>linux进程信息</title><link>http://www.cnblogs.com/Lifehacker/archive/2009/11/03/1595618.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 03 Nov 2009 15:28:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2009/11/03/1595618.html</guid><description><![CDATA[Linux进程的信息都以文件信息存放在/proc目录下，常用的有stat、status和vmstat等，每一个进程都会有对应进程号的目录，目录中存放着进程所打开的文件描述符以及其他一些系统函数调用的次数。]]></description></item><item><title>copy on write</title><link>http://www.cnblogs.com/Lifehacker/archive/2009/10/31/copy-on-write.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Sat, 31 Oct 2009 08:52:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2009/10/31/copy-on-write.html</guid><description><![CDATA[copy on write简单来说，就是发生copy操作的时候并不直接复制，而是创建一个指针指向源文件地址。执行读操作的时候直接在源文件上读取，只有发生写操作的时候（包括源文件和目标文件），才会完整的复制一份。]]></description></item><item><title>反转分页表（Inverted page tables)</title><link>http://www.cnblogs.com/Lifehacker/archive/2009/09/29/inverted_page_table.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Tue, 29 Sep 2009 08:26:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2009/09/29/inverted_page_table.html</guid><description><![CDATA[采用分页机制不失为一个好办法，但对于64bit的系统，virtual address的范围有点太大了，若仍旧采用page table的办法，则page table将会占用大量内存（若分页大小为4K，2<sup>64</sup>/4K约为2<sup>52</sup>，假设表中每项为8byte，则需32768TB），最后得不偿失。因此，业界提出了反转分页表。<br />&nbsp;&nbsp;&nbsp; 反转分页表与分页表刚好相反，分页表通过virtual address直接定位到表项，进而得到具体的物理地址。而反转分页表的每一项对应一个物理帧（Frame)，通过同时查找整个表，得到虚拟地址对应的物理帧。因为涉及到整个表的内容查找，所以速度较慢。人们又进一步地提出了解决方案，使用哈希表（hash table）缩小查找范围。<br /><img alt="" src="http://images.cnblogs.com/cnblogs_com/lifehacker/inverted_page_table.png" height="384" width="797" />]]></description></item><item><title>银行家算法（The banker's algorithm)</title><link>http://www.cnblogs.com/Lifehacker/archive/2009/09/29/banker_algorithm.html</link><dc:creator>lifehacker</dc:creator><author>lifehacker</author><pubDate>Mon, 28 Sep 2009 16:17:00 GMT</pubDate><guid>http://www.cnblogs.com/Lifehacker/archive/2009/09/29/banker_algorithm.html</guid><description><![CDATA[银行家算法主要用于解决死锁问题，是一种基于静态资源分配的死锁检测方法。<br />首先，我们为资源定义出三种状态：<br /><ol><li>已被进程占用</li><li>进程资源需求最大值</li><li>系统可用资源</li></ol><br />易见，（1）+（3）=系统资源总和<br /><br />银行家算法就是通过枚举，验证能否通过手头上的可用资源，逐次满足各进程需要，并释放其占用资源，最终<br />实现所有进程的运行需要。<br /><br />下面通过矩阵演示算法运行过程：<br />假设在某一状态，有<br /><br /><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #000000;">进程&nbsp;&nbsp;最大需求内存&nbsp;&nbsp;需求打印机&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;已占用内存&nbsp;&nbsp;&nbsp;已占用打印机<br />A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800080;">100</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #800080;">1</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">80</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #800080;">0</span><span style="color: #000000;"><br />B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800080;">200</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #800080;">0</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">50</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800080;">0</span></div><br /><br />可用资源：<br />内存&nbsp;&nbsp; 打印机<br />150&nbsp;&nbsp;&nbsp; 1<br /><br />可见，A的需求能够满足。假设A能顺利运行并结束，则A释放所占用资源，此时矩阵化为：<br /><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #000000;">进程&nbsp;&nbsp;最大需求内存&nbsp;&nbsp;需求打印机&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;已占用内存&nbsp;&nbsp;&nbsp;已占用打印机<br />A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800080;">100</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800080;">1</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">80</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800080;">0</span><span style="color: #000000;"><br />B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800080;">200</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800080;">0</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">50</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800080;">0</span></div><br /> <br /> 可用资源：<br /> 内存&nbsp;&nbsp; 打印机<br /> 230 &nbsp;&nbsp; 1<br /><br />此时，B进程的需求也得到满足，所有进程最后均顺利结束。我们称这种状态为安全状态（safe state）。反之，<br />则称为不安全状态（unsafe state)。不安全状态只是找不到一种合适的顺序，可以在使用已有资源的情况下逐次满足<br />*所有*进程的运行需要，但不一定导致死锁。下面假设两种情况：<br /><ol><li>有A、B两进程，当前可用资源无法满足任一进程的需要，但A在运行时暂时释放了所占用的资源，使得B得以结束，从而释放更多资源，使得A顺利结束。</li><li>有A、B、C三个进程，当前资源可以满足A的运行需要，因此此时A并没有陷入死锁。</li></ol>因此，安全状态保证了一定不会发生死锁，而不安全状态没有这个保证，仅此而已。在实际应用当中，往往不能预知进程所需的资源最大值，且资源的可用性<br />容易改变（例如打印机卡纸了），所以应用不广。<br />相关链接：<br />死锁：<a title="http://en.wikipedia.org/wiki/Deadlock" href="http://en.wikipedia.org/wiki/Deadlock">http://en.wikipedia.org/wiki/Deadlock</a><br />银行家算法（英文）：<a title="http://en.wikipedia.org/wiki/Banker%27s_algorithm" href="http://en.wikipedia.org/wiki/Banker%27s_algorithm">http://en.wikipedia.org/wiki/Banker%27s_algorithm</a>]]></description></item></channel></rss>